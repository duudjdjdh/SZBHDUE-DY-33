/*! For license information please see out.js.LICENSE.txt */
https://nettleweb.com/


/*! Copyright (C) 2024 nettleweb.com; All rights reserved. !*/
"use strict";

(()=>{function A(){try{return"object"==typeof indexedDB}catch(A){return!1}}function B(){return new Promise(((A,B)=>{try{let C=!0;const D="validate-browser-context-for-indexeddb-analytics-module",E=self.indexedDB.open(D);E.onsuccess=()=>{E.result.close(),C||self.indexedDB.deleteDatabase(D),A(!0)},E.onupgradeneeded=()=>{C=!1},E.onerror=()=>{var A;B((null===(A=E.error)||void 0===A?void 0:A.message)||"")}}catch(A){B(A)}}))}function C(A,B){if(A===B)return!0;const E=Object.keys(A),F=Object.keys(B)
;for(const G of E){if(!F.includes(G))return!1;const E=A[G],H=B[G];if(D(E)&&D(H)){if(!C(E,H))return!1}else if(E!==H)return!1}for(const A of F)if(!E.includes(A))return!1;return!0}function D(A){return null!==A&&"object"==typeof A}function E(A,B=1e3,C=2){const D=B*Math.pow(C,A),E=Math.round(.5*D*(Math.random()-.5)*2);return Math.min(144e5,D+E)}function F(A){return A&&A._delegate?A._delegate:A}function G(A){
return A!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(…ª||(…ª=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(A)?function(...B){return A.apply( Ç(this),B),I(…º.get(this))}:function(...B){return I(A.apply( Ç(this),B))}:function(B,...C){const D=A.call( Ç(this),B,...C);return …æ.set(D,B.sort?B.sort():[B]),I(D)}}function H(A){return"function"==typeof A?G(A):(A instanceof IDBTransaction&&function(A){
if(…Ω.has(A))return;const B=new Promise(((B,C)=>{const D=()=>{A.removeEventListener("complete",E),A.removeEventListener("error",F),A.removeEventListener("abort",F)},E=()=>{B(),D()},F=()=>{C(A.error||new DOMException("AbortError","AbortError")),D()};A.addEventListener("complete",E),A.addEventListener("error",F),A.addEventListener("abort",F)}));…Ω.set(A,B)}(A),B=A,(…∫||(…∫=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((A=>B instanceof A))?new Proxy(A, Å):A);var B}function I(A){
if(A instanceof IDBRequest)return function(A){const B=new Promise(((B,C)=>{const D=()=>{A.removeEventListener("success",E),A.removeEventListener("error",F)},E=()=>{B(I(A.result)),D()},F=()=>{C(A.error),D()};A.addEventListener("success",E),A.addEventListener("error",F)}));return B.then((B=>{B instanceof IDBCursor&&…º.set(B,A)})).catch((()=>{})), Ä.set(B,A),B}(A);if(…ø.has(A))return …ø.get(A);const B=H(A);return B!==A&&(…ø.set(A,B), Ä.set(B,A)),B}
function J(A,B,{blocked:C,upgrade:D,blocking:E,terminated:F}={}){const G=indexedDB.open(A,B),H=I(G);return D&&G.addEventListener("upgradeneeded",(A=>{D(I(G.result),A.oldVersion,A.newVersion,I(G.transaction),A)})),C&&G.addEventListener("blocked",(A=>C(A.oldVersion,A.newVersion,A))),H.then((A=>{F&&A.addEventListener("close",(()=>F())),E&&A.addEventListener("versionchange",(A=>E(A.oldVersion,A.newVersion,A)))})).catch((()=>{})),H}function K(A,B){
if(!(A instanceof IDBDatabase)||B in A||"string"!=typeof B)return;if( Ö.get(B))return  Ö.get(B);const C=B.replace(/FromIndex$/,""),D=B!==C,E= Ñ.includes(C);if(!(C in(D?IDBIndex:IDBObjectStore).prototype)||!E&&! É.includes(C))return;const F=async function(A,...B){const F=this.transaction(A,E?"readwrite":"readonly");let G=F.store;return D&&(G=G.index(B.shift())),(await Promise.all([G[C](...B),E&&F.done]))[0]};return  Ö.set(B,F),F}function L(A,B){try{A.container.addComponent(B)}catch(C){
 ä.debug(`Component ${B.name} failed to register with FirebaseApp ${A.name}`,C)}}function M(A){const B=A.name;if( ©.has(B))return  ä.debug(`There were multiple attempts to register component ${B}.`),!1; ©.set(B,A);for(const B of  ß.values())L(B,A);for(const B of  ®.values())L(B,A);return!0}function N(A,B){const C=A.container.getProvider("heartbeat").getImmediate({optional:!0});return C&&C.triggerHeartbeat(),A.container.getProvider(B)}function O(A,B={}){let D=A;"object"!=typeof B&&(B={name:B})
;const E=Object.assign({name: •,automaticDataCollectionEnabled:!0},B),F=E.name;if("string"!=typeof F||!F)throw  ™.create("bad-app-name",{appName:F+""});if(D||(D=…´()),!D)throw  ™.create("no-options");const G= ß.get(F);if(G){if(C(D,G.options)&&C(E,G.config))return G;throw  ™.create("duplicate-app",{appName:F})}const H=new …≥(F);for(const A of  ©.values())H.addComponent(A);const I=new  ´(D,E,H);return  ß.set(F,I),I}function P(A,B,C){var D;let E=null!==(D= ¶[A])&&void 0!==D?D:A;C&&(E+="-"+C)
;const F=E.match(/\s|\//),G=B.match(/\s|\//);if(F||G){const A=[`Unable to register library "${E}" with version "${B}":`];return F&&A.push(`library name "${E}" contains illegal characters (whitespace or "/")`),F&&G&&A.push("and"),G&&A.push(`version name "${B}" contains illegal characters (whitespace or "/")`),void  ä.warn(A.join(" "))}M(new …∞(E+"-version",(()=>({library:E,version:B})),"VERSION"))}function Q(){return  ≠||( ≠=J("firebase-heartbeat-database",1,{upgrade:(A,B)=>{if(0===B)try{
A.createObjectStore( ¨)}catch(A){}}}).catch((A=>{throw  ™.create("idb-open",{originalErrorMessage:A.message})}))), ≠}async function R(A,B){try{const C=(await Q()).transaction( ¨,"readwrite"),D=C.objectStore( ¨);await D.put(B,S(A)),await C.done}catch(A){if(A instanceof …≠) ä.warn(A.message);else{const B= ™.create("idb-set",{originalErrorMessage:null==A?void 0:A.message}); ä.warn(B.message)}}}function S(A){return`${A.name}!${A.options.appId}`}function T(){return(new Date).toISOString().substring(0,10)}
function U(A){return …ß(JSON.stringify({version:2,heartbeats:A})).length}function V(A){return A instanceof …≠&&A.code.includes("request-failed")}function W({projectId:A}){return`https://firebaseinstallations.googleapis.com/v1/projects/${A}/installations`}function X(A){return{token:A.token,requestStatus:2,expiresIn:(B=A.expiresIn,Number(B.replace("s","000"))),creationTime:Date.now()};var B}async function Y(A,B){const C=(await B.json()).error;return  µ.create("request-failed",{requestName:A,
serverCode:C.code,serverMessage:C.message,serverStatus:C.status})}function Z({apiKey:A}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":A})}function a(A,{refreshToken:B}){const C=Z(A);return C.append("Authorization",function(A){return`${ ¥} ${A}`}(B)),C}async function b(A){const B=await A();return B.status>=500&&B.status<600?A():B}function c(A){return new Promise((B=>{setTimeout(B,A)}))}function d(){try{const A=new Uint8Array(17)
;(self.crypto||self.msCrypto).getRandomValues(A),A[0]=112+A[0]%16;const B=function(A){const B=(C=A,btoa(String.fromCharCode(...C)).replace(/\+/g,"-").replace(/\//g,"_"));var C;return B.substr(0,22)}(A);return  ∂.test(B)?B:""}catch(A){return""}}function e(A){return`${A.appName}!${A.appId}`}function f(A,B){const C=e(A);g(C,B),function(A,B){const C=h();C&&C.postMessage({key:A,fid:B}),i()}(C,B)}function g(A,B){const C= ∑.get(A);if(C)for(const A of C)A(B)}function h(){
return! ∏&&"BroadcastChannel"in self&&( ∏=new BroadcastChannel("[Firebase] FID Change"), ∏.onmessage=A=>{g(A.data.key,A.data.fid)}), ∏}function i(){0=== ∑.size&& ∏&&( ∏.close(), ∏=null)}function j(){return  ∫||( ∫=J("firebase-installations-database",1,{upgrade:(A,B)=>{0===B&&A.createObjectStore( π)}})), ∫}async function k(A,B){const C=e(A),D=(await j()).transaction( π,"readwrite"),E=D.objectStore( π),F=await E.get(C);return await E.put(B,C),await D.done,F&&F.fid===B.fid||f(A,B.fid),B}async function l(A){
const B=e(A),C=(await j()).transaction( π,"readwrite");await C.objectStore( π).delete(B),await C.done}async function m(A,B){const C=e(A),D=(await j()).transaction( π,"readwrite"),E=D.objectStore( π),F=await E.get(C),G=B(F);return void 0===G?await E.delete(C):await E.put(G,C),await D.done,!G||F&&F.fid===G.fid||f(A,G.fid),G}async function n(A){let B;const C=await m(A.appConfig,(C=>{const D=function(A){const B=A||{fid:d(),registrationStatus:0};return q(B)}(C),E=function(A,B){
if(0===B.registrationStatus){if(!navigator.onLine)return{installationEntry:B,registrationPromise:Promise.reject( µ.create("app-offline"))};const C={fid:B.fid,registrationStatus:1,registrationTime:Date.now()},D=async function(A,B){try{const C=await async function({appConfig:A,heartbeatServiceProvider:B},{fid:C}){const D=W(A),E=Z(A),F=B.getImmediate({optional:!0});if(F){const A=await F.getHeartbeatsHeader();A&&E.append("x-firebase-client",A)}const G={fid:C,authVersion: ¥,appId:A.appId,sdkVersion: ≥
},H={method:"POST",headers:E,body:JSON.stringify(G)},I=await b((()=>fetch(D,H)));if(I.ok){const A=await I.json();return{fid:A.fid||C,registrationStatus:2,refreshToken:A.refreshToken,authToken:X(A.authToken)}}throw await Y("Create Installation",I)}(A,B);return k(A.appConfig,C)}catch(C){throw V(C)&&409===C.customData.serverCode?await l(A.appConfig):await k(A.appConfig,{fid:B.fid,registrationStatus:0}),C}}(A,C);return{installationEntry:C,registrationPromise:D}}return 1===B.registrationStatus?{
installationEntry:B,registrationPromise:o(A)}:{installationEntry:B}}(A,D);return B=E.registrationPromise,E.installationEntry}));return""===C.fid?{installationEntry:await B}:{installationEntry:C,registrationPromise:B}}async function o(A){let B=await p(A.appConfig);for(;1===B.registrationStatus;)await c(100),B=await p(A.appConfig);if(0===B.registrationStatus){const{installationEntry:B,registrationPromise:C}=await n(A);return C||B}return B}function p(A){return m(A,(A=>{
if(!A)throw  µ.create("installation-not-found");return q(A)}))}function q(A){return 1===(B=A).registrationStatus&&B.registrationTime+ ≤<Date.now()?{fid:A.fid,registrationStatus:0}:A;var B}async function r({appConfig:A,heartbeatServiceProvider:B},C){const D=function(A,{fid:B}){return`${W(A)}/${B}/authTokens:generate`}(A,C),E=a(A,C),F=B.getImmediate({optional:!0});if(F){const A=await F.getHeartbeatsHeader();A&&E.append("x-firebase-client",A)}const G={installation:{sdkVersion: ≥,appId:A.appId}},H={
method:"POST",headers:E,body:JSON.stringify(G)},I=await b((()=>fetch(D,H)));if(I.ok)return X(await I.json());throw await Y("Generate Auth Token",I)}async function s(A,B=!1){let C;const D=await m(A.appConfig,(D=>{if(!u(D))throw  µ.create("not-registered");const E=D.authToken;if(!B&&function(A){return 2===A.requestStatus&&!function(A){const B=Date.now();return B<A.creationTime||A.creationTime+A.expiresIn<B+36e5}(A)}(E))return D;if(1===E.requestStatus)return C=async function(A,B){
let C=await t(A.appConfig);for(;1===C.authToken.requestStatus;)await c(100),C=await t(A.appConfig);const D=C.authToken;return 0===D.requestStatus?s(A,B):D}(A,B),D;{if(!navigator.onLine)throw  µ.create("app-offline");const B=function(A){const B={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},A),{authToken:B})}(D);return C=async function(A,B){try{const C=await r(A,B),D=Object.assign(Object.assign({},B),{authToken:C});return await k(A.appConfig,D),C}catch(C){
if(!V(C)||401!==C.customData.serverCode&&404!==C.customData.serverCode){const C=Object.assign(Object.assign({},B),{authToken:{requestStatus:0}});await k(A.appConfig,C)}else await l(A.appConfig);throw C}}(A,B),B}}));return C?await C:D.authToken}function t(A){return m(A,(A=>{if(!u(A))throw  µ.create("not-registered");const B=A.authToken;return 1===(C=B).requestStatus&&C.requestTime+ ≤<Date.now()?Object.assign(Object.assign({},A),{authToken:{requestStatus:0}}):A;var C}))}function u(A){
return void 0!==A&&2===A.registrationStatus}async function v(A,B=!1){const C=A;return await async function(A){const{registrationPromise:B}=await n(A);B&&await B}(C),(await s(C,B)).token}function w(A){return  µ.create("missing-app-config-values",{valueName:A})}function x(A){if(!A.startsWith( æ)){const B=ÀÄ.create("invalid-gtag-resource",{gtagURL:A});return  ø.warn(B.message),""}return A}function y(A){return Promise.all(A.map((A=>A.catch((A=>A)))))}function z(A,B){const C=function(A,B){let C
;return window.trustedTypes&&(C=window.trustedTypes.createPolicy(A,B)),C}("firebase-js-sdk-policy",{createScriptURL:x}),D=document.createElement("script"),E=`${ æ}?l=${A}&id=${B}`;D.src=C?null==C?void 0:C.createScriptURL(E):E,D.async=!0,document.head.appendChild(D)}function ¬™(A,B,C,D){return async function(E,...F){try{if("event"===E){const[D,E]=F;await async function(A,B,C,D,E){try{let F=[];if(E&&E.send_to){let A=E.send_to;Array.isArray(A)||(A=[A]);const D=await y(C);for(const C of A){
const A=D.find((A=>A.measurementId===C)),E=A&&B[A.appId];if(!E){F=[];break}F.push(E)}}0===F.length&&(F=Object.values(B)),await Promise.all(F),A("event",D,E||{})}catch(A){ ø.error(A)}}(A,B,C,D,E)}else if("config"===E){const[E,G]=F;await async function(A,B,C,D,E,F){const G=D[E];try{if(G)await B[G];else{const A=(await y(C)).find((A=>A.measurementId===E));A&&await B[A.appId]}}catch(A){ ø.error(A)}A("config",E,F)}(A,B,C,D,E,G)}else if("consent"===E){const[B,C]=F;A("consent",B,C)}else if("get"===E){
const[B,C,D]=F;A("get",B,C,D)}else if("set"===E){const[B]=F;A("set",B)}else A(E,...F)}catch(A){ ø.error(A)}}}function ¬µ(A){return new Headers({Accept:"application/json","x-goog-api-key":A})}async function ¬∫(A,B=ÀÅ,C){const{appId:D,apiKey:E,measurementId:F}=A.options;if(!D)throw ÀÄ.create("no-app-id");if(!E){if(F)return{measurementId:F,appId:D};throw ÀÄ.create("no-api-key")}const G=B.getThrottleMetadata(D)||{backoffCount:0,throttleEndTimeMillis:Date.now()},H=new ÀÜ;return setTimeout((async()=>{
H.abort()}),void 0!==C?C:6e4),√Ä({appId:D,apiKey:E,measurementId:F},G,H,B)}async function √Ä(A,{throttleEndTimeMillis:B,backoffCount:C},D,F=ÀÅ){var G;const{appId:H,measurementId:I}=A;try{await function(A,B){return new Promise(((C,D)=>{const E=Math.max(B-Date.now(),0),F=setTimeout(C,E);A.addEventListener((()=>{clearTimeout(F),D(ÀÄ.create("fetch-throttle",{throttleEndTimeMillis:B}))}))}))}(D,B)}catch(A){
if(I)return  ø.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+I+` provided in the "measurementId" field in the local Firebase config. [${null==A?void 0:A.message}]`),{appId:H,measurementId:I};throw A}try{const B=await async function(A){var B;const{appId:C,apiKey:D}=A,E={method:"GET",headers:¬µ(D)},F="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",C),G=await fetch(F,E)
;if(200!==G.status&&304!==G.status){let A="";try{const C=await G.json();(null===(B=C.error)||void 0===B?void 0:B.message)&&(A=C.error.message)}catch(A){}throw ÀÄ.create("config-fetch-failed",{httpStatus:G.status,responseMessage:A})}return G.json()}(A);return F.deleteThrottleMetadata(H),B}catch(B){const J=B;if(!function(A){if(!(A instanceof …≠&&A.customData))return!1;const B=Number(A.customData.httpStatus);return 429===B||500===B||503===B||504===B}(J)){if(F.deleteThrottleMetadata(H),
I)return  ø.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+I+` provided in the "measurementId" field in the local Firebase config. [${null==J?void 0:J.message}]`),{appId:H,measurementId:I};throw B}const K=503===Number(null===(G=null==J?void 0:J.customData)||void 0===G?void 0:G.httpStatus)?E(C,F.intervalMillis,30):E(C,F.intervalMillis),L={throttleEndTimeMillis:Date.now()+K,backoffCount:C+1};return F.setThrottleMetadata(H,L),
 ø.debug(`Calling attemptFetch again in ${K} millis`),√Ä(A,L,D,F)}}function √Å(A){Àà=A}function √Ç(A){Àá=A}async function √É(C,D,E,F,G,H,I){var J;const K=¬∫(C);K.then((A=>{E[A.measurementId]=A.appId,
C.options.measurementId&&A.measurementId!==C.options.measurementId&& ø.warn(`The measurement ID in the local Firebase config (${C.options.measurementId}) does not match the measurement ID fetched from the server (${A.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((A=> ø.error(A))),D.push(K);const L=async function(){
if(!A())return  ø.warn(ÀÄ.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await B()}catch(A){return  ø.warn(ÀÄ.create("indexeddb-unavailable",{errorInfo:null==A?void 0:A.toString()}).message),!1}return!0}().then((A=>A?F.getId():void 0)),[M,N]=await Promise.all([K,L]);(function(A){const B=window.document.getElementsByTagName("script");for(const C of Object.values(B))if(C.src&&C.src.includes( æ)&&C.src.includes(A))return C;return null
})(H)||z(H,M.measurementId),Àà&&(G("consent","default",Àà),√Å(void 0)),G("js",new Date);const O=null!==(J=null==I?void 0:I.config)&&void 0!==J?J:{};return O.origin="firebase",O.update=!0,null!=N&&(O.firebase_id=N),G("config",M.measurementId,O),Àá&&(G("set",Àá),√Ç(void 0)),M.measurementId}function √Ñ(){const A=[];if(function(){const A="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof A&&void 0!==A.id
}()&&A.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||A.push("Cookies are not available."),A.length>0){const B=A.map(((A,B)=>`(${B+1}) ${A}`)).join(" "),C=ÀÄ.create("invalid-analytics-context",{errorInfo:B}); ø.warn(C.message)}}function √Ö(A,B,C){√Ñ();const D=A.options.appId;if(!D)throw ÀÄ.create("no-app-id");if(!A.options.apiKey){if(!A.options.measurementId)throw ÀÄ.create("no-api-key")
; ø.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+A.options.measurementId+' provided in the "measurementId" field in the local Firebase config.')}if(null!=Àä[D])throw ÀÄ.create("already-exists",{id:D});if(!Àë){!function(A){let B=[];Array.isArray(window[A])?B=window[A]:window[A]=B}(Àè);const{wrappedGtag:A,gtagCore:B}=function(A,B,C,D,E){let F=function(){
window[D].push(arguments)};return window[E]&&"function"==typeof window[E]&&(F=window[E]),window[E]=¬™(F,A,B,C),{gtagCore:F,wrappedGtag:window[E]}}(Àä,Àã,Àå,Àè,Àê);Àé=A,Àç=B,Àë=!0}return Àä[D]=√É(A,Àã,Àå,B,Àç,Àè,C),new Àâ(A)}function √Ü(A=function(A= •){const B= ß.get(A);if(!B&&A=== •&&…´())return O();if(!B)throw  ™.create("no-app",{appName:A});return B}()){const B=N(A=F(A), Ω);return B.isInitialized()?B.getImmediate():function(A,B={}){const D=N(A, Ω);if(D.isInitialized()){const A=D.getImmediate()
;if(C(B,D.getOptions()))return A;throw ÀÄ.create("already-initialized")}const E=D.initialize({options:B});return E}(A)}function √á(A,B,C){A=F(A),async function(A,B,C,D){if(D&&D.global)return A("set",{user_id:C}),Promise.resolve();A("config",await B,{update:!0,user_id:C})}(Àé,Àä[A.app.options.appId],B,C).catch((A=> ø.error(A)))}function √à(A,B,C){A=F(A),async function(A,B,C,D){if(D&&D.global){const B={};for(const A of Object.keys(C))B["user_properties."+A]=C[A];return A("set",B),Promise.resolve()}
A("config",await B,{update:!0,user_properties:C})}(Àé,Àä[A.app.options.appId],B,C).catch((A=> ø.error(A)))}function √â(A,B,C,D){A=F(A),async function(A,B,C,D,E){if(E&&E.global)A("event",C,D);else{const E=await B;A("event",C,Object.assign(Object.assign({},D),{send_to:E}))}}(Àé,Àä[A.app.options.appId],B,C,D).catch((A=> ø.error(A)))}function √ä(A){if(null==A){const A=Array(16);return A[15]=1,A}if("number"==typeof A){let B=A;const C=Array(16);for(let A=15;A>=0;--A)C[A]=B%256,B=Math.floor(B/256);return C}{
const B=Array.from(A);if(16!==B.length)throw Error("Counter state must have a length of 16.");return B}}function √ã(A){for(let B=15;B>=0;B--){if(A[B]<255){A[B]++;break}A[B]=0}}function √å(A){try{return new DataView(A,0,0),!0}catch(A){return!1}}function √ç(A,B){if(null==A||"object"!=typeof A)throw Error("Invalid buffer data");if(Array.isArray(A)||(A=Array.from(A)),"number"!=typeof B||B<0){B=0;for(const{byteLength:C}of A)B+=C}const C=new Uint8Array(B);let D=0;for(const B of A){const A=B.byteLength
;C.set("length"in B?B:new Uint8Array("buffer"in B?B.buffer:B,B.byteOffset||0,A),D),D+=A}return C}function √é(){return Math.floor(4294967296*Math.random())}function √è(){return[√é(),√é(),√é(),√é()]}function √ê(A){const B=[];for(const C of A){const A=C.codePointAt(0)||0;A<128?B.push(A):A<2048?B.push(A>>6|192,63&A|128):A<65536?B.push(A>>12|224,A>>6&63|128,63&A|128):B.push(A>>18|240,A>>12&63|128,A>>6&63|128,63&A|128)}return Uint8Array.from(B)}function √ë(A){const B=A.length;let C="";for(let D=0;D<B;){
const B=A[D++];if(128&B)if(192==(224&B))C+=String.fromCharCode((31&B)<<6|63&A[D++]);else if(224==(240&B))C+=String.fromCharCode((15&B)<<12|(63&A[D++])<<6|63&A[D++]);else if(240==(248&B)){const E=(7&B)<<18|(63&A[D++])<<12|(63&A[D++])<<6|63&A[D++];C+=E>1114111?"ÔøΩ":String.fromCodePoint(E)}else C+="ÔøΩ";else C+=String.fromCharCode(B)}return C}function √í(A,B){const C=Math.floor((A.length-B)/2),D=Array(C);for(let E=B,F=0;F<C;F++)D[F]=String.fromCharCode((255&A[E++])<<8|255&A[E++]);return D.join("")}
function √ì(A,B){const C=Math.floor((A.length-B)/2),D=Array(C);for(let E=B,F=0;F<C;F++)D[F]=String.fromCharCode(255&A[E++]|(255&A[E++])<<8);return D.join("")}function √î(A){const B=Math.floor(A.length/4),C=Array(B);for(let D=0,E=0;D<B;D++)C[D]=(255&A[E++])<<24|(255&A[E++])<<16|(255&A[E++])<<8|255&A[E++];return C}function √ï(A,B,C){switch(typeof B){case"undefined":A.push(0),C++;break;case"boolean":A.push(B?1:2),C++;break;case"string":{const D=√ê(B),E=D.byteLength
;A.push(101,255&E,E>>8&255,E>>16&255,E>>24&255,D),C+=E+5}break;case"number":{if(Number.isSafeInteger(B))if(B>=0){if(B<256)return A.push(10,B),C+2;if(B<65536)return A.push(11,255&B,B>>8&255),C+3;if(B<4294967296)return A.push(12,255&B,B>>8&255,B>>16&255,B>>24&255),C+5}else{if(B>=-128&&B<128)return A.push(20,B),C+2;if(B>=-32768&&B<32768)return A.push(21,255&B,B>>8&255),C+3;if(B>=-2147483648&&B<2147483648)return A.push(22,255&B,B>>8&255,B>>16&255,B>>24&255),C+5}A.push(33);const D=new ArrayBuffer(8)
;new DataView(D,0,8).setFloat64(0,B,!0),A.push(new Uint8Array(D,0,8)),C+=9}break;case"bigint":A.push(B>=0n?13:23,Number(0xffn&B),Number(B>>8n&0xffn),Number(B>>16n&0xffn),Number(B>>24n&0xffn),Number(B>>32n&0xffn),Number(B>>40n&0xffn),Number(B>>48n&0xffn),Number(B>>56n&0xffn)),C+=9;break;case"object":if(null===B)A.push(255),C++;else if(Array.isArray(B)){const D=B.length;A.push(99,255&D,D>>8&255,D>>16&255,D>>24&255),C+=5;for(const D of B)C=√ï(A,D,C)}else if(ArrayBuffer.isView(B)){
const D=new Uint8Array(B.buffer,B.byteOffset,B.byteLength),E=D.byteLength;A.push(102,255&E,E>>8&255,E>>16&255,E>>24&255,D),C+=E+5}else if(√å(B)){const D=new Uint8Array(B),E=D.byteLength;A.push(102,255&E,E>>8&255,E>>16&255,E>>24&255,D),C+=E+5}else{const D=Object.keys(B),E=D.length;A.push(100,255&E,E>>8&255,E>>16&255,E>>24&255),C+=5;for(const E of D){const D=B[E];switch(typeof D){case"bigint":case"number":case"object":case"string":case"boolean":case"undefined":break;default:continue}
const F=√ê(E),G=F.byteLength;A.push(255&G,G>>8&255,G>>16&255,G>>24&255,F),C=√ï(A,D,C+=G+4)}}}return C}function √ñ(A,B){return A>>>B|A<<32-B}function √ò(A,B){return A>>>B}function √ô(A,B){return »§(A,B||{},0,0)}function √ö(A,B){return »ñ(A,{i:2},B&&B.out,B&&B.dictionary)}function √õ(A){if("string"!=typeof A||!A)throw Error("expected a non-empty string, got: "+A)}function √ú(A){if("number"!=typeof A)throw Error("expected a number, got: "+A)}function √ù(A){return function(A,B){const C=new Set,D=[]
;for(const E of A){const A=B(E);C.has(A)||(C.add(A),D.push(E))}return D}(A,(A=>A.unicode))}function √û(A,B,C){C.onerror=()=>B(C.error),C.onblocked=()=>B(Error("IDB blocked")),C.onsuccess=()=>A(C.result)}async function √ü(A){const B=await new Promise(((B,C)=>{const D=indexedDB.open(A,1);œ≤[A]=D,D.onupgradeneeded=A=>{A.oldVersion<1&&function(A){function B(B,C,D){const E=C?A.createObjectStore(B,{keyPath:C}):A.createObjectStore(B);if(D)for(const[A,[B,C]]of Object.entries(D))E.createIndex(A,B,{
multiEntry:C});return E}B(œß),B(œ¶,"unicode",{[œ©]:["tokens",!0],[œ´]:[["group","order"]],[œ±]:["skinUnicodes",!0]}),B(œ®,void 0,{[œ™]:[""]})}(D.result)},√û(B,C,D)}));return B.onclose=()=>√°(A),B}function √†(A,B,C,D){return new Promise(((E,F)=>{const G=A.transaction(B,C,{durability:"relaxed"}),H="string"==typeof B?G.objectStore(B):B.map((A=>G.objectStore(A)));let I;D(H,G,(A=>{I=A})),G.oncomplete=()=>E(I),G.onerror=()=>F(G.error)}))}function √°(A){const B=œ≤[A],C=B&&B.result;if(C){C.close();const B=œ¥[A]
;if(B)for(const A of B)A()}delete œ≤[A],delete œ≥[A],delete œ¥[A]}function √¢(A){return A.split(/[\s_]+/).map((A=>!A.match(/\w/)||œµ.has(A)?A.toLowerCase():A.replace(/[)(:,]/g,"").replace(/‚Äô/g,"'").toLowerCase())).filter(Boolean)}function √£(A){return A.filter(Boolean).map((A=>A.toLowerCase())).filter((A=>A.length>=2))}function √§(A,B,C,D){A[B](C).onsuccess=A=>D&&D(A.target.result)}function √•(A,B,C){√§(A,"get",B,C)}function √¶(A,B,C){√§(A,"getAll",B,C)}function √ß(A){A.commit&&A.commit()}function √®(A,B){
const C=function(A,B){let C=A[0];for(let D=1;D<A.length;D++){const E=A[D];B(C)>B(E)&&(C=E)}return C}(A,(A=>A.length)),D=[];for(const E of C)A.some((A=>-1===A.findIndex((A=>B(A)===B(E)))))||D.push(E);return D}async function √©(A,B,C,D){try{const E=function(A){const B=A.map((({annotation:A,emoticon:B,group:C,order:D,shortcodes:E,skins:F,tags:G,emoji:H,version:I})=>{const J={annotation:A,group:C,order:D,tags:G,
tokens:[...new Set(√£([...(E||[]).map(√¢).flat(),...(G||[]).map(√¢).flat(),...√¢(A),B]))].sort(),unicode:H,version:I};if(B&&(J.emoticon=B),E&&(J.shortcodes=E),F){J.skinTones=[],J.skinUnicodes=[],J.skinVersions=[];for(const{tone:A,emoji:B,version:C}of F)J.skinTones.push(A),J.skinUnicodes.push(B),J.skinVersions.push(C)}return J}));return B}(B);await √†(A,[œ¶,œß],œ∞,(([A,B],F)=>{function G(){2===++J&&function(){if(H!==D||I!==C){A.clear();for(const B of E)A.put(B);B.put(D,œ¨),B.put(C,œ≠),√ß(F)}}()}let H,I,J=0
;√•(B,œ¨,(A=>{H=A,G()})),√•(B,œ≠,(A=>{I=A,G()}))}))}finally{}}async function √™(A,B){const C=√£(√¢(B));return C.length?√†(A,œ¶,œØ,((A,B,D)=>{const E=[],F=()=>{const A=√®(E,(A=>A.unicode));D(A.sort(((A,B)=>A.order<B.order?-1:1)))};for(let B=0;B<C.length;B++){const D=C[B],G=B===C.length-1?IDBKeyRange.bound(D,D+"Ôøø",!1,!0):IDBKeyRange.only(D);√¶(A.index(œ©),G,(A=>{E.push(A),E.length===C.length&&F()}))}})):[]}async function √´(A,B){const C=await √™(A,B);if(!C.length){
const C=A=>(A.shortcodes||[]).includes(B.toLowerCase());return await async function(A,B){return √†(A,œ¶,œØ,((A,C,D)=>{let E;const F=()=>{A.getAll(E&&IDBKeyRange.lowerBound(E,!0),50).onsuccess=A=>{const C=A.target.result;for(const A of C)if(E=A.unicode,B(A))return D(A);if(C.length<50)return D();F()}};F()}))}(A,C)||null}return C.filter((A=>{const C=(A.shortcodes||[]).map((A=>A.toLowerCase()));return C.includes(B.toLowerCase())}))[0]||null}function √¨(A,B,C){return √†(A,B,œØ,((A,B,D)=>√•(A,C,D)))}
function √≠(A){!function(A){const B=A&&Array.isArray(A),C=B&&A.length&&(!A[0]||œ∑.some((B=>!(B in A[0]))));if(!B||C)throw Error("Custom emojis are in the wrong format")}(A);const B=(A,B)=>A.name.toLowerCase()<B.name.toLowerCase()?-1:1,C=A.sort(B),D=function(A,B){const C=new Map;for(const D of A){const A=B(D);for(const B of A){let A=C;for(let C=0;C<B.length;C++){const D=B.charAt(C);let E=A.get(D);E||(E=new Map,A.set(D,E)),A=E}let E=A.get("");E||(E=[],A.set("",E)),E.push(D)}}return(A,B)=>{let D=C
;for(let B=0;B<A.length;B++){const C=A.charAt(B),E=D.get(C);if(!E)return[];D=E}if(B)return D.get("")||[];const E=[],F=[D];for(;F.length;){const A=[...F.shift().entries()].sort(((A,B)=>A[0]<B[0]?-1:1));for(const[B,C]of A)""===B?E.push(...C):F.push(C)}return E}}(A,(A=>{const B=new Set;if(A.shortcodes)for(const C of A.shortcodes)for(const A of √¢(C))B.add(A);return B})),E=A=>D(A,!0),F=A=>D(A,!1),G=new Map,H=new Map;for(const B of A){H.set(B.name.toLowerCase(),B)
;for(const A of B.shortcodes||[])G.set(A.toLowerCase(),B)}return{all:C,search:A=>{const C=√¢(A),D=C.map(((A,B)=>(B<C.length-1?E:F)(A)));return √®(D,(A=>A.name)).sort(B)},byShortcode:A=>G.get(A.toLowerCase()),byName:A=>H.get(A.toLowerCase())}}function √Æ(A){if(!A)return A;if(œ∏&&(A=structuredClone(A)),delete A.tokens,A.skinTones){const B=A.skinTones.length;A.skins=Array(B);for(let C=0;C<B;C++)A.skins[C]={tone:A.skinTones[C],unicode:A.skinUnicodes[C],version:A.skinVersions[C]};delete A.skinTones,
delete A.skinUnicodes,delete A.skinVersions}return A}function √Ø(A,B){if(2!==Math.floor(A.status/100))throw Error("Failed to fetch: "+B+":  "+A.status)}async function √∞(A){const B=await fetch(A);√Ø(B,A);const C=B.headers.get("etag"),D=await B.json();return function(A){if(!A||!Array.isArray(A)||!A[0]||"object"!=typeof A[0]||œπ.some((B=>!(B in A[0]))))throw Error("Emoji data is in the wrong format")}(D),[C,D]}async function √±(A){let B=function(A){
for(var B=A.length,C=new ArrayBuffer(B),D=new Uint8Array(C),E=-1;++E<B;)D[E]=A.charCodeAt(E);return C}(JSON.stringify(A));const C=function(A){for(var B="",C=new Uint8Array(A),D=C.byteLength,E=-1;++E<D;)B+=String.fromCharCode(C[E]);return B}(await crypto.subtle.digest("SHA-1",B));return btoa(C)}async function √≤(A,B){let C,D=await async function(A){const B=await fetch(A,{method:"HEAD"});√Ø(B,A);const C=B.headers.get("etag");return C}(B);if(!D){const A=await √∞(B);D=A[0],C=A[1],D||(D=await √±(C))}
await async function(A,B,C){const[D,E]=await Promise.all([œ¨,œ≠].map((B=>√¨(A,œß,B))));return D===C&&E===B}(A,B,D)||(C||(C=(await √∞(B))[1]),await √©(A,C,B,D))}function √≥(A){return A.unicode.includes("‚Äç")}function √¥(A){A.preventDefault(),A.stopPropagation()}function √µ(A,B,C){return(B+=A?-1:1)<0?B=C.length-1:B>=C.length&&(B=0),B}function √∂(A,B){const C=new Set,D=[];for(const E of A){const A=B(E);C.has(A)||(C.add(A),D.push(E))}return D}function √∏(A){{const B=document.createRange()
;return B.selectNode(A.firstChild),B.getBoundingClientRect().width}}function √π(A,B,C){let D=A.get(B);return D||(D=C(),A.set(B,D)),D}function √∫(A){return""+A}function √ª(A,B){const{targetNode:C}=B;let{targetParentNode:D}=B,E=!1;D?E=function(A,B){let C=A.firstChild,D=0;for(;C;){if(B[D]!==C)return!0;C=C.nextSibling,D++}return D!==B.length}(D,A):(E=!0,B.targetNode=void 0,B.targetParentNode=D=C.parentNode),E&&function(A,B){–á?A.replaceChildren(...B):(A.innerHTML="",A.append(...B))}(D,A)}function √º(A){
let B="",C=!1,D=!1,E=-1;const F=new Map,G=[];let H=0;for(let I=0,J=A.length;I<J;I++){const K=A[I];if(B+=K.slice(H),I===J-1)break;for(let A=0;A<K.length;A++)switch(K.charAt(A)){case"<":"/"===K.charAt(A+1)?G.pop():(C=!0,G.push(++E));break;case">":C=!1,D=!1;break;case"=":D=!0}const L=√π(F,G[G.length-1],(()=>[]));let M,N,O;if(D){const C=/(\S+)="?([^"=]*)$/.exec(K);M=C[1],N=C[2];const D=/^([^">]*)("?)/.exec(A[I+1]);O=D[1],B=B.slice(0,-1*C[0].length),H=D[0].length}else H=0;const P={attributeName:M,
attributeValuePre:N,attributeValuePost:O,expressionIndex:I};L.push(P),C||D||(B+=" ")}const I=function(A){const B=document.createElement("template");return B.innerHTML=A,B}(B);return{template:I,elementsToBindings:F}}function √Ω(A,B,C){for(let D=0;D<A.length;D++){const E=A[D],F={binding:E,targetNode:E.attributeName?B:B.firstChild,targetParentNode:void 0,currentExpression:void 0};C.push(F)}}function √æ(A){
const{template:B,elementsToBindings:C}=√π(–Ñ,A,(()=>√º(A))),D=B.cloneNode(!0).content.firstElementChild,E=function(A,B){const C=[];let D;if(1===B.size&&(D=B.get(0)))√Ω(D,A,C);else{const D=document.createTreeWalker(A,NodeFilter.SHOW_ELEMENT);let E=A,F=-1;do{const A=B.get(++F);A&&√Ω(A,E,C)}while(E=D.nextNode())}return C}(D,C);return function(A){return function(A,B){for(const C of B){
const{targetNode:B,currentExpression:D,binding:{expressionIndex:E,attributeName:F,attributeValuePre:G,attributeValuePost:H}}=C,I=A[E];if(D!==I)if(C.currentExpression=I,F)if(null===I)B.removeAttribute(F);else{const A=G+√∫(I)+H;B.setAttribute(F,A)}else{let A;Array.isArray(I)?√ª(I,C):I instanceof Element?(A=I,B.replaceWith(A)):B.nodeValue=√∫(I),A&&(C.targetNode=A)}}}(A,E),D}}function √ø(A,B,C,D,E,F,G,H,I){function J(A,C,D){
return O(A,((A,E)=>N`<button role="${C?"option":"menuitem"}" aria-selected="${C?E===B.activeSearchItem:null}" aria-label="${K(A,B.currentSkinTone)}" title="${L(A)}" class="${"emoji"+(C&&E===B.activeSearchItem?" active":"")+(A.unicode?"":" custom-emoji")}" id="${`${D}-${A.id}`}" style="${A.unicode?null:`--custom-emoji-background: url(${JSON.stringify(A.url)})`}">${A.unicode?M(A,B.currentSkinTone):""}</button>`),(A=>`${D}-${A.id}`))}
const{labelWithSkin:K,titleForEmoji:L,unicodeWithSkin:M}=C,{html:N,map:O}=function(A){const B=√π(–Ö,A,(()=>new Map));let C=–Ü;return{map:function(A,B,D){return A.map(((A,E)=>{const F=C;C=D(A);try{return B(A,E)}finally{C=F}}))},html:function(A,...D){const E=√π(B,A,(()=>new Map));return √π(E,C,(()=>√æ(A)))(D)}}
}(B),P=N`<section data-ref="rootElement" class="picker" aria-label="${B.i18n.regionLabel}" style="${B.pickerStyle||""}"><div class="pad-top"></div><div class="search-row"><div class="search-wrapper"><input id="search" class="search" type="search" role="combobox" enterkeyhint="search" placeholder="${B.i18n.searchLabel}" autocapitalize="none" autocomplete="off" spellcheck="true" aria-expanded="${!(!B.searchMode||!B.currentEmojis.length)}" aria-controls="search-results" aria-describedby="search-description" aria-autocomplete="list" aria-activedescendant="${B.activeSearchItemId?"emo-"+B.activeSearchItemId:null}" data-ref="searchElement" data-on-input="onSearchInput" data-on-keydown="onSearchKeydown" /><label class="sr-only" for="search">${B.i18n.searchLabel}</label> <span id="search-description" class="sr-only">${B.i18n.searchDescription}</span></div><div class="skintone-button-wrapper ${B.skinTonePickerExpandedAfterAnimation?"expanded":""}"><button id="skintone-button" class="emoji ${B.skinTonePickerExpanded?"hide-focus":""}" aria-label="${B.skinToneButtonLabel}" title="${B.skinToneButtonLabel}" aria-describedby="skintone-description" aria-haspopup="listbox" aria-expanded="${B.skinTonePickerExpanded}" aria-controls="skintone-list" data-on-click="onClickSkinToneButton">${B.skinToneButtonText||""}</button></div><span id="skintone-description" class="sr-only">${B.i18n.skinToneDescription}</span><div data-ref="skinToneDropdown" id="skintone-list" class="skintone-list hide-focus ${B.skinTonePickerExpanded?"":"hidden no-animate"}" style="transform:translateY(${B.skinTonePickerExpanded?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))"})" role="listbox" aria-label="${B.i18n.skinTonesLabel}" aria-activedescendant="skintone-${B.activeSkinTone}" aria-hidden="${!B.skinTonePickerExpanded}" tabIndex="-1" data-on-focusout="onSkinToneOptionsFocusOut" data-on-click="onSkinToneOptionsClick" data-on-keydown="onSkinToneOptionsKeydown" data-on-keyup="onSkinToneOptionsKeyup">${O(B.skinTones,((A,C)=>N`<div id="skintone-${C}" class="emoji ${C===B.activeSkinTone?"active":""}" aria-selected="${C===B.activeSkinTone}" role="option" title="${B.i18n.skinTones[C]}" aria-label="${B.i18n.skinTones[C]}">${A}</div>`),(A=>A))}</div></div><div class="nav" role="tablist" style="grid-template-columns:repeat(${B.groups.length},1fr)" aria-label="${B.i18n.categoriesLabel}" data-on-keydown="onNavKeydown" data-on-click="onNavClick">${O(B.groups,(A=>N`<button role="tab" class="nav-button" aria-controls="tab-${A.id}" aria-label="${B.i18n.categories[A.name]}" aria-selected="${!B.searchMode&&B.currentGroup.id===A.id}" title="${B.i18n.categories[A.name]}" data-group-id="${A.id}"><div class="nav-emoji emoji">${A.emoji}</div></button>`),(A=>A.id))}</div><div class="indicator-wrapper"><div class="indicator" style="transform:translateX(${(B.isRtl?-1:1)*B.currentGroupIndex*100}%)"></div></div><div class="message ${B.message?"":"gone"}" role="alert" aria-live="polite">${B.message||""}</div><div data-ref="tabpanelElement" class="tabpanel ${!B.databaseLoaded||B.message?"gone":""}" role="${B.searchMode?"region":"tabpanel"}" aria-label="${B.searchMode?B.i18n.searchResultsLabel:B.i18n.categories[B.currentGroup.name]}" id="${B.searchMode?null:"tab-"+B.currentGroup.id}" tabIndex="0" data-on-click="onEmojiClick"><div data-action="calculateEmojiGridStyle">${O(B.currentEmojisWithCategories,((A,C)=>N`<div><div id="menu-label-${C}" class="category ${1===B.currentEmojisWithCategories.length&&""===B.currentEmojisWithCategories[0].category?"gone":""}" aria-hidden="true">${B.searchMode?B.i18n.searchResultsLabel:A.category?A.category:B.currentEmojisWithCategories.length>1?B.i18n.categories.custom:B.i18n.categories[B.currentGroup.name]}</div><div class="emoji-menu ${0===C||B.searchMode||-1!==B.currentGroup.id?"":"visibility-auto"}" style="${"--num-rows: "+Math.ceil(A.emojis.length/B.numColumns)}" data-action="updateOnIntersection" role="${B.searchMode?"listbox":"menu"}" aria-labelledby="menu-label-${C}" id="${B.searchMode?"search-results":null}">${J(A.emojis,B.searchMode,"emo")}</div></div>`),(A=>A.category))}</div></div><div class="favorites onscreen emoji-menu ${B.message?"gone":""}" role="menu" aria-label="${B.i18n.favoritesLabel}" data-on-click="onEmojiClick">${J(B.currentFavorites,!1,"fav")}</div><button data-ref="baselineEmoji" aria-hidden="true" tabindex="-1" class="abs-pos hidden emoji baseline-emoji">üòÄ</button></section>`,Q=(B,C)=>{
for(const D of A.querySelectorAll(`[${B}]`))C(D,D.getAttribute(B))};if(I){A.appendChild(P);for(const A of["click","focusout","input","keydown","keyup"])Q("data-on-"+A,((B,C)=>{B.addEventListener(A,D[C])}));Q("data-ref",((A,B)=>{F[B]=A})),G.addEventListener("abort",(()=>{A.removeChild(P)}))}Q("data-action",((A,B)=>{let C=H.get(B);C||H.set(B,C=new WeakSet),C.has(A)||(C.add(A),E[B](A))}))}function ƒÄ(A,B,C){if(A.length!==B.length)return!1;for(let D=0;D<A.length;D++)if(!C(A[D],B[D]))return!1;return!0
}function ƒÅ(A,B){function C(){const{customEmoji:A,database:B}=L,C=A||–ä;B.customEmoji!==C&&(B.customEmoji=C)}function D(A){const B=function(A,B,C){let D=!0;for(const E of A){const A=C(E);if(!A)continue;const F=√∏(A);void 0===–Ç&&(–Ç=√∏(B));const G=F/1.8<–Ç;–Ä.set(E.unicode,G),G||(D=!1)}return D}(A,I.baselineEmoji,P);B?a():L.currentEmojis=[...L.currentEmojis]}function E(A){return!A.unicode||!√≥(A)||–Ä.get(A.unicode)}function F(A){return function(A){const B=A=>{const B={}
;for(const{tone:C,unicode:D}of A)"number"==typeof C&&(B[C]=D);return B};return A.map((({unicode:A,skins:C,shortcodes:D,url:E,name:F,category:G,annotation:H})=>({unicode:A,name:F,shortcodes:D,url:E,category:G,annotation:H,id:A||F,skins:C&&B(C)})))}(A)}async function G(A){const B=await L.database.getEmojiByUnicodeOrName(A),C=[...L.currentEmojis,...L.currentFavorites].find((B=>B.id===A)),D=C.unicode&&V(C,L.currentSkinTone);await L.database.incrementFavoriteEmojiCount(A),Q("emoji-click",{emoji:B,
skinTone:L.currentSkinTone,...D&&{unicode:D},...C.name&&{name:C.name}})}function H(A){L.currentSkinTone=A,L.skinTonePickerExpanded=!1,O("skintone-button"),Q("skin-tone-change",{skinTone:A}),L.database.setPreferredSkinTone(A)}const I={},J=new AbortController,K=J.signal,{state:L,createEffect:M}=function(A){let B,C=!1;const D=new Map,E=new Set;let F;const G=()=>{if(C)return;const A=[...E];E.clear();try{for(const B of A)B()}finally{F=!1,E.size&&(F=!0,–à(G))}},H=new Proxy({},{get(A,C){if(B){
let A=D.get(C);A||(A=new Set,D.set(C,A)),A.add(B)}return A[C]},set(A,B,C){if(A[B]!==C){A[B]=C;const H=D.get(B);if(H){for(const A of H)E.add(A);F||(F=!0,–à(G))}}return!0}});return A.addEventListener("abort",(()=>{C=!0})),{state:H,createEffect:A=>{const C=()=>{const D=B;B=C;try{return A()}finally{B=D}};return C()}}}(K),N=new Map;–ã(L,{skinToneEmoji:void 0,i18n:void 0,database:void 0,customEmoji:void 0,customCategorySorting:void 0,emojiVersion:void 0}),–ã(L,B),–ã(L,{initialLoad:!0,currentEmojis:[],
currentEmojisWithCategories:[],rawSearchText:"",searchText:"",searchMode:!1,activeSearchItem:-1,message:void 0,skinTonePickerExpanded:!1,skinTonePickerExpandedAfterAnimation:!1,currentSkinTone:0,activeSkinTone:0,skinToneButtonText:void 0,pickerStyle:void 0,skinToneButtonLabel:"",skinTones:[],currentFavorites:[],defaultFavoriteEmojis:void 0,numColumns:8,isRtl:!1,currentGroupIndex:0,groups:œº,databaseLoaded:!1,activeSearchItemId:void 0}),M((()=>{
L.currentGroup!==L.groups[L.currentGroupIndex]&&(L.currentGroup=L.groups[L.currentGroupIndex])}));const O=B=>{A.getElementById(B).focus()},P=B=>A.getElementById("emo-"+B.id),Q=(A,B)=>{I.rootElement.dispatchEvent(new CustomEvent(A,{detail:B,bubbles:!0,composed:!0}))},R=(A,B)=>A.id===B.id,S=(A,B)=>{const{category:C,emojis:D}=A,{category:E,emojis:F}=B;return C===E&&ƒÄ(D,F,R)},T=A=>{ƒÄ(L.currentEmojis,A,R)||(L.currentEmojis=A)},U=A=>{L.searchMode!==A&&(L.searchMode=A)
},V=(A,B)=>B&&A.skins&&A.skins[B]||A.unicode,W={labelWithSkin:(A,B)=>{return(C=[A.name||V(A,B),A.annotation,...A.shortcodes||–ä].filter(Boolean),√∂(C,(A=>A))).join(", ");var C},titleForEmoji:A=>A.annotation||(A.shortcodes||–ä).join(", "),unicodeWithSkin:V},X={onClickSkinToneButton:function(A){L.skinTonePickerExpanded=!L.skinTonePickerExpanded,L.activeSkinTone=L.currentSkinTone,L.skinTonePickerExpanded&&(√¥(A),–Å((()=>O("skintone-list"))))},onEmojiClick:async function(A){const{target:B}=A
;B.classList.contains("emoji")&&(√¥(A),G(B.id.substring(4)))},onNavClick:function(A){const{target:B}=A,C=B.closest(".nav-button");if(!C)return;const D=parseInt(C.dataset.groupId,10);I.searchElement.value="",L.rawSearchText="",L.searchText="",L.activeSearchItem=-1,L.currentGroupIndex=L.groups.findIndex((A=>A.id===D))},onNavKeydown:function(A){const{target:B,key:C}=A,D=B=>{B&&(√¥(A),B.focus())};switch(C){case"ArrowLeft":return D(B.previousElementSibling);case"ArrowRight":
return D(B.nextElementSibling);case"Home":return D(B.parentElement.firstElementChild);case"End":return D(B.parentElement.lastElementChild)}},onSearchKeydown:function(A){if(!L.searchMode||!L.currentEmojis.length)return;const B=B=>{√¥(A),L.activeSearchItem=√µ(B,L.activeSearchItem,L.currentEmojis)};switch(A.key){case"ArrowDown":return B(!1);case"ArrowUp":return B(!0);case"Enter":if(-1!==L.activeSearchItem)return √¥(A),G(L.currentEmojis[L.activeSearchItem].id);L.activeSearchItem=0}},
onSkinToneOptionsClick:function(A){const{target:{id:B}}=A,C=B&&B.match(/^skintone-(\d)/);C&&(√¥(A),H(parseInt(C[1],10)))},onSkinToneOptionsFocusOut:async function(A){const{relatedTarget:B}=A;B&&"skintone-list"===B.id||(L.skinTonePickerExpanded=!1)},onSkinToneOptionsKeydown:function(A){if(!L.skinTonePickerExpanded)return;const B=async B=>{√¥(A),L.activeSkinTone=B};switch(A.key){case"ArrowUp":return B(√µ(!0,L.activeSkinTone,L.skinTones));case"ArrowDown":return B(√µ(!1,L.activeSkinTone,L.skinTones))
;case"Home":return B(0);case"End":return B(L.skinTones.length-1);case"Enter":return √¥(A),H(L.activeSkinTone);case"Escape":return √¥(A),L.skinTonePickerExpanded=!1,O("skintone-button")}},onSkinToneOptionsKeyup:function(A){if(L.skinTonePickerExpanded)return" "===A.key?(√¥(A),H(L.activeSkinTone)):void 0},onSearchInput:function(A){L.rawSearchText=A.target.value}},Y={calculateEmojiGridStyle:function(A){!function(A,B,C){let D;–É?(D=new ResizeObserver(C),D.observe(A)):–Å(C),
B.addEventListener("abort",(()=>{D&&D.disconnect()}))}(A,K,(()=>{{const A=getComputedStyle(I.rootElement),B=parseInt(A.getPropertyValue("--num-columns"),10),C="rtl"===A.getPropertyValue("direction");L.numColumns=B,L.isRtl=C}}))},updateOnIntersection:function(A){!function(A,B,C){{const D=A.closest(".tabpanel");let E=–â.get(D);E||(E=new IntersectionObserver(C,{root:D,rootMargin:"50% 0px 50% 0px",threshold:0}),–â.set(D,E),B.addEventListener("abort",(()=>{E.disconnect()}))),E.observe(A)}}(A,K,(A=>{
for(const{target:B,isIntersecting:C}of A)B.classList.toggle("onscreen",C)}))}};let Z=!0;M((()=>{√ø(A,L,W,X,Y,I,K,N,Z),Z=!1})),M((()=>{L.database&&async function(){let A=!1;const B=setTimeout((()=>{A=!0,L.message=L.i18n.loadingMessage}),1e3);try{await L.database.ready(),L.databaseLoaded=!0}catch(A){L.message=L.i18n.networkErrorMessage}finally{clearTimeout(B),A&&(A=!1,L.message="")}}()})),M((()=>{
L.pickerStyle=`\n\t\t\t--num-groups: ${L.groups.length}; \n\t\t\t--indicator-opacity: ${L.searchMode?0:1}; \n\t\t\t--num-skintones: 6;`})),M((()=>{L.customEmoji&&L.database&&C()})),M((()=>{L.customEmoji&&L.customEmoji.length?L.groups!==œª&&(L.groups=œª):L.groups!==œº&&(L.currentGroupIndex&&L.currentGroupIndex--,L.groups=œº)})),M((()=>{!async function(){L.databaseLoaded&&(L.currentSkinTone=await L.database.getPreferredSkinTone())}()})),M((()=>{L.skinTones=[,,,,,,].fill().map(((A,B)=>function(A,B){
if(0===B)return A;const C=A.indexOf("‚Äç");return-1!==C?A.substring(0,C)+String.fromCodePoint(127995+B-1)+A.substring(C):(A.endsWith("Ô∏è")&&(A=A.substring(0,A.length-1)),A+"\ud83c"+String.fromCodePoint(57339+B-1))}(L.skinToneEmoji,B)))})),M((()=>{L.skinToneButtonText=L.skinTones[L.currentSkinTone]})),M((()=>{L.skinToneButtonLabel=L.i18n.skinToneLabel.replace("{skinTone}",L.i18n.skinTones[L.currentSkinTone])})),M((()=>{L.databaseLoaded&&async function(){
const{database:A}=L,B=(await Promise.all(œæ.map((B=>A.getEmojiByUnicodeOrName(B))))).filter(Boolean);L.defaultFavoriteEmojis=B}()})),M((()=>{L.databaseLoaded&&L.defaultFavoriteEmojis&&async function(){C();const{database:A,defaultFavoriteEmojis:B,numColumns:D}=L,E=F(√∂([...await A.getTopFavoriteEmoji(D),...B],(A=>A.unicode||A.name)).slice(0,D));L.currentFavorites=E}()})),M((()=>{!async function(){const{searchText:A,currentGroup:B,databaseLoaded:C,customEmoji:D}=L;if(C)if(A.length>=2){
const B=await async function(A){return F(await L.database.getEmojiBySearchQuery(A))}(A);L.searchText===A&&(T(B),U(!0))}else{const{id:A}=B;if(-1!==A||D&&D.length){const B=await async function(A){return F(-1===A?L.customEmoji:await L.database.getEmojiByGroup(A))}(A);L.currentGroup.id===A&&(T(B),U(!1))}}else L.currentEmojis=[],L.searchMode=!1}()}));const a=()=>{–Å((()=>{var A;(A=I.tabpanelElement)&&(A.scrollTop=0)}))};return M((()=>{
const{currentEmojis:A,emojiVersion:B}=L,C=A.filter((A=>A.unicode)).filter((A=>√≥(A)&&!–Ä.has(A.unicode)));if(!B&&C.length)T(A),–Å((()=>D(C)));else{const C=B?A:A.filter(E);T(C),a()}})),M((()=>{})),M((()=>{const A=function(){const{searchMode:A,currentEmojis:B}=L;if(A)return[{category:"",emojis:B}];const C=new Map;for(const A of B){const B=A.category||"";let D=C.get(B);D||(D=[],C.set(B,D)),D.push(A)}return[...C.entries()].map((([A,B])=>({category:A,emojis:B
}))).sort(((A,B)=>L.customCategorySorting(A.category,B.category)))}();(A=>{ƒÄ(L.currentEmojisWithCategories,A,S)||(L.currentEmojisWithCategories=A)})(A)})),M((()=>{L.activeSearchItemId=-1!==L.activeSearchItem&&L.currentEmojis[L.activeSearchItem].id})),M((()=>{const{rawSearchText:A}=L;œΩ((()=>{L.searchText=(A||"").trim(),L.activeSearchItem=-1}))})),M((()=>{L.skinTonePickerExpanded?I.skinToneDropdown.addEventListener("transitionend",(()=>{L.skinTonePickerExpandedAfterAnimation=!0}),{once:!0
}):L.skinTonePickerExpandedAfterAnimation=!1})),{$set(A){–ã(L,A)},$destroy(){J.abort()}}}function ƒÇ(A){return A instanceof Uint8Array?A:A instanceof ArrayBuffer?new Uint8Array(A):new Uint8Array(A.buffer,A.byteOffset,A.byteLength)}function ƒÉ(){return new TransformStream({transform(A,B){!function(A,B){–í&&A.data instanceof Blob?A.data.arrayBuffer().then(ƒÇ).then(B):–ì&&(A.data instanceof ArrayBuffer||–î(A.data))?B(ƒÇ(A.data)):–ï(A,!1,(A=>{–ó||(–ó=new TextEncoder),B(–ó.encode(A))}))}(A,(C=>{const D=C.length
;let E;if(D<126)E=new Uint8Array(1),new DataView(E.buffer).setUint8(0,D);else if(D<65536){E=new Uint8Array(3);const A=new DataView(E.buffer);A.setUint8(0,126),A.setUint16(1,D)}else{E=new Uint8Array(9);const A=new DataView(E.buffer);A.setUint8(0,127),A.setBigUint64(1,BigInt(D))}A.data&&"string"!=typeof A.data&&(E[0]|=128),B.enqueue(E),B.enqueue(C)}))}})}function ƒÑ(A){return A.reduce(((A,B)=>A+B.length),0)}function ƒÖ(A,B){if(A[0].length===B)return A.shift();const C=new Uint8Array(B);let D=0
;for(let E=0;E<B;E++)C[E]=A[0][D++],D===A[0].length&&(A.shift(),D=0);return A.length&&D<A[0].length&&(A[0]=A[0].slice(D)),C}function ƒÜ(A){if(A)return function(A){for(var B in ƒÜ.prototype)A[B]=ƒÜ.prototype[B];return A}(A)}function ƒá(A,...B){return B.reduce(((B,C)=>(A.hasOwnProperty(C)&&(B[C]=A[C]),B)),{})}function ƒà(A,B){B.useNativeTimers?(A.setTimeoutFn=–°.bind(–†),A.clearTimeoutFn=–¢.bind(–†)):(A.setTimeoutFn=–†.setTimeout.bind(–†),A.clearTimeoutFn=–†.clearTimeout.bind(–†))}function ƒâ(){
return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function ƒä(){}function ƒã(){for(let A in –©.requests)–©.requests.hasOwnProperty(A)&&–©.requests[A].abort()}function ƒå(A){const B=A.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!B||–ß))return new XMLHttpRequest}catch(A){}if(!B)try{return new(–†[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(A){}}function ƒç(A){if(A.length>8e3)throw"URI too long";const B=A,C=A.indexOf("["),D=A.indexOf("]")
;-1!=C&&-1!=D&&(A=A.substring(0,C)+A.substring(C,D).replace(/:/g,";")+A.substring(D,A.length));let E=–Ø.exec(A||""),F={},G=14;for(;G--;)F[–∞[G]]=E[G]||"";return-1!=C&&-1!=D&&(F.source=B,F.host=F.host.substring(1,F.host.length-1).replace(/;/g,":"),F.authority=F.authority.replace("[","").replace("]","").replace(/;/g,":"),F.ipv6uri=!0),F.pathNames=function(A,B){const C=/\/{2,9}/g,D=B.replace(C,"/").split("/");return"/"!=B.slice(0,1)&&0!==B.length||D.splice(0,1),
"/"==B.slice(-1)&&D.splice(D.length-1,1),D}(0,F.path),F.queryKey=function(A,B){const C={};return B.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(A,B,D){B&&(C[B]=D)})),C}(0,F.query),F}function ƒé(A,B,C){return(B=function(A){var B=function(A,B){var C,D;if("object"!=typeof A||!A)return A;if(void 0!==(C=A[Symbol.toPrimitive])){if("object"!=typeof(D=C.call(A,B)))return D;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===B?String:Number)(A)}(A,"string")
;return"symbol"==typeof B?B:B+""}(B))in A?Object.defineProperty(A,B,{value:C,enumerable:!0,configurable:!0,writable:!0}):A[B]=C,A}function ƒè(){return ƒè=Object.assign?Object.assign.bind():function(A){var B,C,D;for(B=1;B<arguments.length;B++)for(D in C=arguments[B])({}).hasOwnProperty.call(C,D)&&(A[D]=C[D]);return A},ƒè.apply(null,arguments)}function ƒê(A,B){var C,D=Object.keys(A);return Object.getOwnPropertySymbols&&(C=Object.getOwnPropertySymbols(A),B&&(C=C.filter((function(B){
return Object.getOwnPropertyDescriptor(A,B).enumerable}))),D.push.apply(D,C)),D}function ƒë(A){var B,C;for(B=1;B<arguments.length;B++)C=null!=arguments[B]?arguments[B]:{},B%2?ƒê(Object(C),!0).forEach((function(B){ƒé(A,B,C[B])})):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(C)):ƒê(Object(C)).forEach((function(B){Object.defineProperty(A,B,Object.getOwnPropertyDescriptor(C,B))}));return A}function ƒí(){return ƒè({},—Ä)}function ƒì(A,B,C){
return B[A]?B[A].bind(B):function(A,B){const C=self.console[A];return C?C.bind(self.console,`${B?"["+B+"] ":""}[${A}] >`):–ø}(A,C)}function ƒî(A=!0){if("undefined"!=typeof self)return(A||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function ƒï(A,B){const C=Object.keys(A),D=Object.keys(B),E=C.length,F=D.length;return!E||!F||E===F&&!C.some((A=>-1===D.indexOf(A)))}function ƒñ(A,B=!1){if("undefined"!=typeof TextDecoder){const C=new TextDecoder("utf-8").decode(A)
;if(B){const A=C.indexOf("\0");return-1!==A?C.substring(0,A):C}return C.replace(/\0/g,"")}const C=A.length;let D,E,F,G="",H=0;for(;H<C;){if(D=A[H++],0===D&&B)return G;if(0!==D&&3!==D)switch(D>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:G+=String.fromCharCode(D);break;case 12:case 13:E=A[H++],G+=String.fromCharCode((31&D)<<6|63&E);break;case 14:E=A[H++],F=A[H++],G+=String.fromCharCode((15&D)<<12|(63&E)<<6|63&F)}}return G}function ƒó(A){
return A&&A.__esModule&&Object.prototype.hasOwnProperty.call(A,"default")?A.default:A}function ƒò(A){return"initSegment"!==A.sn}function ƒô(A,B){const C=Object.getPrototypeOf(A);if(C){const A=Object.getOwnPropertyDescriptor(C,B);return A||ƒô(C,B)}}function ƒö(A,B){const C=ƒô(A,B);C&&(C.enumerable=!0,Object.defineProperty(A,B,C))}function ƒõ(A){return String.fromCharCode.apply(null,A)}function ƒú(A,B){const C=A[B]<<8|A[B+1];return C<0?65536+C:C}function ƒù(A,B){const C=ƒü(A,B);return C<0?4294967296+C:C}
function ƒû(A,B){let C=ƒù(A,B);return C*=4294967296,C+=ƒù(A,B+4),C}function ƒü(A,B){return A[B]<<24|A[B+1]<<16|A[B+2]<<8|A[B+3]}function ƒ†(A,B,C){A[B]=C>>24,A[B+1]=C>>16&255,A[B+2]=C>>8&255,A[B+3]=255&C}function ƒ°(A,B){const C=[];if(!B.length)return C;const D=A.byteLength;for(let E=0;E<D;){const F=ƒù(A,E),G=F>1?E+F:D;if(ƒõ(A.subarray(E+4,E+8))===B[0])if(1===B.length)C.push(A.subarray(E+8,G));else{const D=ƒ°(A.subarray(E+8,G),B.slice(1));D.length&&—â.apply(C,D)}E=G}return C}function ƒ¢(A){
const B=[],C=A[0];let D=8;const E=ƒù(A,D);D+=4;let F=0,G=0;0===C?(F=ƒù(A,D),G=ƒù(A,D+4),D+=8):(F=ƒû(A,D),G=ƒû(A,D+8),D+=16),D+=2;let H=A.length+G;const I=ƒú(A,D);D+=2;for(let C=0;C<I;C++){let C=D;const F=ƒù(A,C);C+=4;const G=2147483647&F;if(1==(2147483648&F)>>>31)return —Ç.warn("SIDX has hierarchical references (not supported)"),null;const I=ƒù(A,C);C+=4,B.push({referenceSize:G,subsegmentDuration:I,info:{duration:I/E,start:H,end:H+G-1}}),H+=G,C+=4,D=C}return{earliestPresentationTime:F,timescale:E,
version:C,referencesCount:I,references:B}}function ƒ£(A){const B=[],C=ƒ°(A,["moov","trak"]);for(let A=0;A<C.length;A++){const D=C[A],E=ƒ°(D,["tkhd"])[0];if(E){let A=E[0];const C=ƒù(E,0===A?12:20),F=ƒ°(D,["mdia","mdhd"])[0];if(F){A=F[0];const E=ƒù(F,0===A?12:20),G=ƒ°(D,["mdia","hdlr"])[0];if(G){const A=ƒõ(G.subarray(8,12)),F={soun:»ª,vide:»º}[A],H=ƒ§(ƒ°(D,["mdia","minf","stbl","stsd"])[0]);F?(B[C]={timescale:E,type:F,stsd:H},B[F]=ƒë({timescale:E,id:C},H)):B[C]={timescale:E,type:A,stsd:H}}}}}
return ƒ°(A,["moov","mvex","trex"]).forEach((A=>{const C=ƒù(A,4),D=B[C];D&&(D.default={duration:ƒù(A,12),flags:ƒù(A,20)})})),B}function ƒ§(A){const B=A.subarray(8),C=B.subarray(86),D=ƒõ(B.subarray(4,8));let E,F=D;const G="enca"===D||"encv"===D;if(G){const A=ƒ°(B,[D])[0];ƒ°(A.subarray("enca"===D?28:78),["sinf"]).forEach((A=>{const B=ƒ°(A,["schm"])[0];if(B){const C=ƒõ(B.subarray(4,8));if("cbcs"===C||"cenc"===C){const B=ƒ°(A,["frma"])[0];B&&(F=ƒõ(B))}}}))}const H=F;switch(F){case"avc1":case"avc2":case"avc3":
case"avc4":{const A=ƒ°(C,["avcC"])[0];A&&A.length>3&&(F+="."+ƒß(A[1])+ƒß(A[2])+ƒß(A[3]),E=ƒ•("avc1"===H?"dva1":"dvav",C));break}case"mp4a":{const A=ƒ°(B,[D])[0],C=ƒ°(A.subarray(28),["esds"])[0];if(C&&C.length>7){let A=4;if(3!==C[A++])break;A=ƒ¶(C,A),A+=2;const B=C[A++];if(128&B&&(A+=2),64&B&&(A+=C[A++]),4!==C[A++])break;A=ƒ¶(C,A);const D=C[A++];if(64!==D)break;if(F+="."+ƒß(D),A+=12,5!==C[A++])break;A=ƒ¶(C,A);const E=C[A++];let G=(248&E)>>3;31===G&&(G+=1+((7&E)<<3)+((224&C[A])>>5)),F+="."+G}break}
case"hvc1":case"hev1":{const A=ƒ°(C,["hvcC"])[0];if(A&&A.length>12){const B=A[1],C=["","A","B","C"][B>>6],D=31&B,E=ƒù(A,2),G=(32&B)>>5?"H":"L",H=A[12],I=A.subarray(6,12);F+="."+C+D,F+="."+function(A){let B=0;for(let C=0;C<32;C++)B|=(A>>C&1)<<31-C;return B>>>0}(E).toString(16).toUpperCase(),F+="."+G+H;let J="";for(let A=I.length;A--;){const B=I[A];(B||J)&&(J="."+B.toString(16).toUpperCase()+J)}F+=J}E=ƒ•("hev1"==H?"dvhe":"dvh1",C);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":
F=ƒ•(F,C)||F;break;case"vp09":{const A=ƒ°(C,["vpcC"])[0];if(A&&A.length>6){const B=A[4],C=A[5],D=A[6]>>4&15;F+="."+ƒ®(B)+"."+ƒ®(C)+"."+ƒ®(D)}break}case"av01":{const A=ƒ°(C,["av1C"])[0];if(A&&A.length>2){const B=A[1]>>>5,D=31&A[1],G=A[2]>>>7?"H":"M",H=(64&A[2])>>6,I=(32&A[2])>>5,J=2===B&&H?I?12:10:H?10:8,K=(16&A[2])>>4,L=(8&A[2])>>3,M=(4&A[2])>>2,N=3&A[2],O=1,P=1,Q=1,R=0;F+="."+B+"."+ƒ®(D)+G+"."+ƒ®(J)+"."+K+"."+L+M+N+"."+ƒ®(O)+"."+ƒ®(P)+"."+ƒ®(Q)+"."+R,E=ƒ•("dav1",C)}break}}return{codec:F,encrypted:G,
supplemental:E}}function ƒ•(A,B){const C=ƒ°(B,["dvvC"]),D=C.length?C[0]:ƒ°(B,["dvcC"])[0];if(D){const B=D[2]>>1&127,C=D[2]<<5&32|D[3]>>3&31;return A+"."+ƒ®(B)+"."+ƒ®(C)}}function ƒ¶(A,B){const C=B+5;for(;128&A[B++]&&B<C;);return B}function ƒß(A){return("0"+A.toString(16).toUpperCase()).slice(-2)}function ƒ®(A){return(A<10?"0":"")+A}function ƒ©(A){const B=ƒ°(A,["schm"])[0];if(B){const C=ƒõ(B.subarray(4,8));if("cbcs"===C||"cenc"===C)return ƒ°(A,["schi","tenc"])[0]}return null}function ƒ™(A,B){
const C=new Uint8Array(A.length+B.length);return C.set(A),C.set(B,A.length),C}function ƒ´(A,B){const C=[],D=B.samples,E=B.timescale,F=B.id;let G=!1;return ƒ°(D,["moof"]).map((H=>{const I=H.byteOffset-8;ƒ°(H,["traf"]).map((H=>{const J=ƒ°(H,["tfdt"]).map((A=>{const B=A[0];let C=ƒù(A,4);return 1===B&&(C*=4294967296,C+=ƒù(A,8)),C/E}))[0];return void 0!==J&&(A=J),ƒ°(H,["tfhd"]).map((J=>{const K=ƒù(J,4),L=16777215&ƒù(J,0);let M=0;const N=!!(16&L);let O=0;const P=!!(32&L);let Q=8;K===F&&(!!(1&L)&&(Q+=8),
!!(2&L)&&(Q+=4),!!(8&L)&&(M=ƒù(J,Q),Q+=4),N&&(O=ƒù(J,Q),Q+=4),P&&(Q+=4),"video"===B.type&&(G=ƒ¨(B.codec)),ƒ°(H,["trun"]).map((F=>{const H=F[0],J=16777215&ƒù(F,0),K=!!(1&J);let L=0;const N=!!(4&J),P=!!(256&J);let Q=0;const R=!!(512&J);let S=0;const T=!!(1024&J),U=!!(2048&J);let V=0;const W=ƒù(F,4);let X=8;K&&(L=ƒù(F,X),X+=4),N&&(X+=4);let Y=L+I;for(let I=0;I<W;I++){if(P?(Q=ƒù(F,X),X+=4):Q=M,R?(S=ƒù(F,X),X+=4):S=O,T&&(X+=4),U&&(V=0===H?ƒù(F,X):ƒü(F,X),X+=4),B.type===»º){let B=0;for(;B<S;){const F=ƒù(D,Y);Y+=4,
ƒ≠(G,D[Y])&&ƒÆ(D.subarray(Y,Y+F),G?2:1,A+V/E,C),Y+=F,B+=F+4}}A+=Q/E}})))}))}))})),C}function ƒ¨(A){if(!A)return!1;const B=A.substring(0,4);return"hvc1"===B||"hev1"===B||"dvh1"===B||"dvhe"===B}function ƒ≠(A,B){if(A){const A=B>>1&63;return 39===A||40===A}return 6==(31&B)}function ƒÆ(A,B,C,D){const E=ƒØ(A);let F=0;F+=B;let G=0,H=0,I=0;for(;F<E.length;){G=0;do{if(F>=E.length)break;I=E[F++],G+=I}while(255===I);H=0;do{if(F>=E.length)break;I=E[F++],H+=I}while(255===I);const A=E.length-F;let B=F
;if(H<A)F+=H;else if(H>A){—Ç.error(`Malformed SEI payload. ${H} is too small, only ${A} bytes left to parse.`);break}if(4===G){if(181===E[B++]){const A=ƒú(E,B);if(B+=2,49===A){const A=ƒù(E,B);if(B+=4,1195456820===A){const A=E[B++];if(3===A){const F=E[B++],H=64&F,I=H?2+3*(31&F):0,J=new Uint8Array(I);if(H){J[0]=F;for(let A=1;A<I;A++)J[A]=E[B++]}D.push({type:A,payloadType:G,pts:C,bytes:J})}}}}}else if(5===G&&H>16){const A=[];for(let C=0;C<16;C++){const D=E[B++].toString(16)
;A.push(1==D.length?"0"+D:D),3!==C&&5!==C&&7!==C&&9!==C||A.push("-")}const F=H-16,I=new Uint8Array(F);for(let A=0;A<F;A++)I[A]=E[B++];D.push({payloadType:G,pts:C,uuid:A.join(""),userData:ƒñ(I),userDataBytes:I})}}}function ƒØ(A){const B=A.byteLength,C=[];let D=1;for(;D<B-2;)0===A[D]&&0===A[D+1]&&3===A[D+2]?(C.push(D+2),D+=2):D++;if(0===C.length)return A;const E=B-C.length,F=new Uint8Array(E);let G=0;for(D=0;D<E;G++,D++)G===C[0]&&(G++,C.shift()),F[D]=A[G];return F}function ƒ∞(A,B,C){
if(16!==A.byteLength)throw new RangeError("Invalid system id");let D,E,F;D=0,E=new Uint8Array,F=new Uint8Array;const G=new Uint8Array(4);return C&&C.byteLength>0&&new DataView(G.buffer).setUint32(0,C.byteLength,!1),function(A,...B){const C=B.length;let D=8,E=C;for(;E--;)D+=B[E].byteLength;const F=new Uint8Array(D);for(F[0]=D>>24&255,F[1]=D>>16&255,F[2]=D>>8&255,F[3]=255&D,F.set(A,4),E=0,D=8;E<C;E++)F.set(B[E],D),D+=B[E].byteLength;return F
}([112,115,115,104],new Uint8Array([0,0,0,0]),A,F,E,G,C||new Uint8Array)}function ƒ±(A){const B=A.getUint32(0),C=A.byteOffset,D=A.byteLength;if(D<B)return{offset:C,size:D};if(1886614376!==A.getUint32(4))return{offset:C,size:B};const E=A.getUint32(8)>>>24;if(0!==E&&1!==E)return{offset:C,size:B};const F=A.buffer,G=—É(new Uint8Array(F,C+12,16)),H=A.getUint32(28);let I=null,J=null;if(0===E){if(B-32<H||H<22)return{offset:C,size:B};J=new Uint8Array(F,C+32,H)}else if(1===E){if(!H||D<C+32+16*H+16)return{
offset:C,size:B};I=[];for(let A=0;A<H;A++)I.push(new Uint8Array(F,C+32+16*A,16))}return{version:E,systemId:G,kids:I,data:J,offset:C,size:B}}function ƒ≤(A,B){const C=—å[B];return!!C&&!!C[A.slice(0,4)]}function ƒ≥(A,B,C=!0){return!A.split(",").some((A=>!ƒ¥(A,B,C)))}function ƒ¥(A,B,C=!0){var D;const E=ƒî(C);return null!=(D=null==E?void 0:E.isTypeSupported(ƒµ(A,B)))&&D}function ƒµ(A,B){return`${B}/mp4;codecs=${A}`}function ƒ∂(A){if(A){const B=A.substring(0,4);return —å.video[B]}return 2}function ƒ∑(A){
const B=—ã();return A.split(",").reduce(((A,C)=>{const D=B&&ƒ¨(C)?9:—å.video[C];return D?(2*D+A)/(A?3:2):(—å.audio[C]+A)/(A?2:1)}),0)}function ƒ∏(A,B=!0){return A.replace(—é,(A=>function(A,B=!0){if(—ç[A])return —ç[A];const C={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[A];for(let E=0;E<C.length;E++){var D;if(ƒ¥(C[E],"audio",B))return —ç[A]=C[E],C[E];if("mp3"===C[E]&&null!=(D=ƒî(B))&&D.isTypeSupported("audio/mpeg"))return""}return A}(A.toLowerCase(),B)))}function ƒπ(A,B){
if(A&&(A.length>4||-1!==["ac-3","ec-3","alac","fLaC","Opus"].indexOf(A)))return A;if(B){const C=B.split(",");if(C.length>1){if(A)for(let B=C.length;B--;)if(C[B].substring(0,4)===A.substring(0,4))return C[B];return C[0]}}return B||A}function ƒ∫(A){if(A.startsWith("av01.")){const B=A.split("."),C=["0","111","01","01","01","0"];for(let A=B.length;A>4&&A<10;A++)B[A]=C[A-4];return B.join(".")}return A}function ƒª(A){const B=ƒî(A)||{isTypeSupported:()=>!1};return{mpeg:B.isTypeSupported("audio/mpeg"),
mp3:B.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:B.isTypeSupported('audio/mp4; codecs="ac-3"')}}function ƒº(A){return A.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}function ƒΩ(A,B){return{supported:!1,configurations:B,decodingInfoResults:[{supported:!1,smooth:!1,powerEfficient:!1}],error:A}}function ƒæ(A,B,C,D,E,F){const G=A.audioCodec?A.audioGroups:null,H=null==F?void 0:F.audioCodec,I=null==F?void 0:F.channels,J=I?parseInt(I):H?1/0:2;let K=null;if(null!=G&&G.length)try{
K=1===G.length&&G[0]?B.groups[G[0]].channels:G.reduce(((A,C)=>{if(C){const D=B.groups[C];if(!D)throw Error(`Audio track group ${C} not found`);Object.keys(D.channels).forEach((B=>{A[B]=(A[B]||0)+D.channels[B]}))}return A}),{2:0})}catch(A){return!0}return void 0!==A.videoCodec&&(A.width>1920&&A.height>1088||A.height>1920&&A.width>1088||A.frameRate>Math.max(D,30)||"SDR"!==A.videoRange&&A.videoRange!==C||A.bitrate>Math.max(E,8e6))||!!K&&–∂(J)&&Object.keys(K).some((A=>parseInt(A)>J))}
function ƒø(A,B,C){const D=A.videoCodec,E=A.audioCodec;if(!D&&!E||!C)return Promise.resolve(—è);const F=[];if(D){const B={width:A.width,height:A.height,bitrate:Math.ceil(Math.max(.9*A.bitrate,A.averageBitrate)),framerate:A.frameRate||30},C=A.videoRange;"SDR"!==C&&(B.transferFunction=C.toLowerCase());const E=D.split(","),G=navigator.userAgent;if(E.some((A=>ƒ¨(A)))&&—ã())return Promise.resolve(ƒΩ(Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent sting: (${G})`),F))
;F.push.apply(F,E.map((A=>({type:"media-source",video:ƒë(ƒë({},B),{},{contentType:ƒµ(ƒ∫(A),"video")})}))))}return E&&A.audioGroups&&A.audioGroups.forEach((A=>{var C;A&&(null==(C=B.groups[A])||C.tracks.forEach((B=>{if(B.groupId===A){const A=B.channels||"",C=parseFloat(A);–∂(C)&&C>2&&F.push.apply(F,E.split(",").map((A=>({type:"media-source",audio:{contentType:ƒµ(A,"audio"),channels:""+C}}))))}})))})),Promise.all(F.map((A=>{const B=function(A){const{audio:B,video:C}=A,D=C||B;if(D){
const A=ƒº(D.contentType);if(C)return`r${C.height}x${C.width}f${Math.ceil(C.framerate)}${C.transferFunction||"sd"}_${A}_${Math.ceil(C.bitrate/1e5)}`;if(B)return`c${B.channels}${B.spatialRendering?"s":"n"}_${A}`}return""}(A);return —ê[B]||(—ê[B]=C.decodingInfo(A))}))).then((A=>({supported:!A.some((A=>!A.supported)),configurations:F,decodingInfoResults:A}))).catch((A=>({supported:!1,configurations:F,decodingInfoResults:[],error:A})))}function ≈Ä(A){const{canSkipUntil:B,canSkipDateRanges:C,age:D}=A
;return B&&D<B/2?C?…Ä:»ø:»æ}function ≈Å(A,B){return!(!B||!A)&&-1!==A.indexOf(B)}function ≈Ç(A,B){let C=!1,D=[];if(A&&(C="SDR"!==A,D=[A]),B){D=B.allowedVideoRanges||—í.slice(0);const A="SDR"!==D.join("")&&!B.videoCodec;C=void 0!==B.preferHDR?B.preferHDR:A&&function(){if("function"==typeof matchMedia){const A=matchMedia("(dynamic-range: high)"),B=matchMedia("bad query");if(A.media!==B.media)return!0===A.matches}return!1}(),C||(D=["SDR"])}return{preferHDR:C,allowedVideoRanges:D}}function ≈É(A,B){
—Ç.log(`[abr] start candidates with "${A}" ignored because ${B}`)}function ≈Ñ(A){return A.reduce(((A,B)=>{let C=A.groups[B.groupId];C||(C=A.groups[B.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),C.tracks.push(B);const D=B.channels||"2";return C.channels[D]=(C.channels[D]||0)+1,C.hasDefault=C.hasDefault||B.default,C.hasAutoSelect=C.hasAutoSelect||B.autoselect,C.hasDefault&&(A.hasDefaultAudio=!0),C.hasAutoSelect&&(A.hasAutoSelectAudio=!0),A}),{hasDefaultAudio:!1,
hasAutoSelectAudio:!1,groups:{}})}function ≈Ö(A){if(!A)return A;const{lang:B,assocLang:C,characteristics:D,channels:E,audioCodec:F}=A;return{lang:B,assocLang:C,characteristics:D,channels:E,audioCodec:F}}function ≈Ü(A,B,C){if("attrs"in A){const C=B.indexOf(A);if(-1!==C)return C}for(let D=0;D<B.length;D++)if(≈á(A,B[D],C))return D;return-1}function ≈á(A,B,C){const{groupId:D,name:E,lang:F,assocLang:G,default:H}=A,I=A.forced
;return(void 0===D||B.groupId===D)&&(void 0===E||B.name===E)&&(void 0===F||function(A,B="--"){return A.length===B.length?A===B:A.startsWith(B)||B.startsWith(A)}(F,B.lang))&&(void 0===F||B.assocLang===G)&&(void 0===H||B.default===H)&&(void 0===I||B.forced===I)&&(!("characteristics"in A)||function(A,B=""){const C=A.split(","),D=B.split(",");return C.length===D.length&&!C.some((A=>-1===D.indexOf(A)))}(A.characteristics||"",B.characteristics))&&(void 0===C||C(A,B))}function ≈à(A,B){
const{audioCodec:C,channels:D}=A;return!(void 0!==C&&(B.audioCodec||"").substring(0,4)!==C.substring(0,4)||void 0!==D&&D!==(B.channels||"2"))}function ≈â(A,B,C){for(let D=B;D>-1;D--)if(C(A[D]))return D;for(let D=B+1;D<A.length;D++)if(C(A[D]))return D;return-1}function ≈ä(A,B){var C;return!!A&&A!==(null==(C=B.loadLevelObj)?void 0:C.uri)}function ≈ã(A,B,C=0,D=0,E=.005){let F=null;if(A){F=B[1+A.sn-B[0].sn]||null;const D=A.endDTS-C;D>0&&D<15e-7&&(C+=15e-7),
F&&A.level!==F.level&&F.end<=A.end&&(F=B[2+A.sn-B[0].sn]||null)}else 0===C&&0===B[0].start&&(F=B[0]);if(F&&((!A||A.level===F.level)&&0===≈å(C,D,F)||function(A,B,C){if(B&&0===B.start&&B.level<A.level&&(B.endPTS||0)>0){const D=B.tagList.reduce(((A,B)=>("INF"===B[0]&&(A+=parseFloat(B[1])),A)),C);return A.start<=D}return!1}(F,A,Math.min(E,D))))return F;const G=—ñ(B,≈å.bind(null,C,D));return!G||G===A&&F?F:G}function ≈å(A=0,B=0,C){if(C.start<=A&&C.start+C.duration>A)return 0
;const D=Math.min(B,C.duration+(C.deltaPTS?C.deltaPTS:0));return C.start+C.duration-D<=A?1:C.start-D>A&&C.start?-1:0}function ≈ç(A,B,C){const D=1e3*Math.min(B,C.duration+(C.deltaPTS?C.deltaPTS:0));return(C.endProgramDateTime||0)-D>A}function ≈é(A,B,C){if(A&&A.startCC<=B&&A.endCC>=B){let D=A.fragments;const{fragmentHint:E}=A;let F;return E&&(D=D.concat(E)),—ñ(D,(A=>A.cc<B?1:A.cc>B?-1:(F=A,A.end<=C?1:A.start>C?-1:0))),F||null}return null}function ≈è(A){switch(A.details){case –∫.FRAG_LOAD_TIMEOUT:
case –∫.KEY_LOAD_TIMEOUT:case –∫.LEVEL_LOAD_TIMEOUT:case –∫.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function ≈ê(A,B){const C=≈è(B);return A.default[(C?"timeout":"error")+"Retry"]}function ≈ë(A,B){const C="linear"===A.backoff?1:Math.pow(2,B);return Math.min(C*A.retryDelayMs,A.maxRetryDelayMs)}function ≈í(A){return ƒë(ƒë({},A),{errorRetry:null,timeoutRetry:null})}function ≈ì(A,B,C,D){if(!A)return!1;const E=null==D?void 0:D.code,F=B<A.maxNumRetry&&(function(A){
return 0===A&&!1===navigator.onLine||!!A&&(A<400||A>499)}(E)||!!C);return A.shouldRetry?A.shouldRetry(A,B,C,D,F):F}function ≈î(A){const B={action:…Å,flags:…Ö};return A&&(B.resolved=!0),B}function ≈ï(A){var B,C,D;return A.buffered&&(A.body.gap||(null==(B=A.range.video)?void 0:B.partial)||(null==(C=A.range.audio)?void 0:C.partial)||(null==(D=A.range.audiovideo)?void 0:D.partial))}function ≈ñ(A){return`${A.type}_${A.level}_${A.sn}`}function ≈ó(A,B){return A.filter((A=>{const C=B(A)
;return C||A.clearElementaryStreamInfo(),C}))}function ≈ò(A,B=null){var C,D;const E=B||A,F={frag:A,part:B,responseType:"arraybuffer",url:E.url,headers:{},rangeStart:0,rangeEnd:0},G=E.byteRangeStartOffset,H=E.byteRangeEndOffset;if(–∂(G)&&–∂(H)){let B=G,E=H;if("initSegment"===A.sn&&("AES-128"===(D=null==(C=A.decryptdata)?void 0:C.method)||"AES-256"===D)){const A=H-G;A%16&&(E=H+(16-A%16)),0!==G&&(F.resetIV=!0,B=G-16)}F.rangeStart=B,F.rangeEnd=E}return F}function ≈ô(A,B){
const C=Error(`GAP ${A.gap?"tag":"attribute"} found`),D={type:–π.MEDIA_ERROR,details:–∫.FRAG_GAP,fatal:!1,frag:A,error:C,networkDetails:null};return B&&(D.part=B),(B||A).stats.aborted=!0,new —û(D)}function ≈ö(A){return —£.test(A)}function ≈õ(A,B){if(null!==A.variableList||A.hasVariableRefs){const C=A.variableList;return B.replace(—£,(B=>{const D=B.substring(2,B.length-1),E=null==C?void 0:C[D]
;return void 0===E?(A.playlistParsingError||(A.playlistParsingError=Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${D}"`)),B):E}))}return B}function ≈ú(A,B,C){let D,E,F=A.variableList;if(F||(A.variableList=F={}),"QUERYPARAM"in B){D=B.QUERYPARAM;try{const A=new self.URL(C).searchParams;if(!A.has(D))throw Error(`"${D}" does not match any query parameter in URI: "${C}"`);E=A.get(D)}catch(B){
A.playlistParsingError||(A.playlistParsingError=Error("EXT-X-DEFINE QUERYPARAM: "+B.message))}}else D=B.NAME,E=B.VALUE;D in F?A.playlistParsingError||(A.playlistParsingError=Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${D}"`)):F[D]=E||""}function ≈ù(A,B,C){const D=B.IMPORT;if(C&&D in C){let B=A.variableList;B||(A.variableList=B={}),B[D]=C[D]}else A.playlistParsingError||(A.playlistParsingError=Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${D}"`))}
function ≈û(A){return"SCTE35-OUT"===A||"SCTE35-IN"===A||"SCTE35-CMD"===A}function ≈ü(A){return"AES-128"===A||"AES-256"===A||"AES-256-CTR"===A}function ≈†(A){switch(A){case"AES-128":case"AES-256":return …å;case"AES-256-CTR":return …ç;default:throw Error("invalid full segment method "+A)}}function ≈°(A){return Uint8Array.from(atob(A),(A=>A.charCodeAt(0)))}function ≈¢(A){return Uint8Array.from(unescape(encodeURIComponent(A)),(A=>A.charCodeAt(0)))}function ≈£(A){const B=A.split(":");let C=null
;if("data"===B[0]&&2===B.length){const A=B[1].split(";"),D=A[A.length-1].split(",");if(2===D.length){const B="base64"===D[0],E=D[1];B?(A.splice(-1,1),C=≈°(E)):C=function(A){const B=≈¢(A).subarray(0,16),C=new Uint8Array(16);return C.set(B,16-B.length),C}(E)}}return C}function ≈§(A){switch(A){case …ê:return …é.FAIRPLAY;case …ë:return …é.PLAYREADY;case …í:return …é.WIDEVINE;case …è:return …é.CLEARKEY}}function ≈•(A){return A===…ñ?…é.WIDEVINE:A===…ï?…é.PLAYREADY:A===…ì||A===…î?…é.CLEARKEY:void 0}function ≈¶(A){
switch(A){case …é.FAIRPLAY:return …ê;case …é.PLAYREADY:return …ë;case …é.WIDEVINE:return …í;case …é.CLEARKEY:return …è}}function ≈ß(A){const{drmSystems:B,widevineLicenseUrl:C}=A,D=B?[…é.FAIRPLAY,…é.WIDEVINE,…é.PLAYREADY,…é.CLEARKEY].filter((A=>!!B[A])):[];return!D[…é.WIDEVINE]&&C&&D.push(…é.WIDEVINE),D}function ≈®(A){
const B=new Uint16Array(A.buffer,A.byteOffset,A.byteLength/2),C=String.fromCharCode.apply(null,Array.from(B)),D=C.substring(C.indexOf("<"),C.length),E=(new DOMParser).parseFromString(D,"text/xml").getElementsByTagName("KID")[0];if(E){const A=E.childNodes[0]?E.childNodes[0].nodeValue:E.getAttribute("VALUE");if(A){const B=≈°(A).subarray(0,16);return function(A){const B=function(A,B,C){const D=A[B];A[B]=A[C],A[C]=D};B(A,0,3),B(A,1,2),B(A,4,5),B(A,6,7)}(B),B}}return null}function ≈©(A,B){
const C=A.length,D=A[C-1],E=B.live?1/0:B.totalduration,F=Object.keys(B.dateRanges);for(let G=F.length;G--;){const H=B.dateRanges[F[G]],I=H.startDate.getTime();H.tagAnchor=D.ref;for(let D=C;D--;){const C=≈™(B,I,A,D,E);if(-1!==C){H.tagAnchor=B.fragments[C].ref;break}}}}function ≈™(A,B,C,D,E){const F=C[D];if(F){const H=F.programDateTime;var G;if(B>=H||0===D)if(B<=H+1e3*(((null==(G=C[D+1])?void 0:G.start)||E)-F.start)){const E=C[D].sn-A.startSN,F=A.fragments
;if(F.length>C.length)for(let G=(C[D+1]||F[F.length-1]).sn-A.startSN;G>E;G--){const A=F[G].programDateTime;if(B>=A&&B<A+1e3*F[G].duration)return G}return E}}return-1}function ≈´(A,B,C){var D,E;const F=new —¶(A,C),G=null!=(D=F.METHOD)?D:"",H=F.URI,I=F.hexadecimalInteger("IV"),J=F.KEYFORMATVERSIONS,K=null!=(E=F.KEYFORMAT)?E:"identity";H&&F.IV&&!I&&—Ç.error("Invalid IV: "+F.IV);const L=H?—≤.resolve(H,B):"",M=(J||"1").split("/").map(Number).filter(Number.isFinite);return new —¨(G,L,K,M,I)}function ≈¨(A){
const B=new —¶(A).decimalFloatingPoint("TIME-OFFSET");return –∂(B)?B:null}function ≈≠(A,B){let C=(A||"").split(/[ ,]+/).filter((A=>A));["video","audio","text"].forEach((A=>{const D=C.filter((B=>ƒ≤(B,A)));D.length&&(B[A+"Codec"]=D.map((A=>A.split("/")[0])).join(","),C=C.filter((A=>-1===D.indexOf(A))))})),B.unknownCodecs=C}function ≈Æ(A,B,C){const D=B[C];D&&(A[C]=D)}function ≈Ø(A,B,C){A.rawProgramDateTime?C.push(A):null!=B&&B.programDateTime&&(A.programDateTime=B.endProgramDateTime)}function ≈∞(A,B,C,D){
A.relurl=B.URI,B.BYTERANGE&&A.setByteRange(B.BYTERANGE),A.level=C,A.sn="initSegment",D&&(A.levelkeys=D),A.initSegment=null}function ≈±(A,B,C){A.levelkeys=B;const{encryptedFragments:D}=C;D.length&&D[D.length-1].levelkeys===B||!Object.keys(B).some((A=>B[A].isCommonEncryption))||D.push(A)}function ≈≤(A,B,C){A.playlistParsingError=Error(`#EXT-X-${B} must not appear more than once (${C[0]})`)}function ≈≥(A,B,C){
A.playlistParsingError=Error(`#EXT-X-${B} must appear before the first Media Segment (${C[0]})`)}function ≈¥(A,B){const C=B.startPTS;if(–∂(C)){let D,E=0;B.sn>A.sn?(E=C-A.start,D=A):(E=A.start-C,D=B),D.duration!==E&&D.setDuration(E)}else B.sn>A.sn?A.cc===B.cc&&A.minEndPTS?B.setStart(A.start+(A.minEndPTS-A.start)):B.setStart(A.start+A.duration):B.setStart(Math.max(A.start-B.duration,0))}function ≈µ(A,B,C,D,E,F){D-C<=0&&(—Ç.warn("Fragment should have a positive duration",B),D=C+B.duration,
F=E+B.duration);let G=C,H=D;const I=B.startPTS,J=B.endPTS;if(–∂(I)){const A=Math.abs(I-C);–∂(B.deltaPTS)?B.deltaPTS=Math.max(A,B.deltaPTS):B.deltaPTS=A,G=Math.max(C,I),C=Math.min(C,I),E=Math.min(E,B.startDTS),H=Math.min(D,J),D=Math.max(D,J),F=Math.max(F,B.endDTS)}const K=C-B.start;0!==B.start&&B.setStart(C),B.setDuration(D-B.start),B.startPTS=C,B.maxStartPTS=G,B.startDTS=E,B.endPTS=D,B.minEndPTS=H,B.endDTS=F;const L=B.sn;if(!A||L<A.startSN||L>A.endSN)return 0;let M
;const N=L-A.startSN,O=A.fragments;for(O[N]=B,M=N;M>0;M--)≈¥(O[M],O[M-1]);for(M=N;M<O.length-1;M++)≈¥(O[M],O[M+1]);return A.fragmentHint&&≈¥(O[O.length-1],A.fragmentHint),A.PTSKnown=A.alignedSliding=!0,K}function ≈∂(A,B){if(A===B)return;let C=null;const D=A.fragments;for(let A=D.length-1;A>=0;A--){const B=D[A].initSegment;if(B){C=B;break}}let E;A.fragmentHint&&delete A.fragmentHint.endPTS,function(A,B,C){
const D=B.skippedSegments,E=Math.max(A.startSN,B.startSN)-B.startSN,F=(A.fragmentHint?1:0)+(D?B.endSN:Math.min(A.endSN,B.endSN))-B.startSN,G=B.startSN-A.startSN,H=B.fragmentHint?B.fragments.concat(B.fragmentHint):B.fragments,I=A.fragmentHint?A.fragments.concat(A.fragmentHint):A.fragments;for(let J=E;J<=F;J++){const E=I[G+J];let F=H[J];if(D&&!F&&E&&(F=B.fragments[J]=E),E&&F){if(C(E,F,J,H),E.url&&E.url!==F.url)return void(B.playlistParsingError=≈∑(`media sequence mismatch ${F.sn}:`,A,B,0,F))
;if(E.cc!==F.cc)return void(B.playlistParsingError=≈∑(`discontinuity sequence mismatch (${E.cc}!=${F.cc})`,A,B,0,F))}}}(A,B,((D,F,G,H)=>{if(!B.startCC&&F.cc!==D.cc){var I,J;const C=D.cc-F.cc;for(let A=G;A<H.length;A++)H[A].cc+=C;B.startCC=null!=(I=null==(J=≈ª(A,B.startSN-1))?void 0:J.cc)?I:H[0].cc,B.endCC=H[H.length-1].cc}–∂(D.startPTS)&&–∂(D.endPTS)&&(F.setStart(F.startPTS=D.startPTS),F.startDTS=D.startDTS,F.maxStartPTS=D.maxStartPTS,F.endPTS=D.endPTS,F.endDTS=D.endDTS,F.minEndPTS=D.minEndPTS,
F.setDuration(D.endPTS-D.startPTS),F.duration&&(E=F),B.PTSKnown=B.alignedSliding=!0),D.hasStreams&&(F.elementaryStreams=D.elementaryStreams),F.loader=D.loader,D.hasStats&&(F.stats=D.stats),D.initSegment&&(F.initSegment=D.initSegment,C=D.initSegment)}));const F=B.fragments,G=B.fragmentHint?F.concat(B.fragmentHint):F;if(C&&G.forEach((A=>{var B;!A||A.initSegment&&A.initSegment.relurl!==(null==(B=C)?void 0:B.relurl)||(A.initSegment=C)})),B.skippedSegments)if(B.deltaUpdateFailed=F.some((A=>!A)),
B.deltaUpdateFailed){—Ç.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let A=B.skippedSegments;A--;)F.shift();B.startSN=F[0].sn}else{B.endCC=F[F.length-1].cc,B.canSkipDateRanges&&(B.dateRanges=function(A,B){const{dateRanges:C,recentlyRemovedDateranges:D}=B,E=ƒè({},A);D&&D.forEach((A=>{delete E[A]}));const F=Object.keys(E).length;return F&&Object.keys(C).forEach((A=>{const B=E[A],D=new —ß(C[A].attr,B);D.isValid?(E[A]=D,
B||(D.tagOrder+=F)):—Ç.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${—ï(C[A].attr)}"`)})),E}(A.dateRanges,B));const C=A.fragments.filter((A=>A.rawProgramDateTime));if(A.hasProgramDateTime&&!B.hasProgramDateTime)for(let A=1;A<G.length;A++)null===G[A].programDateTime&&≈Ø(G[A],G[A-1],C);≈©(C,B)}!function(A,B,C){if(A&&B){let D=0;for(let E=0,F=A.length;E<=F;E++){const F=A[E],G=B[E+D];F&&G&&F.index===G.index&&F.fragment.sn===G.fragment.sn?C(F,G):D--}}}(A.partList,B.partList,((A,B)=>{
B.elementaryStreams=A.elementaryStreams,B.stats=A.stats})),E?≈µ(B,E,E.startPTS,E.endPTS,E.startDTS,E.endDTS):≈∏(A,B),F.length&&(B.totalduration=B.edge-F[0].start),B.driftStartTime=A.driftStartTime,B.driftStart=A.driftStart;const H=B.advancedDateTime;if(B.advanced&&H){const A=B.edge;B.driftStart||(B.driftStartTime=H,B.driftStart=A),B.driftEndTime=H,B.driftEnd=A}else B.driftEndTime=A.driftEndTime,B.driftEnd=A.driftEnd,B.advancedDateTime=A.advancedDateTime
;-1===B.requestScheduled&&(B.requestScheduled=A.requestScheduled)}function ≈∑(A,B,C,D,E){return Error(`${A} ${E.url}\nPlaylist starting @${B.startSN}\n${B.m3u8}\n\nPlaylist starting @${C.startSN}\n${C.m3u8}`)}function ≈∏(A,B,C=!0){const D=B.startSN+B.skippedSegments-A.startSN,E=A.fragments,F=D>=0;let G=0;if(F&&D<E.length)G=E[D].start;else if(F&&B.startSN===A.endSN+1)G=A.fragmentEnd;else if(F&&C)G=A.fragmentStart+D*B.levelTargetDuration;else{if(B.skippedSegments||0!==B.fragmentStart)return
;G=A.fragmentStart}≈π(B,G)}function ≈π(A,B){if(B){const C=A.fragments;for(let D=A.skippedSegments;D<C.length;D++)C[D].addStart(B);A.fragmentHint&&A.fragmentHint.addStart(B)}}function ≈∫(A,B=1/0){let C=1e3*A.targetduration;if(A.updated){const D=A.fragments,E=4;if(D.length&&C*E>B){const A=1e3*D[D.length-1].duration;A<C&&(C=A)}}else C/=2;return Math.round(C)}function ≈ª(A,B,C){if(!A)return null;let D=A.fragments[B-A.startSN];return D||(D=A.fragmentHint,D&&D.sn===B?D:B<A.startSN&&C&&C.sn===B?C:null)}
function ≈º(A,B,C){return A?≈Ω(A.partList,B,C):null}function ≈Ω(A,B,C){if(A)for(let D=A.length;D--;){const E=A[D];if(E.index===C&&E.fragment.sn===B)return E}return null}function ≈æ(A){A.forEach(((A,B)=>{var C;null==(C=A.details)||C.fragments.forEach((A=>{A.level=B,A.initSegment&&(A.initSegment.level=B)}))}))}function ≈ø(A,B){for(let D=0,E=A.length;D<E;D++){var C;if((null==(C=A[D])?void 0:C.cc)===B)return A[D]}return null}function ∆Ä(A,B){if(A){const C=A.start+B;A.start=A.startPTS=C,
A.endPTS=C+A.duration}}function ∆Å(A,B){const C=B.fragments;for(let B=0,D=C.length;B<D;B++)∆Ä(C[B],A);B.fragmentHint&&∆Ä(B.fragmentHint,A),B.alignedSliding=!0}function ∆Ç(A,B){if(!function(A,B){return!!(A&&B.startCC<A.endCC&&B.endCC>A.startCC)}(B,A))return;const C=Math.min(B.endCC,A.endCC),D=≈ø(B.fragments,C),E=≈ø(A.fragments,C);D&&E&&(—Ç.log("Aligning playlist at start of dicontinuity sequence "+C),∆Å(D.start-E.start,A))}function ∆É(A,B){if(!A.hasProgramDateTime||!B.hasProgramDateTime)return
;const C=A.fragments,D=B.fragments;if(!C.length||!D.length)return;let E,F;const G=Math.min(B.endCC,A.endCC);B.startCC<G&&A.startCC<G&&(E=≈ø(D,G),F=≈ø(C,G)),E&&F||(E=D[Math.floor(D.length/2)],F=≈ø(C,E.cc)||C[Math.floor(C.length/2)]);const H=E.programDateTime,I=F.programDateTime;H&&I&&∆Å((I-H)/1e3-(F.start-E.start),A)}function ∆Ñ(A){return!!A.interstitialsController&&!1!==A.enableInterstitialPlayback}function ∆Ö(A,B){
return B+10<=A.length&&51===A[B]&&68===A[B+1]&&73===A[B+2]&&A[B+3]<255&&A[B+4]<255&&A[B+6]<128&&A[B+7]<128&&A[B+8]<128&&A[B+9]<128}function ∆Ü(A,B){return B+10<=A.length&&73===A[B]&&68===A[B+1]&&51===A[B+2]&&A[B+3]<255&&A[B+4]<255&&A[B+6]<128&&A[B+7]<128&&A[B+8]<128&&A[B+9]<128}function ∆á(A,B){let C=0;return C=(127&A[B])<<21,C|=(127&A[B+1])<<14,C|=(127&A[B+2])<<7,C|=127&A[B+3],C}function ∆à(A,B){const C=B;let D=0;for(;∆Ü(A,B);)D+=10,D+=∆á(A,B+6),∆Ö(A,B+10)&&(D+=10),B+=D
;if(D>0)return A.subarray(C,C+D)}function ∆â(A,B){return 255===A[B]&&240==(246&A[B+1])}function ∆ä(A,B){return 1&A[B+1]?7:9}function ∆ã(A,B){return(3&A[B+3])<<11|A[B+4]<<3|(224&A[B+5])>>>5}function ∆å(A,B){return B+1<A.length&&∆â(A,B)}function ∆ç(A,B){if(∆å(A,B)){const C=∆ä(A,B);if(B+C>=A.length)return!1;const D=∆ã(A,B);if(D<=C)return!1;const E=B+D;return E===A.length||∆å(A,E)}return!1}function ∆é(A,B,C,D,E){if(!A.samplerate){const F=function(A,B,C,D){const E=B[C+2],F=E>>2&15;if(F>12){
const B=Error("invalid ADTS sampling index:"+F);return void A.emit(–ª.ERROR,–ª.ERROR,{type:–π.MEDIA_ERROR,details:–∫.FRAG_PARSING_ERROR,fatal:!0,error:B,reason:B.message})}const G=1+(E>>6&3),H=B[C+3]>>6&3|(1&E)<<2,I="mp4a.40."+G,J=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350][F];let K=F;5!==G&&29!==G||(K-=3);const L=[G<<3|(14&K)>>1,(1&K)<<7|H<<3];return —Ç.log(`manifest codec:${D}, parsed codec:${I}, channels:${H}, rate:${J} (ADTS object type:${G} sampling index:${F})`),{
config:L,samplerate:J,channelCount:H,codec:I,parsedCodec:I,manifestCodec:D}}(B,C,D,E);if(!F)return;ƒè(A,F)}}function ∆è(A){return 9216e4/A}function ∆ê(A,B,C,D,E){const F=D+E*∆è(A.samplerate),G=function(A,B){const C=∆ä(A,B);if(B+C<=A.length){const D=∆ã(A,B)-C;if(D>0)return{headerLength:C,frameLength:D}}}(B,C);let H;if(G){const{frameLength:D,headerLength:E}=G,I=E+D,J=Math.max(0,C+I-B.length);J?(H=new Uint8Array(I-E),H.set(B.subarray(C+E,B.length),0)):H=B.subarray(C+E,C+I);const K={unit:H,pts:F}
;return J||A.samples.push(K),{sample:K,length:I,missing:J}}const I=B.length-C;return H=new Uint8Array(I),H.set(B.subarray(C,B.length),0),{sample:{unit:H,pts:F},length:I,missing:-1}}function ∆ë(A,B){return ∆Ü(A,B)&&∆á(A,B+6)+10<=A.length-B}function ∆í(A,B=0,C=1/0){return function(A,B,C,D){const E=function(A){return A instanceof ArrayBuffer?A:A.buffer}(A);let F=1;"BYTES_PER_ELEMENT"in D&&(F=D.BYTES_PER_ELEMENT)
;const G=(L=A)&&L.buffer instanceof ArrayBuffer&&void 0!==L.byteLength&&void 0!==L.byteOffset?A.byteOffset:0,H=(G+A.byteLength)/F,I=(G+B)/F,J=Math.floor(Math.max(0,Math.min(I,H))),K=Math.floor(Math.min(J+Math.max(C,0),H));var L;return new D(E,J,K-J)}(A,B,C,Uint8Array)}function ∆ì(A){const B={key:A.type,description:"",data:"",mimeType:null,pictureType:null};if(A.size<2)return;if(3!==A.data[0])return;const C=A.data.subarray(1).indexOf(0);if(-1===C)return
;const D=ƒñ(∆í(A.data,1,C)),E=A.data[2+C],F=A.data.subarray(3+C).indexOf(0);if(-1===F)return;const G=ƒñ(∆í(A.data,3+C,F));let H;return H="-->"===D?ƒñ(∆í(A.data,4+C+F)):function(A){return A instanceof ArrayBuffer?A:0==A.byteOffset&&A.byteLength==A.buffer.byteLength?A.buffer:new Uint8Array(A).buffer}(A.data.subarray(4+C+F)),B.mimeType=D,B.pictureType=E,B.description=G,B.data=H,B}function ∆î(A){return"PRIV"===A.type?function(A){if(A.size<2)return
;const B=ƒñ(A.data,!0),C=new Uint8Array(A.data.subarray(B.length+1));return{key:A.type,info:B,data:C.buffer}}(A):"W"===A.type[0]?function(A){if("WXXX"===A.type){if(A.size<2)return;let B=1;const C=ƒñ(A.data.subarray(B),!0);B+=C.length+1;const D=ƒñ(A.data.subarray(B));return{key:A.type,info:C,data:D}}const B=ƒñ(A.data);return{key:A.type,info:"",data:B}}(A):"APIC"===A.type?∆ì(A):function(A){if(A.size<2)return;if("TXXX"===A.type){let B=1;const C=ƒñ(A.data.subarray(B),!0);B+=C.length+1
;const D=ƒñ(A.data.subarray(B));return{key:A.type,info:C,data:D}}const B=ƒñ(A.data.subarray(1));return{key:A.type,info:"",data:B}}(A)}function ∆ï(A){const B=String.fromCharCode(A[0],A[1],A[2],A[3]),C=∆á(A,4);return{type:B,size:C,data:A.subarray(10,10+C)}}function ∆ñ(A){let B=0;const C=[];for(;∆Ü(A,B);){const D=∆á(A,B+6);A[B+5]>>6&1&&(B+=10),B+=10;const E=B+D;for(;B+10<E;){const D=∆ï(A.subarray(B)),E=∆î(D);E&&C.push(E),B+=D.size+10}∆Ö(A,B)&&(B+=10)}return C}function ∆ó(A){
return A&&"PRIV"===A.key&&"com.apple.streaming.transportStreamTimestamp"===A.info}function ∆ò(A){if(8===A.data.byteLength){const B=new Uint8Array(A.data),C=1&B[3];let D=(B[4]<<23)+(B[5]<<15)+(B[6]<<7)+B[7];return D/=45,C&&(D+=47721858.84),Math.round(D)}}function ∆ô(A){const B=∆ñ(A);for(let A=0;A<B.length;A++){const C=B[A];if(∆ó(C))return ∆ò(C)}}function ∆ö(A="",B=9e4){return{type:A,id:-1,pid:-1,inputTimeScale:B,sequenceNumber:-1,samples:[],dropped:0}}function ∆õ(A,B,C,D,E){if(C+24>B.length)return
;const F=∆ú(B,C);if(F&&C+F.frameLength<=B.length){const G=D+E*(9e4*F.samplesPerFrame/F.sampleRate),H={unit:B.subarray(C,C+F.frameLength),pts:G,dts:G};return A.config=[],A.channelCount=F.channelCount,A.samplerate=F.sampleRate,A.samples.push(H),{sample:H,length:F.frameLength,missing:0}}}function ∆ú(A,B){const C=A[B+1]>>3&3,D=A[B+1]>>1&3,E=A[B+2]>>4&15,F=A[B+2]>>2&3;if(1!==C&&0!==E&&15!==E&&3!==F){
const G=A[B+2]>>1&1,H=A[B+3]>>6,I=1e3*“ê[14*(3===C?3-D:3===D?3:4)+E-1],J=“ë[3*(3===C?0:2===C?1:2)+F],K=3===H?1:2,L=“í[C][D],M=“ì[D],N=8*L*M,O=Math.floor(L*I/J+G)*M;if(null===“è){const A=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);“è=A?parseInt(A[1]):0}return!!“è&&“è<=87&&2===D&&I>=224e3&&0===H&&(A[B+3]=128|A[B+3]),{sampleRate:J,channelCount:K,frameLength:O,samplesPerFrame:N}}}function ∆ù(A,B){return!(255!==A[B]||224&~A[B+1]||!(6&A[B+1]))}function ∆û(A,B){return B+1<A.length&&∆ù(A,B)}function ∆ü(A,B){
if(B+1<A.length&&∆ù(A,B)){const C=4,D=∆ú(A,B);let E=C;null!=D&&D.frameLength&&(E=D.frameLength);const F=B+E;return F===A.length||∆û(A,F)}return!1}function ∆†(A,B,C,D,E){if(C+8>B.length)return-1;if(11!==B[C]||119!==B[C+1])return-1;const F=B[C+4]>>6;if(F>=3)return-1
;const G=[48e3,44100,32e3][F],H=63&B[C+4],I=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*H+F]
;if(C+I>B.length)return-1;const J=B[C+6]>>5;let K=0;2===J?K+=2:(1&J&&1!==J&&(K+=2),4&J&&(K+=2));const L=(B[C+6]<<8|B[C+7])>>12-K&1,M=[2,1,2,3,3,4,4,5][J]+L,N=B[C+5]>>3,O=7&B[C+5],P=new Uint8Array([F<<6|N<<1|O>>2,(3&O)<<6|J<<3|L<<2|H>>4,H<<4&224]),Q=D+E*(1536/G*9e4),R=B.subarray(C,C+I);return A.config=P,A.channelCount=M,A.samplerate=G,A.samples.push({unit:R,pts:Q}),I}function ∆°(A,B){return –∂(A.presentationTime)?A.presentationTime/A.timeScale:B+A.presentationTimeDelta/A.timeScale}function ∆¢(A,B){
return((31&A[B+1])<<8)+A[B+2]}function ∆£(A,B){return(31&A[B+10])<<8|A[B+11]}function ∆§(A,B,C,D,E,F){const G={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},H=B+3+((15&A[B+1])<<8|A[B+2])-4;for(B+=12+((15&A[B+10])<<8|A[B+11]);B<H;){const H=∆¢(A,B),I=(15&A[B+3])<<8|A[B+4];switch(A[B]){case 207:if(!D){∆¶("ADTS AAC",F);break}case 15:-1===G.audioPid&&(G.audioPid=H);break;case 21:-1===G.id3Pid&&(G.id3Pid=H);break;case 219:if(!D){∆¶("H.264",F);break}case 27:
-1===G.videoPid&&(G.videoPid=H);break;case 3:case 4:C.mpeg||C.mp3?-1===G.audioPid&&(G.audioPid=H,G.segmentAudioCodec="mp3"):F.log("MPEG audio found, not supported in this browser");break;case 193:if(!D){∆¶("AC-3",F);break}case 129:C.ac3?-1===G.audioPid&&(G.audioPid=H,G.segmentAudioCodec="ac3"):F.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===G.audioPid&&I>0){let D=B+5,E=I;for(;E>2;){
106===A[D]&&(!0!==C.ac3?F.log("AC-3 audio found, not supported in this browser for now"):(G.audioPid=H,G.segmentAudioCodec="ac3"));const B=A[D+1]+2;D+=B,E-=B}}break;case 194:case 135:return ∆•(E,Error("Unsupported EC-3 in M2TS found"),void 0,F),G;case 36:-1===G.videoPid&&(G.videoPid=H,G.segmentVideoCodec="hevc",F.log("HEVC in M2TS found"))}B+=I+5}return G}function ∆•(A,B,C,D){D.warn("parsing error: "+B.message),A.emit(–ª.ERROR,–ª.ERROR,{type:–π.MEDIA_ERROR,details:–∫.FRAG_PARSING_ERROR,fatal:!1,
levelRetry:C,error:B,reason:B.message})}function ∆¶(A,B){B.log(A+" with AES-128-CBC encryption found in unencrypted stream")}function ∆ß(A,B){let C,D,E,F,G,H=0;const I=A.data;if(!A||0===A.size)return null;for(;I[0].length<19&&I.length>1;)I[0]=ƒ™(I[0],I[1]),I.splice(1,1);if(C=I[0],1===(C[0]<<16)+(C[1]<<8)+C[2]){if(D=(C[4]<<8)+C[5],D&&D>A.size-6)return null;const J=C[7];192&J&&(F=536870912*(14&C[9])+4194304*(255&C[10])+16384*(254&C[11])+128*(255&C[12])+(254&C[13])/2,
64&J?(G=536870912*(14&C[14])+4194304*(255&C[15])+16384*(254&C[16])+128*(255&C[17])+(254&C[18])/2,F-G>54e5&&(B.warn(Math.round((F-G)/9e4)+"s delta between PTS and DTS, align them"),F=G)):G=F),E=C[8];let K=E+9;if(A.size<=K)return null;A.size-=K;const L=new Uint8Array(A.size);for(let A=0,B=I.length;A<B;A++){C=I[A];let B=C.byteLength;if(K){if(K>B){K-=B;continue}C=C.subarray(K),B-=K,K=0}L.set(C,H),H+=B}return D&&(D-=E+3),{data:L,pts:F,dts:G,len:D}}return null}function ∆®(A,B,C=1,D=!1){const E=A*B*C
;return D?Math.round(E):E}function ∆©(A,B=!1){return ∆®(A,1e3,1/9e4,B)}function ∆™(A,B,C,D){return{duration:B,size:C,cts:D,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:A?2:1,isNonSync:A?0:1}}}function ∆´(A,B){let C;if(null===B)return A;for(C=B<A?-8589934592:8589934592;Math.abs(A-B)>4294967296;)A+=C;return A}function ∆¨(A,B,C,D){const E=A.samples.length;if(!E)return;const F=A.inputTimeScale;for(let G=0;G<E;G++){const E=A.samples[G]
;E.pts=∆´(E.pts-C.baseTime*F/C.timescale,B*F)/F,E.dts=∆´(E.dts-D.baseTime*F/D.timescale,B*F)/F}const G=A.samples;return A.samples=[],{samples:G}}function ∆≠(A,B,C){const D=A.samples.length;if(!D)return;const E=A.inputTimeScale;for(let F=0;F<D;F++){const D=A.samples[F];D.pts=∆´(D.pts-C.baseTime*E/C.timescale,B*E)/E}A.samples.sort(((A,B)=>A.pts-B.pts));const F=A.samples;return A.samples=[],{samples:F}}function ∆Æ(A,B,C=!1){
return void 0!==(null==A?void 0:A.start)?(A.start+(C?A.duration:0))/A.timescale:B}function ∆Ø(A,B,C){const D=null==A?void 0:A.codec;return D&&D.length>4?D:B===»ª?"ec-3"===D||"ac-3"===D||"alac"===D?D:"fLaC"===D||"Opus"===D?ƒ∏(D,!1):(C.warn(`Unhandled audio codec "${D}" in mp4 MAP`),D||"mp4a"):(C.warn(`Unhandled video codec "${D}" in mp4 MAP`),D||"avc1")}function ∆∞(A){return"then"in A&&A.then instanceof Function}function ∆±(A,B){if(A.length!==B.length)return!1
;for(let C=0;C<A.length;C++)if(!∆≤(A[C].attrs,B[C].attrs))return!1;return!0}function ∆≤(A,B,C){const D=A["STABLE-RENDITION-ID"];return D&&!C?D===B["STABLE-RENDITION-ID"]:!(C||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some((C=>A[C]!==B[C]))}function ∆≥(A,B){return B.label.toLowerCase()===A.name.toLowerCase()&&(!B.language||B.language.toLowerCase()===(A.lang||"").toLowerCase())}function ∆¥(A){const B=A.querySelectorAll("source")
;[].slice.call(B).forEach((B=>{A.removeChild(B)}))}function ∆µ(A){return"audio"===A?1:0}function ∆∂(A,B,C,D){return Error(`failed to ${A} "${function(A){return Array.isArray(A)?JSON.stringify(A):A instanceof Map?"Map{}":A instanceof Set?"Set{}":"object"==typeof A?JSON.stringify(A):A+""}(B)}" as ${C}`,{cause:D})}function ∆∑(A,B,C){return ∆∂("serialize",A,B,C)}function ∆∏(A){if(!1===ArrayBuffer.isView(A))throw ∆∑(A,"Byte Sequence");return`:${B=A,btoa(String.fromCharCode(...B))}:`;var B}function ∆π(A){
if(function(A){return A<-999999999999999||999999999999999<A}(A))throw ∆∑(A,"Integer");return A.toString()}function ∆∫(A,B){if(A<0)return-∆∫(-A,B);const C=Math.pow(10,B);if(Math.abs(A*C%1-.5)<Number.EPSILON){const B=Math.floor(A*C);return(B%2==0?B:B+1)/C}return Math.round(A*C)/C}function ∆ª(A){const B=∆∫(A,3);if(Math.floor(Math.abs(B)).toString().length>12)throw ∆∑(A,"Decimal");const C=B.toString();return C.includes(".")?C:C+".0"}function ∆º(A){const B=(C=A).description||C.toString().slice(7,-1);var C
;if(!1===/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(B))throw ∆∑(B,"Token");return B}function ∆Ω(A){switch(typeof A){case"number":if(!–∂(A))throw ∆∑(A,“∫);return Number.isInteger(A)?∆π(A):∆ª(A);case"string":return function(A){if(“ª.test(A))throw ∆∑(A,"String");return`"${A.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}(A);case"symbol":return ∆º(A);case"boolean":return function(A){if("boolean"!=typeof A)throw ∆∑(A,"Boolean");return A?"?1":"?0"}(A);case"object":if(A instanceof Date)return function(A){
return"@"+∆π(A.getTime()/1e3)}(A);if(A instanceof Uint8Array)return ∆∏(A);if(A instanceof “π)return ∆º(A);default:throw ∆∑(A,“∫)}}function ∆æ(A){if(!1===/^[a-z*][a-z0-9\-_.*]*$/.test(A))throw ∆∑(A,"Key");return A}function ∆ø(A){return null==A?"":Object.entries(A).map((([A,B])=>!0===B?";"+∆æ(A):`;${∆æ(A)}=${∆Ω(B)}`)).join("")}function «Ä(A){return A instanceof “∏?`${∆Ω(A.value)}${∆ø(A.params)}`:∆Ω(A)}function «Å(A,B={whitespace:!0}){if("object"!=typeof A)throw ∆∑(A,"Dict")
;const C=A instanceof Map?A.entries():Object.entries(A),D=(null==B?void 0:B.whitespace)?" ":"";return Array.from(C).map((([A,B])=>{B instanceof “∏==0&&(B=new “∏(B));let C=∆æ(A);return!0===B.value?C+=∆ø(B.params):(C+="=",Array.isArray(B.value)?C+=function(A){return`(${A.value.map(«Ä).join(" ")})${∆ø(A.params)}`}(B):C+=«Ä(B)),C})).join(","+D)}function «Ç(A,B){const C={};if(null==A||"object"!=typeof A)return C;const D=Object.keys(A).sort(),E=ƒè({},“æ,null==B?void 0:B.formatters),F=null==B?void 0:B.filter
;return D.forEach((D=>{if(null==F?void 0:F(D))return;let G=A[D];const H=E[D];H&&(G=H(G,B)),"v"===D&&1===G||"pr"==D&&1===G||function(A){return"number"==typeof A?–∂(A):null!=A&&""!==A&&!1!==A}(G)&&(function(A){return"ot"===A||"sf"===A||"st"===A}(D)&&"string"==typeof G&&(G=new “π(G)),C[D]=G)})),C}function «É(A,B={}){return A?function(A,B){return «Å(A,B)}(«Ç(A,B),ƒè({whitespace:!1},B)):""}function «Ñ(A,B,C){return ƒè(A,function(A,B={}){const C={};if(!A)return C
;const D=Object.entries(A),E=Object.entries(“∑).concat(Object.entries((null==B?void 0:B.customHeaderMap)||{})),F=D.reduce(((A,B)=>{var C,D;const[F,G]=B,H=(null===(C=E.find((A=>A[1].includes(F))))||void 0===C?void 0:C[0])||“¥;return null!==(D=A[H])&&void 0!==D||(A[H]={}),A[H][F]=G,A}),{});return Object.entries(F).reduce(((A,[C,D])=>(A[C]=«É(D,B),A)),C)}(B,C))}function «Ö(A,B,C){const D=function(A,B={}){if(!A)return"";const C=«É(A,B);return"CMCD="+encodeURIComponent(C)}(B,C);if(!D)return A
;if(“ø.test(A))return A.replace(“ø,D);const E=A.includes("?")?"&":"?";return`${A}${E}${D}`}function «Ü(A,B,C,D){A&&Object.keys(B).forEach((E=>{const F=A.filter((A=>A.groupId===E)).map((A=>{const F=ƒè({},A);return F.details=void 0,F.attrs=new —¶(F.attrs),F.url=F.attrs.URI=«á(A.url,A.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",C),F.groupId=F.attrs["GROUP-ID"]=B[E],F.attrs["PATHWAY-ID"]=D,F}));A.push(...F)}))}function «á(A,B,C,D){const{HOST:E,PARAMS:F,[C]:G}=D;let H;B&&(H=null==G?void 0:G[B],
H&&(A=H));const I=new self.URL(A);return E&&!H&&(I.host=E),F&&Object.keys(F).sort().forEach((A=>{A&&I.searchParams.set(A,F[A])})),I.href}function «à(A,B,C){«â(A,B,C),A.addEventListener(B,C)}function «â(A,B,C){A.removeEventListener(B,C)}function «ä(A,B){let C;try{C=new Event("addtrack")}catch(A){C=document.createEvent("Event"),C.initEvent("addtrack",!1,!1)}C.track=A,B.dispatchEvent(C)}function «ã(A,B){const C=A.mode;if("disabled"===C&&(A.mode="hidden"),A.cues&&!A.cues.getCueById(B.id))try{
if(A.addCue(B),!A.cues.getCueById(B.id))throw Error("addCue is failed for: "+B)}catch(C){—Ç.debug("[texttrack-utils]: "+C);try{const C=new self.TextTrackCue(B.startTime,B.endTime,B.text);C.id=B.id,A.addCue(C)}catch(A){—Ç.debug("[texttrack-utils]: Legacy TextTrackCue fallback failed: "+A)}}"disabled"===C&&(A.mode=C)}function «å(A,B){const C=A.mode;if("disabled"===C&&(A.mode="hidden"),A.cues)for(let C=A.cues.length;C--;)B&&A.cues[C].removeEventListener("enter",B),A.removeCue(A.cues[C])
;"disabled"===C&&(A.mode=C)}function «ç(A,B,C,D){const E=A.mode;if("disabled"===E&&(A.mode="hidden"),A.cues&&A.cues.length>0){const E=function(A,B,C){const D=[],E=function(A,B){if(B<=A[0].startTime)return 0;const C=A.length-1;if(B>A[C].endTime)return-1;let D,E=0,F=C;for(;E<=F;)if(D=Math.floor((F+E)/2),B<A[D].startTime)F=D-1;else{if(!(B>A[D].startTime&&E<C))return D;E=D+1}return A[E].startTime-B<B-A[F].startTime?E:F}(A,B);if(E>-1)for(let F=E,G=A.length;F<G;F++){const E=A[F]
;if(E.startTime>=B&&E.endTime<=C)D.push(E);else if(E.startTime>C)return D}return D}(A.cues,B,C);for(let B=0;B<E.length;B++)D&&!D(E[B])||A.removeCue(E[B])}"disabled"===E&&(A.mode=E)}function «é(A){const B=[];for(let C=0;C<A.length;C++){const D=A[C];"subtitles"!==D.kind&&"captions"!==D.kind||!D.label||B.push(A[C])}return B}function «è(A){let B=5381,C=A.length;for(;C;)B=33*B^A.charCodeAt(--C);return""+(B>>>0)}function «ê(A,B,C){return`${A.identifier}-${C+1}-${«è(B)}`}function «ë(A,B){
return A-B.start<B.duration/2&&!(Math.abs(A-(B.start+B.duration))<”Ç)?B.start:B.start+B.duration}function «í(A,B,C){const D=new self.URL(A,C);return"data:"!==D.protocol&&D.searchParams.set("_HLS_primary_id",B),D}function «ì(A,B){for(;null!=(C=A.assetList[++B])&&C.error;)var C;return B}function «î(A){const B=A.timelineStart,C=A.duration||0;return`["${A.identifier}" ${B.toFixed(2)}-${(B+C).toFixed(2)}]`}function «ï(A){
return`[${A.event?'"'+A.event.identifier+'"':"primary"}: ${A.start.toFixed(2)}-${A.end.toFixed(2)}]`}function «ñ(A){null==A||A.play().catch((()=>{}))}function «ó(A,B,C){C.a=A,C.b=B}function «ò(A,B,C){return C.a===A&&C.b===B}function «ô(A){function B(A,B,C,D){return 3600*(0|A)+60*(0|B)+(0|C)+parseFloat(D||0)}const C=A.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return C?parseFloat(C[2])>59?B(C[2],C[3],0,C[4]):B(C[1],C[2],C[3],C[4]):null}function «ö(A,B,C,D){const E=D?A.split(D):[A];for(const A in E){
if("string"!=typeof E[A])continue;const D=E[A].split(C);2===D.length&&B(D[0],D[1])}}function «õ(A,B,C){function D(){const B=«ô(A);if(null===B)throw Error("Malformed timestamp: "+F);return A=A.replace(/^[^\sa-zA-Z-]+/,""),B}function E(){A=A.replace(/^\s+/,"")}const F=A;if(E(),B.startTime=D(),E(),"-->"!==A.slice(0,3))throw Error("Malformed time stamp (time stamps must be separated by '-->'): "+F);A=A.slice(3),E(),B.endTime=D(),E(),function(A,B){const D=new ”õ;«ö(A,(function(A,B){let E;switch(A){
case"region":for(let E=C.length-1;E>=0;E--)if(C[E].id===B){D.set(A,C[E].region);break}break;case"vertical":D.alt(A,B,["rl","lr"]);break;case"line":E=B.split(","),D.integer(A,E[0]),D.percent(A,E[0])&&D.set("snapToLines",!1),D.alt(A,E[0],["auto"]),2===E.length&&D.alt("lineAlign",E[1],["start",”ù,"end"]);break;case"position":E=B.split(","),D.percent(A,E[0]),2===E.length&&D.alt("positionAlign",E[1],["start",”ù,"end","line-left","line-right","auto"]);break;case"size":D.percent(A,B);break;case"align":
D.alt(A,B,["start",”ù,"end","left","right"])}}),/:/,/\s/),B.region=D.get("region",null),B.vertical=D.get("vertical","");let E=D.get("line","auto");"auto"===E&&-1===”ú.line&&(E=-1),B.line=E,B.lineAlign=D.get("lineAlign","start"),B.snapToLines=D.get("snapToLines",!0),B.size=D.get("size",100),B.align=D.get("align",”ù);let F=D.get("position","auto");"auto"===F&&50===”ú.position&&(F="start"===B.align||"left"===B.align?0:"end"===B.align||"right"===B.align?100:50),B.position=F}(A,B)}function «ú(A){
return A.replace(/<br(?: \/)?>/gi,"\n")}function «ù(A,B,C){return «è(A.toString())+«è(B.toString())+«è(C)}function «û(A,B,C,D,E,F,G){const H=new ”û,I=ƒñ(new Uint8Array(A)).trim().replace(”ü,"\n").split("\n"),J=[],K=B?function(A,B=1){return ∆®(A,9e4,1/B)}(B.baseTime,B.timescale):0;let L,M="00:00.000",N=0,O=0,P=!0;H.oncue=function(A){const F=C[D];let G=C.ccOffset;const H=(N-K)/9e4;if(null!=F&&F.new&&(void 0!==O?G=C.ccOffset=F.start:function(A,B,C){let D=A[B],E=A[D.prevCC]
;if(!E||!E.new&&D.new)return A.ccOffset=A.presentationOffset=D.start,void(D.new=!1);for(;null!=(F=E)&&F.new;){var F;A.ccOffset+=D.start-E.start,D.new=!1,D=E,E=A[D.prevCC]}A.presentationOffset=C}(C,D,H)),H){if(!B)return void(L=Error("Missing initPTS for VTT MPEGTS"));G=H-C.presentationOffset}const I=A.endTime-A.startTime,M=∆´(9e4*(A.startTime+G-O),9e4*E)/9e4;A.startTime=Math.max(M,0),A.endTime=Math.max(M+I,0);const P=A.text.trim();A.text=decodeURIComponent(encodeURIComponent(P)),
A.id||(A.id=«ù(A.startTime,A.endTime,P)),A.endTime>0&&J.push(A)},H.onparsingerror=function(A){L=A},H.onflush=function(){L?G(L):F(J)},I.forEach((A=>{if(P){if(”†(A,"X-TIMESTAMP-MAP=")){P=!1,A.slice(16).split(",").forEach((A=>{”†(A,"LOCAL:")?M=A.slice(6):”†(A,"MPEGTS:")&&(N=parseInt(A.slice(7)))}));try{O=function(A){let B=parseInt(A.slice(-3));const C=parseInt(A.slice(-6,-4)),D=parseInt(A.slice(-9,-7)),E=A.length>9?parseInt(A.substring(0,A.indexOf(":"))):0
;if(!(–∂(B)&&–∂(C)&&–∂(D)&&–∂(E)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+A);return B+=1e3*C,B+=6e4*D,B+=36e5*E,B}(M)/1e3}catch(A){L=A}return}""===A&&(P=!1)}H.parse(A+"\n")})),H.flush()}function «ü(A,B,C,D){const E=ƒ°(new Uint8Array(A),["mdat"]);if(0===E.length)return void D(Error("Could not parse IMSC1 mdat"));const F=E.map((A=>ƒñ(A))),G=function(A,B,C=1,D=!1){return ∆®(A,B,1/C,D)}(B.baseTime,1,B.timescale);try{F.forEach((A=>C(function(A,B){
const C=(new DOMParser).parseFromString(A,"text/xml"),D=C.getElementsByTagName("tt")[0];if(!D)throw Error("Invalid ttml");const E={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},F=Object.keys(E).reduce(((A,B)=>(A[B]=D.getAttribute("ttp:"+B)||E[B],A)),{}),G="preserve"!==D.getAttribute("xml:space"),H=«°(«†(D,"styling","style")),I=«°(«†(D,"layout","region")),J=«†(D,"body","[begin]");return[].map.call(J,(A=>{const C=«¢(A,G);if(!C||!A.hasAttribute("begin"))return null
;const D=«•(A.getAttribute("begin"),F),E=«•(A.getAttribute("dur"),F);let J=«•(A.getAttribute("end"),F);if(null===D)throw «§(A);if(null===J){if(null===E)throw «§(A);J=D+E}const K=new …õ(D-B,J-B,C);K.id=«ù(K.startTime,K.endTime,K.text);const L=function(A,B,C){const D="http://www.w3.org/ns/ttml#styling";let E=null;const F=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],G=null!=A&&A.hasAttribute("style")?A.getAttribute("style"):null;return G&&C.hasOwnProperty(G)&&(E=C[G]),
F.reduce(((C,F)=>{const G=«£(B,D,F)||«£(A,D,F)||«£(E,D,F);return G&&(C[F]=G),C}),{})}(I[A.getAttribute("region")],H[A.getAttribute("style")],H),{textAlign:M}=L;if(M){const A=”§[M];A&&(K.lineAlign=A),K.align=M}return ƒè(K,L),K})).filter((A=>null!==A))}(A,G))))}catch(A){D(A)}}function «†(A,B,C){const D=A.getElementsByTagName(B)[0];return D?[].slice.call(D.querySelectorAll(C)):[]}function «°(A){return A.reduce(((A,B)=>{const C=B.getAttribute("xml:id");return C&&(A[C]=B),A}),{})}function «¢(A,B){
return[].slice.call(A.childNodes).reduce(((A,C,D)=>{var E;return"br"===C.nodeName&&D?A+"\n":null!=(E=C.childNodes)&&E.length?«¢(C,B):B?A+C.textContent.trim().replace(/\s+/g," "):A+C.textContent}),"")}function «£(A,B,C){return A&&A.hasAttributeNS(B,C)?A.getAttributeNS(B,C):null}function «§(A){return Error("Could not parse ttml timestamp "+A)}function «•(A,B){if(!A)return null;let C=«ô(A);return null===C&&(”¢.test(A)?C=function(A,B){const C=”¢.exec(A),D=(0|C[4])+(0|C[5])/B.subFrameRate
;return 3600*(0|C[1])+60*(0|C[2])+(0|C[3])+D/B.frameRate}(A,B):”£.test(A)&&(C=function(A,B){const C=”£.exec(A),D=Number(C[1]);switch(C[2]){case"h":return 3600*D;case"m":return 60*D;case"ms":return 1e3*D;case"f":return D/B.frameRate;case"t":return D/B.tickRate}return D}(A,B))),C}function «¶(A){return A.characteristics&&/transcribes-spoken-dialog/gi.test(A.characteristics)&&/describes-music-and-sound/gi.test(A.characteristics)?"captions":"subtitles"}function «ß(A,B){return!!A&&A.kind===«¶(B)&&∆≥(B,A)}
function «®(A){const B=A.get("Content-Range");if(B){const A=function(A){const B=”®.exec(A);if(B)return parseInt(B[2])-parseInt(B[1])+1}(B);if(–∂(A))return A}const C=A.get("Content-Length");if(C)return parseInt(C)}function «©(A,B){return new self.Request(A.url,B)}function «™(A){return A&&"object"==typeof A?Array.isArray(A)?A.map(«™):Object.keys(A).reduce(((B,C)=>(B[C]=«™(A[C]),B)),{}):A}function «´(A,B){const C=A.loader
;C!==”©&&C!==”¨?(B.log("[config]: Custom loader detected, cannot enable progressive streaming"),A.progressive=!1):function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(A){}return!1}()&&(A.loader=”©,A.progressive=!0,A.enableSoftwareAES=!0,B.log("[config]: Progressive streaming enabled, using FetchLoader"))}function «¨(A,B){const C=«≠(A.main);if(C&&C.start<=B)return C;const D=«≠(A.audio);return D&&D.start<=B?D:null}
function «≠(A){if(!A)return null;switch(A.state){case —µ:case —¥:case —º:case —Ω:return null}return A.frag}function «Æ(){if("undefined"!=typeof self)return self.VTTCue||self.TextTrackCue}function «Ø(A,B,C,D,E){let F=new A(B,C,"");try{F.value=D,E&&(F.type=E)}catch(G){F=new A(B,C,—ï(E?ƒë({type:E},D):D))}return F}function «∞(A){const B={};A.forEach((A=>{const C=A.groupId||"";A.id=B[C]=B[C]||0,B[C]++}))}function «±(){return self.SourceBuffer||self.WebKitSourceBuffer}function «≤(){if(!ƒî())return!1;const A=«±()
;return!A||A.prototype&&"function"==typeof A.prototype.appendBuffer&&"function"==typeof A.prototype.remove}function «≥(A){const{type:B}=A;switch(B){case »≥:return »∂;case »¥:return »∑;default:return »µ}}function «¥(A,B){let C=A.url;return void 0!==C&&0!==C.indexOf("data:")||(C=B.url),C}
var «µ,«∂,«∑,«∏,«π,«∫,«ª,«º,«Ω,«æ,«ø,»Ä,»Å,»Ç,»É,»Ñ,»Ö,»Ü,»á,»à,»â,»ä,»ã,»å,»ç,»é,»è,»ê,»ë,»í,»ì,»î,»ï,»ñ,»ó,»ò,»ô,»ö,»õ,»ú,»ù,»û,»ü,»†,»°,»¢,»£,»§,»•,»¶,»ß,»®,»©,»™,»´,»¨,»≠,»Æ,»Ø,»∞,»±,»≤,»≥,»¥,»µ,»∂,»∑,»∏,»π,»∫,»ª,»º,»Ω,»æ,»ø,…Ä,…Å,…Ç,…É,…Ñ,…Ö,…Ü,…á,…à,…â,…ä,…ã,…å,…ç,…é,…è,…ê,…ë,…í,…ì,…î,…ï,…ñ,…ó,…ò,…ô,…ö,…õ,…ú,…ù,…û,…ü,…†,…°,…¢,…£={};…£.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(A){if("object"==typeof window)return window}}();const …§=function(A){const B=[];let C=0;for(let D=0;D<A.length;D++){let E=A.charCodeAt(D)
;E<128?B[C++]=E:E<2048?(B[C++]=E>>6|192,B[C++]=63&E|128):55296==(64512&E)&&D+1<A.length&&56320==(64512&A.charCodeAt(D+1))?(E=65536+((1023&E)<<10)+(1023&A.charCodeAt(++D)),B[C++]=E>>18|240,B[C++]=E>>12&63|128,B[C++]=E>>6&63|128,B[C++]=63&E|128):(B[C++]=E>>12|224,B[C++]=E>>6&63|128,B[C++]=63&E|128)}return B},…•={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",
get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(A,B){if(!Array.isArray(A))throw Error("encodeByteArray takes an array as a parameter");this.init_();const C=B?this.byteToCharMapWebSafe_:this.byteToCharMap_,D=[];for(let B=0;B<A.length;B+=3){const E=A[B],F=B+1<A.length,G=F?A[B+1]:0,H=B+2<A.length,I=H?A[B+2]:0,J=E>>2,K=(3&E)<<4|G>>4;let L=(15&G)<<2|I>>6,M=63&I;H||(M=64,
F||(L=64)),D.push(C[J],C[K],C[L],C[M])}return D.join("")},encodeString(A,B){return this.HAS_NATIVE_SUPPORT&&!B?btoa(A):this.encodeByteArray(…§(A),B)},decodeString(A,B){return this.HAS_NATIVE_SUPPORT&&!B?atob(A):function(A){const B=[];let C=0,D=0;for(;C<A.length;){const E=A[C++];if(E<128)B[D++]=String.fromCharCode(E);else if(E>191&&E<224){const F=A[C++];B[D++]=String.fromCharCode((31&E)<<6|63&F)}else if(E>239&&E<365){const F=((7&E)<<18|(63&A[C++])<<12|(63&A[C++])<<6|63&A[C++])-65536
;B[D++]=String.fromCharCode(55296+(F>>10)),B[D++]=String.fromCharCode(56320+(1023&F))}else{const F=A[C++],G=A[C++];B[D++]=String.fromCharCode((15&E)<<12|(63&F)<<6|63&G)}}return B.join("")}(this.decodeStringToByteArray(A,B))},decodeStringToByteArray(A,B){this.init_();const C=B?this.charToByteMapWebSafe_:this.charToByteMap_,D=[];for(let B=0;B<A.length;){const E=C[A.charAt(B++)],F=B<A.length?C[A.charAt(B)]:0;++B;const G=B<A.length?C[A.charAt(B)]:64;++B;const H=B<A.length?C[A.charAt(B)]:64;if(++B,
null==E||null==F||null==G||null==H)throw new …¶;const I=E<<2|F>>4;if(D.push(I),64!==G){const A=F<<4&240|G>>2;if(D.push(A),64!==H){const A=G<<6&192|H;D.push(A)}}}return D},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let A=0;A<this.ENCODED_VALS.length;A++)this.byteToCharMap_[A]=this.ENCODED_VALS.charAt(A),this.charToByteMap_[this.byteToCharMap_[A]]=A,
this.byteToCharMapWebSafe_[A]=this.ENCODED_VALS_WEBSAFE.charAt(A),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[A]]=A,A>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(A)]=A,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(A)]=A)}}};class …¶ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const …ß=function(A){return function(A){const B=…§(A);return …•.encodeByteArray(B,!0)}(A).replace(/\./g,"")},…®=function(A){try{
return …•.decodeString(A,!0)}catch(A){}return null},…©=()=>function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==…£.g)return …£.g;throw Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,…™=()=>{try{return …©()||(()=>{if("undefined"==typeof process||void 0===process.env)return;const A=process.env.__FIREBASE_DEFAULTS__;return A?JSON.parse(A):void 0})()||(()=>{if("undefined"==typeof document)return;let A;try{
A=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(A){return}const B=A&&…®(A[1]);return B&&JSON.parse(B)})()}catch(A){return}},…´=()=>{var A;return null===(A=…™())||void 0===A?void 0:A.config};class …¨{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((A,B)=>{this.resolve=A,this.reject=B}))}wrapCallback(A){return(B,C)=>{B?this.reject(B):this.resolve(C),"function"==typeof A&&(this.promise.catch((()=>{})),1===A.length?A(B):A(B,C))}}}class …≠ extends Error{
constructor(A,B,C){super(B),this.code=A,this.customData=C,this.name="FirebaseError",Object.setPrototypeOf(this,…≠.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,…Æ.prototype.create)}}class …Æ{constructor(A,B,C){this.service=A,this.serviceName=B,this.errors=C}create(A,...B){const C=B[0]||{},D=`${this.service}/${A}`,E=this.errors[A],F=E?function(A,B){return A.replace(…Ø,((A,C)=>{const D=B[C];return null!=D?D+"":`<${C}?>`}))}(E,C):"Error",G=`${this.serviceName}: ${F} (${D}).`
;return new …≠(D,G,C)}}const …Ø=/\{\$([^}]+)}/g;class …∞{constructor(A,B,C){this.name=A,this.instanceFactory=B,this.type=C,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(A){return this.instantiationMode=A,this}setMultipleInstances(A){return this.multipleInstances=A,this}setServiceProps(A){return this.serviceProps=A,this}setInstanceCreatedCallback(A){return this.onInstanceCreated=A,this}}const …±="[DEFAULT]";class …≤{
constructor(A,B){this.name=A,this.container=B,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(A){const B=this.normalizeInstanceIdentifier(A);if(!this.instancesDeferred.has(B)){const A=new …¨;if(this.instancesDeferred.set(B,A),this.isInitialized(B)||this.shouldAutoInitialize())try{const C=this.getOrInitializeService({instanceIdentifier:B});C&&A.resolve(C)}catch(A){}}return this.instancesDeferred.get(B).promise
}getImmediate(A){var B;const C=this.normalizeInstanceIdentifier(null==A?void 0:A.identifier),D=null!==(B=null==A?void 0:A.optional)&&void 0!==B&&B;if(!this.isInitialized(C)&&!this.shouldAutoInitialize()){if(D)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:C})}catch(A){if(D)return null;throw A}}getComponent(){return this.component}setComponent(A){
if(A.name!==this.name)throw Error(`Mismatching Component ${A.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=A,this.shouldAutoInitialize()){if(function(A){return"EAGER"===A.instantiationMode}(A))try{this.getOrInitializeService({instanceIdentifier:…±})}catch(A){}for(const[A,B]of this.instancesDeferred.entries()){const C=this.normalizeInstanceIdentifier(A);try{const A=this.getOrInitializeService({
instanceIdentifier:C});B.resolve(A)}catch(A){}}}}clearInstance(A=…±){this.instancesDeferred.delete(A),this.instancesOptions.delete(A),this.instances.delete(A)}async delete(){const A=Array.from(this.instances.values());await Promise.all([...A.filter((A=>"INTERNAL"in A)).map((A=>A.INTERNAL.delete())),...A.filter((A=>"_delete"in A)).map((A=>A._delete()))])}isComponentSet(){return null!=this.component}isInitialized(A=…±){return this.instances.has(A)}getOptions(A=…±){
return this.instancesOptions.get(A)||{}}initialize(A={}){const{options:B={}}=A,C=this.normalizeInstanceIdentifier(A.instanceIdentifier);if(this.isInitialized(C))throw Error(`${this.name}(${C}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const D=this.getOrInitializeService({instanceIdentifier:C,options:B});for(const[A,B]of this.instancesDeferred.entries())C===this.normalizeInstanceIdentifier(A)&&B.resolve(D);return D}
onInit(A,B){var C;const D=this.normalizeInstanceIdentifier(B),E=null!==(C=this.onInitCallbacks.get(D))&&void 0!==C?C:new Set;E.add(A),this.onInitCallbacks.set(D,E);const F=this.instances.get(D);return F&&A(F,D),()=>{E.delete(A)}}invokeOnInitCallbacks(A,B){const C=this.onInitCallbacks.get(B);if(C)for(const D of C)try{D(A,B)}catch(A){}}getOrInitializeService({instanceIdentifier:A,options:B={}}){let C=this.instances.get(A);if(!C&&this.component&&(C=this.component.instanceFactory(this.container,{
instanceIdentifier:(D=A,D===…±?void 0:D),options:B}),this.instances.set(A,C),this.instancesOptions.set(A,B),this.invokeOnInitCallbacks(C,A),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,A,C)}catch(A){}var D;return C||null}normalizeInstanceIdentifier(A=…±){return this.component?this.component.multipleInstances?A:…±:A}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class …≥{constructor(A){this.name=A,
this.providers=new Map}addComponent(A){const B=this.getProvider(A.name);if(B.isComponentSet())throw Error(`Component ${A.name} has already been registered with ${this.name}`);B.setComponent(A)}addOrOverwriteComponent(A){this.getProvider(A.name).isComponentSet()&&this.providers.delete(A.name),this.addComponent(A)}getProvider(A){if(this.providers.has(A))return this.providers.get(A);const B=new …≤(A,this);return this.providers.set(A,B),B}getProviders(){return Array.from(this.providers.values())}}
const …¥=[];!function(A){A[A.DEBUG=0]="DEBUG",A[A.VERBOSE=1]="VERBOSE",A[A.INFO=2]="INFO",A[A.WARN=3]="WARN",A[A.ERROR=4]="ERROR",A[A.SILENT=5]="SILENT"}(«µ||(«µ={}));const …µ={debug:«µ.DEBUG,verbose:«µ.VERBOSE,info:«µ.INFO,warn:«µ.WARN,error:«µ.ERROR,silent:«µ.SILENT},…∂=«µ.INFO,…∑={[«µ.DEBUG]:"log",[«µ.VERBOSE]:"log",[«µ.INFO]:"info",[«µ.WARN]:"warn",[«µ.ERROR]:"error"},…∏=(A,B)=>{if(!(B<A.logLevel||((new Date).toISOString(),…∑[B])))throw Error(`Attempted to log a message with an invalid logType (value: ${B})`)}
;class …π{constructor(A){this.name=A,this._logLevel=…∂,this._logHandler=…∏,this._userLogHandler=null,…¥.push(this)}get logLevel(){return this._logLevel}set logLevel(A){if(!(A in «µ))throw new TypeError(`Invalid value "${A}" assigned to \`logLevel\``);this._logLevel=A}setLogLevel(A){this._logLevel="string"==typeof A?…µ[A]:A}get logHandler(){return this._logHandler}set logHandler(A){if("function"!=typeof A)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=A}
get userLogHandler(){return this._userLogHandler}set userLogHandler(A){this._userLogHandler=A}debug(...A){this._userLogHandler&&this._userLogHandler(this,«µ.DEBUG,...A),this._logHandler(this,«µ.DEBUG,...A)}log(...A){this._userLogHandler&&this._userLogHandler(this,«µ.VERBOSE,...A),this._logHandler(this,«µ.VERBOSE,...A)}info(...A){this._userLogHandler&&this._userLogHandler(this,«µ.INFO,...A),this._logHandler(this,«µ.INFO,...A)}warn(...A){this._userLogHandler&&this._userLogHandler(this,«µ.WARN,...A),
this._logHandler(this,«µ.WARN,...A)}error(...A){this._userLogHandler&&this._userLogHandler(this,«µ.ERROR,...A),this._logHandler(this,«µ.ERROR,...A)}}let …∫,…ª;const …º=new WeakMap,…Ω=new WeakMap,…æ=new WeakMap,…ø=new WeakMap, Ä=new WeakMap;let  Å={get(A,B,C){if(A instanceof IDBTransaction){if("done"===B)return …Ω.get(A);if("objectStoreNames"===B)return A.objectStoreNames||…æ.get(A);if("store"===B)return C.objectStoreNames[1]?void 0:C.objectStore(C.objectStoreNames[0])}return I(A[B])},set:(A,B,C)=>(A[B]=C,
!0),has:(A,B)=>A instanceof IDBTransaction&&("done"===B||"store"===B)||B in A};const  Ç=A=> Ä.get(A), É=["get","getKey","getAll","getAllKeys","count"], Ñ=["put","add","delete","clear"], Ö=new Map;var  Ü; Ü= Å, Å={... Ü,get:(A,B,C)=>K(A,B)|| Ü.get(A,B,C),has:(A,B)=>!!K(A,B)|| Ü.has(A,B)};class  á{constructor(A){this.container=A}getPlatformInfoString(){return this.container.getProviders().map((A=>{if(function(A){const B=A.getComponent();return"VERSION"===(null==B?void 0:B.type)}(A)){const B=A.getImmediate()
;return`${B.library}/${B.version}`}return null})).filter((A=>A)).join(" ")}}
const  à="@firebase/app", â="0.13.0", ä=new …π("@firebase/app"), ã="@firebase/app-compat", å="@firebase/analytics-compat", ç="@firebase/analytics", é="@firebase/app-check-compat", è="@firebase/app-check", ê="@firebase/auth", ë="@firebase/auth-compat", í="@firebase/database", ì="@firebase/data-connect", î="@firebase/database-compat", ï="@firebase/functions", ñ="@firebase/functions-compat", ó="@firebase/installations", ò="@firebase/installations-compat", ô="@firebase/messaging", ö="@firebase/messaging-compat", õ="@firebase/performance", ú="@firebase/performance-compat", ù="@firebase/remote-config", û="@firebase/remote-config-compat", ü="@firebase/storage", †="@firebase/storage-compat", °="@firebase/firestore", ¢="@firebase/ai", £="@firebase/firestore-compat", §="firebase", •="[DEFAULT]", ¶={
[ à]:"fire-core",[ ã]:"fire-core-compat",[ ç]:"fire-analytics",[ å]:"fire-analytics-compat",[ è]:"fire-app-check",[ é]:"fire-app-check-compat",[ ê]:"fire-auth",[ ë]:"fire-auth-compat",[ í]:"fire-rtdb",[ ì]:"fire-data-connect",[ î]:"fire-rtdb-compat",[ ï]:"fire-fn",[ ñ]:"fire-fn-compat",[ ó]:"fire-iid",[ ò]:"fire-iid-compat",[ ô]:"fire-fcm",[ ö]:"fire-fcm-compat",[ õ]:"fire-perf",[ ú]:"fire-perf-compat",[ ù]:"fire-rc",[ û]:"fire-rc-compat",[ ü]:"fire-gcs",[ †]:"fire-gcs-compat",[ °]:"fire-fst",[ £]:"fire-fst-compat",
[ ¢]:"fire-vertex","fire-js":"fire-js",[ §]:"fire-js-all"}, ß=new Map, ®=new Map, ©=new Map, ™=new …Æ("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted",
"no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",
"idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class  ´{constructor(A,B,C){this._isDeleted=!1,
this._options=Object.assign({},A),this._config=Object.assign({},B),this._name=B.name,this._automaticDataCollectionEnabled=B.automaticDataCollectionEnabled,this._container=C,this.container.addComponent(new …∞("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(A){this.checkDestroyed(),this._automaticDataCollectionEnabled=A}get name(){return this.checkDestroyed(),this._name}
get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(A){this._isDeleted=A}checkDestroyed(){if(this.isDeleted)throw  ™.create("app-deleted",{appName:this._name})}}const  ¨="firebase-heartbeat-store";let  ≠=null;class  Æ{constructor(A){this.container=A,this._heartbeatsCache=null;const B=this.container.getProvider("app").getImmediate()
;this._storage=new  Ø(B),this._heartbeatsCachePromise=this._storage.read().then((A=>(this._heartbeatsCache=A,A)))}async triggerHeartbeat(){var A,B;try{const C=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),D=T();if(null==(null===(A=this._heartbeatsCache)||void 0===A?void 0:A.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(B=this._heartbeatsCache)||void 0===B?void 0:B.heartbeats)))return
;if(this._heartbeatsCache.lastSentHeartbeatDate===D||this._heartbeatsCache.heartbeats.some((A=>A.date===D)))return;if(this._heartbeatsCache.heartbeats.push({date:D,agent:C}),this._heartbeatsCache.heartbeats.length>30){const A=function(A){if(0===A.length)return-1;let B=0,C=A[0].date;for(let D=1;D<A.length;D++)A[D].date<C&&(C=A[D].date,B=D);return B}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(A,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(A){
 ä.warn(A)}}async getHeartbeatsHeader(){var A;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(A=this._heartbeatsCache)||void 0===A?void 0:A.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const B=T(),{heartbeatsToSend:C,unsentEntries:D}=function(A,B=1024){const C=[];let D=A.slice();for(const E of A){const A=C.find((A=>A.agent===E.agent));if(A){if(A.dates.push(E.date),U(C)>B){A.dates.pop();break}}else if(C.push({agent:E.agent,dates:[E.date]
}),U(C)>B){C.pop();break}D=D.slice(1)}return{heartbeatsToSend:C,unsentEntries:D}}(this._heartbeatsCache.heartbeats),E=…ß(JSON.stringify({version:2,heartbeats:C}));return this._heartbeatsCache.lastSentHeartbeatDate=B,D.length>0?(this._heartbeatsCache.heartbeats=D,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),E}catch(A){return  ä.warn(A),""}}}class  Ø{constructor(A){this.app=A,
this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!A()&&B().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const A=await async function(A){try{const B=(await Q()).transaction( ¨),C=await B.objectStore( ¨).get(S(A));return await B.done,C}catch(A){if(A instanceof …≠) ä.warn(A.message);else{const B= ™.create("idb-get",{originalErrorMessage:null==A?void 0:A.message}); ä.warn(B.message)}}}(this.app)
;return(null==A?void 0:A.heartbeats)?A:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(A){var B;if(await this._canUseIndexedDBPromise){const C=await this.read();return R(this.app,{lastSentHeartbeatDate:null!==(B=A.lastSentHeartbeatDate)&&void 0!==B?B:C.lastSentHeartbeatDate,heartbeats:A.heartbeats})}}async add(A){var B;if(await this._canUseIndexedDBPromise){const C=await this.read();return R(this.app,{
lastSentHeartbeatDate:null!==(B=A.lastSentHeartbeatDate)&&void 0!==B?B:C.lastSentHeartbeatDate,heartbeats:[...C.heartbeats,...A.heartbeats]})}}}…ú="",M(new …∞("platform-logger",(A=>new  á(A)),"PRIVATE")),M(new …∞("heartbeat",(A=>new  Æ(A)),"PRIVATE")),P( à, â,…ú),P( à, â,"esm2017"),P("fire-js","");const  ∞="@firebase/installations", ±="0.6.17", ≤=1e4, ≥="w:"+ ±, ¥="FIS_v2", µ=new …Æ("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',
"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."}), ∂=/^[cdef][\w-]{21}$/, ∑=new Map;let  ∏=null;const  π="firebase-installations-store";let  ∫=null
;const  ª="installations", º=A=>{const B=N(A.getProvider("app").getImmediate(), ª).getImmediate();return{getId:()=>async function(A){const B=A,{installationEntry:C,registrationPromise:D}=await n(B);return D?D.catch(console.error):s(B).catch(console.error),C.fid}(B),getToken:A=>v(B,A)}};M(new …∞( ª,(A=>{const B=A.getProvider("app").getImmediate(),C=function(A){if(!A||!A.options)throw w("App Configuration");if(!A.name)throw w("App Name");const B=["projectId","apiKey","appId"]
;for(const C of B)if(!A.options[C])throw w(C);return{appName:A.name,projectId:A.options.projectId,apiKey:A.options.apiKey,appId:A.options.appId}}(B);return{app:B,appConfig:C,heartbeatServiceProvider:N(B,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),M(new …∞("installations-internal", º,"PRIVATE")),P( ∞, ±),P( ∞, ±,"esm2017");const  Ω="analytics", æ="https://www.googletagmanager.com/gtag/js", ø=new …π("@firebase/analytics"),ÀÄ=new …Æ("analytics","Analytics",{
"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.",
"already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}",
"invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",
"fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',
"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."}),ÀÅ=new class{constructor(A={},B=1e3){this.throttleMetadata=A,this.intervalMillis=B}getThrottleMetadata(A){return this.throttleMetadata[A]}setThrottleMetadata(A,B){this.throttleMetadata[A]=B}deleteThrottleMetadata(A){
delete this.throttleMetadata[A]}};class ÀÜ{constructor(){this.listeners=[]}addEventListener(A){this.listeners.push(A)}abort(){this.listeners.forEach((A=>A()))}}let Àá,Àà;class Àâ{constructor(A){this.app=A}_delete(){return delete Àä[this.app.options.appId],Promise.resolve()}}let Àä={},Àã=[];const Àå={};let Àç,Àé,Àè="dataLayer",Àê="gtag",Àë=!1;const À†="@firebase/analytics",À°="0.10.16"
;M(new …∞( Ω,((A,{options:B})=>√Ö(A.getProvider("app").getImmediate(),A.getProvider("installations-internal").getImmediate(),B)),"PUBLIC")),M(new …∞("analytics-internal",(function(A){try{const B=A.getProvider( Ω).getImmediate();return{logEvent:(A,C,D)=>√â(B,A,C,D)}}catch(A){throw ÀÄ.create("interop-component-reg-failed",{reason:A})}}),"PRIVATE")),P(À†,À°),P(À†,À°,"esm2017"),P("firebase","11.8.1","app");const À¢=()=>{throw Error("Function not implemented!")
},À£=new Uint8Array(new ArrayBuffer(0),0,0),À§=Object.setPrototypeOf((function(){const A=new.target;return Reflect.construct(Uint8Array,arguments,null==A||A===À§?Uint8Array:A)}),null);Object.defineProperty(À§,"prototype",{value:Object.freeze(Object.create(null)),writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(À§,"emptyBuffer",{value:À£,writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(À§,"from",{value:function(A,B){
if(null==A||"object"!=typeof A)throw Error("INvalid buffer source");if(√å(A)){const C=new Uint8Array(A);if(null!=B)for(let A=0;A<C.byteLength;A++)C[A]=B(C[A],A);return C}if(ArrayBuffer.isView(A)){const C=new Uint8Array(A.buffer,A.byteOffset,A.byteLength);if(null!=B)for(let A=0;A<C.byteLength;A++)C[A]=B(C[A],A);return C}return Uint8Array.from(A,B||void 0)},writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(À§,"concat",{value:√ç,writable:!1,enumerable:!1,configurable:!1}),
Object.defineProperty(À§,"isBuffer",{value:A=>{if(ArrayBuffer.isView(A)){const B=A[Symbol.toStringTag];return"Uint8Array"===B||"Buffer"===B}return!1},writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(À§,"isArrayBuffer",{value:√å,writable:!1,enumerable:!1,configurable:!1});const À¨=Object.freeze(À§),ÀÆ=Object.setPrototypeOf((function(){if("function"!=typeof new.target)return Object.create(Õ∞);for(let A=Object.getPrototypeOf(this);null!=A;A=Object.getPrototypeOf(A))try{
delete A.constructor}catch(A){}}),null),Õ∞=Object.freeze(Object.create(null));Object.defineProperty(ÀÆ,"prototype",{value:Õ∞,writable:!1,enumerable:!1,configurable:!1});const Õ±=Object.freeze(ÀÆ),Õ≤={name:"ascii",encode:A=>Uint8Array.from(A,(A=>A.charCodeAt(0))),decode:A=>Array.from(A,(A=>String.fromCharCode(A))).join("")},Õ≥={name:"utf-8",encode:√ê,decode:√ë},Õ¥={name:"utf-16",encode:A=>{const B=A.length,C=new Uint8Array(2*B+2);C[0]=254,C[1]=255;for(let D=2,E=0;E<B;E++){const B=A.charCodeAt(E)
;C[D++]=B>>8&255,C[D++]=255&B}return C},decode:A=>{if(A.length>2)switch(255&A[0]|(255&A[1])<<8){case 65279:return √ì(A,2);case 65534:return √í(A,2)}return √í(A,0)}},Õ∂={name:"utf-16be",encode:A=>{const B=A.length,C=new Uint8Array(2*B);for(let D=0,E=0;E<B;E++){const B=A.charCodeAt(E);C[D++]=B>>8&255,C[D++]=255&B}return C},decode:A=>√í(A,0)},Õ∑={name:"utf-16le",encode:A=>{const B=A.length,C=new Uint8Array(2*B);for(let D=0,E=0;E<B;E++){const B=A.charCodeAt(E);C[D++]=255&B,C[D++]=B>>8&255}return C},
decode:A=>√ì(A,0)},Õ∫={name:"utf-32be",encode:A=>{const B=Array.from(A),C=B.length,D=new Uint8Array(4*C);for(let A=0,E=0;E<C;E++){const C=B[E].codePointAt(0)||0;D[A++]=C>>24&255,D[A++]=C>>16&255,D[A++]=C>>8&255,D[A++]=255&C}return D},decode:A=>{const B=Math.floor(A.length/4),C=Array(B);for(let D=0,E=0;E<B;E++){const B=((255&A[D++])<<24|(255&A[D++])<<16|(255&A[D++])<<8|255&A[D++])>>>0;C[E]=B>1114111?"ÔøΩ":String.fromCodePoint(B)}return C.join("")}},Õª={name:"utf32-le",encode:A=>{
const B=Array.from(A),C=B.length,D=new Uint8Array(4*C);for(let A=0,E=0;E<C;E++){const C=B[E].codePointAt(0)||0;D[A++]=255&C,D[A++]=C>>8&255,D[A++]=C>>16&255,D[A++]=C>>24&255}return D},decode:A=>{const B=Math.floor(A.length/4),C=Array(B);for(let D=0,E=0;E<B;E++){const B=(255&A[D++]|(255&A[D++])<<8|(255&A[D++])<<16|(255&A[D++])<<24)>>>0;C[E]=B>1114111?"ÔøΩ":String.fromCodePoint(B)}return C.join("")}};class Õº extends Õ±{#A;get name(){return this.#A}static#B=Object.setPrototypeOf({"":Õ≥,utf8:Õ≥,
"utf-8":Õ≥,utf16:Õ¥,"utf-16":Õ¥,unicode:Õ¥,utf16be:Õ∂,"utf16-be":Õ∂,utf16le:Õ∑,"utf16-le":Õ∑,utf32be:Õ∫,"utf-32be":Õ∫,utf32le:Õª,"utf-32le":Õª,ascii:Õ≤,latin1:Õ≤,"us-ascii":Õ≤,"iso-8859-1":Õ≤},null);static{const A=Object.freeze(Object.defineProperty(this.prototype,Symbol.toStringTag,{value:"Charset",writable:!1,enumerable:!1,configurable:!1}));Object.freeze(Object.setPrototypeOf(Õ≤,A)),Object.freeze(Object.setPrototypeOf(Õ≥,A)),Object.freeze(Object.setPrototypeOf(Õ¥,A)),Object.freeze(Object.setPrototypeOf(Õ∂,A)),
Object.freeze(Object.setPrototypeOf(Õ∑,A)),Object.freeze(Object.setPrototypeOf(Õ∫,A)),Object.freeze(Object.setPrototypeOf(Õª,A))}constructor(A){if(super(),new.target===Õº)throw Error("This abstract class cannot be constructed directly");{const B=Õº.#B;A in B||(B[A]=this)}this.#A=A}static forName(A){"string"!=typeof A&&(A=A.#A);const B=this.#B[A.toLowerCase()];if(null!=B)return B;throw Error("Unsupported charset: "+A)}static isSupported(A){return A.toLowerCase()in this.#B}static defaultCharset(){
return Õ≥}encode(){return À¢()}decode(){return À¢()}}class ÕΩ extends Õ±{#C;#D;#E;#F=!1;get sync(){return this.#C}get closed(){return this.#F}get canRead(){return this.#D}get canWrite(){return this.#E}constructor(A,B,C){super(),this.#C=A??!1,this.#D=B??!1,this.#E=C??!1}close(){this.#F=!0}}class Õø extends ÕΩ{constructor(A,B){super(!0,A,B)}close(){super.close()}}class ŒÜ extends Õø{constructor(){super(!0,!1)}read(){return-1}readBuf(A,B,C){B||=0,C||=A.byteLength;for(let D=0;D<C;D++){const C=this.read()
;if(!(C>=0))return D;A[B+D]=C}return C}readText(A,B){const C=this.readNBytes(A);return"utf-8"===(B||="utf-8")?√ë(C):Õº.forName(B).decode(C)}readNBytes(A){const B=new Uint8Array(new ArrayBuffer(A),0,A);let C=0;for(;A>0;){const D=this.readBuf(B,C,Math.min(8192,A));if(D<0)break;A-=D,C+=D}return B.subarray(0,C)}readAllBytes(){const A=new Uint8Array(new ArrayBuffer(8192),0,8192),B=[];let C=0,D=0;for(;(C=this.readBuf(A,0,8192))>=0;)D+=C,B.push(A.subarray(0,C));return √ç(B,D)}async pipe(A){
const B=new Uint8Array(new ArrayBuffer(8192),0,8192);let C=0,D=0;for(;(C=this.readBuf(B,0,8192))>=0;)await A.writeBuf(B,0,C),await A.flush(),D+=C;return D}pipeSync(A){const B=new Uint8Array(new ArrayBuffer(8192),0,8192);let C=0,D=0;for(;(C=this.readBuf(B,0,8192))>=0;)A.writeBuf(B,0,C),A.flush(),D+=C;return D}}class Œà extends Õø{constructor(){super(!1,!0)}flush(){}write(A){}writeBuf(A,B,C){for(B||=0,C||=A.byteLength;B<C;)this.write(A[B])}writeText(A,B){
const C=("utf-8"===(B||="utf-8")?Õ≥:Õº.forName(B)).encode(A);this.writeBuf(C,0,C.byteLength)}}const Œâ="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",Œä={encode:A=>{const B=A.length;let C="",D=0,E=0;for(let F=0;F<B;F++)for(D=D<<8|A[F],E+=8;E>=5;)C+=Œâ[D>>E-5&31],E-=5;for(E>0&&(C+=Œâ[D<<5-E&31]);C.length%8!=0;)C+="=";return C},decode:A=>{A=A.replace(/=+$/,"");const B=[];let C=0,D=0;for(let E=0;E<A.length;E++){const F=Œâ.indexOf(A[E].toUpperCase());if(F<0)throw Error("Invalid character found in Base32 string.")
;C=C<<5|F,D+=5,D>=8&&(B.push(C>>D-8&255),D-=8)}return Uint8Array.from(B)}},Œå=Object.freeze(Object.setPrototypeOf(Œä,null)),Œé="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Œè=new Uint8Array(new ArrayBuffer(256),0,256);for(let A=0;A<64;A++)Œè[Œé.charCodeAt(A)]=A;const Œê={encode:A=>{const B=A.length;let C="";for(let D=0;D<B;D+=3){const B=A[D]<<16|A[D+1]<<8|A[D+2];C+=Œé[B>>18&63]+Œé[B>>12&63]+Œé[B>>6&63]+Œé[63&B]}switch(B%3){case 1:return C.slice(0,-2)+"==";case 2:
return C.slice(0,-1)+"=";default:return C}},decode:A=>{const B=A.length,C=new Uint8Array(.75*B-("=="===A.slice(B-2)?2:"="===A[B-1]?1:0));for(let D=0,E=0;D<B;D+=4){const B=Œè[A.charCodeAt(D)]<<18|Œè[A.charCodeAt(D+1)]<<12|Œè[A.charCodeAt(D+2)]<<6|Œè[A.charCodeAt(D+3)];C[E++]=B>>16&255,C[E++]=B>>8&255,C[E++]=255&B}return C}},Œë=Object.freeze(Object.setPrototypeOf(Œê,null)),Œí="0123456789abcdef",Œì=A=>{let B="";for(let C=0;C<=3;C++)B+=Œí.charAt(A>>8*C+4&15)+Œí.charAt(A>>8*C&15);return B},Œî=(A,B)=>{
let C=(65535&A)+(65535&B);return(A>>16)+(B>>16)+(C>>16)<<16|65535&C},Œï=(A,B,C,D,E,F)=>Œî(((A,B)=>A<<B|A>>>32-B)(Œî(Œî(B,A),Œî(D,F)),E),C),Œñ=(A,B,C,D,E,F,G)=>Œï(B&C|~B&D,A,B,E,F,G),Œó=(A,B,C,D,E,F,G)=>Œï(B&D|C&~D,A,B,E,F,G),Œò=(A,B,C,D,E,F,G)=>Œï(B^C^D,A,B,E,F,G),Œô=(A,B,C,D,E,F,G)=>Œï(C^(B|~D),A,B,E,F,G),Œö={encode:A=>{const B=A.length,C=Array(B);for(let D=0;D<B;D++)C[D]=A[D].toString(16).padStart(2,"0");return C.join("")},decode:A=>{const B=Math.floor(A.length/2),C=new Uint8Array(B)
;for(let D=0,E=0;D<B;D++)C[D]=parseInt(A.slice(E,E+=2),16);return C}
},Œõ=Object.freeze(Object.setPrototypeOf(Œö,null)),Œú=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145],Œù=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],Œû=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],Œü=[3328402341,4168907908,4000806809,4135287693,4294111757,3597364157,3731845041,2445657428,1613770832,33620227,3462883241,1445669757,3892248089,3050821474,1303096294,3967186586,2412431941,528646813,2311702848,4202528135,4026202645,2992200171,2387036105,4226871307,1101901292,3017069671,1604494077,1169141738,597466303,1403299063,3832705686,2613100635,1974974402,3791519004,1033081774,1277568618,1815492186,2118074177,4126668546,2211236943,1748251740,1369810420,3521504564,4193382664,3799085459,2883115123,1647391059,706024767,134480908,2512897874,1176707941,2646852446,806885416,932615841,168101135,798661301,235341577,605164086,461406363,3756188221,3454790438,1311188841,2142417613,3933566367,302582043,495158174,1479289972,874125870,907746093,3698224818,3025820398,1537253627,2756858614,1983593293,3084310113,2108928974,1378429307,3722699582,1580150641,327451799,2790478837,3117535592,0,3253595436,1075847264,3825007647,2041688520,3059440621,3563743934,2378943302,1740553945,1916352843,2487896798,2555137236,2958579944,2244988746,3151024235,3320835882,1336584933,3992714006,2252555205,2588757463,1714631509,293963156,2319795663,3925473552,67240454,4269768577,2689618160,2017213508,631218106,1269344483,2723238387,1571005438,2151694528,93294474,1066570413,563977660,1882732616,4059428100,1673313503,2008463041,2950355573,1109467491,537923632,3858759450,4260623118,3218264685,2177748300,403442708,638784309,3287084079,3193921505,899127202,2286175436,773265209,2479146071,1437050866,4236148354,2050833735,3362022572,3126681063,840505643,3866325909,3227541664,427917720,2655997905,2749160575,1143087718,1412049534,999329963,193497219,2353415882,3354324521,1807268051,672404540,2816401017,3160301282,369822493,2916866934,3688947771,1681011286,1949973070,336202270,2454276571,201721354,1210328172,3093060836,2680341085,3184776046,1135389935,3294782118,965841320,831886756,3554993207,4068047243,3588745010,2345191491,1849112409,3664604599,26054028,2983581028,2622377682,1235855840,3630984372,2891339514,4092916743,3488279077,3395642799,4101667470,1202630377,268961816,1874508501,4034427016,1243948399,1546530418,941366308,1470539505,1941222599,2546386513,3421038627,2715671932,3899946140,1042226977,2521517021,1639824860,227249030,260737669,3765465232,2084453954,1907733956,3429263018,2420656344,100860677,4160157185,470683154,3261161891,1781871967,2924959737,1773779408,394692241,2579611992,974986535,664706745,3655459128,3958962195,731420851,571543859,3530123707,2849626480,126783113,865375399,765172662,1008606754,361203602,3387549984,2278477385,2857719295,1344809080,2782912378,59542671,1503764984,160008576,437062935,1707065306,3622233649,2218934982,3496503480,2185314755,697932208,1512910199,504303377,2075177163,2824099068,1841019862,739644986],Œ†=[2781242211,2230877308,2582542199,2381740923,234877682,3184946027,2984144751,1418839493,1348481072,50462977,2848876391,2102799147,434634494,1656084439,3863849899,2599188086,1167051466,2636087938,1082771913,2281340285,368048890,3954334041,3381544775,201060592,3963727277,1739838676,4250903202,3930435503,3206782108,4149453988,2531553906,1536934080,3262494647,484572669,2923271059,1783375398,1517041206,1098792767,49674231,1334037708,1550332980,4098991525,886171109,150598129,2481090929,1940642008,1398944049,1059722517,201851908,1385547719,1699095331,1587397571,674240536,2704774806,252314885,3039795866,151914247,908333586,2602270848,1038082786,651029483,1766729511,3447698098,2682942837,454166793,2652734339,1951935532,775166490,758520603,3000790638,4004797018,4217086112,4137964114,1299594043,1639438038,3464344499,2068982057,1054729187,1901997871,2534638724,4121318227,1757008337,0,750906861,1614815264,535035132,3363418545,3988151131,3201591914,1183697867,3647454910,1265776953,3734260298,3566750796,3903871064,1250283471,1807470800,717615087,3847203498,384695291,3313910595,3617213773,1432761139,2484176261,3481945413,283769337,100925954,2180939647,4037038160,1148730428,3123027871,3813386408,4087501137,4267549603,3229630528,2315620239,2906624658,3156319645,1215313976,82966005,3747855548,3245848246,1974459098,1665278241,807407632,451280895,251524083,1841287890,1283575245,337120268,891687699,801369324,3787349855,2721421207,3431482436,959321879,1469301956,4065699751,2197585534,1199193405,2898814052,3887750493,724703513,2514908019,2696962144,2551808385,3516813135,2141445340,1715741218,2119445034,2872807568,2198571144,3398190662,700968686,3547052216,1009259540,2041044702,3803995742,487983883,1991105499,1004265696,1449407026,1316239930,504629770,3683797321,168560134,1816667172,3837287516,1570751170,1857934291,4014189740,2797888098,2822345105,2754712981,936633572,2347923833,852879335,1133234376,1500395319,3084545389,2348912013,1689376213,3533459022,3762923945,3034082412,4205598294,133428468,634383082,2949277029,2398386810,3913789102,403703816,3580869306,2297460856,1867130149,1918643758,607656988,4049053350,3346248884,1368901318,600565992,2090982877,2632479860,557719327,3717614411,3697393085,2249034635,2232388234,2430627952,1115438654,3295786421,2865522278,3633334344,84280067,33027830,303828494,2747425121,1600795957,4188952407,3496589753,2434238086,1486471617,658119965,3106381470,953803233,334231800,3005978776,857870609,3151128937,1890179545,2298973838,2805175444,3056442267,574365214,2450884487,550103529,1233637070,4289353045,2018519080,2057691103,2399374476,4166623649,2148108681,387583245,3664101311,836232934,3330556482,3100665960,3280093505,2955516313,2002398509,287182607,3413881008,4238890068,3597515707,975967766],Œ°=[1671808611,2089089148,2006576759,2072901243,4061003762,1807603307,1873927791,3310653893,810573872,16974337,1739181671,729634347,4263110654,3613570519,2883997099,1989864566,3393556426,2191335298,3376449993,2106063485,4195741690,1508618841,1204391495,4027317232,2917941677,3563566036,2734514082,2951366063,2629772188,2767672228,1922491506,3227229120,3082974647,4246528509,2477669779,644500518,911895606,1061256767,4144166391,3427763148,878471220,2784252325,3845444069,4043897329,1905517169,3631459288,827548209,356461077,67897348,3344078279,593839651,3277757891,405286936,2527147926,84871685,2595565466,118033927,305538066,2157648768,3795705826,3945188843,661212711,2999812018,1973414517,152769033,2208177539,745822252,439235610,455947803,1857215598,1525593178,2700827552,1391895634,994932283,3596728278,3016654259,695947817,3812548067,795958831,2224493444,1408607827,3513301457,0,3979133421,543178784,4229948412,2982705585,1542305371,1790891114,3410398667,3201918910,961245753,1256100938,1289001036,1491644504,3477767631,3496721360,4012557807,2867154858,4212583931,1137018435,1305975373,861234739,2241073541,1171229253,4178635257,33948674,2139225727,1357946960,1011120188,2679776671,2833468328,1374921297,2751356323,1086357568,2408187279,2460827538,2646352285,944271416,4110742005,3168756668,3066132406,3665145818,560153121,271589392,4279952895,4077846003,3530407890,3444343245,202643468,322250259,3962553324,1608629855,2543990167,1154254916,389623319,3294073796,2817676711,2122513534,1028094525,1689045092,1575467613,422261273,1939203699,1621147744,2174228865,1339137615,3699352540,577127458,712922154,2427141008,2290289544,1187679302,3995715566,3100863416,339486740,3732514782,1591917662,186455563,3681988059,3762019296,844522546,978220090,169743370,1239126601,101321734,611076132,1558493276,3260915650,3547250131,2901361580,1655096418,2443721105,2510565781,3828863972,2039214713,3878868455,3359869896,928607799,1840765549,2374762893,3580146133,1322425422,2850048425,1823791212,1459268694,4094161908,3928346602,1706019429,2056189050,2934523822,135794696,3134549946,2022240376,628050469,779246638,472135708,2800834470,3032970164,3327236038,3894660072,3715932637,1956440180,522272287,1272813131,3185336765,2340818315,2323976074,1888542832,1044544574,3049550261,1722469478,1222152264,50660867,4127324150,236067854,1638122081,895445557,1475980887,3117443513,2257655686,3243809217,489110045,2662934430,3778599393,4162055160,2561878936,288563729,1773916777,3648039385,2391345038,2493985684,2612407707,505560094,2274497927,3911240169,3460925390,1442818645,678973480,3749357023,2358182796,2717407649,2306869641,219617805,3218761151,3862026214,1120306242,1756942440,1103331905,2578459033,762796589,252780047,2966125488,1425844308,3151392187,372911126],Œ£=[1667474886,2088535288,2004326894,2071694838,4075949567,1802223062,1869591006,3318043793,808472672,16843522,1734846926,724270422,4278065639,3621216949,2880169549,1987484396,3402253711,2189597983,3385409673,2105378810,4210693615,1499065266,1195886990,4042263547,2913856577,3570689971,2728590687,2947541573,2627518243,2762274643,1920112356,3233831835,3082273397,4261223649,2475929149,640051788,909531756,1061110142,4160160501,3435941763,875846760,2779116625,3857003729,4059105529,1903268834,3638064043,825316194,353713962,67374088,3351728789,589522246,3284360861,404236336,2526454071,84217610,2593830191,117901582,303183396,2155911963,3806477791,3958056653,656894286,2998062463,1970642922,151591698,2206440989,741110872,437923380,454765878,1852748508,1515908788,2694904667,1381168804,993742198,3604373943,3014905469,690584402,3823320797,791638366,2223281939,1398011302,3520161977,0,3991743681,538992704,4244381667,2981218425,1532751286,1785380564,3419096717,3200178535,960056178,1246420628,1280103576,1482221744,3486468741,3503319995,4025428677,2863326543,4227536621,1128514950,1296947098,859002214,2240123921,1162203018,4193849577,33687044,2139062782,1347481760,1010582648,2678045221,2829640523,1364325282,2745433693,1077985408,2408548869,2459086143,2644360225,943212656,4126475505,3166494563,3065430391,3671750063,555836226,269496352,4294908645,4092792573,3537006015,3452783745,202118168,320025894,3974901699,1600119230,2543297077,1145359496,387397934,3301201811,2812801621,2122220284,1027426170,1684319432,1566435258,421079858,1936954854,1616945344,2172753945,1330631070,3705438115,572679748,707427924,2425400123,2290647819,1179044492,4008585671,3099120491,336870440,3739122087,1583276732,185277718,3688593069,3772791771,842159716,976899700,168435220,1229577106,101059084,606366792,1549591736,3267517855,3553849021,2897014595,1650632388,2442242105,2509612081,3840161747,2038008818,3890688725,3368567691,926374254,1835907034,2374863873,3587531953,1313788572,2846482505,1819063512,1448540844,4109633523,3941213647,1701162954,2054852340,2930698567,134748176,3132806511,2021165296,623210314,774795868,471606328,2795958615,3031746419,3334885783,3907527627,3722280097,1953799400,522133822,1263263126,3183336545,2341176845,2324333839,1886425312,1044267644,3048588401,1718004428,1212733584,50529542,4143317495,235803164,1633788866,892690282,1465383342,3115962473,2256965911,3250673817,488449850,2661202215,3789633753,4177007595,2560144171,286339874,1768537042,3654906025,2391705863,2492770099,2610673197,505291324,2273808917,3924369609,3469625735,1431699370,673740880,3755965093,2358021891,2711746649,2307489801,218961690,3217021541,3873845719,1111672452,1751693520,1094828930,2576986153,757954394,252645662,2964376443,1414855848,3149649517,370555436],Œ§=[1374988112,2118214995,437757123,975658646,1001089995,530400753,2902087851,1273168787,540080725,2910219766,2295101073,4110568485,1340463100,3307916247,641025152,3043140495,3736164937,632953703,1172967064,1576976609,3274667266,2169303058,2370213795,1809054150,59727847,361929877,3211623147,2505202138,3569255213,1484005843,1239443753,2395588676,1975683434,4102977912,2572697195,666464733,3202437046,4035489047,3374361702,2110667444,1675577880,3843699074,2538681184,1649639237,2976151520,3144396420,4269907996,4178062228,1883793496,2403728665,2497604743,1383856311,2876494627,1917518562,3810496343,1716890410,3001755655,800440835,2261089178,3543599269,807962610,599762354,33778362,3977675356,2328828971,2809771154,4077384432,1315562145,1708848333,101039829,3509871135,3299278474,875451293,2733856160,92987698,2767645557,193195065,1080094634,1584504582,3178106961,1042385657,2531067453,3711829422,1306967366,2438237621,1908694277,67556463,1615861247,429456164,3602770327,2302690252,1742315127,2968011453,126454664,3877198648,2043211483,2709260871,2084704233,4169408201,0,159417987,841739592,504459436,1817866830,4245618683,260388950,1034867998,908933415,168810852,1750902305,2606453969,607530554,202008497,2472011535,3035535058,463180190,2160117071,1641816226,1517767529,470948374,3801332234,3231722213,1008918595,303765277,235474187,4069246893,766945465,337553864,1475418501,2943682380,4003061179,2743034109,4144047775,1551037884,1147550661,1543208500,2336434550,3408119516,3069049960,3102011747,3610369226,1113818384,328671808,2227573024,2236228733,3535486456,2935566865,3341394285,496906059,3702665459,226906860,2009195472,733156972,2842737049,294930682,1206477858,2835123396,2700099354,1451044056,573804783,2269728455,3644379585,2362090238,2564033334,2801107407,2776292904,3669462566,1068351396,742039012,1350078989,1784663195,1417561698,4136440770,2430122216,775550814,2193862645,2673705150,1775276924,1876241833,3475313331,3366754619,270040487,3902563182,3678124923,3441850377,1851332852,3969562369,2203032232,3868552805,2868897406,566021896,4011190502,3135740889,1248802510,3936291284,699432150,832877231,708780849,3332740144,899835584,1951317047,4236429990,3767586992,866637845,4043610186,1106041591,2144161806,395441711,1984812685,1139781709,3433712980,3835036895,2664543715,1282050075,3240894392,1181045119,2640243204,25965917,4203181171,4211818798,3009879386,2463879762,3910161971,1842759443,2597806476,933301370,1509430414,3943906441,3467192302,3076639029,3776767469,2051518780,2631065433,1441952575,404016761,1942435775,1408749034,1610459739,3745345300,2017778566,3400528769,3110650942,941896748,3265478751,371049330,3168937228,675039627,4279080257,967311729,135050206,3635733660,1683407248,2076935265,3576870512,1215061108,3501741890],Œ•=[1347548327,1400783205,3273267108,2520393566,3409685355,4045380933,2880240216,2471224067,1428173050,4138563181,2441661558,636813900,4233094615,3620022987,2149987652,2411029155,1239331162,1730525723,2554718734,3781033664,46346101,310463728,2743944855,3328955385,3875770207,2501218972,3955191162,3667219033,768917123,3545789473,692707433,1150208456,1786102409,2029293177,1805211710,3710368113,3065962831,401639597,1724457132,3028143674,409198410,2196052529,1620529459,1164071807,3769721975,2226875310,486441376,2499348523,1483753576,428819965,2274680428,3075636216,598438867,3799141122,1474502543,711349675,129166120,53458370,2592523643,2782082824,4063242375,2988687269,3120694122,1559041666,730517276,2460449204,4042459122,2706270690,3446004468,3573941694,533804130,2328143614,2637442643,2695033685,839224033,1973745387,957055980,2856345839,106852767,1371368976,4181598602,1033297158,2933734917,1179510461,3046200461,91341917,1862534868,4284502037,605657339,2547432937,3431546947,2003294622,3182487618,2282195339,954669403,3682191598,1201765386,3917234703,3388507166,0,2198438022,1211247597,2887651696,1315723890,4227665663,1443857720,507358933,657861945,1678381017,560487590,3516619604,975451694,2970356327,261314535,3535072918,2652609425,1333838021,2724322336,1767536459,370938394,182621114,3854606378,1128014560,487725847,185469197,2918353863,3106780840,3356761769,2237133081,1286567175,3152976349,4255350624,2683765030,3160175349,3309594171,878443390,1988838185,3704300486,1756818940,1673061617,3403100636,272786309,1075025698,545572369,2105887268,4174560061,296679730,1841768865,1260232239,4091327024,3960309330,3497509347,1814803222,2578018489,4195456072,575138148,3299409036,446754879,3629546796,4011996048,3347532110,3252238545,4270639778,915985419,3483825537,681933534,651868046,2755636671,3828103837,223377554,2607439820,1649704518,3270937875,3901806776,1580087799,4118987695,3198115200,2087309459,2842678573,3016697106,1003007129,2802849917,1860738147,2077965243,164439672,4100872472,32283319,2827177882,1709610350,2125135846,136428751,3874428392,3652904859,3460984630,3572145929,3593056380,2939266226,824852259,818324884,3224740454,930369212,2801566410,2967507152,355706840,1257309336,4148292826,243256656,790073846,2373340630,1296297904,1422699085,3756299780,3818836405,457992840,3099667487,2135319889,77422314,1560382517,1945798516,788204353,1521706781,1385356242,870912086,325965383,2358957921,2050466060,2388260884,2313884476,4006521127,901210569,3990953189,1014646705,1503449823,1062597235,2031621326,3212035895,3931371469,1533017514,350174575,2256028891,2177544179,1052338372,741876788,1606591296,1914052035,213705253,2334669897,1107234197,1899603969,3725069491,2631447780,2422494913,1635502980,1893020342,1950903388,1120974935],Œ¶=[2807058932,1699970625,2764249623,1586903591,1808481195,1173430173,1487645946,59984867,4199882800,1844882806,1989249228,1277555970,3623636965,3419915562,1149249077,2744104290,1514790577,459744698,244860394,3235995134,1963115311,4027744588,2544078150,4190530515,1608975247,2627016082,2062270317,1507497298,2200818878,567498868,1764313568,3359936201,2305455554,2037970062,1047239e3,1910319033,1337376481,2904027272,2892417312,984907214,1243112415,830661914,861968209,2135253587,2011214180,2927934315,2686254721,731183368,1750626376,4246310725,1820824798,4172763771,3542330227,48394827,2404901663,2871682645,671593195,3254988725,2073724613,145085239,2280796200,2779915199,1790575107,2187128086,472615631,3029510009,4075877127,3802222185,4107101658,3201631749,1646252340,4270507174,1402811438,1436590835,3778151818,3950355702,3963161475,4020912224,2667994737,273792366,2331590177,104699613,95345982,3175501286,2377486676,1560637892,3564045318,369057872,4213447064,3919042237,1137477952,2658625497,1119727848,2340947849,1530455833,4007360968,172466556,266959938,516552836,0,2256734592,3980931627,1890328081,1917742170,4294704398,945164165,3575528878,958871085,3647212047,2787207260,1423022939,775562294,1739656202,3876557655,2530391278,2443058075,3310321856,547512796,1265195639,437656594,3121275539,719700128,3762502690,387781147,218828297,3350065803,2830708150,2848461854,428169201,122466165,3720081049,1627235199,648017665,4122762354,1002783846,2117360635,695634755,3336358691,4234721005,4049844452,3704280881,2232435299,574624663,287343814,612205898,1039717051,840019705,2708326185,793451934,821288114,1391201670,3822090177,376187827,3113855344,1224348052,1679968233,2361698556,1058709744,752375421,2431590963,1321699145,3519142200,2734591178,188127444,2177869557,3727205754,2384911031,3215212461,2648976442,2450346104,3432737375,1180849278,331544205,3102249176,4150144569,2952102595,2159976285,2474404304,766078933,313773861,2570832044,2108100632,1668212892,3145456443,2013908262,418672217,3070356634,2594734927,1852171925,3867060991,3473416636,3907448597,2614737639,919489135,164948639,2094410160,2997825956,590424639,2486224549,1723872674,3157750862,3399941250,3501252752,3625268135,2555048196,3673637356,1343127501,4130281361,3599595085,2957853679,1297403050,81781910,3051593425,2283490410,532201772,1367295589,3926170974,895287692,1953757831,1093597963,492483431,3528626907,1446242576,1192455638,1636604631,209336225,344873464,1015671571,669961897,3375740769,3857572124,2973530695,3747192018,1933530610,3464042516,935293895,3454686199,2858115069,1863638845,3683022916,4085369519,3292445032,875313188,1080017571,3279033885,621591778,1233856572,2504130317,24197544,3017672716,3835484340,3247465558,2220981195,3060847922,1551124588,1463996600],Œß=[4104605777,1097159550,396673818,660510266,2875968315,2638606623,4200115116,3808662347,821712160,1986918061,3430322568,38544885,3856137295,718002117,893681702,1654886325,2975484382,3122358053,3926825029,4274053469,796197571,1290801793,1184342925,3556361835,2405426947,2459735317,1836772287,1381620373,3196267988,1948373848,3764988233,3385345166,3263785589,2390325492,1480485785,3111247143,3780097726,2293045232,548169417,3459953789,3746175075,439452389,1362321559,1400849762,1685577905,1806599355,2174754046,137073913,1214797936,1174215055,3731654548,2079897426,1943217067,1258480242,529487843,1437280870,3945269170,3049390895,3313212038,923313619,679998e3,3215307299,57326082,377642221,3474729866,2041877159,133361907,1776460110,3673476453,96392454,878845905,2801699524,777231668,4082475170,2330014213,4142626212,2213296395,1626319424,1906247262,1846563261,562755902,3708173718,1040559837,3871163981,1418573201,3294430577,114585348,1343618912,2566595609,3186202582,1078185097,3651041127,3896688048,2307622919,425408743,3371096953,2081048481,1108339068,2216610296,0,2156299017,736970802,292596766,1517440620,251657213,2235061775,2933202493,758720310,265905162,1554391400,1532285339,908999204,174567692,1474760595,4002861748,2610011675,3234156416,3693126241,2001430874,303699484,2478443234,2687165888,585122620,454499602,151849742,2345119218,3064510765,514443284,4044981591,1963412655,2581445614,2137062819,19308535,1928707164,1715193156,4219352155,1126790795,600235211,3992742070,3841024952,836553431,1669664834,2535604243,3323011204,1243905413,3141400786,4180808110,698445255,2653899549,2989552604,2253581325,3252932727,3004591147,1891211689,2487810577,3915653703,4237083816,4030667424,2100090966,865136418,1229899655,953270745,3399679628,3557504664,4118925222,2061379749,3079546586,2915017791,983426092,2022837584,1607244650,2118541908,2366882550,3635996816,972512814,3283088770,1568718495,3499326569,3576539503,621982671,2895723464,410887952,2623762152,1002142683,645401037,1494807662,2595684844,1335535747,2507040230,4293295786,3167684641,367585007,3885750714,1865862730,2668221674,2960971305,2763173681,1059270954,2777952454,2724642869,1320957812,2194319100,2429595872,2815956275,77089521,3973773121,3444575871,2448830231,1305906550,4021308739,2857194700,2516901860,3518358430,1787304780,740276417,1699839814,1592394909,2352307457,2272556026,188821243,1729977011,3687994002,274084841,3594982253,3613494426,2701949495,4162096729,322734571,2837966542,1640576439,484830689,1202797690,3537852828,4067639125,349075736,3342319475,4157467219,4255800159,1030690015,1155237496,2951971274,1757691577,607398968,2738905026,499347990,3794078908,1011452712,227885567,2818666809,213114376,3034881240,1455525988,3414450555,850817237,1817998408,3092726480],Œ®=[0,235474187,470948374,303765277,941896748,908933415,607530554,708780849,1883793496,2118214995,1817866830,1649639237,1215061108,1181045119,1417561698,1517767529,3767586992,4003061179,4236429990,4069246893,3635733660,3602770327,3299278474,3400528769,2430122216,2664543715,2362090238,2193862645,2835123396,2801107407,3035535058,3135740889,3678124923,3576870512,3341394285,3374361702,3810496343,3977675356,4279080257,4043610186,2876494627,2776292904,3076639029,3110650942,2472011535,2640243204,2403728665,2169303058,1001089995,899835584,666464733,699432150,59727847,226906860,530400753,294930682,1273168787,1172967064,1475418501,1509430414,1942435775,2110667444,1876241833,1641816226,2910219766,2743034109,2976151520,3211623147,2505202138,2606453969,2302690252,2269728455,3711829422,3543599269,3240894392,3475313331,3843699074,3943906441,4178062228,4144047775,1306967366,1139781709,1374988112,1610459739,1975683434,2076935265,1775276924,1742315127,1034867998,866637845,566021896,800440835,92987698,193195065,429456164,395441711,1984812685,2017778566,1784663195,1683407248,1315562145,1080094634,1383856311,1551037884,101039829,135050206,437757123,337553864,1042385657,807962610,573804783,742039012,2531067453,2564033334,2328828971,2227573024,2935566865,2700099354,3001755655,3168937228,3868552805,3902563182,4203181171,4102977912,3736164937,3501741890,3265478751,3433712980,1106041591,1340463100,1576976609,1408749034,2043211483,2009195472,1708848333,1809054150,832877231,1068351396,766945465,599762354,159417987,126454664,361929877,463180190,2709260871,2943682380,3178106961,3009879386,2572697195,2538681184,2236228733,2336434550,3509871135,3745345300,3441850377,3274667266,3910161971,3877198648,4110568485,4211818798,2597806476,2497604743,2261089178,2295101073,2733856160,2902087851,3202437046,2968011453,3936291284,3835036895,4136440770,4169408201,3535486456,3702665459,3467192302,3231722213,2051518780,1951317047,1716890410,1750902305,1113818384,1282050075,1584504582,1350078989,168810852,67556463,371049330,404016761,841739592,1008918595,775550814,540080725,3969562369,3801332234,4035489047,4269907996,3569255213,3669462566,3366754619,3332740144,2631065433,2463879762,2160117071,2395588676,2767645557,2868897406,3102011747,3069049960,202008497,33778362,270040487,504459436,875451293,975658646,675039627,641025152,2084704233,1917518562,1615861247,1851332852,1147550661,1248802510,1484005843,1451044056,933301370,967311729,733156972,632953703,260388950,25965917,328671808,496906059,1206477858,1239443753,1543208500,1441952575,2144161806,1908694277,1675577880,1842759443,3610369226,3644379585,3408119516,3307916247,4011190502,3776767469,4077384432,4245618683,2809771154,2842737049,3144396420,3043140495,2673705150,2438237621,2203032232,2370213795],Œ©=[0,185469197,370938394,487725847,741876788,657861945,975451694,824852259,1483753576,1400783205,1315723890,1164071807,1950903388,2135319889,1649704518,1767536459,2967507152,3152976349,2801566410,2918353863,2631447780,2547432937,2328143614,2177544179,3901806776,3818836405,4270639778,4118987695,3299409036,3483825537,3535072918,3652904859,2077965243,1893020342,1841768865,1724457132,1474502543,1559041666,1107234197,1257309336,598438867,681933534,901210569,1052338372,261314535,77422314,428819965,310463728,3409685355,3224740454,3710368113,3593056380,3875770207,3960309330,4045380933,4195456072,2471224067,2554718734,2237133081,2388260884,3212035895,3028143674,2842678573,2724322336,4138563181,4255350624,3769721975,3955191162,3667219033,3516619604,3431546947,3347532110,2933734917,2782082824,3099667487,3016697106,2196052529,2313884476,2499348523,2683765030,1179510461,1296297904,1347548327,1533017514,1786102409,1635502980,2087309459,2003294622,507358933,355706840,136428751,53458370,839224033,957055980,605657339,790073846,2373340630,2256028891,2607439820,2422494913,2706270690,2856345839,3075636216,3160175349,3573941694,3725069491,3273267108,3356761769,4181598602,4063242375,4011996048,3828103837,1033297158,915985419,730517276,545572369,296679730,446754879,129166120,213705253,1709610350,1860738147,1945798516,2029293177,1239331162,1120974935,1606591296,1422699085,4148292826,4233094615,3781033664,3931371469,3682191598,3497509347,3446004468,3328955385,2939266226,2755636671,3106780840,2988687269,2198438022,2282195339,2501218972,2652609425,1201765386,1286567175,1371368976,1521706781,1805211710,1620529459,2105887268,1988838185,533804130,350174575,164439672,46346101,870912086,954669403,636813900,788204353,2358957921,2274680428,2592523643,2441661558,2695033685,2880240216,3065962831,3182487618,3572145929,3756299780,3270937875,3388507166,4174560061,4091327024,4006521127,3854606378,1014646705,930369212,711349675,560487590,272786309,457992840,106852767,223377554,1678381017,1862534868,1914052035,2031621326,1211247597,1128014560,1580087799,1428173050,32283319,182621114,401639597,486441376,768917123,651868046,1003007129,818324884,1503449823,1385356242,1333838021,1150208456,1973745387,2125135846,1673061617,1756818940,2970356327,3120694122,2802849917,2887651696,2637442643,2520393566,2334669897,2149987652,3917234703,3799141122,4284502037,4100872472,3309594171,3460984630,3545789473,3629546796,2050466060,1899603969,1814803222,1730525723,1443857720,1560382517,1075025698,1260232239,575138148,692707433,878443390,1062597235,243256656,91341917,409198410,325965383,3403100636,3252238545,3704300486,3620022987,3874428392,3990953189,4042459122,4227665663,2460449204,2578018489,2226875310,2411029155,3198115200,3046200461,2827177882,2743944855],Œ™=[0,218828297,437656594,387781147,875313188,958871085,775562294,590424639,1750626376,1699970625,1917742170,2135253587,1551124588,1367295589,1180849278,1265195639,3501252752,3720081049,3399941250,3350065803,3835484340,3919042237,4270507174,4085369519,3102249176,3051593425,2734591178,2952102595,2361698556,2177869557,2530391278,2614737639,3145456443,3060847922,2708326185,2892417312,2404901663,2187128086,2504130317,2555048196,3542330227,3727205754,3375740769,3292445032,3876557655,3926170974,4246310725,4027744588,1808481195,1723872674,1910319033,2094410160,1608975247,1391201670,1173430173,1224348052,59984867,244860394,428169201,344873464,935293895,984907214,766078933,547512796,1844882806,1627235199,2011214180,2062270317,1507497298,1423022939,1137477952,1321699145,95345982,145085239,532201772,313773861,830661914,1015671571,731183368,648017665,3175501286,2957853679,2807058932,2858115069,2305455554,2220981195,2474404304,2658625497,3575528878,3625268135,3473416636,3254988725,3778151818,3963161475,4213447064,4130281361,3599595085,3683022916,3432737375,3247465558,3802222185,4020912224,4172763771,4122762354,3201631749,3017672716,2764249623,2848461854,2331590177,2280796200,2431590963,2648976442,104699613,188127444,472615631,287343814,840019705,1058709744,671593195,621591778,1852171925,1668212892,1953757831,2037970062,1514790577,1463996600,1080017571,1297403050,3673637356,3623636965,3235995134,3454686199,4007360968,3822090177,4107101658,4190530515,2997825956,3215212461,2830708150,2779915199,2256734592,2340947849,2627016082,2443058075,172466556,122466165,273792366,492483431,1047239e3,861968209,612205898,695634755,1646252340,1863638845,2013908262,1963115311,1446242576,1530455833,1277555970,1093597963,1636604631,1820824798,2073724613,1989249228,1436590835,1487645946,1337376481,1119727848,164948639,81781910,331544205,516552836,1039717051,821288114,669961897,719700128,2973530695,3157750862,2871682645,2787207260,2232435299,2283490410,2667994737,2450346104,3647212047,3564045318,3279033885,3464042516,3980931627,3762502690,4150144569,4199882800,3070356634,3121275539,2904027272,2686254721,2200818878,2384911031,2570832044,2486224549,3747192018,3528626907,3310321856,3359936201,3950355702,3867060991,4049844452,4234721005,1739656202,1790575107,2108100632,1890328081,1402811438,1586903591,1233856572,1149249077,266959938,48394827,369057872,418672217,1002783846,919489135,567498868,752375421,209336225,24197544,376187827,459744698,945164165,895287692,574624663,793451934,1679968233,1764313568,2117360635,1933530610,1343127501,1560637892,1243112415,1192455638,3704280881,3519142200,3336358691,3419915562,3907448597,3857572124,4075877127,4294704398,3029510009,3113855344,2927934315,2744104290,2159976285,2377486676,2594734927,2544078150],Œ´=[0,151849742,303699484,454499602,607398968,758720310,908999204,1059270954,1214797936,1097159550,1517440620,1400849762,1817998408,1699839814,2118541908,2001430874,2429595872,2581445614,2194319100,2345119218,3034881240,3186202582,2801699524,2951971274,3635996816,3518358430,3399679628,3283088770,4237083816,4118925222,4002861748,3885750714,1002142683,850817237,698445255,548169417,529487843,377642221,227885567,77089521,1943217067,2061379749,1640576439,1757691577,1474760595,1592394909,1174215055,1290801793,2875968315,2724642869,3111247143,2960971305,2405426947,2253581325,2638606623,2487810577,3808662347,3926825029,4044981591,4162096729,3342319475,3459953789,3576539503,3693126241,1986918061,2137062819,1685577905,1836772287,1381620373,1532285339,1078185097,1229899655,1040559837,923313619,740276417,621982671,439452389,322734571,137073913,19308535,3871163981,4021308739,4104605777,4255800159,3263785589,3414450555,3499326569,3651041127,2933202493,2815956275,3167684641,3049390895,2330014213,2213296395,2566595609,2448830231,1305906550,1155237496,1607244650,1455525988,1776460110,1626319424,2079897426,1928707164,96392454,213114376,396673818,514443284,562755902,679998e3,865136418,983426092,3708173718,3557504664,3474729866,3323011204,4180808110,4030667424,3945269170,3794078908,2507040230,2623762152,2272556026,2390325492,2975484382,3092726480,2738905026,2857194700,3973773121,3856137295,4274053469,4157467219,3371096953,3252932727,3673476453,3556361835,2763173681,2915017791,3064510765,3215307299,2156299017,2307622919,2459735317,2610011675,2081048481,1963412655,1846563261,1729977011,1480485785,1362321559,1243905413,1126790795,878845905,1030690015,645401037,796197571,274084841,425408743,38544885,188821243,3613494426,3731654548,3313212038,3430322568,4082475170,4200115116,3780097726,3896688048,2668221674,2516901860,2366882550,2216610296,3141400786,2989552604,2837966542,2687165888,1202797690,1320957812,1437280870,1554391400,1669664834,1787304780,1906247262,2022837584,265905162,114585348,499347990,349075736,736970802,585122620,972512814,821712160,2595684844,2478443234,2293045232,2174754046,3196267988,3079546586,2895723464,2777952454,3537852828,3687994002,3234156416,3385345166,4142626212,4293295786,3841024952,3992742070,174567692,57326082,410887952,292596766,777231668,660510266,1011452712,893681702,1108339068,1258480242,1343618912,1494807662,1715193156,1865862730,1948373848,2100090966,2701949495,2818666809,3004591147,3122358053,2235061775,2352307457,2535604243,2653899549,3915653703,3764988233,4219352155,4067639125,3444575871,3294430577,3746175075,3594982253,836553431,953270745,600235211,718002117,367585007,484830689,133361907,251657213,2041877159,1891211689,1806599355,1654886325,1568718495,1418573201,1335535747,1184342925]
;class Œ¨ extends Õ±{#G;#H;#I;get key(){return this.#G}constructor(A){var B,C,D,E,F,G;super();const H=this.#G=Array.from(A);let I;switch(H.length){case 16:I=10;break;case 24:I=12;break;case 32:I=14;break;default:throw Error("Key size must be 16, 24 or 32 bytes.")}const J=this.#H=Array(I),K=this.#I=Array(I);for(let A=0;A<=I;A++)J[A]=[0,0,0,0],K[A]=[0,0,0,0];const L=4*(I+1),M=H.length/4,N=√î(H);for(let A=0;A<M;A++){const B=A>>2;J[B][A%4]=N[A],K[I-B][A%4]=N[A]}for(B=0,C=M;C<L;){if(D=N[M-1],
N[0]^=Œù[D>>16&255]<<24^Œù[D>>8&255]<<16^Œù[255&D]<<8^Œù[D>>24&255]^Œú[B]<<24,B+=1,8!=M)for(E=1;E<M;E++)N[E]^=N[E-1];else{for(E=1;E<M/2;E++)N[E]^=N[E-1];for(D=N[M/2-1],N[M/2]^=Œù[255&D]^Œù[D>>8&255]<<8^Œù[D>>16&255]<<16^Œù[D>>24&255]<<24,E=M/2+1;E<M;E++)N[E]^=N[E-1]}for(E=0;E<M&&C<L;)G=C%4,J[F=C>>2][G]=N[E],K[I-F][G]=N[E++],C++}for(let A=1;A<I;A++)for(let B=0;B<4;B++)D=K[A][B],K[A][B]=Œ®[D>>24&255]^Œ©[D>>16&255]^Œ™[D>>8&255]^Œ´[255&D]}encrypt(A){
if(16!==A.length)throw Error("Input data must be exactly 16 bytes.");const B=this.#H,C=B.length-1;let D=√î(A);for(let A=0;A<4;A++)D[A]^=B[0][A];for(let A=1;A<C;A++){const C=[,,,,];for(let E=0;E<4;E++)C[E]=Œü[D[E]>>24&255]^Œ†[D[(E+1)%4]>>16&255]^Œ°[D[(E+2)%4]>>8&255]^Œ£[255&D[(E+3)%4]]^B[A][E];D=C}const E=Array(16);for(let A=0;A<4;A++){const F=B[C][A];E[4*A]=255&(Œù[D[A]>>24&255]^F>>24),E[4*A+1]=255&(Œù[D[(A+1)%4]>>16&255]^F>>16),E[4*A+2]=255&(Œù[D[(A+2)%4]>>8&255]^F>>8),
E[4*A+3]=255&(Œù[255&D[(A+3)%4]]^F)}return E}decrypt(A){if(16!==A.length)throw Error("Input data must be exactly 16 bytes.");const B=this.#I,C=B.length-1;let D=√î(A);for(let A=0;A<4;A++)D[A]^=B[0][A];for(let A=1;A<C;A++){const C=[,,,,];for(let E=0;E<4;E++)C[E]=Œ§[D[E]>>24&255]^Œ•[D[(E+3)%4]>>16&255]^Œ¶[D[(E+2)%4]>>8&255]^Œß[255&D[(E+1)%4]]^B[A][E];D=C}const E=Array(16);for(let A=0;A<4;A++){const F=B[C][A];E[4*A]=255&(Œû[D[A]>>24&255]^F>>24),E[4*A+1]=255&(Œû[D[(A+3)%4]>>16&255]^F>>16),
E[4*A+2]=255&(Œû[D[(A+2)%4]>>8&255]^F>>8),E[4*A+3]=255&(Œû[255&D[(A+1)%4]]^F)}return E}encryptCTR(A,B){const C=Array.from(A),D=√ä(B),E=C.length;let F=[],G=16;for(let A=0;A<E;A++)16===G&&(F=this.encrypt(D),G=0,√ã(D)),C[A]^=F[G++];return C}decryptCTR(A,B){return this.encryptCTR(A,B)}}class Œ≠ extends Õ±{randBuf(A){const B=A.length,C=B-B%4;for(let B=0;B<C;){const C=4294967296*this.rand()>>>0;A[B++]=255&C,A[B++]=C>>8&255,A[B++]=C>>16&255,A[B++]=C>>24&255}for(let D=C;D<B;D++)A[D++]=256*this.rand()&255
;return A}randInt(A,B){return(B||=0)+Math.floor(this.rand()*((A||4294967296)-B))}randUUID(){const A=this.randBuf(new Uint8Array(16));A[6]=15&A[6]|64,A[8]=63&A[8]|128;let B="";for(let C=0;C<16;C++)B+=A[C].toString(16).padStart(2,"0"),3!==C&&5!==C&&7!==C&&9!==C||(B+="-");return B}}class ŒÆ extends Œ≠{#J;get seed(){return this.#J}constructor(A){super(),this.#J=null==A?√è():√î(A)}rand(){let[A,B,C,D]=this.#J,E=(A+B|0)+D|0;return D=D+1|0,A=B^B>>>9,B=C+(C<<3)|0,C=C<<21|C>>>11,C=C+E|0,this.#J=[A,B,C,D],
(E>>>0)/4294967296}setSeed(A){this.#J=√î(A)}}class ŒØ extends Œ≠{#J;get seed(){return this.#J}constructor(A){super(),this.#J=A||√é()}rand(){const A=this.#J=2654435769+(0|this.#J)|0;let B=A^A>>>16;return B=Math.imul(B,569420461),B^=B>>>15,B=Math.imul(B,1935289751),((B^=B>>>15)>>>0)/4294967296}setSeed(A){this.#J=A}}class Œ∞ extends Œ≠{#J;get seed(){return this.#J}constructor(A){super(),this.#J=A||=√é()}rand(){let A=this.#J=1831565813+(0|this.#J);return A=Math.imul(A^A>>>15,1|A),
A^=A+Math.imul(A^A>>>7,61|A),((A^A>>>14)>>>0)/4294967296}setSeed(A){this.#J=A}}class Œ± extends Œ≠{#J;get seed(){return this.#J}constructor(A){super(),this.#J=null==A?√è():√î(A)}rand(){let[A,B,C,D]=this.#J,E=B<<9,F=5*B;return F=9*(F<<7|F>>>25),C^=A,D^=B,B^=C,A^=D,C^=E,D=D<<11|D>>>21,this.#J=[A,B,C,D],(F>>>0)/4294967296}setSeed(A){this.#J=√î(A)}}class Œ≤ extends Œ≠{static[Symbol.hasInstance](A){return A instanceof Œ≠}constructor(A,B){if(super(),new.target===Œ≤)switch(A||"mulberry32"){case"sfc32":
return new ŒÆ(B);case"splitmix32":return new ŒØ(B);case"mulberry32":return new Œ∞(B);case"xoshiro128":return new Œ±(B);default:throw Error("Unsupported algorithm: "+A)}}seed=null;rand(){return À¢()}setSeed(){À¢()}}const Œ≥={validate:A=>A.length>6&&128===A[0]&&99===A[1]&&98===A[2]&&106===A[3]&&102===A[4]&&2===A[5],encode:A=>{const B=[128,99,98,106,102,2],C=new Uint8Array(√ï(B,A,6));let D=0;for(const A of B)"number"!=typeof A?(C.set(A,D),D+=A.byteLength):C[D++]=A;return C},decode:A=>{
if(128!==A[0]||99!==A[1]||98!==A[2]||106!==A[3]||102!==A[4]||2!==A[5])throw Error("Parse Error: Invalid magic value");const B=new DataView(A.buffer,A.byteOffset,A.byteLength);let C=6;const D=()=>{const E=A[C++];switch(E){case 0:return;case 255:return null;case 1:return!0;case 2:return!1;case 20:return A[C++]<<24>>24;case 21:return(255&A[C++]|(255&A[C++])<<8)<<16>>16;case 22:return 255&A[C++]|(255&A[C++])<<8|(255&A[C++])<<16|(255&A[C++])<<24;case 23:return B.getBigInt64((C+=8)-8,!0);case 10:
return A[C++];case 11:return 255&A[C++]|(255&A[C++])<<8;case 12:return(255&A[C++]|(255&A[C++])<<8|(255&A[C++])<<16|(255&A[C++])<<24)>>>0;case 13:return B.getBigUint64((C+=8)-8,!0);case 32:return B.getFloat32((C+=4)-4,!0);case 33:return B.getFloat64((C+=8)-8,!0);case 99:{const B=(255&A[C++]|(255&A[C++])<<8|(255&A[C++])<<16|(255&A[C++])<<24)>>>0,E=Array(B);for(let A=0;A<B;A++)E[A]=D();return E}case 100:{
const B=(255&A[C++]|(255&A[C++])<<8|(255&A[C++])<<16|(255&A[C++])<<24)>>>0,E=Object.create(null);for(let F=0;F<B;F++){const B=(255&A[C++]|(255&A[C++])<<8|(255&A[C++])<<16|(255&A[C++])<<24)>>>0;E[√ë(A.subarray(C,C+=B))]=D()}return E}case 102:{const B=(255&A[C++]|(255&A[C++])<<8|(255&A[C++])<<16|(255&A[C++])<<24)>>>0;return A.subarray(C,C+=B)}case 101:{const B=(255&A[C++]|(255&A[C++])<<8|(255&A[C++])<<16|(255&A[C++])<<24)>>>0;return √ë(A.subarray(C,C+=B))}default:
throw Error("Parse Error: Invalid data ID: "+E)}};return D()}
},Œ¥=Object.freeze(Object.setPrototypeOf(Œ≥,null)),Œµ=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Œ∂={
md5:function(A){const B=Array.from("string"==typeof A?√ê(A):A),C=B.length,D=16*(1+(C+8>>6)),E=Array(D).fill(0);let F,G,H,I,J,K=1732584193,L=-271733879,M=-1732584194,N=271733878;for(F=0;F<C;F++)E[F>>2]|=B[F]<<F%4*8;for(E[F>>2]|=128<<F%4*8,E[D-2]=8*C,F=0;F<D;F+=16)G=K,H=L,I=M,J=N,K=Œñ(K,L,M,N,E[F+0],7,-680876936),N=Œñ(N,K,L,M,E[F+1],12,-389564586),M=Œñ(M,N,K,L,E[F+2],17,606105819),L=Œñ(L,M,N,K,E[F+3],22,-1044525330),K=Œñ(K,L,M,N,E[F+4],7,-176418897),N=Œñ(N,K,L,M,E[F+5],12,1200080426),
M=Œñ(M,N,K,L,E[F+6],17,-1473231341),L=Œñ(L,M,N,K,E[F+7],22,-45705983),K=Œñ(K,L,M,N,E[F+8],7,1770035416),N=Œñ(N,K,L,M,E[F+9],12,-1958414417),M=Œñ(M,N,K,L,E[F+10],17,-42063),L=Œñ(L,M,N,K,E[F+11],22,-1990404162),K=Œñ(K,L,M,N,E[F+12],7,1804603682),N=Œñ(N,K,L,M,E[F+13],12,-40341101),M=Œñ(M,N,K,L,E[F+14],17,-1502002290),L=Œñ(L,M,N,K,E[F+15],22,1236535329),K=Œó(K,L,M,N,E[F+1],5,-165796510),N=Œó(N,K,L,M,E[F+6],9,-1069501632),M=Œó(M,N,K,L,E[F+11],14,643717713),L=Œó(L,M,N,K,E[F+0],20,-373897302),
K=Œó(K,L,M,N,E[F+5],5,-701558691),N=Œó(N,K,L,M,E[F+10],9,38016083),M=Œó(M,N,K,L,E[F+15],14,-660478335),L=Œó(L,M,N,K,E[F+4],20,-405537848),K=Œó(K,L,M,N,E[F+9],5,568446438),N=Œó(N,K,L,M,E[F+14],9,-1019803690),M=Œó(M,N,K,L,E[F+3],14,-187363961),L=Œó(L,M,N,K,E[F+8],20,1163531501),K=Œó(K,L,M,N,E[F+13],5,-1444681467),N=Œó(N,K,L,M,E[F+2],9,-51403784),M=Œó(M,N,K,L,E[F+7],14,1735328473),L=Œó(L,M,N,K,E[F+12],20,-1926607734),K=Œò(K,L,M,N,E[F+5],4,-378558),N=Œò(N,K,L,M,E[F+8],11,-2022574463),
M=Œò(M,N,K,L,E[F+11],16,1839030562),L=Œò(L,M,N,K,E[F+14],23,-35309556),K=Œò(K,L,M,N,E[F+1],4,-1530992060),N=Œò(N,K,L,M,E[F+4],11,1272893353),M=Œò(M,N,K,L,E[F+7],16,-155497632),L=Œò(L,M,N,K,E[F+10],23,-1094730640),K=Œò(K,L,M,N,E[F+13],4,681279174),N=Œò(N,K,L,M,E[F+0],11,-358537222),M=Œò(M,N,K,L,E[F+3],16,-722521979),L=Œò(L,M,N,K,E[F+6],23,76029189),K=Œò(K,L,M,N,E[F+9],4,-640364487),N=Œò(N,K,L,M,E[F+12],11,-421815835),M=Œò(M,N,K,L,E[F+15],16,530742520),L=Œò(L,M,N,K,E[F+2],23,-995338651),
K=Œô(K,L,M,N,E[F+0],6,-198630844),N=Œô(N,K,L,M,E[F+7],10,1126891415),M=Œô(M,N,K,L,E[F+14],15,-1416354905),L=Œô(L,M,N,K,E[F+5],21,-57434055),K=Œô(K,L,M,N,E[F+12],6,1700485571),N=Œô(N,K,L,M,E[F+3],10,-1894986606),M=Œô(M,N,K,L,E[F+10],15,-1051523),L=Œô(L,M,N,K,E[F+1],21,-2054922799),K=Œô(K,L,M,N,E[F+8],6,1873313359),N=Œô(N,K,L,M,E[F+15],10,-30611744),M=Œô(M,N,K,L,E[F+6],15,-1560198380),L=Œô(L,M,N,K,E[F+13],21,1309151649),K=Œô(K,L,M,N,E[F+4],6,-145523070),N=Œô(N,K,L,M,E[F+11],10,-1120210379),
M=Œô(M,N,K,L,E[F+2],15,718787259),L=Œô(L,M,N,K,E[F+9],21,-343485551),K=Œî(K,G),L=Œî(L,H),M=Œî(M,I),N=Œî(N,J);return Œì(K)+Œì(L)+Œì(M)+Œì(N)},AES:Œ¨,Hex:Œõ,Null:Õ±,NTON:Œ¥,ASCII:Õ≤,UTF_8:Õ≥,sha256:function(A){const B=Array.from("string"==typeof A?√ê(A):A),C=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],D=8*B.length;for(B.push(128);B.length%64!=56;)B.push(0);const E=D/4294967296>>>0,F=D>>>0;for(let A=24;A>=0;A-=8)B.push(E>>A&255);for(let A=24;A>=0;A-=8)B.push(F>>A&255)
;for(let A=0;A<B.length;A+=64){const D=B.slice(A,A+64);let E=Array(64);for(let A=0;A<16;A++)E[A]=D[4*A]<<24|D[4*A+1]<<16|D[4*A+2]<<8|D[4*A+3],E[A]=E[A]>>>0;for(let A=16;A<64;A++){const B=√ñ(E[A-15],7)^√ñ(E[A-15],18)^√ò(E[A-15],3),C=√ñ(E[A-2],17)^√ñ(E[A-2],19)^√ò(E[A-2],10);E[A]=E[A-16]+B+E[A-7]+C>>>0}let F=C[0],G=C[1],H=C[2],I=C[3],J=C[4],K=C[5],L=C[6],M=C[7];for(let A=0;A<64;A++){const B=M+(√ñ(J,6)^√ñ(J,11)^√ñ(J,25))+(J&K^~J&L)+Œµ[A]+E[A]>>>0,C=F&G^F&H^G&H;M=L,L=K,K=J,J=I+B>>>0,I=H,H=G,G=F,
F=B+((√ñ(F,2)^√ñ(F,13)^√ñ(F,22))+C>>>0)>>>0}C[0]=C[0]+F>>>0,C[1]=C[1]+G>>>0,C[2]=C[2]+H>>>0,C[3]=C[3]+I>>>0,C[4]=C[4]+J>>>0,C[5]=C[5]+K>>>0,C[6]=C[6]+L>>>0,C[7]=C[7]+M>>>0}return C.map((A=>A.toString(16).padStart(8,"0"))).join("")},Base32:Œå,Base64:Œë,Buffer:À¨,Random:Œ≤,Stream:ÕΩ,Charset:Õº,UTF16BE:Õ∂,UTF16LE:Õ∑,UTF32BE:Õ∫,UTF32LE:Õª,cyrb128:function(A){const B=Array.from("string"==typeof A?√ê(A):A);let C=1779033703,D=3144134277,E=1013904242,F=2773480762;for(const A of B)C=D^Math.imul(C^A,597399067),
D=E^Math.imul(D^A,2869860233),E=F^Math.imul(E^A,951274213),F=C^Math.imul(F^A,2716044179);return C=Math.imul(E^C>>>18,597399067),D=Math.imul(F^D>>>22,2869860233),E=Math.imul(C^E>>>17,951274213),F=Math.imul(D^F>>>19,2716044179),((C^D^E^F)>>>0).toString(16).padStart(8,"0")+((D^C)>>>0).toString(16).padStart(8,"0")+((E^C)>>>0).toString(16).padStart(8,"0")+((F^C)>>>0).toString(16).padStart(8,"0")},AsyncLock:class extends Õ±{#K=!1;#L=[];get locked(){return this.#K}then(A){
"function"==typeof A&&(this.#K?this.#L.push(A):A())}lock(){this.#K=!0}unlock(){const A=this.#L;for(const B of A)B();A.length=0,this.#K=!1}},SyncStream:Õø,ReadStream:class extends ÕΩ{constructor(){super(!1,!0,!1)}async read(){return-1}async readBuf(A,B,C){B||=0,C||=A.byteLength;for(let D=0;D<C;D++){const C=await this.read();if(!(C>=0))return D;A[B+D]=C}return C}async readText(A,B){const C=await this.readNBytes(A);return"utf-8"===(B||="utf-8")?√ë(C):Õº.forName(B).decode(C)}async readNBytes(A){
const B=new Uint8Array(new ArrayBuffer(A),0,A);let C=0;for(;A>0;){const D=await this.readBuf(B,C,Math.min(8192,A));if(D<0)break;A-=D,C+=D}return B.subarray(0,C)}async readAllBytes(){const A=new Uint8Array(new ArrayBuffer(8192),0,8192),B=[];let C=0,D=0;for(;(C=await this.readBuf(A,0,8192))>=0;)D+=C,B.push(A.subarray(0,C));return √ç(B,D)}async pipe(A){const B=new Uint8Array(new ArrayBuffer(8192),0,8192);let C=0,D=0;for(;(C=await this.readBuf(B,0,8192))>=0;)await A.writeBuf(B,0,C),await A.flush(),
D+=C;return D}},WriteStream:class extends ÕΩ{constructor(){super(!1,!1,!0)}async flush(){}async write(A){}async writeBuf(A,B,C){for(B||=0,C||=A.byteLength;B<C;)await this.write(A[B])}async writeText(A,B){const C=("utf-8"===(B||="utf-8")?Õ≥:Õº.forName(B)).encode(A);await this.writeBuf(C,0,C.byteLength)}},EventEmitter:class extends Õ±{#M=Object.create(null);on(A,B){const C=this.#M[A]||=[];for(const A of C)if(A.$===B)return void(A.m=!1);C.push({$:B,m:!1})}once(A,B){const C=this.#M[A]||=[]
;for(const A of C)if(A.$===B)return void(A.m=!0);C.push({$:B,m:!0})}off(A,B){const C=this.#M;if(null!=A){const D=C[A];if(null!=D&&D.length>0){if(null!=B){for(let A=0;A<D.length;A++)if(D[A].$===B)return D.splice(A,1),!0;return!1}return delete C[A]}return!1}if(null!=B){let A=!1;for(const D of Reflect.ownKeys(C)){const E=C[D];if(null!=E)A:for(let C=0;C<E.length;C++)if(E[C].$===B){E.splice(C,1),A=!0;break A}}return A}let D=!1;for(const A of Object.keys(C))delete C[A]&&(D=!0);return D}emit(A,...B){
const C=this.#M[A];if(null!=C){let A=!1;for(let D=0;D<C.length;D++){const E=C[D];A=!0,E.m&&C.splice(D--,1),Reflect.apply(E.$,this,B)}return A}return!1}getListeners(A){if(null!=A)return this.#M[A]?.map((A=>A.$))||[];const B=this.#M,C=new Set;for(const A of Reflect.ownKeys(B)){const D=B[A];if(null!=D)for(const A of D)C.add(A.$)}return Array.from(C)}},SecureRandom:class extends Œ≠{#N;#O=16;#P=Array(16).fill(0);#Q;get aes(){return this.#N}get seed(){return this.#N.key}get counter(){return this.#Q}
constructor(A,B){super(),this.#N=new Œ¨(A||=function(){const A=Array(16);for(let B=0,C=0;B<4;B++){const B=√é();A[C++]=255&B,A[C++]=B>>8&255,A[C++]=B>>16&255,A[C++]=B>>24&255}return A}()),this.#Q=√ä(B)}rand(){const A=this.randBuf([,,,,]);return((255&A[0]|(255&A[1])<<8|(255&A[2])<<16|(255&A[3])<<24)>>>0)/4294967296}randBuf(A){const B=this.#Q,C=A.length,D=this.#N;let E=this.#P,F=this.#O,G=0;for(;G<C;){const H=16-F;if(H<1){E=D.encryptCTR(E,B),√ã(B),F=0;continue}const I=Math.min(C-G,H)
;for(let B=0;B<I;B++)A[G++]=E[F++]}return this.#P=E,this.#O=F,A}setSeed(A){this.#N=new Œ¨(A)}setCounter(A){this.#Q=√ä(A)}},SyncReadStream:ŒÜ,SyncWriteStream:Œà,BufferReadStream:class extends ŒÜ{#O;#P;get index(){return this.#O}set index(A){this.#O=A||0}get buffer(){return this.#P}set buffer(A){this.#P=A}constructor(A,B){super(),this.#O=B||0,this.#P=A}read(){return this.#P[this.#O++]}readBuf(A,B,C){const D=this.#P.subarray(this.#O,this.#O+=C||=A.byteLength);return A.set(D,B||0),C}readNBytes(A){
return this.#P.subarray(this.#O,this.#O+=A)}readAllBytes(){return this.#P.subarray(this.#O)}get closed(){return!1}close(){}},BufferWriteStream:class extends Œà{#R=[];#S=0;write(A){"number"==typeof A?(this.#R.push(A),this.#S++):(this.#R.push(A),this.#S+=A.byteLength)}toBuffer(){const A=new Uint8Array(this.#S);let B=0;for(const C of this.#R)"number"!=typeof C?(A.set(C,B),B+=C.byteLength):A[B++]=C;return A}get closed(){return!1}flush(){}close(){}}};Object.setPrototypeOf(Œ∂,null),
Object.defineProperty(Œ∂,"NettleWeb",{value:Œ∂,writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(Œ∂,Symbol.toStringTag,{value:"NettleWeb",writable:!1,enumerable:!1,configurable:!1});const Œ∑=Œ∂,Œ∏="object"==typeof globalThis?globalThis:"object"==typeof window?window:"object"==typeof global?global:"object"==typeof self?self:Function("return this;")();if(null==Œ∏||"object"!=typeof Œ∏)throw Error("Failed to resolve global object");const Œπ=Object.create(null)
;Object.defineProperty(Œ∑,"loadModule",{value:(A,B)=>{if("string"!=typeof A||"core"===A)throw Error("Invalid module name: "+A);if(A in Œπ)throw Error("Module has already been loaded: "+A);const C=Object.keys(B);for(const A of C)Object.defineProperty(Œ∑,A,{value:B[A],writable:!1,enumerable:!0,configurable:!0});Œπ[A]=C},writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(Œ∑,"removeModule",{value:A=>{if("string"!=typeof A||"core"===A)throw Error("Invalid module name: "+A);const B=Œπ[A]
;if(null!=B){for(const A of B)delete Œ∑[A];return!0}return!1},writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(Œ∑,"activeModules",{value:()=>{const A=Object.keys(Œπ);return A.unshift("core"),A},writable:!1,enumerable:!1,configurable:!1}),"NettleWeb"in Œ∏||Object.defineProperty(Œ∏,"NettleWeb",{value:Œ∑,writable:!1,enumerable:!1,configurable:!1});const Œ∫=Œ∑;for(«∂={},«∑=function(A,B,C,D,E){
var F=new Worker(«∂[B]||(«∂[B]=URL.createObjectURL(new Blob([A+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return F.onmessage=function(A){var B,C=A.data,D=C.$e$;D?((B=Error(D[0])).code=D[1],B.stack=D[2],E(B,null)):E(null,C)},F.postMessage(C,D),F},«∏=Uint8Array,«π=Uint16Array,«∫=Int32Array,«ª=new «∏([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),
«º=new «∏([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),«Ω=new «∏([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),«æ=function(A,B){var C,D,E,F=new «π(31);for(C=0;C<31;++C)F[C]=B+=1<<A[C-1];for(D=new «∫(F[30]),C=1;C<30;++C)for(E=F[C];E<F[C+1];++E)D[E]=E-F[C]<<5|C;return{b:F,r:D}},«ø=«æ(«ª,2),»Ä=«ø.b,»Å=«ø.r,»Ä[28]=258,»Å[258]=28,»Ç=«æ(«º,0),»É=»Ç.b,»Ñ=»Ç.r,»Ö=new «π(32768),»Ü=0;»Ü<32768;++»Ü)»á=(61680&(»á=(52428&(»á=(43690&»Ü)>>1|(21845&»Ü)<<1))>>2|(13107&»á)<<2))>>4|(3855&»á)<<4,
»Ö[»Ü]=((65280&»á)>>8|(255&»á)<<8)>>1;for(»à=function(A,B,C){for(var D,E,F,G,H,I,J,K=A.length,L=0,M=new «π(B);L<K;++L)A[L]&&++M[A[L]-1];for(D=new «π(B),L=1;L<B;++L)D[L]=D[L-1]+M[L-1]<<1;if(C){for(E=new «π(1<<B),F=15-B,L=0;L<K;++L)if(A[L])for(G=L<<4|A[L],H=B-A[L],J=(I=D[A[L]-1]++<<H)|(1<<H)-1;I<=J;++I)E[»Ö[I]>>F]=G}else for(E=new «π(K),L=0;L<K;++L)A[L]&&(E[L]=»Ö[D[A[L]-1]++]>>15-A[L]);return E},»â=new «∏(288),»Ü=0;»Ü<144;++»Ü)»â[»Ü]=8;for(»Ü=144;»Ü<256;++»Ü)»â[»Ü]=9;for(»Ü=256;»Ü<280;++»Ü)»â[»Ü]=7;for(»Ü=280;»Ü<288;++»Ü)»â[»Ü]=8
;for(»ä=new «∏(32),»Ü=0;»Ü<32;++»Ü)»ä[»Ü]=5;»ã=»à(»â,9,0),»å=»à(»â,9,1),»ç=»à(»ä,5,0),»é=»à(»ä,5,1),»è=function(A){var B,C=A[0];for(B=1;B<A.length;++B)A[B]>C&&(C=A[B]);return C},»ê=function(A,B,C){var D=B/8|0;return(A[D]|A[D+1]<<8)>>(7&B)&C},»ë=function(A,B){var C=B/8|0;return(A[C]|A[C+1]<<8|A[C+2]<<16)>>(7&B)},»í=function(A){return(A+7)/8|0},»ì=function(A,B,C){return(null==B||B<0)&&(B=0),(null==C||C>A.length)&&(C=A.length),new «∏(A.subarray(B,C))},
»î=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],»ï=function(A,B,C){var D=Error(B||»î[A]);if(D.code=A,Error.captureStackTrace&&Error.captureStackTrace(D,»ï),!C)throw D;return D},»ñ=function(A,B,C,D){
var E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=A.length,u=D?D.length:0;if(!t||B.f&&!B.l)return C||new «∏(0);F=(E=!C)||2!=B.i,G=B.i,E&&(C=new «∏(3*t)),H=function(A){var B,D=C.length;A>D&&((B=new «∏(Math.max(2*D,A))).set(C),C=B)},I=B.f||0,J=B.p||0,K=B.b||0,L=B.l,M=B.d,N=B.m,O=B.n,P=8*t;do{if(!L){if(I=»ê(A,J,1),Q=»ê(A,J+1,3),J+=3,!Q){if((T=(R=»í(J)+4)+(S=A[R-4]|A[R-3]<<8))>t){G&&»ï(0);break}F&&H(K+S),C.set(A.subarray(R,T),K),B.b=K+=S,B.p=J=8*T,B.f=I;continue}
if(1==Q)L=»å,M=»é,N=9,O=5;else if(2==Q){for(U=»ê(A,J,31)+257,V=»ê(A,J+10,15)+4,W=U+»ê(A,J+5,31)+1,J+=14,X=new «∏(W),Y=new «∏(19),Z=0;Z<V;++Z)Y[«Ω[Z]]=»ê(A,J+3*Z,7);for(J+=3*V,b=(1<<(a=»è(Y)))-1,c=»à(Y,a,1),Z=0;Z<W;)if(J+=15&(d=c[»ê(A,J,b)]),(R=d>>4)<16)X[Z++]=R;else for(e=0,f=0,16==R?(f=3+»ê(A,J,3),J+=2,e=X[Z-1]):17==R?(f=3+»ê(A,J,7),J+=3):18==R&&(f=11+»ê(A,J,127),J+=7);f--;)X[Z++]=e;g=X.subarray(0,U),h=X.subarray(U),N=»è(g),O=»è(h),L=»à(g,N,1),M=»à(h,O,1)}else »ï(1);if(J>P){G&&»ï(0);break}}for(F&&H(K+131072),
i=(1<<N)-1,j=(1<<O)-1,k=J;;k=J){if(l=(e=L[»ë(A,J)&i])>>4,(J+=15&e)>P){G&&»ï(0);break}if(e||»ï(2),l<256)C[K++]=l;else{if(256==l){k=J,L=null;break}if(m=l-254,l>264&&(n=«ª[Z=l-257],m=»ê(A,J,(1<<n)-1)+»Ä[Z],J+=n),p=(o=M[»ë(A,J)&j])>>4,o||»ï(3),J+=15&o,h=»É[p],p>3&&(n=«º[p],h+=»ë(A,J)&(1<<n)-1,J+=n),J>P){G&&»ï(0);break}if(F&&H(K+131072),q=K+m,K<h)for(r=u-h,s=Math.min(h,q),r+K<0&&»ï(3);K<s;++K)C[K]=D[r+K];for(;K<q;++K)C[K]=C[K-h]}}B.l=L,B.p=k,B.b=K,B.f=I,L&&(I=1,B.m=N,B.d=M,B.n=O)}while(!I)
;return K!=C.length&&E?»ì(C,0,K):C.subarray(0,K)},»ó=function(A,B,C){C<<=7&B;var D=B/8|0;A[D]|=C,A[D+1]|=C>>8},»ò=function(A,B,C){C<<=7&B;var D=B/8|0;A[D]|=C,A[D+1]|=C>>8,A[D+2]|=C>>16},»ô=function(A,B){var C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U=[];for(C=0;C<A.length;++C)A[C]&&U.push({s:C,f:A[C]});if(D=U.length,E=U.slice(),!D)return{t:»†,l:0};if(1==D)return(F=new «∏(U[0].s+1))[U[0].s]=1,{t:F,l:1};for(U.sort((function(A,B){return A.f-B.f})),U.push({s:-1,f:25001}),G=U[0],H=U[1],I=0,J=1,K=2,U[0]={s:-1,
f:G.f+H.f,l:G,r:H};J!=D-1;)G=U[U[I].f<U[K].f?I++:K++],H=U[I!=J&&U[I].f<U[K].f?I++:K++],U[J++]={s:-1,f:G.f+H.f,l:G,r:H};for(L=E[0].s,C=1;C<D;++C)E[C].s>L&&(L=E[C].s);if(M=new «π(L+1),(N=»ö(U[J-1],M,0))>B){for(C=0,O=0,Q=1<<(P=N-B),E.sort((function(A,B){return M[B.s]-M[A.s]||A.f-B.f}));C<D&&(R=E[C].s,M[R]>B);++C)O+=Q-(1<<N-M[R]),M[R]=B;for(O>>=P;O>0;)S=E[C].s,M[S]<B?O-=1<<B-M[S]++-1:++C;for(;C>=0&&O;--C)T=E[C].s,M[T]==B&&(--M[T],++O);N=B}return{t:new «∏(M),l:N}},»ö=function(A,B,C){
return-1==A.s?Math.max(»ö(A.l,B,C+1),»ö(A.r,B,C+1)):B[A.s]=C},»õ=function(A){for(var B,C,D,E,F,G,H=A.length;H&&!A[--H];);for(B=new «π(++H),C=0,D=A[0],E=1,F=function(A){B[C++]=A},G=1;G<=H;++G)if(A[G]==D&&G!=H)++E;else{if(!D&&E>2){for(;E>138;E-=138)F(32754);E>2&&(F(E>10?E-11<<5|28690:E-3<<5|12305),E=0)}else if(E>3){for(F(D),--E;E>6;E-=6)F(8304);E>2&&(F(E-3<<5|8208),E=0)}for(;E--;)F(D);E=1,D=A[G]}return{c:B.subarray(0,C),n:H}},»ú=function(A,B){var C,D=0;for(C=0;C<B.length;++C)D+=A[C]*B[C];return D},
»ù=function(A,B,C){var D,E=C.length,F=»í(B+2);for(A[F]=255&E,A[F+1]=E>>8,A[F+2]=255^A[F],A[F+3]=255^A[F+1],D=0;D<E;++D)A[F+D+4]=C[D];return 8*(F+4+E)},»û=function(A,B,C,D,E,F,G,H,I,J,K){var L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;for(»ó(B,K++,C),++E[256],M=(L=»ô(E,15)).t,N=L.l,P=(O=»ô(F,15)).t,Q=O.l,S=(R=»õ(M)).c,T=R.n,V=(U=»õ(P)).c,W=U.n,X=new «π(19),Y=0;Y<S.length;++Y)++X[31&S[Y]];for(Y=0;Y<V.length;++Y)++X[31&V[Y]];for(a=(Z=»ô(X,7)).t,b=Z.l,c=19;c>4&&!a[«Ω[c-1]];--c);if(d=J+5<<3,
e=»ú(E,»â)+»ú(F,»ä)+G,f=»ú(E,M)+»ú(F,P)+G+14+3*c+»ú(X,a)+2*X[16]+3*X[17]+7*X[18],I>=0&&d<=e&&d<=f)return »ù(B,K,A.subarray(I,I+J));if(»ó(B,K,1+(f<e)),K+=2,f<e){for(g=»à(M,N,0),h=M,i=»à(P,Q,0),j=P,k=»à(a,b,0),»ó(B,K,T-257),»ó(B,K+5,W-1),»ó(B,K+10,c-4),K+=14,Y=0;Y<c;++Y)»ó(B,K+3*Y,a[«Ω[Y]]);for(K+=3*c,l=[S,V],m=0;m<2;++m)for(n=l[m],Y=0;Y<n.length;++Y)o=31&n[Y],»ó(B,K,k[o]),K+=a[o],o>15&&(»ó(B,K,n[Y]>>5&127),K+=n[Y]>>12)}else g=»ã,h=»â,i=»ç,j=»ä;for(Y=0;Y<H;++Y)(p=D[Y])>255?(»ò(B,K,g[257+(o=p>>18&31)]),K+=h[o+257],
o>7&&(»ó(B,K,p>>23&31),K+=«ª[o]),»ò(B,K,i[q=31&p]),K+=j[q],q>3&&(»ò(B,K,p>>5&8191),K+=«º[q])):(»ò(B,K,g[p]),K+=h[p]);return »ò(B,K,g[256]),K+h[256]},»ü=new «∫([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),»†=new «∏(0),»°=function(A,B,C,D,E,F){var G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=F.z||A.length,t=new «∏(D+s+5*(1+Math.ceil(s/7e3))+E),u=t.subarray(D,t.length-E),v=F.l,w=7&(F.r||0);if(B){for(w&&(u[0]=F.r>>3),H=(G=»ü[B-1])>>13,I=8191&G,J=(1<<C)-1,
K=F.p||new «π(32768),L=F.h||new «π(J+1),N=2*(M=Math.ceil(C/3)),O=function(B){return(A[B]^A[B+1]<<M^A[B+2]<<N)&J},P=new «∫(25e3),Q=new «π(288),R=new «π(32),S=0,T=0,U=F.i||0,V=0,W=F.w||0,X=0;U+2<s;++U)if(Z=32767&U,a=L[Y=O(U)],K[Z]=a,L[Y]=Z,W<=U){if(b=s-U,(S>7e3||V>24576)&&(b>423||!v)){for(w=»û(A,u,0,P,Q,R,T,V,X,U-X,w),V=S=T=0,X=U,c=0;c<286;++c)Q[c]=0;for(c=0;c<30;++c)R[c]=0}if(d=2,e=0,f=I,g=Z-a&32767,b>2&&Y==O(U-g))for(h=Math.min(H,b)-1,i=Math.min(32767,U),j=Math.min(258,b);g<=i&&--f&&Z!=a;){
if(A[U+d]==A[U+d-g]){for(k=0;k<j&&A[U+k]==A[U+k-g];++k);if(k>d){if(d=k,e=g,k>h)break;for(l=Math.min(g,k-2),m=0,c=0;c<l;++c)(o=(n=U-g+c&32767)-K[n]&32767)>m&&(m=o,a=n)}}g+=(Z=a)-(a=K[Z])&32767}e?(P[V++]=268435456|»Å[d]<<18|»Ñ[e],p=31&»Å[d],q=31&»Ñ[e],T+=«ª[p]+«º[q],++Q[257+p],++R[q],W=U+d,++S):(P[V++]=A[U],++Q[A[U]])}for(U=Math.max(U,W);U<s;++U)P[V++]=A[U],++Q[A[U]];w=»û(A,u,v,P,Q,R,T,V,X,U-X,w),v||(F.r=7&w|u[w/8|0]<<3,w-=7,F.h=L,F.p=K,F.i=U,F.w=W)}else{
for(U=F.w||0;U<s+v;U+=65535)(r=U+65535)>=s&&(u[w/8|0]=v,r=s),w=»ù(u,w+1,A.subarray(U,r));F.i=s}return »ì(t,0,D+»í(w)+E)},»¢=null,»£=function(){var A=1,B=0;return{p:function(C){var D,E,F=A,G=B,H=0|C.length;for(D=0;D!=H;){for(E=Math.min(D+2655,H);D<E;++D)G+=F+=C[D];F=(65535&F)+15*(F>>16),G=(65535&G)+15*(G>>16)}A=F,B=G},d:function(){return(255&(A%=65521))<<24|(65280&A)<<8|(255&(B%=65521))<<8|B>>8}}},»§=function(A,B,C,D,E){var F,G;return E||(E={l:1},B.dictionary&&(F=B.dictionary.subarray(-32768),
(G=new «∏(F.length+A.length)).set(F),G.set(A,F.length),A=G,E.w=F.length)),»°(A,null==B.level?6:B.level,null==B.mem?E.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(A.length)))):20:12+B.mem,C,D,E)},»•=function(A,B){var C,D={};for(C in A)D[C]=A[C];for(C in B)D[C]=B[C];return D},»¶=function(A,B,C){var D,E,F,G,H,I,J=A(),K=A.toString(),L=K.slice(K.indexOf("[")+1,K.lastIndexOf("]")).replace(/\s+/g,"").split(",");for(D=0;D<J.length;++D)if(E=J[D],F=L[D],"function"==typeof E)if(B+=";"+F+"=",G=E.toString(),
E.prototype)if(-1!=G.indexOf("[native code]"))H=G.indexOf(" ",8)+1,B+=G.slice(H,G.indexOf("(",H));else for(I in B+=G,E.prototype)B+=";"+F+".prototype."+I+"="+E.prototype[I].toString();else B+=G;else C[F]=E;return B},»ß=null,»®=function(A){var B,C=[];for(B in A)A[B].buffer&&C.push((A[B]=new A[B].constructor(A[B])).buffer);return C},»©=function(A,B){return A[B]|A[B+1]<<8},»™=function(A,B){return(A[B]|A[B+1]<<8|A[B+2]<<16|A[B+3]<<24)>>>0},»´=function(A,B){return »™(A,B)+4294967296*»™(A,B+4)},
»¨=function(A,B,C){for(;C;++B)A[B]=C,C>>>=8},»≠=function(A,B,C,D){var E,F,G,H;for(E in A)F=A[E],G=B+E,H=D,Array.isArray(F)&&(H=»•(D,F[1]),F=F[0]),F instanceof «∏?C[G]=[F,H]:(C[G+="/"]=[new «∏(0),H],»≠(F,G,C,D))},»Æ="undefined"!=typeof TextDecoder&&new TextDecoder;try{»Æ.decode(»†,{stream:!0})}catch(A){}"function"==typeof queueMicrotask&&queueMicrotask
;const Œª=Œ∫.NTON.decode(√ö(Œ∫.Base64.decode("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")))
;let Œº,ŒΩ;const Œæ=Object.freeze(Object.setPrototypeOf({_:({console:A},B)=>{if(null==A||"object"!=typeof A)throw Error("Invalid interface");const C=Reflect.get(A,"log",void 0);if("function"!=typeof C)throw Error("Invalid instance impl");for(const B of Object.keys(A))delete A[B];Œº=(...A)=>(Reflect.apply(C,null,A),!0),ŒΩ=B},get $(){const A=Œº;return Œº=void 0,A},get l(){const A=ŒΩ;return ŒΩ=void 0,A}},null)),Œø=Œæ,œÄ=[.2,3/8,5/9,2/3],œÅ=(A,B)=>C=>{
const D=4*A+C-4,E="*-04-39?2$%%$%%'$%''%'''%')(%'))%(++'(++'(+.'+-.',/3',33)-/5)-43).36)058*18<+37<+4:<,4:E,5<A-7>C/8@F/:EH/<EK0=FM1?IP2@KS3BNV4DPY5FS\\6HV_6IXb7K[e8N^i9Pam;Rdp<Tgt".charCodeAt(D)-35,F=D>8?E:1,G=B/F|0,H=B%F,I=F-H,J=D>8?G*œÄ[C]+(A>5)&-2:E,K=G-J;return{t:I*K+H*K+H,o:[[I,K],[H,K+1]],i:J}},œÇ=A=>new Uint8Array(A),œÉ=A=>{const B=Error("lean-qr error "+A);throw B.code=A,B
},œÑ=A=>"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:".indexOf(A),œÖ=A=>A.charCodeAt(0),œÜ=(...A)=>(B,C)=>A.forEach((A=>A(B,C))),œá=A=>B=>{B.eci!==A&&(B.push(7,4),B.push(A,8),B.eci=A)},œà=A=>(B,C)=>{B.push(4,4),B.push(A.length,8+8*(C>9)),A.forEach((A=>B.push(A,8)))},œâ=(A,B,C,D,E=(A,B)=>C(A.length,B),F=(D?B=>œÜ(œá(D),A(B)):A))=>(F.test=B,F.l=C,F.est=E,F.eci=D&&[D],F),œä=œâ((A=>(B,C)=>{B.push(1,4),B.push(A.length,10+2*(C>26)+2*(C>9));let D=0;for(;D<A.length-2;D+=3)B.push(+A.slice(D,D+3),10)
;D<A.length-1?B.push(+A.slice(D),7):D<A.length&&B.push(+A[D],4)}),(A=>/[0-9]/.test(A)),((A,B)=>14+2*(B>26)+2*(B>9)+10*A/3)),œã=œâ((A=>(B,C)=>{B.push(2,4),B.push(A.length,9+2*(C>26)+2*(C>9));let D=0;for(;D<A.length-1;D+=2)B.push(45*œÑ(A[D])+œÑ(A[D+1]),11);D<A.length&&B.push(œÑ(A[D]),6)}),(A=>œÑ(A)>=0),((A,B)=>13+2*(B>26)+2*(B>9)+5.5*A)),œå=œâ((A=>œà([...A].map(œÖ))),(A=>œÖ(A)<128),((A,B)=>12+8*(B>9)+8*A));œå._=!0,œå.u=!0;const œç=œâ(œå,(A=>œÖ(A)<256),œå.l,3);œç._=!0
;const œé=new TextEncoder,œè=œâ((A=>œà(œé.encode(A))),(()=>1),0,26,((A,B)=>12+8*(B>9)+8*œé.encode(A).length));œè._=!0;let œê=()=>{const A=new Map,B=new TextDecoder("sjis"),C=œÇ(2);for(let D=0;D<7973;++D)C[0]=D/192+129+64*(D>5951),C[1]=D%192+64,A.set(B.decode(C),D);return A.delete("ÔøΩ"),œê=()=>A,A};const œë=œâ((A=>(B,C)=>{B.push(8,4),B.push(A.length,8+2*(C>26)+2*(C>9));for(const C of A)B.push(œê().get(C),13)}),(A=>œê().has(A)),((A,B)=>12+2*(B>26)+2*(B>9)+13*A));œë._=!0
;const œí=[œä,œã,œå,œç,œë,œè],œì=(A,{modes:B=œí}={})=>(C,D)=>{const E=B.map(((B,C)=>{const E=new Map,F=(A,B)=>(E.has(A)||E.set(A,B(A,D)),E.get(A));return{m:B,h:1<<C,C:B.est("",D),S:B.l?(A,C)=>F(C-A,B.l):(C,D)=>F(A.slice(C,D),B.est)}}));let F=[{v:0}],G=0,H=0,I=-1;for(const B of[...A,""]){let A=0;if(B)for(const C of E)C.m.test(B)&&(A|=C.h);if(!B||A!==I){if(-1!==I){const A=new Set(F.map((A=>A.D))),B=[];for(const{m:C,C:D,S:J,h:K}of E)if(I&K){const E=J(G,H);for(const I of C.eci??A)if(!C.u||!I){let A
;for(const B of F)if(B.D===I||C.eci){const F=B.m===C&&B.D===I,K=F?B.V:B,L=C._&&F?B.v+E-D:K.v+12*(K.D!==I)+(F?J(F?B.$:G,H):E);(!A||L<A.v)&&(A={$:F?B.$:G,V:K,m:C,D:I,A:H,v:L})}A&&B.push(A)}}F=B}I=A,G=H}H+=B.length}F.length||œÉ(5);const J=[];for(let B=F.reduce(((A,B)=>B.v<A.v?B:A));B.m;B=B.V)J.push(B.m(A.slice(B.$,B.A)));J.reverse().forEach((A=>A(C,D)))},œî=()=>({F:œÇ(2956),I:0,push(A,B){for(let C=B,D=8-(7&this.I);C>0;C-=D,D=8)this.F[this.I>>3]|=A<<D>>C,this.I+=C<D?C:D}}),œï=(A,B=A*A,C=œÇ(B))=>({size:A,
K:C,get:(B,D)=>B>=0&&B<A&&!!(1&C[D*A+B]),toString({on:B="##",off:C="  ",lf:D="\n",padX:E=4,padY:F=4}={}){let G="";for(let H=-F;H<A+F;++H){for(let D=-E;D<A+E;++D)G+=this.get(D,H)?B:C;G+=D}return G},toImageData(B,{on:C=[0,0,0],off:D=[0,0,0,0],padX:E=4,padY:F=4}={}){const G=A+2*E,H=A+2*F,I=B.createImageData(G,H),J=new Uint32Array(I.data.buffer);I.data.set([...C,255]);const K=J[0];I.data.set([...D,255]);const L=J[0];for(let A=0;A<H;++A)for(let B=0;B<G;++B)J[A*G+B]=this.get(B-E,A-F)?K:L;return I},
toCanvas(A,B){const C=A.getContext("2d"),D=this.toImageData(C,B);A.width=D.width,A.height=D.height,C.putImageData(D,0,0)},toDataURL({type:A="image/png",scale:B=1,...C}={}){const D=document.createElement("canvas"),E=D.getContext("2d"),F=this.toImageData(E,C);return D.width=F.width*B,D.height=F.height*B,E.putImageData(F,0,0),E.imageSmoothingEnabled=!1,E.globalCompositeOperation="copy",E.drawImage(D,0,0,F.width,F.height,0,0,D.width,D.height),D.toDataURL(A,1)}
}),œñ=[(A,B)=>!(1&(A^B)),(A,B)=>!(1&B),A=>!(A%3),(A,B)=>!((A+B)%3),(A,B)=>!(1&(A/3^B>>1)),(A,B)=>!((A&B&1)+A*B%3),(A,B)=>!((A&B&1)+A*B%3&1),(A,B)=>!((1&(A^B))+A*B%3&1)],œó=œÇ(511);for(let A=0,B=1;A<255;B=2*B^285*(B>127))œó[œó[B+255]=A++]=B;const œò=A=>œó[A%255],œô=A=>œó[A+255],œö=(A,B)=>{const C=œÇ(A.length+B.length-1);for(let D=0;D<A.length;++D)for(let E=0;E<B.length;++E)C[D+E]^=œò(A[D]+B[E]);return C.map(œô)},œõ=(A,B)=>{const C=œÇ(A.length+B.length-1);C.set(A,0);for(let D=0;D<A.length;++D)if(C[D]){
const A=œô(C[D]);for(let E=0;E<B.length;++E)C[D+E]^=œò(B[E]+A)}return C.slice(A.length)},œú=[[0],[0,0]];for(let A=1;A<30;++A)œú.push(œö(œú[A],[0,A]));const œù=(A,B)=>{const C=[[],[]];let D=0,E=0;for(const[F,G]of B.o)for(let H=0;H<F;++H,D+=G){const F=A.slice(D,D+G);C[0].push(F),C[1].push(œõ(F,œú[B.i])),E+=G+B.i}const F=œÇ(E);E=0;for(const A of C)for(let B,C=0;E!==B;++C){B=E;for(const B of A)C<B.length&&(F[E++]=B[C])}return F},œû=(A,B,C)=>{let D=A<<=C;for(let A=134217728;A>>=1;)D&A&&(D^=B*(A>>C));return D|A
},œü=({size:A,K:B},C)=>{const D=(C,D,E,F)=>{for(;E-- >0;C+=A)B.fill(F,C,C+D)},E=(B,C,E)=>{for(let F=0;F++<3;E-=2)D(C*A+B-(E>>1)*(A+1),E,E,2|F)},F=2*((A-13)/(1+(C/7|0))/2+.75|0);if(C>1)for(let B=A-7;B>8;B-=F){for(let A=B;A>8;A-=F)E(B,A,5);B<A-7&&E(B,6,5)}if(C>6)for(let D=œû(C,7973,12),E=1;E<7;++E)for(let C=12;C-- >9;D>>=1)B[E*A-C]=2|1&D;D(7,2,9,2),D(A-8,8,9,2);for(let C=0;C<A;++C)B[6*A+C]=3^1&C;E(3,3,7),E(A-4,3,7);for(let C=0;C<A;++C)for(let D=C;D<A;++D)B[D*A+C]=B[C*A+D];B[(A-8)*A+8]=3
},œ†=({size:A,K:B})=>{const C=[];for(let D=A-2,E=A,F=-1;D>=0;D-=2){for(5===D&&(D=4);E+=F,-1!==E&&E!==A;){const F=E*A+D;B[F+1]||C.push(F+1),B[F]||C.push(F)}F*=-1}return C},œ°=({K:A},B,C)=>B.forEach(((B,D)=>A[B]=C[D>>3]>>(7&~D)&1)),œ¢=({size:A,K:B},C,D,E)=>{for(let D=0;D<A;++D)for(let E=0;E<A;++E){const F=D*A+E;B[F]^=C(E,D)&(B[F]>>1^1)}let F=21522^œû((1^E)<<3|D,1335,10);for(let C=0;C++<8;F>>=1)B[(C-(C<7))*A+8]=1&F,B[9*A-C]=1&F;for(let C=8;--C,F;F>>=1)B[8*A+C-(C<7)]=1&F,B[(A-C)*A+8]=1&F
},œ£=({size:A,K:B},C=0,D=0)=>{for(let E=0;E<A;++E){for(let F=0;F<2;++F)for(let G,H=0,I=0,J=0;H<A;++H){const K=1&B[F?E*A+H:H*A+E];D+=K,I=(I>>1|2098176)&(3047517^K-1),2049&I&&(C+=40),K!==G&&(J=0),G=K,C+=5===++J?3:J>5}if(E)for(let D=A+E,F=5*B[E-1]^B[E];D<A*A;D+=A){const A=5*B[D-1]^B[D];C+=3*!(1&(F|A)|4&(F^A)),F=A}}return C+10*(10*Math.abs(D/(A*A)-1)|0)},œ§=[],œ•=(A=œÉ(1),{minCorrectionLevel:B=0,maxCorrectionLevel:C=3,minVersion:D=1,maxVersion:E=40,mask:F,trailer:G=60433,...H}={})=>{C<B&&œÉ(3),E<D&&œÉ(2),
"string"==typeof A&&(A=œì(A,H));for(let H=D,I=0;H<=E;++H){let D=œ§[H];D||(œ§[H]=D=œï(4*H+17),œü(D,H),D.p=œ†(D));const E=œÅ(H,D.p.length>>3);if(8*E(B).t<I)continue;const J=œî();A(J,H),I=J.I;for(let A=C;A>=B;--A){const B=E(A);if(8*B.t<I)continue;for(J.I=I+11&-8;J.I<8*B.t;)J.push(G,16);const C=œï(D.size,D.K);return œ°(C,D.p,œù(J.F,B)),(œñ[F??-1]?[œñ[F]]:œñ).map(((B,D)=>{const E=œï(C.size,C.K);return œ¢(E,B,F??D,A),E.s=œ£(E),E})).reduce(((A,B)=>B.s<A.s?B:A))}}œÉ(4)};œ•.with=(...A)=>(B,C)=>œ•(B,{modes:[...œí,...A],...C})
;const œ¶="emoji",œß="keyvalue",œ®="favorites",œ©="tokens",œ™="count",œ´="group-order",œ¨="eTag",œ≠="url",œÆ="skinTone",œØ="readonly",œ∞="readwrite",œ±="skinUnicodes",œ≤={},œ≥={},œ¥={},œµ=new Set([":D","XD",":'D","O:)",":X",":P",";P","XP",":L",":Z",":j","8D","XO","8)",":B",":O",":S",":'o","Dx","X(","D:",":C",">0)",":3","</3","<3","\\M/",":E","8#"]),œ∑=["name","url"],œ∏="undefined"!=typeof wrappedJSObject,œπ=["annotation","emoji","group","order","version"];class œ∫{
constructor({dataSource:A="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",locale:B="en",customEmoji:C=[]}={}){this.dataSource=A,this.locale=B,this._dbName="emoji-picker-element-"+this.locale,this._db=void 0,this._lazyUpdate=void 0,this._custom=√≠(C),this._clear=this._clear.bind(this),this._ready=this._init()}async _init(){const A=this._db=await(B=this._dbName,œ≥[B]||(œ≥[B]=√ü(B)),œ≥[B]);var B;!function(A,B){let C=œ¥[A];C||(C=œ¥[A]=[]),C.push(B)
}(this._dbName,this._clear);const C=this.dataSource,D=await async function(A){return!await √¨(A,œß,œ≠)}(A);D?await async function(A,B){let[C,D]=await √∞(B);C||(C=await √±(D)),await √©(A,D,B,C)}(A,C):this._lazyUpdate=async function(A,B){try{await √≤(A,B)}catch(A){if("InvalidStateError"!==A.name)throw A}}(A,C)}async ready(){const A=async()=>(this._ready||(this._ready=this._init()),this._ready);await A(),this._db||await A()}async getEmojiByGroup(A){return √ú(A),await this.ready(),
√ù(await async function(A,B){return √†(A,œ¶,œØ,((A,C,D)=>{const E=IDBKeyRange.bound([B,0],[B+1,0],!1,!0);√¶(A.index(œ´),E,D)}))}(this._db,A)).map(√Æ)}async getEmojiBySearchQuery(A){return √õ(A),await this.ready(),[...this._custom.search(A),...√ù(await √™(this._db,A)).map(√Æ)]}async getEmojiByShortcode(A){√õ(A),await this.ready();const B=this._custom.byShortcode(A);return B||√Æ(await √´(this._db,A))}async getEmojiByUnicodeOrName(A){√õ(A),await this.ready();const B=this._custom.byName(A)
;return B||√Æ(await async function(A,B){return √†(A,œ¶,œØ,((A,C,D)=>√•(A,B,(C=>{if(C)return D(C);√•(A.index(œ±),B,(A=>D(A||null)))}))))}(this._db,A))}async getPreferredSkinTone(){return await this.ready(),await √¨(this._db,œß,œÆ)||0}async setPreferredSkinTone(A){return √ú(A),await this.ready(),function(A,B,C,D){return √†(A,B,œ∞,((A,B)=>{A.put(D,C),√ß(B)}))}(this._db,œß,œÆ,A)}async incrementFavoriteEmojiCount(A){return √õ(A),await this.ready(),B=this._db,C=A,√†(B,œ®,œ∞,((A,B)=>√•(A,C,(D=>{A.put((D||0)+1,C),√ß(B)}))))
;var B,C}async getTopFavoriteEmoji(A){return √ú(A),await this.ready(),(await function(A,B,C){return 0===C?[]:√†(A,[œ®,œ¶],œØ,(([A,D],E,F)=>{const G=[];A.index(œ™).openCursor(void 0,"prev").onsuccess=A=>{function E(A){if(G.push(A),G.length===C)return F(G);H.continue()}const H=A.target.result;if(!H)return F(G);const I=H.primaryKey,J=B.byName(I);if(J)return E(J);√•(D,I,(A=>{if(A)return E(A);H.continue()}))}}))}(this._db,this._custom,A)).map(√Æ)}set customEmoji(A){this._custom=√≠(A)}get customEmoji(){
return this._custom.all}async _shutdown(){await this.ready();try{await this._lazyUpdate}catch(A){}}_clear(){this._db=this._ready=this._lazyUpdate=void 0}async close(){await this._shutdown(),await √°(this._dbName)}async delete(){var A;await this._shutdown(),await(A=this._dbName,new Promise(((B,C)=>{√°(A),√û(B,C,indexedDB.deleteDatabase(A))})))}}
const œª=[[-1,"‚ú®","custom"],[0,"üòÄ","smileys-emotion"],[1,"üëã","people-body"],[3,"üê±","animals-nature"],[4,"üçé","food-drink"],[5,"üè†Ô∏è","travel-places"],[6,"‚öΩ","activities"],[7,"üìù","objects"],[8,"‚õîÔ∏è","symbols"],[9,"üèÅ","flags"]].map((([A,B,C])=>({id:A,emoji:B,name:C}))),œº=œª.slice(1),œΩ="function"==typeof requestIdleCallback?requestIdleCallback:setTimeout,œæ=["üòä","üòí","‚ù§Ô∏è","üëçÔ∏è","üòç","üòÇ","üò≠","‚ò∫Ô∏è","üòî","üò©","üòè","üíï","üôå","üòò"],œø=(A,B)=>A<B?-1:A>B?1:0,–Ä=new Map,–Å=requestAnimationFrame
;let –Ç,–É="function"==typeof ResizeObserver;const –Ñ=new WeakMap,–Ö=new WeakMap,–Ü=Symbol("un-keyed"),–á="replaceChildren"in Element.prototype,–à="function"==typeof queueMicrotask?queueMicrotask:A=>Promise.resolve().then(A),–â=new WeakMap,–ä=[],{assign:–ã}=Object;»Ø={categoriesLabel:"Categories",emojiUnsupportedMessage:"Your browser does not support color emoji.",favoritesLabel:"Favorites",loadingMessage:"Loading‚Ä¶",networkErrorMessage:"Could not load emoji.",regionLabel:"Emoji picker",
searchDescription:"When search results are available, press up or down to select and enter to choose.",searchLabel:"Search",searchResultsLabel:"Search results",skinToneDescription:"When expanded, press up or down to select and enter to choose.",skinToneLabel:"Choose a skin tone (currently {skinTone})",skinTonesLabel:"Skin tones",skinTones:["Default","Light","Medium-Light","Medium","Medium-Dark","Dark"],categories:{custom:"Custom","smileys-emotion":"Smileys and emoticons",
"people-body":"People and body","animals-nature":"Animals and nature","food-drink":"Food and drink","travel-places":"Travel and places",activities:"Activities",objects:"Objects",symbols:"Symbols",flags:"Flags"}},
»∞=':host{--emoji-size:1.375rem;--emoji-padding:0.5rem;--category-emoji-size:var(--emoji-size);--category-emoji-padding:var(--emoji-padding);--indicator-height:3px;--input-border-radius:0.5rem;--input-border-size:1px;--input-font-size:1rem;--input-line-height:1.5;--input-padding:0.25rem;--num-columns:8;--outline-size:2px;--border-size:1px;--border-radius:0;--skintone-border-radius:1rem;--category-font-size:1rem;display:flex;width:min-content;height:400px}:host,:host(.light){color-scheme:light;--background:#fff;--border-color:#e0e0e0;--indicator-color:#385ac1;--input-border-color:#999;--input-font-color:#111;--input-placeholder-color:#999;--outline-color:#999;--category-font-color:#111;--button-active-background:#e6e6e6;--button-hover-background:#d9d9d9}:host(.dark){color-scheme:dark;--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}@media (prefers-color-scheme:dark){:host{color-scheme:dark;--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}}:host([hidden]){display:none}button{margin:0;padding:0;border:0;background:0 0;box-shadow:none;-webkit-tap-highlight-color:transparent}button::-moz-focus-inner{border:0}input{padding:0;margin:0;line-height:1.15;font-family:inherit}input[type=search]{-webkit-appearance:none}:focus{outline:var(--outline-color) solid var(--outline-size);outline-offset:calc(-1*var(--outline-size))}:host([data-js-focus-visible]) :focus:not([data-focus-visible-added]){outline:0}:focus:not(:focus-visible){outline:0}.hide-focus{outline:0}*{box-sizing:border-box}.picker{contain:content;display:flex;flex-direction:column;background:var(--background);border:var(--border-size) solid var(--border-color);border-radius:var(--border-radius);width:100%;height:100%;overflow:hidden;--total-emoji-size:calc(var(--emoji-size) + (2 * var(--emoji-padding)));--total-category-emoji-size:calc(var(--category-emoji-size) + (2 * var(--category-emoji-padding)))}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hidden{opacity:0;pointer-events:none}.abs-pos{position:absolute;left:0;top:0}.gone{display:none!important}.skintone-button-wrapper,.skintone-list{background:var(--background);z-index:3}.skintone-button-wrapper.expanded{z-index:1}.skintone-list{position:absolute;inset-inline-end:0;top:0;z-index:2;overflow:visible;border-bottom:var(--border-size) solid var(--border-color);border-radius:0 0 var(--skintone-border-radius) var(--skintone-border-radius);will-change:transform;transition:transform .2s ease-in-out;transform-origin:center 0}@media (prefers-reduced-motion:reduce){.skintone-list{transition-duration:.001s}}@supports not (inset-inline-end:0){.skintone-list{right:0}}.skintone-list.no-animate{transition:none}.tabpanel{overflow-y:auto;scrollbar-gutter:stable;-webkit-overflow-scrolling:touch;will-change:transform;min-height:0;flex:1;contain:content}.emoji-menu{display:grid;grid-template-columns:repeat(var(--num-columns),var(--total-emoji-size));justify-content:space-around;align-items:flex-start;width:100%}.emoji-menu.visibility-auto{content-visibility:auto;contain-intrinsic-size:calc(var(--num-columns)*var(--total-emoji-size)) calc(var(--num-rows)*var(--total-emoji-size))}.category{padding:var(--emoji-padding);font-size:var(--category-font-size);color:var(--category-font-color)}.emoji,button.emoji{font-size:var(--emoji-size);display:flex;align-items:center;justify-content:center;border-radius:100%;height:var(--total-emoji-size);width:var(--total-emoji-size);line-height:1;overflow:hidden;font-family:var(--emoji-font-family);cursor:pointer}@media (hover:hover) and (pointer:fine){.emoji:hover,button.emoji:hover{background:var(--button-hover-background)}}.emoji.active,.emoji:active,button.emoji.active,button.emoji:active{background:var(--button-active-background)}.onscreen .custom-emoji::after{content:"";width:var(--emoji-size);height:var(--emoji-size);background-repeat:no-repeat;background-position:center center;background-size:contain;background-image:var(--custom-emoji-background)}.nav,.nav-button{align-items:center}.nav{display:grid;justify-content:space-between;contain:content}.nav-button{display:flex;justify-content:center}.nav-emoji{font-size:var(--category-emoji-size);width:var(--total-category-emoji-size);height:var(--total-category-emoji-size)}.indicator-wrapper{display:flex;border-bottom:1px solid var(--border-color)}.indicator{width:calc(100%/var(--num-groups));height:var(--indicator-height);opacity:var(--indicator-opacity);background-color:var(--indicator-color);will-change:transform,opacity;transition:opacity .1s linear,transform .25s ease-in-out}@media (prefers-reduced-motion:reduce){.indicator{will-change:opacity;transition:opacity .1s linear}}.pad-top,input.search{background:var(--background);width:100%}.pad-top{height:var(--emoji-padding);z-index:3}.search-row{display:flex;align-items:center;position:relative;padding-inline-start:var(--emoji-padding);padding-bottom:var(--emoji-padding)}.search-wrapper{flex:1;min-width:0}input.search{padding:var(--input-padding);border-radius:var(--input-border-radius);border:var(--input-border-size) solid var(--input-border-color);color:var(--input-font-color);font-size:var(--input-font-size);line-height:var(--input-line-height)}input.search::placeholder{color:var(--input-placeholder-color)}.favorites{overflow-y:auto;scrollbar-gutter:stable;display:flex;flex-direction:row;border-top:var(--border-size) solid var(--border-color);contain:content}.message{padding:var(--emoji-padding)}'
;const –å=["customEmoji","customCategorySorting","database","dataSource","i18n","locale","skinToneEmoji","emojiVersion"];class –ç extends HTMLElement{constructor(A){super(),this.attachShadow({mode:"open"});const B=document.createElement("style");B.textContent=»∞+':host{--emoji-font-family:"Twemoji Mozilla","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji","EmojiOne Color","Android Emoji",sans-serif}',this.shadowRoot.appendChild(B),this._ctx={locale:"en",
dataSource:"https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",skinToneEmoji:"üñêÔ∏è",customCategorySorting:œø,customEmoji:null,i18n:»Ø,emojiVersion:null,...A};for(const A of –å)"database"!==A&&Object.prototype.hasOwnProperty.call(this,A)&&(this._ctx[A]=this[A],delete this[A]);this._dbFlush()}connectedCallback(){this._cmp||(this._cmp=ƒÅ(this.shadowRoot,this._ctx))}disconnectedCallback(){–à((()=>{if(!this.isConnected&&this._cmp){this._cmp.$destroy(),this._cmp=void 0
;const{database:A}=this._ctx;A.close().catch((()=>{}))}}))}static get observedAttributes(){return["locale","data-source","skin-tone-emoji","emoji-version"]}attributeChangedCallback(A,B,C){this._set(A.replace(/-([a-z])/g,((A,B)=>B.toUpperCase())),"emoji-version"===A?parseFloat(C):C)}_set(A,B){this._ctx[A]=B,this._cmp&&this._cmp.$set({[A]:B}),["locale","dataSource"].includes(A)&&this._dbFlush()}_dbCreate(){const{locale:A,dataSource:B,database:C}=this._ctx
;C&&C.locale===A&&C.dataSource===B||this._set("database",new œ∫({locale:A,dataSource:B}))}_dbFlush(){–à((()=>this._dbCreate()))}}const –é={};for(const A of –å)–é[A]={get(){return"database"===A&&this._dbCreate(),this._ctx[A]},set(B){if("database"===A)throw Error("database is read-only");this._set(A,B)}};Object.defineProperties(–ç.prototype,–é),customElements.get("emoji-picker")||customElements.define("emoji-picker",–ç);const –è=Object.create(null);–è.open="0",–è.close="1",–è.ping="2",–è.pong="3",
–è.message="4",–è.upgrade="5",–è.noop="6";const –ê=Object.create(null);Object.keys(–è).forEach((A=>{–ê[–è[A]]=A}));const –ë={type:"error",data:"parser error"
},–í="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),–ì="function"==typeof ArrayBuffer,–î=A=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(A):A&&A.buffer instanceof ArrayBuffer,–ï=({type:A,data:B},C,D)=>–í&&B instanceof Blob?C?D(B):–ñ(B,D):–ì&&(B instanceof ArrayBuffer||–î(B))?C?D(B):–ñ(new Blob([B]),D):D(–è[A]+(B||"")),–ñ=(A,B)=>{const C=new FileReader;return C.onload=function(){const A=C.result.split(",")[1];B("b"+(A||""))},
C.readAsDataURL(A)};let –ó;const –ò="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",–ô="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let A=0;A<64;A++)–ô[–ò.charCodeAt(A)]=A;const –ö="function"==typeof ArrayBuffer,–õ=(A,B)=>{if("string"!=typeof A)return{type:"message",data:–ù(A,B)};const C=A.charAt(0);return"b"===C?{type:"message",data:–ú(A.substring(1),B)}:–ê[C]?A.length>1?{type:–ê[C],data:A.substring(1)}:{type:–ê[C]}:–ë},–ú=(A,B)=>{if(–ö){const C=(A=>{
let B,C,D,E,F,G=.75*A.length,H=A.length,I=0;"="===A[A.length-1]&&(G--,"="===A[A.length-2]&&G--);const J=new ArrayBuffer(G),K=new Uint8Array(J);for(B=0;B<H;B+=4)C=–ô[A.charCodeAt(B)],D=–ô[A.charCodeAt(B+1)],E=–ô[A.charCodeAt(B+2)],F=–ô[A.charCodeAt(B+3)],K[I++]=C<<2|D>>4,K[I++]=(15&D)<<4|E>>2,K[I++]=(3&E)<<6|63&F;return J})(A);return –ù(C,B)}return{base64:!0,data:A}},–ù=(A,B)=>"blob"===B?A instanceof Blob?A:new Blob([A]):A instanceof ArrayBuffer?A:A.buffer;let –û
;ƒÜ.prototype.on=ƒÜ.prototype.addEventListener=function(A,B){return this._callbacks=this._callbacks||{},(this._callbacks["$"+A]=this._callbacks["$"+A]||[]).push(B),this},ƒÜ.prototype.once=function(A,B){function C(){this.off(A,C),B.apply(this,arguments)}return C.fn=B,this.on(A,C),this},ƒÜ.prototype.off=ƒÜ.prototype.removeListener=ƒÜ.prototype.removeAllListeners=ƒÜ.prototype.removeEventListener=function(A,B){var C,D,E;if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},
this;if(!(C=this._callbacks["$"+A]))return this;if(1==arguments.length)return delete this._callbacks["$"+A],this;for(E=0;E<C.length;E++)if((D=C[E])===B||D.fn===B){C.splice(E,1);break}return 0===C.length&&delete this._callbacks["$"+A],this},ƒÜ.prototype.emit=function(A){var B,C,D,E;for(this._callbacks=this._callbacks||{},B=Array(arguments.length-1),C=this._callbacks["$"+A],D=1;D<arguments.length;D++)B[D-1]=arguments[D];if(C)for(D=0,E=(C=C.slice(0)).length;D<E;++D)C[D].apply(this,B);return this},
ƒÜ.prototype.emitReserved=ƒÜ.prototype.emit,ƒÜ.prototype.listeners=function(A){return this._callbacks=this._callbacks||{},this._callbacks["$"+A]||[]},ƒÜ.prototype.hasListeners=function(A){return!!this.listeners(A).length};const –ü="function"==typeof Promise&&"function"==typeof Promise.resolve?A=>Promise.resolve().then(A):(A,B)=>B(A,0),–†="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")(),–°=–†.setTimeout,–¢=–†.clearTimeout;class –£ extends Error{constructor(A,B,C){
super(A),this.description=B,this.context=C,this.type="TransportError"}}class –§ extends ƒÜ{constructor(A){super(),this.writable=!1,ƒà(this,A),this.opts=A,this.query=A.query,this.socket=A.socket,this.supportsBinary=!A.forceBase64}onError(A,B,C){return super.emitReserved("error",new –£(A,B,C)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(A){
"open"===this.readyState&&this.write(A)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(A){const B=–õ(A,this.socket.binaryType);this.onPacket(B)}onPacket(A){super.emitReserved("packet",A)}onClose(A){this.readyState="closed",super.emitReserved("close",A)}pause(A){}createUri(A,B={}){return A+"://"+this._hostname()+this._port()+this.opts.path+this._query(B)}_hostname(){const A=this.opts.hostname;return-1===A.indexOf(":")?A:"["+A+"]"}_port(){
return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(A){const B=function(A){let B="";for(let C in A)A.hasOwnProperty(C)&&(B.length&&(B+="&"),B+=encodeURIComponent(C)+"="+encodeURIComponent(A[C]));return B}(A);return B.length?"?"+B:""}}class –• extends –§{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(A){this.readyState="pausing";const B=()=>{
this.readyState="paused",A()};if(this._polling||!this.writable){let A=0;this._polling&&(A++,this.once("pollComplete",(function(){--A||B()}))),this.writable||(A++,this.once("drain",(function(){--A||B()})))}else B()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(A){((A,B)=>{const C=A.split(""),D=[];for(let A=0;A<C.length;A++){const E=–õ(C[A],B);if(D.push(E),"error"===E.type)break}return D})(A,this.socket.binaryType).forEach((A=>{
if("opening"===this.readyState&&"open"===A.type&&this.onOpen(),"close"===A.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(A)})),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())}doClose(){const A=()=>{this.write([{type:"close"}])};"open"===this.readyState?A():this.once("open",A)}write(A){this.writable=!1,((A,B)=>{const C=A.length,D=Array(C);let E=0;A.forEach(((A,F)=>{–ï(A,!1,(A=>{
D[F]=A,++E===C&&B(D.join(""))}))}))})(A,(A=>{this.doWrite(A,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){const A=this.opts.secure?"https":"http",B=this.query||{};return!1!==this.opts.timestampRequests&&(B[this.opts.timestampParam]=ƒâ()),this.supportsBinary||B.sid||(B.b64=1),this.createUri(A,B)}}let –¶=!1;try{–¶="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(»ï){}const –ß=–¶;class –® extends –•{constructor(A){if(super(A),"undefined"!=typeof location){
const B="https:"===location.protocol;let C=location.port;C||(C=B?"443":"80"),this.xd="undefined"!=typeof location&&A.hostname!==location.hostname||C!==A.port}}doWrite(A,B){const C=this.request({method:"POST",data:A});C.on("success",B),C.on("error",((A,B)=>{this.onError("xhr post error",A,B)}))}doPoll(){const A=this.request();A.on("data",this.onData.bind(this)),A.on("error",((A,B)=>{this.onError("xhr poll error",A,B)})),this.pollXhr=A}}class –© extends ƒÜ{constructor(A,B,C){super(),
this.createRequest=A,ƒà(this,C),this._opts=C,this._method=C.method||"GET",this._uri=B,this._data=void 0!==C.data?C.data:null,this._create()}_create(){var A;const B=ƒá(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");B.xdomain=!!this._opts.xd;const C=this._xhr=this.createRequest(B);try{C.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){C.setDisableHeaderCheck&&C.setDisableHeaderCheck(!0)
;for(let A in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(A)&&C.setRequestHeader(A,this._opts.extraHeaders[A])}}catch(A){}if("POST"===this._method)try{C.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(A){}try{C.setRequestHeader("Accept","*/*")}catch(A){}null===(A=this._opts.cookieJar)||void 0===A||A.addCookies(C),"withCredentials"in C&&(C.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(C.timeout=this._opts.requestTimeout),
C.onreadystatechange=()=>{var A;3===C.readyState&&(null===(A=this._opts.cookieJar)||void 0===A||A.parseCookies(C.getResponseHeader("set-cookie"))),4===C.readyState&&(200===C.status||1223===C.status?this._onLoad():this.setTimeoutFn((()=>{this._onError("number"==typeof C.status?C.status:0)}),0))},C.send(this._data)}catch(A){return void this.setTimeoutFn((()=>{this._onError(A)}),0)}"undefined"!=typeof document&&(this._index=–©.requestsCount++,–©.requests[this._index]=this)}_onError(A){
this.emitReserved("error",A,this._xhr),this._cleanup(!0)}_cleanup(A){if(void 0!==this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=ƒä,A)try{this._xhr.abort()}catch(A){}"undefined"!=typeof document&&delete –©.requests[this._index],this._xhr=null}}_onLoad(){const A=this._xhr.responseText;null!==A&&(this.emitReserved("data",A),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}–©.requestsCount=0,–©.requests={},
"undefined"!=typeof document&&("function"==typeof attachEvent?attachEvent("onunload",ƒã):"function"==typeof addEventListener&&addEventListener("onpagehide"in –†?"pagehide":"unload",ƒã,!1));const –™=function(){const A=ƒå({xdomain:!1});return A&&null!==A.responseType}(),–´="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class –¨ extends –§{get name(){return"websocket"}doOpen(){
const A=this.uri(),B=this.opts.protocols,C=–´?{}:ƒá(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(C.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(A,B,C)}catch(A){return this.emitReserved("error",A)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{
this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=A=>this.onClose({description:"websocket connection closed",context:A}),this.ws.onmessage=A=>this.onData(A.data),this.ws.onerror=A=>this.onError("websocket error",A)}write(A){this.writable=!1;for(let B=0;B<A.length;B++){const C=A[B],D=B===A.length-1;–ï(C,this.supportsBinary,(A=>{try{this.doWrite(C,A)}catch(A){}D&&–ü((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){
void 0!==this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const A=this.opts.secure?"wss":"ws",B=this.query||{};return this.opts.timestampRequests&&(B[this.opts.timestampParam]=ƒâ()),this.supportsBinary||(B.b64=1),this.createUri(A,B)}}const –≠=–†.WebSocket||–†.MozWebSocket,–Æ={websocket:class extends –¨{createSocket(A,B,C){return –´?new –≠(A,B,C):B?new –≠(A,B):new –≠(A)}doWrite(A,B){this.ws.send(B)}},webtransport:class extends –§{get name(){return"webtransport"}doOpen(){try{
this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(A){return this.emitReserved("error",A)}this._transport.closed.then((()=>{this.onClose()})).catch((A=>{this.onError("webtransport error",A)})),this._transport.ready.then((()=>{this._transport.createBidirectionalStream().then((A=>{const B=function(A,B){–û||(–û=new TextDecoder);const C=[];let D=0,E=-1,F=!1;return new TransformStream({transform(G,H){for(C.push(G);;){if(0===D){if(ƒÑ(C)<1)break
;const A=ƒÖ(C,1);F=!(128&~A[0]),E=127&A[0],D=E<126?3:126===E?1:2}else if(1===D){if(ƒÑ(C)<2)break;const A=ƒÖ(C,2);E=new DataView(A.buffer,A.byteOffset,A.length).getUint16(0),D=3}else if(2===D){if(ƒÑ(C)<8)break;const A=ƒÖ(C,8),B=new DataView(A.buffer,A.byteOffset,A.length),F=B.getUint32(0);if(F>2097151){H.enqueue(–ë);break}E=4294967296*F+B.getUint32(4),D=3}else{if(ƒÑ(C)<E)break;const A=ƒÖ(C,E);H.enqueue(–õ(F?A:–û.decode(A),B)),D=0}if(0===E||E>A){H.enqueue(–ë);break}}}})
}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),C=A.readable.pipeThrough(B).getReader(),D=ƒÉ();D.readable.pipeTo(A.writable),this._writer=D.writable.getWriter();const E=()=>{C.read().then((({done:A,value:B})=>{A||(this.onPacket(B),E())})).catch((()=>{}))};E();const F={type:"open"};this.query.sid&&(F.data=`{"sid":"${this.query.sid}"}`),this._writer.write(F).then((()=>this.onOpen()))}))}))}write(A){this.writable=!1;for(let B=0;B<A.length;B++){const C=A[B],D=B===A.length-1
;this._writer.write(C).then((()=>{D&&–ü((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){var A;null===(A=this._transport)||void 0===A||A.close()}},polling:class extends –®{constructor(A){super(A);const B=A&&A.forceBase64;this.supportsBinary=–™&&!B}request(A={}){return Object.assign(A,{xd:this.xd},this.opts),new –©(ƒå,this.uri(),A)}}
},–Ø=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,–∞=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],–±="function"==typeof addEventListener&&"function"==typeof removeEventListener,–≤=[]
;–±&&addEventListener("offline",(()=>{–≤.forEach((A=>A()))}),!1);class –≥ extends ƒÜ{constructor(A,B){if(super(),this.binaryType="arraybuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,A&&"object"==typeof A&&(B=A,A=null),A){const C=ƒç(A);B.hostname=C.host,B.secure="https"===C.protocol||"wss"===C.protocol,B.port=C.port,C.query&&(B.query=C.query)}else B.host&&(B.hostname=ƒç(B.host).host);ƒà(this,B),
this.secure=null!=B.secure?B.secure:"undefined"!=typeof location&&"https:"===location.protocol,B.hostname&&!B.port&&(B.port=this.secure?"443":"80"),this.hostname=B.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=B.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},B.transports.forEach((A=>{const B=A.prototype.name;this.transports.push(B),this._transportsByName[B]=A})),
this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},B),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(A){let B={},C=A.split("&");for(let A=0,D=C.length;A<D;A++){let D=C[A].split("=")
;B[decodeURIComponent(D[0])]=decodeURIComponent(D[1])}return B}(this.opts.query)),–±&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},–≤.push(this._offlineEventListener))),
this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(A){const B=Object.assign({},this.opts.query);B.EIO=4,B.transport=A,this.id&&(B.sid=this.id);const C=Object.assign({},this.opts,{query:B,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[A]);return new this._transportsByName[A](C)}_open(){if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0)
;const A=this.opts.rememberUpgrade&&–≥.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";const B=this.createTransport(A);B.open(),this.setTransport(B)}setTransport(A){this.transport&&this.transport.removeAllListeners(),this.transport=A,A.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",(A=>this._onClose("transport close",A)))}onOpen(){
this.readyState="open",–≥.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(A){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",A),this.emitReserved("heartbeat"),A.type){case"open":this.onHandshake(JSON.parse(A.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":
const B=Error("server error");B.code=A.data,this._onError(B);break;case"message":this.emitReserved("data",A.data),this.emitReserved("message",A.data)}}onHandshake(A){this.emitReserved("handshake",A),this.id=A.sid,this.transport.query.sid=A.sid,this._pingInterval=A.pingInterval,this._pingTimeout=A.pingTimeout,this._maxPayload=A.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer)
;const A=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+A,this._pingTimeoutTimer=this.setTimeoutFn((()=>{this._onClose("ping timeout")}),A),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){
const A=this._getWritablePackets();this.transport.send(A),this._prevBufferLen=A.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let A=1;for(let C=0;C<this.writeBuffer.length;C++){const D=this.writeBuffer[C].data;if(D&&(A+="string"==typeof(B=D)?function(A){let B=0,C=0;for(let D=0,E=A.length;D<E;D++)B=A.charCodeAt(D),B<128?C+=1:B<2048?C+=2:B<55296||B>=57344?C+=3:(D++,C+=4);return C
}(B):Math.ceil(1.33*(B.byteLength||B.size))),C>0&&A>this._maxPayload)return this.writeBuffer.slice(0,C);A+=2}var B;return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const A=Date.now()>this._pingTimeoutTime;return A&&(this._pingTimeoutTime=0,–ü((()=>{this._onClose("ping timeout")}),this.setTimeoutFn)),A}write(A,B,C){return this._sendPacket("message",A,B,C),this}send(A,B,C){return this._sendPacket("message",A,B,C),this}_sendPacket(A,B,C,D){if("function"==typeof B&&(D=B,
B=void 0),"function"==typeof C&&(D=C,C=null),"closing"===this.readyState||"closed"===this.readyState)return;(C=C||{}).compress=!1!==C.compress;const E={type:A,data:B,options:C};this.emitReserved("packetCreate",E),this.writeBuffer.push(E),D&&this.once("flush",D),this.flush()}close(){const A=()=>{this._onClose("forced close"),this.transport.close()},B=()=>{this.off("upgrade",B),this.off("upgradeError",B),A()},C=()=>{this.once("upgrade",B),this.once("upgradeError",B)}
;return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?C():A()})):this.upgrading?C():A()),this}_onError(A){if(–≥.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",A),this._onClose("transport error",A)}_onClose(A,B){
if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),–±&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const A=–≤.indexOf(this._offlineEventListener);-1!==A&&–≤.splice(A,1)}this.readyState="closed",this.id=null,
this.emitReserved("close",A,B),this.writeBuffer=[],this._prevBufferLen=0}}}–≥.protocol=4;class –¥ extends –≥{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade)for(let A=0;A<this._upgrades.length;A++)this._probe(this._upgrades[A])}_probe(A){function B(){G||(G=!0,J(),F.close(),F=null)}function C(){I("transport closed")}function D(){I("socket closed")}function E(A){F&&A.name!==F.name&&B()}let F=this.createTransport(A),G=!1
;–≥.priorWebsocketSuccess=!1;const H=()=>{G||(F.send([{type:"ping",data:"probe"}]),F.once("packet",(A=>{if(!G)if("pong"===A.type&&"probe"===A.data){if(this.upgrading=!0,this.emitReserved("upgrading",F),!F)return;–≥.priorWebsocketSuccess="websocket"===F.name,this.transport.pause((()=>{G||"closed"!==this.readyState&&(J(),this.setTransport(F),F.send([{type:"upgrade"}]),this.emitReserved("upgrade",F),F=null,this.upgrading=!1,this.flush())}))}else{const A=Error("probe error");A.transport=F.name,
this.emitReserved("upgradeError",A)}})))},I=A=>{const C=Error("probe error: "+A);C.transport=F.name,B(),this.emitReserved("upgradeError",C)},J=()=>{F.removeListener("open",H),F.removeListener("error",I),F.removeListener("close",C),this.off("close",D),this.off("upgrading",E)};F.once("open",H),F.once("error",I),F.once("close",C),this.once("close",D),this.once("upgrading",E),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==A?this.setTimeoutFn((()=>{G||F.open()}),200):F.open()}
onHandshake(A){this._upgrades=this._filterUpgrades(A.upgrades),super.onHandshake(A)}_filterUpgrades(A){const B=[];for(let C=0;C<A.length;C++)~this.transports.indexOf(A[C])&&B.push(A[C]);return B}}class –µ extends –¥{constructor(A,B={}){const C="object"==typeof A?A:B;(!C.transports||C.transports&&"string"==typeof C.transports[0])&&(C.transports=(C.transports||["polling","websocket","webtransport"]).map((A=>–Æ[A])).filter((A=>!!A))),super(A,C)}}const –∂=Number.isFinite||function(A){
return"number"==typeof A&&isFinite(A)},–∑=Number.isSafeInteger||function(A){return"number"==typeof A&&Math.abs(A)<=–∏},–∏=Number.MAX_SAFE_INTEGER||9007199254740991;let –π=function(A){return A.NETWORK_ERROR="networkError",A.MEDIA_ERROR="mediaError",A.KEY_SYSTEM_ERROR="keySystemError",A.MUX_ERROR="muxError",A.OTHER_ERROR="otherError",A}({}),–∫=function(A){return A.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",A.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",A.KEY_SYSTEM_NO_SESSION="keySystemNoSession",
A.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",A.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",A.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",A.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",A.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",A.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",
A.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",A.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",A.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",A.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",A.MANIFEST_LOAD_ERROR="manifestLoadError",A.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",A.MANIFEST_PARSING_ERROR="manifestParsingError",A.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",
A.LEVEL_EMPTY_ERROR="levelEmptyError",A.LEVEL_LOAD_ERROR="levelLoadError",A.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",A.LEVEL_PARSING_ERROR="levelParsingError",A.LEVEL_SWITCH_ERROR="levelSwitchError",A.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",A.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",A.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",A.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",A.FRAG_LOAD_ERROR="fragLoadError",A.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",
A.FRAG_DECRYPT_ERROR="fragDecryptError",A.FRAG_PARSING_ERROR="fragParsingError",A.FRAG_GAP="fragGap",A.REMUX_ALLOC_ERROR="remuxAllocError",A.KEY_LOAD_ERROR="keyLoadError",A.KEY_LOAD_TIMEOUT="keyLoadTimeOut",A.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",A.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",A.BUFFER_APPEND_ERROR="bufferAppendError",A.BUFFER_APPENDING_ERROR="bufferAppendingError",A.BUFFER_STALLED_ERROR="bufferStalledError",A.BUFFER_FULL_ERROR="bufferFullError",
A.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",A.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",A.ASSET_LIST_LOAD_ERROR="assetListLoadError",A.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",A.ASSET_LIST_PARSING_ERROR="assetListParsingError",A.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",A.INTERNAL_EXCEPTION="internalException",A.INTERNAL_ABORTED="aborted",A.ATTACH_MEDIA_ERROR="attachMediaError",A.UNKNOWN="unknown",A}({}),–ª=function(A){return A.MEDIA_ATTACHING="hlsMediaAttaching",
A.MEDIA_ATTACHED="hlsMediaAttached",A.MEDIA_DETACHING="hlsMediaDetaching",A.MEDIA_DETACHED="hlsMediaDetached",A.MEDIA_ENDED="hlsMediaEnded",A.STALL_RESOLVED="hlsStallResolved",A.BUFFER_RESET="hlsBufferReset",A.BUFFER_CODECS="hlsBufferCodecs",A.BUFFER_CREATED="hlsBufferCreated",A.BUFFER_APPENDING="hlsBufferAppending",A.BUFFER_APPENDED="hlsBufferAppended",A.BUFFER_EOS="hlsBufferEos",A.BUFFERED_TO_END="hlsBufferedToEnd",A.BUFFER_FLUSHING="hlsBufferFlushing",A.BUFFER_FLUSHED="hlsBufferFlushed",
A.MANIFEST_LOADING="hlsManifestLoading",A.MANIFEST_LOADED="hlsManifestLoaded",A.MANIFEST_PARSED="hlsManifestParsed",A.LEVEL_SWITCHING="hlsLevelSwitching",A.LEVEL_SWITCHED="hlsLevelSwitched",A.LEVEL_LOADING="hlsLevelLoading",A.LEVEL_LOADED="hlsLevelLoaded",A.LEVEL_UPDATED="hlsLevelUpdated",A.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",A.LEVELS_UPDATED="hlsLevelsUpdated",A.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",A.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",
A.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",A.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",A.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",A.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",A.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",A.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",A.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",A.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",A.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",A.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",
A.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",A.CUES_PARSED="hlsCuesParsed",A.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",A.INIT_PTS_FOUND="hlsInitPtsFound",A.FRAG_LOADING="hlsFragLoading",A.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",A.FRAG_LOADED="hlsFragLoaded",A.FRAG_DECRYPTED="hlsFragDecrypted",A.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",A.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",A.FRAG_PARSING_METADATA="hlsFragParsingMetadata",
A.FRAG_PARSED="hlsFragParsed",A.FRAG_BUFFERED="hlsFragBuffered",A.FRAG_CHANGED="hlsFragChanged",A.FPS_DROP="hlsFpsDrop",A.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",A.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",A.ERROR="hlsError",A.DESTROYING="hlsDestroying",A.KEY_LOADING="hlsKeyLoading",A.KEY_LOADED="hlsKeyLoaded",A.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",A.BACK_BUFFER_REACHED="hlsBackBufferReached",A.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",
A.ASSET_LIST_LOADING="hlsAssetListLoading",A.ASSET_LIST_LOADED="hlsAssetListLoaded",A.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",A.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",A.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",A.INTERSTITIAL_STARTED="hlsInterstitialStarted",A.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",A.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",A.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",
A.INTERSTITIAL_ENDED="hlsInterstitialEnded",A.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",A.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",A.EVENT_CUE_ENTER="hlsEventCueEnter",A}({});»±="manifest",»≤="level",»≥="audioTrack",»¥="subtitleTrack",»µ="main",»∂="audio",»∑="subtitle";class –º{constructor(A,B=0,C=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=A,this.alpha_=A?Math.exp(Math.log(.5)/A):0,this.estimate_=B,
this.totalWeight_=C}sample(A,B){const C=Math.pow(this.alpha_,A);this.estimate_=B*(1-C)+C*this.estimate_,this.totalWeight_+=A}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const A=1-Math.pow(this.alpha_,this.totalWeight_);if(A)return this.estimate_/A}return this.estimate_}}class –Ω{constructor(A,B,C,D=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,
this.defaultEstimate_=C,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new –º(A),this.fast_=new –º(B),this.defaultTTFB_=D,this.ttfb_=new –º(A)}update(A,B){const{slow_:C,fast_:D,ttfb_:E}=this;C.halfLife!==A&&(this.slow_=new –º(A,C.getEstimate(),C.getTotalWeight())),D.halfLife!==B&&(this.fast_=new –º(B,D.getEstimate(),D.getTotalWeight())),E.halfLife!==A&&(this.ttfb_=new –º(A,E.getEstimate(),E.getTotalWeight()))}sample(A,B){const C=(A=Math.max(A,this.minDelayMs_))/1e3,D=8*B/C;this.fast_.sample(C,D),
this.slow_.sample(C,D)}sampleTTFB(A){const B=A/1e3,C=Math.sqrt(2)*Math.exp(-Math.pow(B,2)/2);this.ttfb_.sample(C,Math.max(A,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}class –æ{
constructor(A,B){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const C=`[${A}]:`;this.trace=–ø,this.debug=B.debug.bind(null,C),this.log=B.log.bind(null,C),this.warn=B.warn.bind(null,C),this.info=B.info.bind(null,C),this.error=B.error.bind(null,C)}}const –ø=function(){},—Ä={trace:–ø,debug:–ø,log:–ø,warn:–ø,info:–ø,error:–ø},—Å=ƒí(),—Ç=—Å,—É=function(A){let B="";for(let C=0;C<A.length;C++){let D=A[C].toString(16);D.length<2&&(D="0"+D),B+=D}return B};»∏={
exports:{}},»π||(»π=1,…ù=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,…û=/^(?=([^\/?#]*))\1([^]*)$/,…ü=/(?:\/|^)\.(?=\/)/g,…†=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,…°={buildAbsoluteURL:function(A,B,C){var D,E,F,G,H,I,J;if(C=C||{},A=A.trim(),!(B=B.trim())){if(!C.alwaysNormalize)return A;if(!(D=…°.parseURL(A)))throw Error("Error trying to parse base URL.");return D.path=…°.normalizePath(D.path),…°.buildURLFromParts(D)}
if(!(E=…°.parseURL(B)))throw Error("Error trying to parse relative URL.");if(E.scheme)return C.alwaysNormalize?(E.path=…°.normalizePath(E.path),…°.buildURLFromParts(E)):B;if(!(F=…°.parseURL(A)))throw Error("Error trying to parse base URL.");return!F.netLoc&&F.path&&"/"!==F.path[0]&&(G=…û.exec(F.path),F.netLoc=G[1],F.path=G[2]),F.netLoc&&!F.path&&(F.path="/"),H={scheme:F.scheme,netLoc:E.netLoc,path:null,params:E.params,query:E.query,fragment:E.fragment},E.netLoc||(H.netLoc=F.netLoc,
"/"!==E.path[0]&&(E.path?(J=(I=F.path).substring(0,I.lastIndexOf("/")+1)+E.path,H.path=…°.normalizePath(J)):(H.path=F.path,E.params||(H.params=F.params,E.query||(H.query=F.query))))),null===H.path&&(H.path=C.alwaysNormalize?…°.normalizePath(E.path):E.path),…°.buildURLFromParts(H)},parseURL:function(A){var B=…ù.exec(A);return B?{scheme:B[1]||"",netLoc:B[2]||"",path:B[3]||"",params:B[4]||"",query:B[5]||"",fragment:B[6]||""}:null},normalizePath:function(A){
for(A=A.split("").reverse().join("").replace(…ü,"");A.length!==(A=A.replace(…†,"")).length;);return A.split("").reverse().join("")},buildURLFromParts:function(A){return A.scheme+A.netLoc+A.path+A.params+A.query+A.fragment}},»∏.exports=…°),»∫=»∏.exports;class —Ñ{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}»ª="audio",»º="video",
»Ω="audiovideo";class —Ö{constructor(A){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,"string"==typeof A&&(A={url:A}),this.base=A,ƒö(this,"stats")}setByteRange(A,B){const C=A.split("@",2);let D;D=1===C.length?(null==B?void 0:B.byteRangeEndOffset)||0:parseInt(C[1]),this._byteRange=[D,parseInt(C[0])+D]}get baseurl(){return this.base.url}get byteRange(){return null===this._byteRange?[]:this._byteRange}get byteRangeStartOffset(){
return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return null===this._streams&&(this._streams={[»ª]:null,[»º]:null,[»Ω]:null}),this._streams}set elementaryStreams(A){this._streams=A}get hasStats(){return null!==this._stats}get hasStreams(){return null!==this._streams}get stats(){return null===this._stats&&(this._stats=new —Ñ),this._stats}set stats(A){this._stats=A}get url(){
return!this._url&&this.baseurl&&this.relurl&&(this._url=»∫.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(A){this._url=A}clearElementaryStreamInfo(){const{elementaryStreams:A}=this;A[»ª]=null,A[»º]=null,A[»Ω]=null}}class —Ü extends —Ö{constructor(A,B){super(B),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,
this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=A}get byteLength(){if(this.hasStats){const A=this.stats.total;if(A)return A}if(this.byteRange){
const A=this.byteRange[0],B=this.byteRange[1];if(–∂(A)&&–∂(B))return B-A}return null}get bitrate(){return this.byteLength?8*this.byteLength/this.duration:this._bitrate?this._bitrate:null}set bitrate(A){this._bitrate=A}get decryptdata(){const{levelkeys:A}=this;if(!A&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const A=this.levelkeys.identity;if(A)this._decryptdata=A.getDecryptData(this.sn);else{const A=Object.keys(this.levelkeys)
;if(1===A.length)return this._decryptdata=this.levelkeys[A[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;const A=–∂(this.duration)?this.duration:0;return this.programDateTime+1e3*A}get encrypted(){var A;if(null!=(A=this._decryptdata)&&A.encrypted)return!0;if(this.levelkeys){const A=Object.keys(this.levelkeys),B=A.length;if(B>1||1===B&&this.levelkeys[A[0]].encrypted)return!0}
return!1}get programDateTime(){return null===this._programDateTime&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(A){–∂(A)?this._programDateTime=A:this._programDateTime=this.rawProgramDateTime=null}get ref(){return ƒò(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(A){this.setStart(this.start+A)}setStart(A){
this.start=A,this._ref&&(this._ref.start=A)}setDuration(A){this.duration=A,this._ref&&(this._ref.duration=A)}setKeyFormat(A){if(this.levelkeys){const B=this.levelkeys[A];B&&!this._decryptdata&&(this._decryptdata=B.getDecryptData(this.sn))}}abortRequests(){var A,B;null==(A=this.loader)||A.abort(),null==(B=this.keyLoader)||B.abort()}setElementaryStreamInfo(A,B,C,D,E,F=!1){const{elementaryStreams:G}=this,H=G[A];H?(H.startPTS=Math.min(H.startPTS,B),H.endPTS=Math.max(H.endPTS,C),
H.startDTS=Math.min(H.startDTS,D),H.endDTS=Math.max(H.endDTS,E)):G[A]={startPTS:B,endPTS:C,startDTS:D,endDTS:E,partial:F}}}class —á extends —Ö{constructor(A,B,C,D,E){super(C),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=A.decimalFloatingPoint("DURATION"),this.gap=A.bool("GAP"),this.independent=A.bool("INDEPENDENT"),this.relurl=A.enumeratedString("URI"),this.fragment=B,this.index=D
;const F=A.enumeratedString("BYTERANGE");F&&this.setByteRange(F,E),E&&(this.fragOffset=E.fragOffset+E.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:A}=this;return!!(A.audio||A.video||A.audiovideo)}}const —à=4294967295,—â=[].push,—ä={video:1,audio:2,id3:3,text:4},—ã=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),—å={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,
dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}},—ç={},—é=/flac|opus|mp4a\.40\.34/i,—è={supported:!0,
configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},—ê={},—ë=["NONE","TYPE-0","TYPE-1",null],—í=["SDR","PQ","HLG"];»æ="",»ø="YES",…Ä="v2";class —ì{constructor(A,B,C){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=A,this.part=B,this.skip=C}addDirectives(A){const B=new self.URL(A);return void 0!==this.msn&&B.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&B.searchParams.set("_HLS_part",this.part.toString()),
this.skip&&B.searchParams.set("_HLS_skip",this.skip),B.href}}class —î{constructor(A){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,
this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[A.url],this._attrs=[A.attrs],this.bitrate=A.bitrate,A.details&&(this.details=A.details),this.id=A.id||0,this.name=A.name,this.width=A.width||0,this.height=A.height||0,this.frameRate=A.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=A.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=A.audioCodec,this.videoCodec=A.videoCodec,
this.codecSet=[A.videoCodec,A.audioCodec].filter((A=>!!A)).map((A=>A.substring(0,4))).join(","),"supplemental"in A){var B;this.supplemental=A.supplemental;const C=null==(B=A.supplemental)?void 0:B.videoCodec;C&&C!==A.videoCodec&&(this.codecSet+=","+C.substring(0,4))}this.addGroupId("audio",A.attrs.AUDIO),this.addGroupId("text",A.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}
get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(A){return ≈Å(this._audioGroups,A)}hasSubtitleGroup(A){return ≈Å(this._subtitleGroups,A)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(A,B){
if(B)if("audio"===A){let A=this._audioGroups;A||(A=this._audioGroups=[]),-1===A.indexOf(B)&&A.push(B)}else if("text"===A){let A=this._subtitleGroups;A||(A=this._subtitleGroups=[]),-1===A.indexOf(B)&&A.push(B)}}get urlId(){return 0}set urlId(A){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var A;return null==(A=this.audioGroups)?void 0:A[0]}get textGroupId(){var A
;return null==(A=this.subtitleGroups)?void 0:A[0]}addFallback(){}}const —ï=(A,B)=>JSON.stringify(A,(A=>{const B=new WeakSet;return(C,D)=>{if(A&&(D=A(C,D)),"object"==typeof D&&null!==D){if(B.has(D))return;B.add(D)}return D}})(B)),—ñ=function(A,B){let C=0,D=A.length-1,E=null,F=null;for(;C<=D;){E=(C+D)/2|0,F=A[E];const G=B(F);if(G>0)C=E+1;else{if(!(G<0))return F;D=E-1}}return null};…Å=0,…Ç=2,…É=3,…Ñ=5,…Ö=0,…Ü=1,…á=2,…à="NOT_LOADED",…â="APPENDING",…ä="PARTIAL",…ã="OK";class —ó{constructor(A){
this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=A,this._registerListeners()}_registerListeners(){const{hls:A}=this;A.on(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.on(–ª.BUFFER_APPENDED,this.onBufferAppended,this),A.on(–ª.FRAG_BUFFERED,this.onFragBuffered,this),A.on(–ª.FRAG_LOADED,this.onFragLoaded,this)}
_unregisterListeners(){const{hls:A}=this;A.off(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.off(–ª.BUFFER_APPENDED,this.onBufferAppended,this),A.off(–ª.FRAG_BUFFERED,this.onFragBuffered,this),A.off(–ª.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(A,B){const C=this.activePartLists[B];if(C)for(let B=C.length;B--;){const D=C[B];if(!D)break;const E=D.end
;if(D.start<=A&&null!==E&&A<=E)return D}return this.getBufferedFrag(A,B)}getBufferedFrag(A,B){return this.getFragAtPos(A,B,!0)}getFragAtPos(A,B,C){const{fragments:D}=this,E=Object.keys(D);for(let F=E.length;F--;){const G=D[E[F]];if((null==G?void 0:G.body.type)===B&&(!C||G.buffered)){const B=G.body;if(B.start<=A&&A<=B.end)return B}}return null}detectEvictedFragments(A,B,C,D,E){this.timeRanges&&(this.timeRanges[A]=B);const F=(null==D?void 0:D.fragment.sn)||-1
;Object.keys(this.fragments).forEach((D=>{const G=this.fragments[D];if(!G)return;if(F>=G.body.sn)return;if(!G.buffered&&(!G.loaded||E))return void(G.body.type===C&&this.removeFragment(G.body));const H=G.range[A];H&&(0!==H.time.length?H.time.some((A=>{const C=!this.isTimeBuffered(A.startPTS,A.endPTS,B);return C&&this.removeFragment(G.body),C})):this.removeFragment(G.body))}))}detectPartialFragments(A){const B=this.timeRanges;if(!B||"initSegment"===A.frag.sn)return
;const C=A.frag,D=≈ñ(C),E=this.fragments[D];if(!E||E.buffered&&C.gap)return;const F=!C.relurl;Object.keys(B).forEach((D=>{const G=C.elementaryStreams[D];if(!G)return;const H=B[D],I=F||!0===G.partial;E.range[D]=this.getBufferedTimes(C,A.part,I,H)})),E.loaded=null,Object.keys(E.range).length?(E.buffered=!0,(E.body.endList=C.endList||E.body.endList)&&(this.endListFragments[E.body.type]=E),≈ï(E)||this.removeParts(C.sn-1,C.type)):this.removeFragment(E.body)}removeParts(A,B){
const C=this.activePartLists[B];C&&(this.activePartLists[B]=≈ó(C,(B=>B.fragment.sn>=A)))}fragBuffered(A,B){const C=≈ñ(A);let D=this.fragments[C];!D&&B&&(D=this.fragments[C]={body:A,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},A.gap&&(this.hasGaps=!0)),D&&(D.loaded=null,D.buffered=!0)}getBufferedTimes(A,B,C,D){const E={time:[],partial:C},F=A.start,G=A.end,H=A.minEndPTS||G,I=A.maxStartPTS||F;for(let A=0;A<D.length;A++){
const B=D.start(A)-this.bufferPadding,C=D.end(A)+this.bufferPadding;if(I>=B&&H<=C){E.time.push({startPTS:Math.max(F,D.start(A)),endPTS:Math.min(G,D.end(A))});break}if(F<C&&G>B){const B=Math.max(F,D.start(A)),C=Math.min(G,D.end(A));C>B&&(E.partial=!0,E.time.push({startPTS:B,endPTS:C}))}else if(G<=B)break}return E}getPartialFragment(A){let B,C,D,E=null,F=0;const{bufferPadding:G,fragments:H}=this;return Object.keys(H).forEach((I=>{const J=H[I];J&&≈ï(J)&&(C=J.body.start-G,D=J.body.end+G,
A>=C&&A<=D&&(B=Math.min(A-C,D-A),F<=B&&(E=J.body,F=B)))})),E}isEndListAppended(A){const B=this.endListFragments[A];return void 0!==B&&(B.buffered||≈ï(B))}getState(A){const B=≈ñ(A),C=this.fragments[B];return C?C.buffered?≈ï(C)?…ä:…ã:…â:…à}isTimeBuffered(A,B,C){let D,E;for(let F=0;F<C.length;F++){if(D=C.start(F)-this.bufferPadding,E=C.end(F)+this.bufferPadding,A>=D&&B<=E)return!0;if(B<=D)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(A,B){
if("initSegment"===B.frag.sn||B.frag.bitrateTest)return;const C=B.frag,D=B.part?null:B,E=≈ñ(C);this.fragments[E]={body:C,appendedPTS:null,loaded:D,buffered:!1,range:Object.create(null)}}onBufferAppended(A,B){const{frag:C,part:D,timeRanges:E,type:F}=B;if("initSegment"===C.sn)return;const G=C.type;if(D){let A=this.activePartLists[G];A||(this.activePartLists[G]=A=[]),A.push(D)}this.timeRanges=E;const H=E[F];this.detectEvictedFragments(F,H,G,D)}onFragBuffered(A,B){this.detectPartialFragments(B)}
hasFragment(A){const B=≈ñ(A);return!!this.fragments[B]}hasFragments(A){const{fragments:B}=this,C=Object.keys(B);if(!A)return C.length>0;for(let D=C.length;D--;){const E=B[C[D]];if((null==E?void 0:E.body.type)===A)return!0}return!1}hasParts(A){var B;return!(null==(B=this.activePartLists[A])||!B.length)}removeFragmentsInRange(A,B,C,D,E){D&&!this.hasGaps||Object.keys(this.fragments).forEach((F=>{const G=this.fragments[F];if(!G)return;const H=G.body
;H.type!==C||D&&!H.gap||H.start<B&&H.end>A&&(G.buffered||E)&&this.removeFragment(H)}))}removeFragment(A){const B=≈ñ(A);A.clearElementaryStreamInfo();const C=this.activePartLists[A.type];if(C){const B=A.sn;this.activePartLists[A.type]=≈ó(C,(A=>A.fragment.sn!==B))}delete this.fragments[B],A.endList&&delete this.endListFragments[A.type]}removeAllFragments(){var A,B;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1
;const C=null==(A=this.hls)||null==(B=A.latestLevelDetails)?void 0:B.partList;C&&C.forEach((A=>A.clearElementaryStreamInfo()))}}…å=0,…ç=1;class —ò{constructor(A,B,C){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=A,this.aesIV=B,this.aesMode=C}decrypt(A,B){switch(this.aesMode){case …å:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},B,A);case …ç:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},B,A);default:
throw Error("[AESCrypto] invalid aes mode "+this.aesMode)}}}class —ô{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,
this.initTable()}uint8ArrayToUint32Array_(A){const B=new DataView(A),C=new Uint32Array(4);for(let A=0;A<4;A++)C[A]=B.getUint32(4*A);return C}initTable(){const A=this.sBox,B=this.invSBox,C=this.subMix,D=C[0],E=C[1],F=C[2],G=C[3],H=this.invSubMix,I=H[0],J=H[1],K=H[2],L=H[3],M=new Uint32Array(256);let N=0,O=0,P=0;for(P=0;P<256;P++)M[P]=P<128?P<<1:P<<1^283;for(P=0;P<256;P++){let C=O^O<<1^O<<2^O<<3^O<<4;C=C>>>8^255&C^99,A[N]=C,B[C]=N;const H=M[N],P=M[H],Q=M[P];let R=257*M[C]^16843008*C
;D[N]=R<<24|R>>>8,E[N]=R<<16|R>>>16,F[N]=R<<8|R>>>24,G[N]=R,R=16843009*Q^65537*P^257*H^16843008*N,I[C]=R<<24|R>>>8,J[C]=R<<16|R>>>16,K[C]=R<<8|R>>>24,L[C]=R,N?(N=H^M[M[M[Q^H]]],O^=M[M[O]]):N=O=1}}expandKey(A){const B=this.uint8ArrayToUint32Array_(A);let C=!0,D=0;for(;D<B.length&&C;)C=B[D]===this.key[D],D++;if(C)return;this.key=B;const E=this.keySize=B.length;if(4!==E&&6!==E&&8!==E)throw Error("Invalid aes key size="+E);const F=this.ksRows=4*(E+6+1);let G,H
;const I=this.keySchedule=new Uint32Array(F),J=this.invKeySchedule=new Uint32Array(F),K=this.sBox,L=this.rcon,M=this.invSubMix,N=M[0],O=M[1],P=M[2],Q=M[3];let R,S;for(G=0;G<F;G++)G<E?R=I[G]=B[G]:(S=R,G%E===0?(S=S<<8|S>>>24,S=K[S>>>24]<<24|K[S>>>16&255]<<16|K[S>>>8&255]<<8|K[255&S],S^=L[G/E|0]<<24):E>6&&G%E===4&&(S=K[S>>>24]<<24|K[S>>>16&255]<<16|K[S>>>8&255]<<8|K[255&S]),I[G]=R=(I[G-E]^S)>>>0);for(H=0;H<F;H++)G=F-H,S=3&H?I[G]:I[G-4],
J[H]=H<4||G<=4?S:N[K[S>>>24]]^O[K[S>>>16&255]]^P[K[S>>>8&255]]^Q[K[255&S]],J[H]=J[H]>>>0}networkToHostOrderSwap(A){return A<<24|(65280&A)<<8|(16711680&A)>>8|A>>>24}decrypt(A,B,C){const D=this.keySize+6,E=this.invKeySchedule,F=this.invSBox,G=this.invSubMix,H=G[0],I=G[1],J=G[2],K=G[3],L=this.uint8ArrayToUint32Array_(C);let M=L[0],N=L[1],O=L[2],P=L[3];const Q=new Int32Array(A),R=new Int32Array(Q.length);let S,T,U,V,W,X,Y,Z,a,b,c,d,e,f;const g=this.networkToHostOrderSwap;for(;B<Q.length;){
for(a=g(Q[B]),b=g(Q[B+1]),c=g(Q[B+2]),d=g(Q[B+3]),W=a^E[0],X=d^E[1],Y=c^E[2],Z=b^E[3],e=4,f=1;f<D;f++)S=H[W>>>24]^I[X>>16&255]^J[Y>>8&255]^K[255&Z]^E[e],T=H[X>>>24]^I[Y>>16&255]^J[Z>>8&255]^K[255&W]^E[e+1],U=H[Y>>>24]^I[Z>>16&255]^J[W>>8&255]^K[255&X]^E[e+2],V=H[Z>>>24]^I[W>>16&255]^J[X>>8&255]^K[255&Y]^E[e+3],W=S,X=T,Y=U,Z=V,e+=4;S=F[W>>>24]<<24^F[X>>16&255]<<16^F[Y>>8&255]<<8^F[255&Z]^E[e],T=F[X>>>24]<<24^F[Y>>16&255]<<16^F[Z>>8&255]<<8^F[255&W]^E[e+1],
U=F[Y>>>24]<<24^F[Z>>16&255]<<16^F[W>>8&255]<<8^F[255&X]^E[e+2],V=F[Z>>>24]<<24^F[W>>16&255]<<16^F[X>>8&255]<<8^F[255&Y]^E[e+3],R[B]=g(S^M),R[B+1]=g(V^N),R[B+2]=g(U^O),R[B+3]=g(T^P),M=a,N=b,O=c,P=d,B+=4}return R.buffer}}class —ö{constructor(A,B,C){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=A,this.key=B,this.aesMode=C}expandKey(){const A=function(A){switch(A){case …å:return"AES-CBC";case …ç:return"AES-CTR";default:throw Error("[FastAESKey] invalid aes mode "+A)}
}(this.aesMode);return this.subtle.importKey("raw",this.key,{name:A},!1,["encrypt","decrypt"])}}class —õ{constructor(A,{removePKCS7Padding:B=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=A.enableSoftwareAES,this.removePKCS7Padding=B,B)try{const A=self.crypto
;A&&(this.subtle=A.subtle||A.webkitSubtle)}catch(A){}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:A,remainderData:B}=this;if(!A||B)return this.reset(),null;const C=new Uint8Array(A);return this.reset(),this.removePKCS7Padding?function(A){
const B=A.byteLength,C=B&&new DataView(A.buffer).getUint8(B-1);return C?A.slice(0,B-C):A}(C):C}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(A,B,C,D){return this.useSoftware?new Promise(((E,F)=>{const G=ArrayBuffer.isView(A)?A:new Uint8Array(A);this.softwareDecrypt(G,B,C,D);const H=this.flush();H?E(H.buffer):F(Error("[softwareDecrypt] Failed to decrypt data"))
})):this.webCryptoDecrypt(new Uint8Array(A),B,C,D)}softwareDecrypt(A,B,C,D){const{currentIV:E,currentResult:F,remainderData:G}=this;if(D!==…å||16!==B.byteLength)return —Ç.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),G&&(A=ƒ™(G,A),this.remainderData=null);const H=this.getValidChunk(A);if(!H.length)return null;E&&(C=E);let I=this.softwareDecrypter;I||(I=this.softwareDecrypter=new —ô),I.expandKey(B);const J=F;return this.currentResult=I.decrypt(H.buffer,0,C),
this.currentIV=H.slice(-16).buffer,J||null}webCryptoDecrypt(A,B,C,D){if(this.key!==B||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(A,B,C,D));this.key=B,this.fastAesKey=new —ö(this.subtle,B,D)}return this.fastAesKey.expandKey().then((B=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),
new —ò(this.subtle,new Uint8Array(C),D).decrypt(A.buffer,B)):Promise.reject(Error("web crypto not initialized")))).catch((E=>(—Ç.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${E.name}: ${E.message}`),this.onWebCryptoError(A,B,C,D))))}onWebCryptoError(A,B,C,D){const E=this.enableSoftwareAES;if(E){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(A,B,C,D);const E=this.flush();if(E)return E.buffer}
throw Error("WebCrypto"+(E?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(A){let B=A;const C=A.length-A.length%16;return C!==A.length&&(B=A.slice(0,C),this.remainderData=A.slice(C)),B}logOnce(A){this.logEnabled&&(—Ç.log("[decrypter]: "+A),this.logEnabled=!1)}}const —ú=131072;class —ù{constructor(A){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=A}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}
load(A,B){const C=A.url;if(!C)return Promise.reject(new —û({type:–π.NETWORK_ERROR,details:–∫.FRAG_LOAD_ERROR,fatal:!1,frag:A,error:Error("Fragment does not have a "+(C?"part list":"url")),networkDetails:null}));this.abort();const D=this.config,E=D.fLoader,F=D.loader;return new Promise(((G,H)=>{if(this.loader&&this.loader.destroy(),A.gap){if(A.tagList.some((A=>"GAP"===A[0])))return void H(≈ô(A));A.gap=!1}const I=this.loader=E?new E(D):new F(D),J=≈ò(A);A.loader=I;const K=≈í(D.fragLoadPolicy.default),L={
loadPolicy:K,timeout:K.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===A.sn?1/0:—ú};A.stats=I.stats;const M={onSuccess:(B,C,D,E)=>{this.resetLoader(A,I);let F=B.data;D.resetIV&&A.decryptdata&&(A.decryptdata.iv=new Uint8Array(F.slice(0,16)),F=F.slice(16)),G({frag:A,part:null,payload:F,networkDetails:E})},onError:(B,D,E,F)=>{this.resetLoader(A,I),H(new —û({type:–π.NETWORK_ERROR,details:–∫.FRAG_LOAD_ERROR,fatal:!1,frag:A,response:ƒë({url:C,data:void 0},B),
error:Error(`HTTP Error ${B.code} ${B.text}`),networkDetails:E,stats:F}))},onAbort:(B,C,D)=>{this.resetLoader(A,I),H(new —û({type:–π.NETWORK_ERROR,details:–∫.INTERNAL_ABORTED,fatal:!1,frag:A,error:Error("Aborted"),networkDetails:D,stats:B}))},onTimeout:(B,C,D)=>{this.resetLoader(A,I),H(new —û({type:–π.NETWORK_ERROR,details:–∫.FRAG_LOAD_TIMEOUT,fatal:!1,frag:A,error:Error(`Timeout after ${L.timeout}ms`),networkDetails:D,stats:B}))}};B&&(M.onProgress=(C,D,E,F)=>B({frag:A,part:null,payload:E,
networkDetails:F})),I.load(J,L,M)}))}loadPart(A,B,C){this.abort();const D=this.config,E=D.fLoader,F=D.loader;return new Promise(((G,H)=>{if(this.loader&&this.loader.destroy(),A.gap||B.gap)return void H(≈ô(A,B));const I=this.loader=E?new E(D):new F(D),J=≈ò(A,B);A.loader=I;const K=≈í(D.fragLoadPolicy.default),L={loadPolicy:K,timeout:K.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:—ú};B.stats=I.stats,I.load(J,L,{onSuccess:(D,E,F,H)=>{this.resetLoader(A,I),
this.updateStatsFromPart(A,B);const J={frag:A,part:B,payload:D.data,networkDetails:H};C(J),G(J)},onError:(C,D,E,F)=>{this.resetLoader(A,I),H(new —û({type:–π.NETWORK_ERROR,details:–∫.FRAG_LOAD_ERROR,fatal:!1,frag:A,part:B,response:ƒë({url:J.url,data:void 0},C),error:Error(`HTTP Error ${C.code} ${C.text}`),networkDetails:E,stats:F}))},onAbort:(C,D,E)=>{A.stats.aborted=B.stats.aborted,this.resetLoader(A,I),H(new —û({type:–π.NETWORK_ERROR,details:–∫.INTERNAL_ABORTED,fatal:!1,frag:A,part:B,
error:Error("Aborted"),networkDetails:E,stats:C}))},onTimeout:(C,D,E)=>{this.resetLoader(A,I),H(new —û({type:–π.NETWORK_ERROR,details:–∫.FRAG_LOAD_TIMEOUT,fatal:!1,frag:A,part:B,error:Error(`Timeout after ${L.timeout}ms`),networkDetails:E,stats:C}))}})}))}updateStatsFromPart(A,B){const C=A.stats,D=B.stats,E=D.total;if(C.loaded+=D.loaded,E){const D=Math.round(A.duration/B.duration),F=Math.min(Math.round(C.loaded/E),D),G=(D-F)*Math.round(C.loaded/F);C.total=C.loaded+G
}else C.total=Math.max(C.loaded,C.total);const F=C.loading,G=D.loading;F.start?F.first+=G.first-G.start:(F.start=G.start,F.first=G.first),F.end=G.end}resetLoader(A,B){A.loader=null,this.loader===B&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),B.destroy()}}class —û extends Error{constructor(A){super(A.error.message),this.data=void 0,this.data=A}}class —ü extends –æ{constructor(A,B){super(A,B),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,
this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(A){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,A),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)
}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class —†{constructor(A,B,C,D=0,E=-1,F=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={
start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=A,this.sn=B,this.id=C,this.size=D,this.part=E,this.partial=F}}const —°={length:0,start:()=>0,end:()=>0};class —¢{static isBuffered(A,B){if(A){const C=—¢.getBuffered(A);for(let A=C.length;A--;)if(B>=C.start(A)&&B<=C.end(A))return!0}return!1}static bufferedRanges(A){if(A){
const B=—¢.getBuffered(A);return —¢.timeRangesToArray(B)}return[]}static timeRangesToArray(A){const B=[];for(let C=0;C<A.length;C++)B.push({start:A.start(C),end:A.end(C)});return B}static bufferInfo(A,B,C){if(A){const D=—¢.bufferedRanges(A);if(D.length)return —¢.bufferedInfo(D,B,C)}return{len:0,start:B,end:B,bufferedIndex:-1}}static bufferedInfo(A,B,C){B=Math.max(0,B),A.length>1&&A.sort(((A,B)=>A.start-B.start||B.end-A.end));let D=-1,E=[];if(C)for(let F=0;F<A.length;F++){
B>=A[F].start&&B<=A[F].end&&(D=F);const G=E.length;if(G){const B=E[G-1].end;A[F].start-B<C?A[F].end>B&&(E[G-1].end=A[F].end):E.push(A[F])}else E.push(A[F])}else E=A;let F,G=0,H=B,I=B;for(let A=0;A<E.length;A++){const J=E[A].start,K=E[A].end;if(-1===D&&B>=J&&B<=K&&(D=A),B+C>=J&&B<K)H=J,I=K,G=I-B;else if(B+C<J){F=J;break}}return{len:G,start:H||0,end:I||0,nextStart:F,buffered:A,bufferedIndex:D}}static getBuffered(A){try{return A.buffered||—°}catch(A){return —Ç.log("failed to get media.buffered",A),—°}
}}const —£=/\{\$([a-zA-Z0-9-_]+)\}/g,—§=/^(\d+)x(\d+)$/,—•=/(.+?)=(".*?"|.*?)(?:,|$)/g;class —¶{constructor(A,B){"string"==typeof A&&(A=—¶.parseAttrList(A,B)),ƒè(this,A)}get clientAttrs(){return Object.keys(this).filter((A=>"X-"===A.substring(0,2)))}decimalInteger(A){const B=parseInt(this[A],10);return B>Number.MAX_SAFE_INTEGER?1/0:B}hexadecimalInteger(A){if(this[A]){let B=(this[A]||"0x").slice(2);B=(1&B.length?"0":"")+B;const C=new Uint8Array(B.length/2)
;for(let A=0;A<B.length/2;A++)C[A]=parseInt(B.slice(2*A,2*A+2),16);return C}return null}hexadecimalIntegerAsNumber(A){const B=parseInt(this[A],16);return B>Number.MAX_SAFE_INTEGER?1/0:B}decimalFloatingPoint(A){return parseFloat(this[A])}optionalFloat(A,B){const C=this[A];return C?parseFloat(C):B}enumeratedString(A){return this[A]}enumeratedStringList(A,B){const C=this[A];return(C?C.split(/[ ,]+/):[]).reduce(((A,B)=>(A[B.toLowerCase()]=!0,A)),B)}bool(A){return"YES"===this[A]}decimalResolution(A){
const B=—§.exec(this[A]);if(null!==B)return{width:parseInt(B[1],10),height:parseInt(B[2],10)}}static parseAttrList(A,B){let C;const D={};for(—•.lastIndex=0;null!==(C=—•.exec(A));){const E=C[1].trim();let F=C[2];const G=0===F.indexOf('"')&&F.lastIndexOf('"')===F.length-1;let H=!1;if(G)F=F.slice(1,-1);else switch(E){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":H=!0}if(B&&(G||H))F=≈õ(B,F);else if(!H&&!G)switch(E){case"CLOSED-CAPTIONS":if("NONE"===F)break;case"ALLOWED-CPC":case"CLASS":
case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":
case"X-ASSET-URI":—Ç.warn(`${A}: attribute ${E} is missing quotes`)}D[E]=F}return D}}class —ß{constructor(A,B,C=0){var D;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(null==B?void 0:B.tagAnchor)||null,this.tagOrder=null!=(D=null==B?void 0:B.tagOrder)?D:C,B){const C=B.attr;for(const B in C)if(Object.prototype.hasOwnProperty.call(A,B)&&A[B]!==C[B]){
—Ç.warn(`DATERANGE tag attribute: "${B}" does not match for tags with ID: "${A.ID}"`),this._badValueForSameId=B;break}A=ƒè(new —¶({}),C,A)}if(this.attr=A,B?(this._startDate=B._startDate,this._cue=B._cue,this._endDate=B._endDate,this._dateAtEnd=B._dateAtEnd):this._startDate=new Date(A["START-DATE"]),"END-DATE"in this.attr){const A=(null==B?void 0:B.endDate)||new Date(this.attr["END-DATE"]);–∂(A.getTime())&&(this._endDate=A)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){
const A=this._cue;return void 0===A?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):A}get startTime(){const{tagAnchor:A}=this;return null===A||null===A.programDateTime?(—Ç.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${A}`),NaN):A.start+(this.startDate.getTime()-A.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const A=this._endDate||this._dateAtEnd;if(A)return A;const B=this.duration
;return null!==B?this._dateAtEnd=new Date(this._startDate.getTime()+1e3*B):null}get duration(){if("DURATION"in this.attr){const A=this.attr.decimalFloatingPoint("DURATION");if(–∂(A))return A}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){
return"com.apple.hls.interstitial"===this.class}get isValid(){return!!this.id&&!this._badValueForSameId&&–∂(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}class —®{constructor(A){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,
this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,
this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=A}reloaded(A){
if(!A)return this.advanced=!0,void(this.updated=!0);const B=this.lastPartSn-A.lastPartSn,C=this.lastPartIndex-A.lastPartIndex;this.updated=this.endSN!==A.endSN||!!C||!!B||!this.live,this.advanced=this.endSN>A.endSN||B>0||0===B&&C>0,this.updated||this.advanced?this.misses=Math.floor(.6*A.misses):this.misses=A.misses+1}get hasProgramDateTime(){return!!this.fragments.length&&–∂(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){
return this.averagetargetduration||this.targetduration||10}get drift(){const A=this.driftEndTime-this.driftStartTime;return A>0?1e3*(this.driftEnd-this.driftStart)/A:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var A;return null!=(A=this.partList)&&A.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var A;return null!=(A=this.fragments)&&A.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){var A
;return null!=(A=this.fragments)&&A.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var A;return null!=(A=this.partList)&&A.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const A=this.partList;if(A){const B=this.lastPartIndex;if(-1!==B){for(let C=A.length;C--;)if(A[C].index>B)return A[C].index;return B}}return 0}get lastPartSn(){var A
;return null!=(A=this.partList)&&A.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const A=this.partEnd-this.fragmentStart;return this.age>Math.max(A,this.totalduration)+this.levelTargetDuration}return!1}}const —©="undefined"!=typeof self?self:void 0;…é={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},…è="org.w3.clearkey",…ê="com.apple.streamingkeydelivery",
…ë="com.microsoft.playready",…í="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",…ì="1077efecc0b24d02ace33c1e52e2fb4b",…î="e2719d58a985b3c9781ab030af78d30e",…ï="9a04f07998404286ab92e65be0885f95",…ñ="edef8ba979d64acea3c827dcd51d21ed";const —™=null!=—©&&null!=(…¢=—©.navigator)&&…¢.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;let —´={};class —¨{static clearKeyUriToKeyIdMap(){—´={}}constructor(A,B,C,D=[1],E=null){this.uri=void 0,this.method=void 0,
this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=A,this.uri=B,this.keyFormat=C,this.keyFormatVersions=D,this.iv=E,this.encrypted=!!A&&"NONE"!==A,this.isCommonEncryption=this.encrypted&&!≈ü(A)}isSupported(){if(this.method){if(≈ü(this.method)||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case …ê:case …í:
case …ë:case …è:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(A){if(!this.encrypted||!this.uri)return null;if(≈ü(this.method)&&this.uri&&!this.iv){"number"!=typeof A&&(—Ç.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),A=0);const B=function(A){const B=new Uint8Array(16);for(let C=12;C<16;C++)B[C]=A>>8*(15-C)&255;return B}(A)
;return new —¨(this.method,this.uri,"identity",this.keyFormatVersions,B)}const B=≈£(this.uri);if(B)switch(this.keyFormat){case …í:this.pssh=B,B.length>=22&&(this.keyId=B.subarray(B.length-22,B.length-6));break;case …ë:{const A=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=ƒ∞(A,0,B),this.keyId=≈®(B);break}default:{let A=B.subarray(0,16);if(16!==A.length){const B=new Uint8Array(16);B.set(A,16-A.length),A=B}this.keyId=A;break}}
if(!this.keyId||16!==this.keyId.byteLength){let A=—´[this.uri];if(!A){const B=Object.keys(—´).length%Number.MAX_SAFE_INTEGER;A=new Uint8Array(16),new DataView(A.buffer,12,4).setUint32(0,B),—´[this.uri]=A}this.keyId=A}return this}}
const —≠=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,—Æ=/#EXT-X-MEDIA:(.*)/g,—Ø=/^#EXT(?:INF|-X-TARGETDURATION):/m,—∞=RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),—±=RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"))
;class —≤{static findGroup(A,B){for(let C=0;C<A.length;C++){const D=A[C];if(D.id===B)return D}}static resolve(A,B){return »∫.buildAbsoluteURL(B,A,{alwaysNormalize:!0})}static isMediaPlaylist(A){return —Ø.test(A)}static parseMasterPlaylist(A,B){const C={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:≈ö(A)},D=[];let E;for(—≠.lastIndex=0;null!=(E=—≠.exec(A));)if(E[1]){var F
;const A=new —¶(E[1],C),G=≈õ(C,E[2]),H={attrs:A,bitrate:A.decimalInteger("BANDWIDTH")||A.decimalInteger("AVERAGE-BANDWIDTH"),name:A.NAME,url:—≤.resolve(G,B)},I=A.decimalResolution("RESOLUTION");I&&(H.width=I.width,H.height=I.height),≈≠(A.CODECS,H);const J=A["SUPPLEMENTAL-CODECS"];J&&(H.supplemental={},≈≠(J,H.supplemental)),null!=(F=H.unknownCodecs)&&F.length||D.push(H),C.levels.push(H)}else if(E[3]){const A=E[3],D=E[4];switch(A){case"SESSION-DATA":{const A=new —¶(D,C),B=A["DATA-ID"]
;B&&(null===C.sessionData&&(C.sessionData={}),C.sessionData[B]=A);break}case"SESSION-KEY":{const A=≈´(D,B,C);A.encrypted&&A.isSupported()?(null===C.sessionKeys&&(C.sessionKeys=[]),C.sessionKeys.push(A)):—Ç.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${D}"`);break}case"DEFINE":≈ú(C,new —¶(D,C),B);break;case"CONTENT-STEERING":{const A=new —¶(D,C);C.contentSteering={uri:—≤.resolve(A["SERVER-URI"],B),pathwayId:A["PATHWAY-ID"]||"."};break}case"START":C.startTimeOffset=≈¨(D)}}
const G=D.length>0&&D.length<C.levels.length;return C.levels=G?D:C.levels,0===C.levels.length&&(C.playlistParsingError=Error("no levels found in manifest")),C}static parseMasterPlaylistMedia(A,B,C){let D;const E={},F=C.levels,G={AUDIO:F.map((A=>({id:A.attrs.AUDIO,audioCodec:A.audioCodec}))),SUBTITLES:F.map((A=>({id:A.attrs.SUBTITLES,textCodec:A.textCodec}))),"CLOSED-CAPTIONS":[]};let H=0;for(—Æ.lastIndex=0;null!==(D=—Æ.exec(A));){const A=new —¶(D[1],C),F=A.TYPE;if(F){const C=G[F],D=E[F]||[];E[F]=D
;const I=A.LANGUAGE,J=A["ASSOC-LANGUAGE"],K=A.CHANNELS,L=A.CHARACTERISTICS,M=A["INSTREAM-ID"],N={attrs:A,bitrate:0,id:H++,groupId:A["GROUP-ID"]||"",name:A.NAME||I||"",type:F,default:A.bool("DEFAULT"),autoselect:A.bool("AUTOSELECT"),forced:A.bool("FORCED"),lang:I,url:A.URI?—≤.resolve(A.URI,B):""};if(J&&(N.assocLang=J),K&&(N.channels=K),L&&(N.characteristics=L),M&&(N.instreamId=M),null!=C&&C.length){const A=—≤.findGroup(C,N.groupId)||C[0];≈Æ(N,A,"audioCodec"),≈Æ(N,A,"textCodec")}D.push(N)}}return E}
static parseLevelPlaylist(A,B,C,D,E,F){var G;const H={url:B},I=new —®(B),J=I.fragments,K=[];let L,M,N,O,P=null,Q=0,R=0,S=0,T=0,U=0,V=null,W=new —Ü(D,H),X=-1,Y=!1,Z=null;if(—∞.lastIndex=0,I.m3u8=A,I.hasVariableRefs=≈ö(A),"#EXTM3U"!==(null==(G=—∞.exec(A))?void 0:G[0]))return I.playlistParsingError=Error("Missing format identifier #EXTM3U"),I;for(;null!==(L=—∞.exec(A));){Y&&(Y=!1,W=new —Ü(D,H),W.playlistOffset=S,W.start=S,W.sn=Q,W.cc=T,U&&(W.bitrate=U),W.level=C,P&&(W.initSegment=P,
P.rawProgramDateTime&&(W.rawProgramDateTime=P.rawProgramDateTime,P.rawProgramDateTime=null),Z&&(W.setByteRange(Z),Z=null)));const A=L[1];if(A){W.duration=parseFloat(A);const B=(" "+L[2]).slice(1);W.title=B||null,W.tagList.push(B?["INF",A,B]:["INF",A])}else if(L[3]){if(–∂(W.duration)){W.playlistOffset=S,W.start=S,N&&≈±(W,N,I),W.sn=Q,W.level=C,W.cc=T,J.push(W);const A=(" "+L[3]).slice(1);W.relurl=≈õ(I,A),≈Ø(W,V,K),V=W,S+=W.duration,Q++,R=0,Y=!0}}else{if(L=L[0].match(—±),!L){
—Ç.warn("No matches on slow regex match for level playlist!");continue}for(M=1;M<L.length&&void 0===L[M];M++);const A=(" "+L[M]).slice(1),E=(" "+L[M+1]).slice(1),G=L[M+2]?(" "+L[M+2]).slice(1):null;switch(A){case"BYTERANGE":V?W.setByteRange(E,V):W.setByteRange(E);break;case"PROGRAM-DATE-TIME":W.rawProgramDateTime=E,W.tagList.push(["PROGRAM-DATE-TIME",E]),-1===X&&(X=J.length);break;case"PLAYLIST-TYPE":I.type&&≈≤(I,A,L),I.type=E.toUpperCase();break;case"MEDIA-SEQUENCE":
0!==I.startSN?≈≤(I,A,L):J.length>0&&≈≥(I,A,L),Q=I.startSN=parseInt(E);break;case"SKIP":{I.skippedSegments&&≈≤(I,A,L);const B=new —¶(E,I),C=B.decimalInteger("SKIPPED-SEGMENTS");if(–∂(C)){I.skippedSegments+=C;for(let A=C;A--;)J.push(null);Q+=C}const D=B.enumeratedString("RECENTLY-REMOVED-DATERANGES");D&&(I.recentlyRemovedDateranges=(I.recentlyRemovedDateranges||[]).concat(D.split("\t")));break}case"TARGETDURATION":0!==I.targetduration&&≈≤(I,A,L),I.targetduration=Math.max(parseInt(E),1);break
;case"VERSION":null!==I.version&&≈≤(I,A,L),I.version=parseInt(E);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":I.live||≈≤(I,A,L),I.live=!1;break;case"#":(E||G)&&W.tagList.push(G?[E,G]:[E]);break;case"DISCONTINUITY":T++,W.tagList.push(["DIS"]);break;case"GAP":W.gap=!0,W.tagList.push([A]);break;case"BITRATE":W.tagList.push([A,E]),U=1e3*parseInt(E),–∂(U)?W.bitrate=U:U=0;break;case"DATERANGE":{const A=new —¶(E,I),B=new —ß(A,I.dateRanges[A.ID],I.dateRangeTagCount);I.dateRangeTagCount++,
B.isValid||I.skippedSegments?I.dateRanges[B.id]=B:—Ç.warn(`Ignoring invalid DATERANGE tag: "${E}"`),W.tagList.push(["EXT-X-DATERANGE",E]);break}case"DEFINE":{const A=new —¶(E,I);"IMPORT"in A?≈ù(I,A,F):≈ú(I,A,B)}break;case"DISCONTINUITY-SEQUENCE":0!==I.startCC?≈≤(I,A,L):J.length>0&&≈≥(I,A,L),I.startCC=T=parseInt(E);break;case"KEY":{const A=≈´(E,B,I);if(A.isSupported()){if("NONE"===A.method){N=void 0;break}N||(N={}),N[A.keyFormat]&&(N=ƒè({},N)),N[A.keyFormat]=A
}else —Ç.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${E}"`);break}case"START":I.startTimeOffset=≈¨(E);break;case"MAP":{const A=new —¶(E,I);if(W.duration){const B=new —Ü(D,H);≈∞(B,A,C,N),P=B,W.initSegment=P,P.rawProgramDateTime&&!W.rawProgramDateTime&&(W.rawProgramDateTime=P.rawProgramDateTime)}else{const B=W.byteRangeEndOffset;if(B){const A=W.byteRangeStartOffset;Z=`${B-A}@${A}`}else Z=null;≈∞(W,A,C,N),P=W,Y=!0}P.cc=T;break}case"SERVER-CONTROL":O&&≈≤(I,A,L),O=new —¶(E),
I.canBlockReload=O.bool("CAN-BLOCK-RELOAD"),I.canSkipUntil=O.optionalFloat("CAN-SKIP-UNTIL",0),I.canSkipDateRanges=I.canSkipUntil>0&&O.bool("CAN-SKIP-DATERANGES"),I.partHoldBack=O.optionalFloat("PART-HOLD-BACK",0),I.holdBack=O.optionalFloat("HOLD-BACK",0);break;case"PART-INF":{I.partTarget&&≈≤(I,A,L);const B=new —¶(E);I.partTarget=B.decimalFloatingPoint("PART-TARGET");break}case"PART":{let A=I.partList;A||(A=I.partList=[]);const B=R>0?A[A.length-1]:void 0,C=R++,D=new —¶(E,I),F=new —á(D,W,H,C,B)
;A.push(F),W.duration+=F.duration;break}case"PRELOAD-HINT":{const A=new —¶(E,I);I.preloadHint=A;break}case"RENDITION-REPORT":{const A=new —¶(E,I);I.renditionReports=I.renditionReports||[],I.renditionReports.push(A);break}default:—Ç.warn("line parsed but not handled: "+L)}}}V&&!V.relurl?(J.pop(),S-=V.duration,I.partList&&(I.fragmentHint=V)):I.partList&&(≈Ø(W,V,K),W.cc=T,I.fragmentHint=W,N&&≈±(W,N,I)),I.targetduration||(I.playlistParsingError=Error("#EXT-X-TARGETDURATION is required"))
;const a=J.length,b=J[0],c=J[a-1];if(S+=I.skippedSegments*I.targetduration,S>0&&a&&c){I.averagetargetduration=S/a;const A=c.sn;I.endSN="initSegment"!==A?A:0,I.live||(c.endList=!0),b&&void 0===I.startCC&&(I.startCC=b.cc),X>0&&(function(A,B){let C=A[B];for(let D=B;D--;){const B=A[D];if(!B)return;B.programDateTime=C.programDateTime-1e3*B.duration,C=B}}(J,X),b&&K.unshift(b))}else I.endSN=0,I.startCC=0;return I.fragmentHint&&(S+=I.fragmentHint.duration),I.totalduration=S,
K.length&&I.dateRangeTagCount&&b&&≈©(K,I),I.endCC=T,I}}const —≥=function(A){let B="";const C=A.length;for(let D=0;D<C;D++)B+=`[${A.start(D).toFixed(3)}-${A.end(D).toFixed(3)}]`;return B},—¥="STOPPED",—µ="IDLE",—∂="KEY_LOADING",—∑="FRAG_LOADING",—∏="FRAG_LOADING_WAITING_RETRY",—π="WAITING_TRACK",—∫="PARSING",—ª="PARSED",—º="ENDED",—Ω="ERROR",—æ="WAITING_INIT_PTS",—ø="WAITING_LEVEL";class “Ä extends —ü{constructor(A,B,C,D,E){super(D,A.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,
this.fragmentTracker=void 0,this.transmuxer=null,this._state=—¥,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,
this.onMediaSeeking=()=>{const{config:A,fragCurrent:B,media:C,mediaBuffer:D,state:E}=this,F=C?C.currentTime:0,G=—¢.bufferInfo(D||C,F,A.maxBufferHole);if(this.log(`media seeking to ${–∂(F)?F.toFixed(3):F}, state: ${E}`),this.state===—º)this.resetLoadingState();else if(B){const C=A.maxFragLookUpTolerance,D=B.start-C,E=B.start+B.duration+C;if(!G.len||E<G.start||D>G.end){const A=F>E;(F<D||A)&&(A&&B.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),
B.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(C&&(this.fragmentTracker.removeFragmentsInRange(F,1/0,this.playlistType,!0),F>this.lastCurrentTime&&(this.lastCurrentTime=F),!this.loadingParts)){const A=Math.max(G.end,F),B=this.shouldLoadParts(this.getLevelDetails(),A);B&&(this.log(`LL-Part loading ON after seeking to ${F.toFixed(2)} with buffer @${A.toFixed(2)}`),this.loadingParts=B)}
this.hls.hasEnoughToStart||G.len||(this.log(`setting startPosition to ${F} because of seek before start`),this.nextLoadPosition=this.startPosition=F),this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=E,this.hls=A,this.fragmentLoader=new —ù(A.config),this.keyLoader=C,this.fragmentTracker=B,this.config=A.config,this.decrypter=new —õ(A.config)}registerListeners(){const{hls:A}=this
;A.on(–ª.MEDIA_ATTACHED,this.onMediaAttached,this),A.on(–ª.MEDIA_DETACHING,this.onMediaDetaching,this),A.on(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.on(–ª.MANIFEST_LOADED,this.onManifestLoaded,this),A.on(–ª.ERROR,this.onError,this)}unregisterListeners(){const{hls:A}=this;A.off(–ª.MEDIA_ATTACHED,this.onMediaAttached,this),A.off(–ª.MEDIA_DETACHING,this.onMediaDetaching,this),A.off(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.off(–ª.MANIFEST_LOADED,this.onManifestLoaded,this),
A.off(–ª.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(A){}stopLoad(){if(this.state===—¥)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const A=this.fragCurrent;null!=A&&A.loader&&(A.abortRequests(),this.fragmentTracker.removeFragment(A)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=—¥}get startPositionValue(){const{nextLoadPosition:A,startPosition:B}=this
;return-1===B&&A?A:B}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(A,B){if(B.live||!this.media)return!1;const C=A.end||0,D=this.config.timelineOffset||0;if(C<=D)return!1;const E=A.buffered;this.config.maxBufferHole&&E&&E.length>1&&(A=—¢.bufferedInfo(E,A.start,0));const F=A.nextStart;if(F&&F>D&&F<B.edge)return!1
;if(this.media.currentTime<A.start)return!1;const G=B.partList;if(null!=G&&G.length){const A=G[G.length-1];return —¢.isBuffered(this.media,A.start+A.duration/2)}const H=B.fragments[B.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(H)}getLevelDetails(){var A;if(this.levels&&null!==this.levelLastLoaded)return null==(A=this.levelLastLoaded)?void 0:A.details}get timelineOffset(){const A=this.config.timelineOffset;var B
;return A?(null==(B=this.getLevelDetails())?void 0:B.appliedTimelineOffset)||A:0}onMediaAttached(A,B){const C=this.media=this.mediaBuffer=B.media;C.removeEventListener("seeking",this.onMediaSeeking),C.removeEventListener("ended",this.onMediaEnded),C.addEventListener("seeking",this.onMediaSeeking),C.addEventListener("ended",this.onMediaEnded);const D=this.config;this.levels&&D.autoStartLoad&&this.state===—¥&&this.startLoad(D.startPosition)}onMediaDetaching(A,B){
const C=!!B.transferMedia,D=this.media;if(null!==D){if(D.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),D.removeEventListener("seeking",this.onMediaSeeking),D.removeEventListener("ended",this.onMediaEnded),this.keyLoader&&!C&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,C)return this.resetLoadingState(),void this.resetTransmuxer();this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),
this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(A,B){}onManifestLoaded(A,B){this.startTimeOffset=B.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=—¥,
this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(A,B,C){this.startFragRequested=!0,this._loadFragForPlayback(A,B,C)}_loadFragForPlayback(A,B,C){this._doFragLoad(A,B,C,(A=>{const B=A.frag
;if(this.fragContextChanged(B))return this.warn(`${B.type} sn: ${B.sn}${A.part?" part: "+A.part.index:""} of ${this.fragInfo(B,!1,A.part)}) was dropped during download.`),void this.fragmentTracker.removeFragment(B);B.stats.chunkCount++,this._handleFragmentLoadProgress(A)})).then((A=>{if(!A)return;const B=this.state,C=A.frag;this.fragContextChanged(C)?(B===—∑||!this.fragCurrent&&B===—∫)&&(this.fragmentTracker.removeFragment(C),
this.state=—µ):("payload"in A&&(this.log(`Loaded ${C.type} sn: ${C.sn} of ${this.playlistLabel()} ${C.level}`),this.hls.trigger(–ª.FRAG_LOADED,A)),this._handleFragmentLoadComplete(A))})).catch((B=>{this.state!==—¥&&this.state!==—Ω&&(this.warn("Frag error: "+((null==B?void 0:B.message)||B)),this.resetFragmentLoading(A))}))}clearTrackerIfNeeded(A){var B;const{fragmentTracker:C}=this;if(C.getState(A)===…â){
const B=A.type,D=this.getFwdBufferInfo(this.mediaBuffer,B),E=Math.max(A.duration,D?D.len:this.config.maxBufferLength),F=this.backtrackFragment;(1===(F?A.sn-F.sn:0)||this.reduceMaxBufferLength(E,A.duration))&&C.removeFragment(A)}else 0===(null==(B=this.mediaBuffer)?void 0:B.buffered.length)?C.removeAllFragments():C.hasParts(A.type)&&(C.detectPartialFragments({frag:A,part:null,stats:A.stats,id:A.type}),C.getState(A)===…ä&&C.removeFragment(A))}checkLiveUpdate(A){if(A.updated&&!A.live){
const B=A.fragments[A.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:B,part:null,stats:B.stats,id:B.type})}A.fragments[0]||(A.deltaUpdateFailed=!0)}waitForLive(A){const B=A.details;return(null==B?void 0:B.live)&&"EVENT"!==B.type&&(this.levelLastLoaded!==A||B.expired)}flushMainBuffer(A,B,C=null){if(!(A-B))return;const D={startOffset:A,endOffset:B,type:C};this.hls.trigger(–ª.BUFFER_FLUSHING,D)}_loadInitSegment(A,B){this._doFragLoad(A,B).then((A=>{const B=null==A?void 0:A.frag
;if(!B||this.fragContextChanged(B)||!this.levels)throw Error("init load aborted");return A})).then((A=>{const{hls:B}=this,{frag:C,payload:D}=A,E=C.decryptdata;if(D&&D.byteLength>0&&null!=E&&E.key&&E.iv&&≈ü(E.method)){const F=self.performance.now();return this.decrypter.decrypt(new Uint8Array(D),E.key.buffer,E.iv.buffer,≈†(E.method)).catch((A=>{throw B.trigger(–ª.ERROR,{type:–π.MEDIA_ERROR,details:–∫.FRAG_DECRYPT_ERROR,fatal:!1,error:A,reason:A.message,frag:C}),A})).then((D=>{
const E=self.performance.now();return B.trigger(–ª.FRAG_DECRYPTED,{frag:C,payload:D,stats:{tstart:F,tdecrypt:E}}),A.payload=D,this.completeInitSegmentLoad(A)}))}return this.completeInitSegmentLoad(A)})).catch((B=>{this.state!==—¥&&this.state!==—Ω&&(this.warn(B),this.resetFragmentLoading(A))}))}completeInitSegmentLoad(A){const{levels:B}=this;if(!B)throw Error("init load aborted, missing levels");const C=A.frag.stats;this.state!==—¥&&(this.state=—µ),A.frag.data=new Uint8Array(A.payload),
C.parsing.start=C.buffering.start=self.performance.now(),C.parsing.end=C.buffering.end=self.performance.now(),this.tick()}fragContextChanged(A){const{fragCurrent:B}=this;return!A||!B||A.sn!==B.sn||A.level!==B.level}fragBufferedComplete(A,B){const C=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${A.type} sn: ${A.sn}${B?" part: "+B.index:""} of ${this.fragInfo(A,!1,B)} > buffer:${C?—≥(—¢.getBuffered(C)):"(detached)"})`),ƒò(A)){var D;if(A.type!==»∑){const B=A.elementaryStreams
;if(!Object.keys(B).some((A=>!!B[A])))return void(this.state=—µ)}const B=null==(D=this.levels)?void 0:D[A.level];null!=B&&B.fragmentError&&(this.log(`Resetting level fragment error count of ${B.fragmentError} on frag buffered`),B.fragmentError=0)}this.state=—µ}_handleFragmentLoadComplete(A){const{transmuxer:B}=this;if(!B)return;const{frag:C,part:D,partsLoaded:E}=A,F=!E||0===E.length||E.some((A=>!A)),G=new —†(C.level,C.sn,C.stats.chunkCount+1,0,D?D.index:-1,!F);B.flush(G)}
_handleFragmentLoadProgress(A){}_doFragLoad(A,B,C=null,D){var E;this.fragCurrent=A;const F=null==B?void 0:B.details;if(!this.levels||!F)throw Error(`frag load aborted, missing level${F?"":" detail"}s`);let G=null;!A.encrypted||null!=(E=A.decryptdata)&&E.key?A.encrypted||(G=this.keyLoader.loadClear(A,F.encryptedFragments),G&&this.log("[eme] blocking frag load until media-keys acquired")):(this.log(`Loading key for ${A.sn} of [${F.startSN}-${F.endSN}], ${this.playlistLabel()} ${A.level}`),
this.state=—∂,this.fragCurrent=A,G=this.keyLoader.load(A).then((A=>{if(!this.fragContextChanged(A.frag))return this.hls.trigger(–ª.KEY_LOADED,A),this.state===—∂&&(this.state=—µ),A})),this.hls.trigger(–ª.KEY_LOADING,{frag:A}),null===this.fragCurrent&&(G=Promise.reject(Error("frag load aborted, context changed in KEY_LOADING"))));const H=this.fragPrevious;if(ƒò(A)&&(!H||A.sn!==H.sn)){const C=this.shouldLoadParts(B.details,A.end)
;C!==this.loadingParts&&(this.log(`LL-Part loading ${C?"ON":"OFF"} loading sn ${null==H?void 0:H.sn}->${A.sn}`),this.loadingParts=C)}if(C=Math.max(A.start,C||0),this.loadingParts&&ƒò(A)){const E=F.partList;if(E&&D){C>A.end&&F.fragmentHint&&(A=F.fragmentHint);const H=this.getNextPart(E,A,C);if(H>-1){const I=E[H];let J;return A=this.fragCurrent=I.fragment,
this.log(`Loading ${A.type} sn: ${A.sn} part: ${I.index} (${H}/${E.length-1}) of ${this.fragInfo(A,!1,I)}) cc: ${A.cc} [${F.startSN}-${F.endSN}], target: ${parseFloat(C.toFixed(3))}`),this.nextLoadPosition=I.start+I.duration,this.state=—∑,J=G?G.then((C=>!C||this.fragContextChanged(C.frag)?null:this.doFragPartsLoad(A,I,B,D))).catch((A=>this.handleFragLoadError(A))):this.doFragPartsLoad(A,I,B,D).catch((A=>this.handleFragLoadError(A))),this.hls.trigger(–ª.FRAG_LOADING,{frag:A,part:I,
targetBufferTime:C}),null===this.fragCurrent?Promise.reject(Error("frag load aborted, context changed in FRAG_LOADING parts")):J}if(!A.url||this.loadedEndOfParts(E,C))return Promise.resolve(null)}}if(ƒò(A)&&this.loadingParts)this.log("LL-Part loading OFF after next part miss @"+C.toFixed(2)),this.loadingParts=!1;else if(!A.url)return Promise.resolve(null)
;this.log(`Loading ${A.type} sn: ${A.sn} of ${this.fragInfo(A,!1)}) cc: ${A.cc} ${F?"["+F.startSN+"-"+F.endSN+"]":""}, target: ${parseFloat(C.toFixed(3))}`),–∂(A.sn)&&!this.bitrateTest&&(this.nextLoadPosition=A.start+A.duration),this.state=—∑;const I=this.config.progressive;let J
;return J=I&&G?G.then((B=>!B||this.fragContextChanged(null==B?void 0:B.frag)?null:this.fragmentLoader.load(A,D))).catch((A=>this.handleFragLoadError(A))):Promise.all([this.fragmentLoader.load(A,I?D:void 0),G]).then((([A])=>(!I&&A&&D&&D(A),A))).catch((A=>this.handleFragLoadError(A))),this.hls.trigger(–ª.FRAG_LOADING,{frag:A,targetBufferTime:C}),null===this.fragCurrent?Promise.reject(Error("frag load aborted, context changed in FRAG_LOADING")):J}doFragPartsLoad(A,B,C,D){return new Promise(((E,F)=>{
var G;const H=[],I=null==(G=C.details)?void 0:G.partList,J=B=>{this.fragmentLoader.loadPart(A,B,D).then((D=>{H[B.index]=D;const F=D.part;this.hls.trigger(–ª.FRAG_LOADED,D);const G=≈º(C.details,A.sn,B.index+1)||≈Ω(I,A.sn,B.index+1);if(!G)return E({frag:A,part:F,partsLoaded:H});J(G)})).catch(F)};J(B)}))}handleFragLoadError(A){if("data"in A){const B=A.data;A.data&&B.details===–∫.INTERNAL_ABORTED?this.handleFragLoadAborted(B.frag,B.part):this.hls.trigger(–ª.ERROR,B)}else this.hls.trigger(–ª.ERROR,{
type:–π.OTHER_ERROR,details:–∫.INTERNAL_EXCEPTION,err:A,error:A,fatal:!0});return null}_handleTransmuxerFlush(A){const B=this.getCurrentContext(A);if(!B||this.state!==—∫)return void(this.fragCurrent||this.state===—¥||this.state===—Ω||(this.state=—µ));const{frag:C,part:D,level:E}=B,F=self.performance.now();C.stats.parsing.end=F,D&&(D.stats.parsing.end=F);const G=this.getLevelDetails(),H=G&&C.sn>G.endSN||this.shouldLoadParts(G,C.end)
;H!==this.loadingParts&&(this.log(`LL-Part loading ${H?"ON":"OFF"} after parsing segment ending @${C.end.toFixed(2)}`),this.loadingParts=H),this.updateLevelTiming(C,D,E,A.partial)}shouldLoadParts(A,B){var C,D;if(this.config.lowLatencyMode){if(!A)return this.loadingParts;if(null!=A&&A.partList){const E=A.partList[0]
;if(B>=E.end+((null==(C=A.fragmentHint)?void 0:C.duration)||0)&&(this.hls.hasEnoughToStart?(null==(D=this.media)?void 0:D.currentTime)||this.lastCurrentTime:this.getLoadPosition())>E.start-E.fragment.duration)return!0}}return!1}getCurrentContext(A){const{levels:B,fragCurrent:C}=this,{level:D,sn:E,part:F}=A;if(null==B||!B[D])return this.warn(`Levels object was unset while buffering fragment ${E} of ${this.playlistLabel()} ${D}. The current chunk will not be buffered.`),null
;const G=B[D],H=G.details,I=F>-1?≈º(H,E,F):null,J=I?I.fragment:≈ª(H,E,C);return J?(C&&C!==J&&(J.stats=C.stats),{frag:J,part:I,level:G}):null}bufferFragmentData(A,B,C,D,E){var F;if(!A||this.state!==—∫)return;const{data1:G,data2:H}=A;let I=G;if(G&&H&&(I=ƒ™(G,H)),null==(F=I)||!F.length)return;const J={type:A.type,frag:B,part:C,chunkMeta:D,parent:B.type,data:I};if(this.hls.trigger(–ª.BUFFER_APPENDING,J),A.dropped&&A.independent&&!C){if(E)return;this.flushBufferGap(B)}}flushBufferGap(A){const B=this.media
;if(!B)return;if(!—¢.isBuffered(B,B.currentTime))return void this.flushMainBuffer(0,A.start);const C=B.currentTime,D=—¢.bufferInfo(B,C,0),E=A.duration,F=Math.min(2*this.config.maxFragLookUpTolerance,.25*E),G=Math.max(Math.min(A.start-F,D.end-F),C+F);A.start-G>F&&this.flushMainBuffer(G,A.start)}getFwdBufferInfo(A,B){var C;const D=this.getLoadPosition();if(!–∂(D))return null;const E=this.lastCurrentTime>D||null!=(C=this.media)&&C.paused?0:this.config.maxBufferHole
;return this.getFwdBufferInfoAtPos(A,D,B,E)}getFwdBufferInfoAtPos(A,B,C,D){const E=—¢.bufferInfo(A,B,D);if(0===E.len&&void 0!==E.nextStart){const F=this.fragmentTracker.getBufferedFrag(B,C);if(F&&(E.nextStart<=F.end||F.gap)){const C=Math.max(Math.min(E.nextStart,F.end)-B,D);return —¢.bufferInfo(A,B,C)}}return E}getMaxBufferLength(A){const{config:B}=this;let C;return C=A?Math.max(8*B.maxBufferSize/A,B.maxBufferLength):B.maxBufferLength,Math.min(C,B.maxMaxBufferLength)}reduceMaxBufferLength(A,B){
const C=this.config,D=Math.max(Math.min(A-B,C.maxBufferLength),B),E=Math.max(A-3*B,C.maxMaxBufferLength/2,D);return E>=D&&(C.maxMaxBufferLength=E,this.warn(`Reduce max buffer length to ${E}s`),!0)}getAppendedFrag(A,B=»µ){var C;const D=null==(C=this.fragmentTracker)?void 0:C.getAppendedFrag(A,B);return D&&"fragment"in D?D.fragment:D}getNextFragment(A,B){const C=B.fragments,D=C.length;if(!D)return null;const{config:E}=this,F=C[0].start,G=E.lowLatencyMode&&!!B.partList;let H=null;if(B.live){
const C=E.initialLiveManifestSize;if(D<C)return this.warn(`Not enough fragments to start playback (have: ${D}, need: ${C})`),null;if(!B.PTSKnown&&!this.startFragRequested&&-1===this.startPosition||A<F){var I;G&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),H=this.getInitialLiveFragment(B);const C=this.hls.startPosition,D=this.hls.liveSyncPosition,E=H?(-1!==C&&C>=F?C:D)||H.start:A
;this.log(`Setting startPosition to ${E} to match start frag at live edge. mainStart: ${C} liveSyncPosition: ${D} frag.start: ${null==(I=H)?void 0:I.start}`),this.startPosition=this.nextLoadPosition=E}}else A<=F&&(H=C[0]);if(!H){const C=this.loadingParts?B.partEnd:B.fragmentEnd;H=this.getFragmentAtPosition(A,C,B)}let J=this.filterReplacedPrimary(H,B);if(!J&&H){const A=H.sn-B.startSN;J=this.filterReplacedPrimary(C[A+1]||null,B)}return this.mapToInitFragWhenRequired(J)}isLoopLoading(A,B){
const C=this.fragmentTracker.getState(A);return(C===…ã||C===…ä&&!!A.gap)&&this.nextLoadPosition>B}getNextFragmentLoopLoading(A,B,C,D,E){let F=null;if(A.gap&&(F=this.getNextFragment(this.nextLoadPosition,B),F&&!F.gap&&C.nextStart)){const A=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,C.nextStart,D,0);if(null!==A&&C.len+A.len>=E){const A=F.sn;return this.loopSn!==A&&(this.log(`buffer full after gaps in "${D}" playlist starting at sn: ${A}`),this.loopSn=A),null}}
return this.loopSn=void 0,F}get primaryPrefetch(){var A,B;if(∆Ñ(this.hls.config)&&(null==(A=this.hls.interstitialsManager)||null==(B=A.playingItem)?void 0:B.event))return!0;return!1}filterReplacedPrimary(A,B){if(!A)return A;if(∆Ñ(this.hls.config)&&A.type!==»∑){const C=this.hls.interstitialsManager,D=null==C?void 0:C.bufferingItem;if(D){const C=D.event;if(C){if(C.appendInPlace||Math.abs(A.start-D.start)>1||0===D.start)return null}else{if(A.end<=D.start&&!1===(null==B?void 0:B.live))return null
;if(A.start>D.end&&D.nextEvent&&(D.nextEvent.appendInPlace||A.start-D.end>1))return null}}const E=null==C?void 0:C.playerQueue;if(E)for(let B=E.length;B--;){const C=E[B].interstitial;if(C.appendInPlace&&A.start>=C.startTime&&A.end<=C.resumeTime)return null}}return A}mapToInitFragWhenRequired(A){return null==A||!A.initSegment||null!=A&&A.initSegment.data||this.bitrateTest?A:A.initSegment}getNextPart(A,B,C){let D=-1,E=!1,F=!0;for(let G=0,H=A.length;G<H;G++){const H=A[G];if(F=F&&!H.independent,
D>-1&&C<H.start)break;const I=H.loaded;I?D=-1:(E||H.independent||F)&&H.fragment===B&&(D=G),E=I}return D}loadedEndOfParts(A,B){const C=A[A.length-1];return C&&B>C.start&&C.loaded}getInitialLiveFragment(A){const B=A.fragments,C=this.fragPrevious;let D=null;if(C){if(A.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+C.programDateTime),D=function(A,B,C){if(null===B||!Array.isArray(A)||!A.length||!–∂(B))return null;if(B<(A[0].programDateTime||0))return null
;if(B>=(A[A.length-1].endProgramDateTime||0))return null;for(let D=0;D<A.length;++D){const E=A[D];if(≈ç(B,C,E))return E}return null}(B,C.endProgramDateTime,this.config.maxFragLookUpTolerance)),!D){const E=C.sn+1;if(E>=A.startSN&&E<=A.endSN){const F=B[E-A.startSN];C.cc===F.cc&&(D=F,this.log("Live playlist, switching playlist, load frag with next SN: "+D.sn))}D||(D=≈é(A,C.cc,C.end),D&&this.log("Live playlist, switching playlist, load frag with same CC: "+D.sn))}}else{
const B=this.hls.liveSyncPosition;null!==B&&(D=this.getFragmentAtPosition(B,this.bitrateTest?A.fragmentEnd:A.edge,A))}return D}getFragmentAtPosition(A,B,C){const{config:D}=this;let{fragPrevious:E}=this,{fragments:F,endSN:G}=C;const{fragmentHint:H}=C,{maxFragLookUpTolerance:I}=D,J=C.partList,K=!!(this.loadingParts&&null!=J&&J.length&&H);let L;var M;(K&&H&&!this.bitrateTest&&J[J.length-1].fragment.sn===H.sn&&(F=F.concat(H),G=H.sn),
A<B)?L=≈ã(E,F,A,A<this.lastCurrentTime||A>B-I||null!=(M=this.media)&&M.paused||!this.startFragRequested?0:I):L=F[F.length-1];if(L){const A=L.sn-C.startSN,B=this.fragmentTracker.getState(L);if((B===…ã||B===…ä&&L.gap)&&(E=L),E&&L.sn===E.sn&&(!K||J[0].fragment.sn>L.sn||!C.live&&!K)&&E&&L.level===E.level){const B=F[A+1];L=L.sn<G&&this.fragmentTracker.getState(B)!==…ã?B:null}}return L}alignPlaylists(A,B,C){const D=A.fragments.length;if(!D)return this.warn("No fragments in live playlist"),0
;const E=A.fragmentStart,F=!B,G=A.alignedSliding&&–∂(E);if(F||!G&&!E){!function(A,B){A&&(∆Ç(B,A),!B.alignedSliding&&A&&∆É(B,A),B.alignedSliding||!A||B.skippedSegments||≈∏(A,B,!1))}(C,A);const E=A.fragmentStart;return this.log(`Live playlist sliding: ${E.toFixed(2)} start-sn: ${B?B.startSN:"na"}->${A.startSN} fragments: ${D}`),E}return E}waitForCdnTuneIn(A){return A.live&&A.canBlockReload&&A.partTarget&&A.tuneInGoal>Math.max(A.partHoldBack,3*A.partTarget)}setStartPosition(A,B){
let C=this.startPosition;C<B&&(C=-1);const D=this.timelineOffset;if(-1===C){const E=null!==this.startTimeOffset,F=E?this.startTimeOffset:A.startTimeOffset;null!==F&&–∂(F)?(C=B+F,F<0&&(C+=A.edge),C=Math.min(Math.max(B,C),B+A.totalduration),this.log(`Setting startPosition to ${C} for start time offset ${F} found in ${E?"multivariant":"media"} playlist`),this.startPosition=C):A.live?(C=this.hls.liveSyncPosition||B,this.log("Setting startPosition to -1 to start at live edge "+C),
this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=C=0),this.lastCurrentTime=C+D}this.nextLoadPosition=C+D}getLoadPosition(){var A;const{media:B}=this;let C=0;return null!=(A=this.hls)&&A.hasEnoughToStart&&B?C=B.currentTime:this.nextLoadPosition>=0&&(C=this.nextLoadPosition),C}handleFragLoadAborted(A,B){
this.transmuxer&&A.type===this.playlistType&&ƒò(A)&&A.stats.aborted&&(this.warn(`Fragment ${A.sn}${B?" part "+B.index:""} of ${this.playlistLabel()} ${A.level} was aborted`),this.resetFragmentLoading(A))}resetFragmentLoading(A){this.fragCurrent&&(this.fragContextChanged(A)||this.state===—∏)||(this.state=—µ)}onFragmentOrKeyLoadError(A,B){if(B.chunkMeta&&!B.frag){const A=this.getCurrentContext(B.chunkMeta);A&&(B.frag=A.frag)}const C=B.frag;if(!C||C.type!==A||!this.levels)return;var D
;if(this.fragContextChanged(C))return void this.warn(`Frag load error must match current frag to retry ${C.url} > ${null==(D=this.fragCurrent)?void 0:D.url}`);const E=B.details===–∫.FRAG_GAP;E&&this.fragmentTracker.fragBuffered(C,!0);const F=B.errorAction,{action:G,flags:H,retryCount:I=0,retryConfig:J}=F||{},K=!!F&&!!J,L=K&&G===…Ñ,M=K&&!F.resolved&&H===…Ü;if(!L&&M&&ƒò(C)&&!C.endList)this.resetFragmentErrors(A),this.treatAsGap(C),F.resolved=!0;else if((L||M)&&I<J.maxNumRetry){
this.resetStartWhenNotLoaded(this.levelLastLoaded);const D=≈ë(J,I);this.warn(`Fragment ${C.sn} of ${A} ${C.level} errored with ${B.details}, retrying loading ${I+1}/${J.maxNumRetry} in ${D}ms`),F.resolved=!0,this.retryDate=self.performance.now()+D,this.state=—∏}else if(J&&F){if(this.resetFragmentErrors(A),!(I<J.maxNumRetry))return void this.warn(`${B.details} reached or exceeded max retry (${I})`);E||G===…É||(F.resolved=!0)}else this.state=G===…Ç?—ø:—Ω;this.tickImmediate()}
reduceLengthAndFlushBuffer(A){if(this.state===—∫||this.state===—ª){const B=A.frag,C=A.parent,D=this.getFwdBufferInfo(this.mediaBuffer,C),E=D&&D.len>.5;E&&this.reduceMaxBufferLength(D.len,(null==B?void 0:B.duration)||10);const F=!E;return F&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${C} buffer`),B&&(this.fragmentTracker.removeFragment(B),this.nextLoadPosition=B.start),this.resetLoadingState(),F}return!1}resetFragmentErrors(A){A===»∂&&(this.fragCurrent=null),
this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==—¥&&(this.state=—µ)}afterBufferFlushed(A,B,C){if(!A)return;const D=—¢.getBuffered(A);this.fragmentTracker.detectEvictedFragments(B,D,C),this.state===—º&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==—¥&&(this.state=—µ)}resetStartWhenNotLoaded(A){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const B=A?A.details:null
;null!=B&&B.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(B,B.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(A){this.warn(`The loading context changed while buffering fragment ${A.sn} of ${this.playlistLabel()} ${A.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}
removeUnbufferedFrags(A=0){this.fragmentTracker.removeFragmentsInRange(A,1/0,this.playlistType,!1,!0)}updateLevelTiming(A,B,C,D){const E=C.details;if(E){var F;if(!Object.keys(A.elementaryStreams).reduce(((B,F)=>{const G=A.elementaryStreams[F];if(G){const H=G.endPTS-G.startPTS;if(H<=0)return this.warn(`Could not parse fragment ${A.sn} ${F} duration reliably (${H})`),B||!1;const I=D?0:≈µ(E,A,G.startPTS,G.endPTS,G.startDTS,G.endDTS);return this.hls.trigger(–ª.LEVEL_PTS_UPDATED,{details:E,level:C,
drift:I,type:F,frag:A,start:G.startPTS,end:G.endPTS}),!0}return B}),!1)&&(0===C.fragmentError&&this.treatAsGap(A,C),null===(null==(F=this.transmuxer)?void 0:F.error))){const B=Error(`Found no media in fragment ${A.sn} of ${this.playlistLabel()} ${A.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(B.message),this.hls.trigger(–ª.ERROR,{type:–π.MEDIA_ERROR,details:–∫.FRAG_PARSING_ERROR,fatal:!1,error:B,frag:A,
reason:`Found no media in msn ${A.sn} of ${this.playlistLabel()} "${C.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=—ª,this.log(`Parsed ${A.type} sn: ${A.sn}${B?" part: "+B.index:""} of ${this.fragInfo(A,!1,B)})`),this.hls.trigger(–ª.FRAG_PARSED,{frag:A,part:B})}else this.warn("level.details undefined")}playlistLabel(){return this.playlistType===»µ?"level":"track"}fragInfo(A,B=!0,C){var D,E
;return`${this.playlistLabel()} ${A.level} (${C?"part":"frag"}:[${(null!=(D=B&&!C?A.startPTS:(C||A).start)?D:NaN).toFixed(3)}-${(null!=(E=B&&!C?A.endPTS:(C||A).end)?E:NaN).toFixed(3)}]${C&&"main"===A.type?"INDEPENDENT="+(C.independent?"YES":"NO"):""}`}treatAsGap(A,B){B&&B.fragmentError++,A.gap=!0,this.fragmentTracker.removeFragment(A),this.fragmentTracker.fragBuffered(A,!0)}resetTransmuxer(){var A;null==(A=this.transmuxer)||A.reset()}recoverWorkerError(A){
"demuxerWorker"===A.event&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(A){const B=this._state;B!==A&&(this._state=A,this.log(`${B}->${A}`))}get state(){return this._state}}class “Å{constructor(){this.chunks=[],this.dataLength=0}push(A){this.chunks.push(A),this.dataLength+=A.length}flush(){const{chunks:A,dataLength:B}=this;let C
;return A.length?(C=1===A.length?A[0]:function(A,B){const C=new Uint8Array(B);let D=0;for(let B=0;B<A.length;B++){const E=A[B];C.set(E,D),D+=E.length}return C}(A,B),this.reset(),C):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}…ó={exports:{}},…ò||(…ò=1,function(A){function B(){}function C(A,B,C){this.fn=A,this.context=B,this.once=C||!1}function D(A,B,D,E,F){if("function"!=typeof D)throw new TypeError("The listener must be a function");var G=new C(D,E||A,F),I=H?H+B:B
;return A._events[I]?A._events[I].fn?A._events[I]=[A._events[I],G]:A._events[I].push(G):(A._events[I]=G,A._eventsCount++),A}function E(A,C){0===--A._eventsCount?A._events=new B:delete A._events[C]}function F(){this._events=new B,this._eventsCount=0}var G=Object.prototype.hasOwnProperty,H="~";Object.create&&(B.prototype=Object.create(null),(new B).__proto__||(H=!1)),F.prototype.eventNames=function(){var A,B,C=[];if(0===this._eventsCount)return C
;for(B in A=this._events)G.call(A,B)&&C.push(H?B.slice(1):B);return Object.getOwnPropertySymbols?C.concat(Object.getOwnPropertySymbols(A)):C},F.prototype.listeners=function(A){var B,C,D,E=H?H+A:A,F=this._events[E];if(!F)return[];if(F.fn)return[F.fn];for(B=0,C=F.length,D=Array(C);B<C;B++)D[B]=F[B].fn;return D},F.prototype.listenerCount=function(A){var B=H?H+A:A,C=this._events[B];return C?C.fn?1:C.length:0},F.prototype.emit=function(A,B,C,D,E,F){var G,I,J,K,L,M,N=H?H+A:A
;if(!this._events[N])return!1;if(G=this._events[N],I=arguments.length,G.fn){switch(G.once&&this.removeListener(A,G.fn,void 0,!0),I){case 1:return G.fn.call(G.context),!0;case 2:return G.fn.call(G.context,B),!0;case 3:return G.fn.call(G.context,B,C),!0;case 4:return G.fn.call(G.context,B,C,D),!0;case 5:return G.fn.call(G.context,B,C,D,E),!0;case 6:return G.fn.call(G.context,B,C,D,E,F),!0}for(K=1,J=Array(I-1);K<I;K++)J[K-1]=arguments[K];G.fn.apply(G.context,J)}else for(L=G.length,
K=0;K<L;K++)switch(G[K].once&&this.removeListener(A,G[K].fn,void 0,!0),I){case 1:G[K].fn.call(G[K].context);break;case 2:G[K].fn.call(G[K].context,B);break;case 3:G[K].fn.call(G[K].context,B,C);break;case 4:G[K].fn.call(G[K].context,B,C,D);break;default:if(!J)for(M=1,J=Array(I-1);M<I;M++)J[M-1]=arguments[M];G[K].fn.apply(G[K].context,J)}return!0},F.prototype.on=function(A,B,C){return D(this,A,B,C,!1)},F.prototype.once=function(A,B,C){return D(this,A,B,C,!0)},
F.prototype.removeListener=function(A,B,C,D){var F,G,I,J,K=H?H+A:A;if(!this._events[K])return this;if(!B)return E(this,K),this;if((F=this._events[K]).fn)F.fn!==B||D&&!F.once||C&&F.context!==C||E(this,K);else{for(G=0,I=[],J=F.length;G<J;G++)(F[G].fn!==B||D&&!F[G].once||C&&F[G].context!==C)&&I.push(F[G]);I.length?this._events[K]=1===I.length?I[0]:I:E(this,K)}return this},F.prototype.removeAllListeners=function(A){var C;return A?(C=H?H+A:A,this._events[C]&&E(this,C)):(this._events=new B,
this._eventsCount=0),this},F.prototype.off=F.prototype.removeListener,F.prototype.addListener=F.prototype.on,F.prefixed=H,F.EventEmitter=F,A.exports=F}(…ó)),…ô=…ó.exports,…ö=ƒó(…ô);const “ä="1.6.4",“ã={};let “å=function(A){return A.audioId3="org.id3",A.dateRange="com.apple.quicktime.HLS",A.emsg="https://aomedia.org/emsg/ID3",A.misbklv="urn:misb:KLV:bin:1910.1",A}({});class “ç{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,
this.initPTS=null,this.lastPTS=null}resetInitSegment(A,B,C,D){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(A){this.initPTS=A,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(A,B){return!1}appendFrame(A,B,C){}demux(A,B){this.cachedData&&(A=ƒ™(this.cachedData,A),this.cachedData=null);let C,D=∆à(A,0),E=D?D.length:0
;const F=this._audioTrack,G=this._id3Track,H=D?∆ô(D):void 0,I=A.length;for((null===this.basePTS||0===this.frameIndex&&–∂(H))&&(this.basePTS=“é(H,B,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),D&&D.length>0&&G.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:D,type:“å.audioId3,duration:1/0});E<I;){if(this.canParse(A,E)){const B=this.appendFrame(F,A,E);B?(this.frameIndex++,this.lastPTS=B.sample.pts,E+=B.length,C=E):E=I}else ∆ë(A,E)?(D=∆à(A,E),
G.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:D,type:“å.audioId3,duration:1/0}),E+=D.length,C=E):E++;if(E===I&&C!==I){const B=A.slice(C);this.cachedData?this.cachedData=ƒ™(this.cachedData,B):this.cachedData=B}}return{audioTrack:F,videoTrack:∆ö(),id3Track:G,textTrack:∆ö()}}demuxSampleAes(A,B,C){return Promise.reject(Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(A){const B=this.cachedData;return B&&(this.cachedData=null,this.demux(B,0)),{
audioTrack:this._audioTrack,videoTrack:∆ö(),id3Track:this._id3Track,textTrack:∆ö()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const “é=(A,B,C)=>–∂(A)?90*A:9e4*B+(C?9e4*C.baseTime/C.timescale:0);let “è=null
;const “ê=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],“ë=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],“í=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],“ì=[0,1,1,4],“î=(A,B)=>{let C=0,D=5;B+=D;const E=new Uint32Array(1),F=new Uint32Array(1),G=new Uint8Array(1);for(;D>0;){G[0]=A[B]
;const H=Math.min(D,8),I=8-H;F[0]=4278190080>>>24+I<<I,E[0]=(G[0]&F[0])>>I,C=C?C<<H|E[0]:E[0],B+=1,D-=H}return C};class “ï extends “ç{constructor(A){super(),this.observer=void 0,this.observer=A}resetInitSegment(A,B,C,D){super.resetInitSegment(A,B,C,D),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:B,duration:D,inputTimeScale:9e4,dropped:0}}canParse(A,B){return B+64<A.length}appendFrame(A,B,C){
const D=∆†(A,B,C,this.basePTS,this.frameIndex);if(-1!==D)return{sample:A.samples[A.samples.length-1],length:D,missing:0}}static probe(A){if(!A)return!1;const B=∆à(A,0);if(!B)return!1;const C=B.length;return 11===A[C]&&119===A[C+1]&&void 0!==∆ô(B)&&“î(A,C)<16}}const “ñ=/\/emsg[-/]ID3/i;class “ó{constructor(A,B,C){this.keyData=void 0,this.decrypter=void 0,this.keyData=C,this.decrypter=new —õ(B,{removePKCS7Padding:!1})}decryptBuffer(A){
return this.decrypter.decrypt(A,this.keyData.key.buffer,this.keyData.iv.buffer,…å)}decryptAacSample(A,B,C){const D=A[B].unit;if(D.length<=16)return;const E=D.subarray(16,D.length-D.length%16),F=E.buffer.slice(E.byteOffset,E.byteOffset+E.length);this.decryptBuffer(F).then((E=>{const F=new Uint8Array(E);D.set(F,16),this.decrypter.isSync()||this.decryptAacSamples(A,B+1,C)}))}decryptAacSamples(A,B,C){for(;;B++){if(B>=A.length)return void C();if(!(A[B].unit.length<32||(this.decryptAacSample(A,B,C),
this.decrypter.isSync())))return}}getAvcEncryptedData(A){const B=16*Math.floor((A.length-48)/160)+16,C=new Int8Array(B);let D=0;for(let B=32;B<A.length-16;B+=160,D+=16)C.set(A.subarray(B,B+16),D);return C}getAvcDecryptedUnit(A,B){const C=new Uint8Array(B);let D=0;for(let B=32;B<A.length-16;B+=160,D+=16)A.set(C.subarray(D,D+16),B);return A}decryptAvcSample(A,B,C,D,E){const F=ƒØ(E.data),G=this.getAvcEncryptedData(F);this.decryptBuffer(G.buffer).then((G=>{E.data=this.getAvcDecryptedUnit(F,G),
this.decrypter.isSync()||this.decryptAvcSamples(A,B,C+1,D)}))}decryptAvcSamples(A,B,C,D){if(A instanceof Uint8Array)throw Error("Cannot decrypt samples of type Uint8Array");for(;;B++,C=0){if(B>=A.length)return void D();const E=A[B].units;for(;!(C>=E.length);C++){const F=E[C];if(!(F.data.length<=48||1!==F.type&&5!==F.type||(this.decryptAvcSample(A,B,C,D,F),this.decrypter.isSync())))return}}}}class “ò{constructor(){this.VideoSample=null}createVideoSample(A,B,C){return{key:A,frame:!1,pts:B,dts:C,
units:[],length:0}}getLastNalUnit(A){var B;let C,D=this.VideoSample;if(D&&0!==D.units.length||(D=A[A.length-1]),null!=(B=D)&&B.units){const A=D.units;C=A[A.length-1]}return C}pushAccessUnit(A,B){if(A.units.length&&A.frame){if(void 0===A.pts){const C=B.samples,D=C.length;if(!D)return void B.dropped++;{const B=C[D-1];A.pts=B.pts,A.dts=B.dts}}B.samples.push(A)}}parseNALu(A,B,C){const D=B.byteLength;let E=A.naluState||0;const F=E,G=[];let H,I,J,K=0,L=-1,M=0;for(-1===E&&(L=0,M=this.getNALuType(B,0),
E=0,K=1);K<D;)if(H=B[K++],E)if(1!==E)if(H)if(1===H){if(I=K-E-1,L>=0){const A={data:B.subarray(L,I),type:M};G.push(A)}else{const C=this.getLastNalUnit(A.samples);C&&(F&&K<=4-F&&C.state&&(C.data=C.data.subarray(0,C.data.byteLength-F)),I>0&&(C.data=ƒ™(C.data,B.subarray(0,I)),C.state=0))}K<D?(J=this.getNALuType(B,K),L=K,M=J,E=0):E=-1}else E=0;else E=3;else E=H?0:2;else E=H?0:1;if(L>=0&&E>=0){const A={data:B.subarray(L,D),type:M,state:E};G.push(A)}if(0===G.length){
const C=this.getLastNalUnit(A.samples);C&&(C.data=ƒ™(C.data,B))}return A.naluState=E,G}}class “ô{constructor(A){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=A,this.bytesAvailable=A.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const A=this.data,B=this.bytesAvailable,C=A.byteLength-B,D=new Uint8Array(4),E=Math.min(4,B);if(0===E)throw Error("no bytes available");D.set(A.subarray(C,C+E)),this.word=new DataView(D.buffer).getUint32(0),
this.bitsAvailable=8*E,this.bytesAvailable-=E}skipBits(A){let B;A=Math.min(A,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>A?(this.word<<=A,this.bitsAvailable-=A):(B=(A-=this.bitsAvailable)>>3,A-=B<<3,this.bytesAvailable-=B,this.loadWord(),this.word<<=A,this.bitsAvailable-=A)}readBits(A){let B=Math.min(this.bitsAvailable,A);const C=this.word>>>32-B;if(A>32&&—Ç.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=B,this.bitsAvailable>0)this.word<<=B;else{
if(!(this.bytesAvailable>0))throw Error("no bits available");this.loadWord()}return B=A-B,B>0&&this.bitsAvailable?C<<B|this.readBits(B):C}skipLZ(){let A;for(A=0;A<this.bitsAvailable;++A)if(this.word&2147483648>>>A)return this.word<<=A,this.bitsAvailable-=A,A;return this.loadWord(),A+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const A=this.skipLZ();return this.readBits(A+1)-1}readEG(){const A=this.readUEG();return 1&A?1+A>>>1:-1*(A>>>1)
}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class “ö extends “ò{parsePES(A,B,C,D){const E=this.parseNALu(A,C.data,D);let F,G=this.VideoSample,H=!1;C.data=null,G&&E.length&&!A.audFound&&(this.pushAccessUnit(G,A),G=this.VideoSample=this.createVideoSample(!1,C.pts,C.dts)),E.forEach((D=>{var E,I,J,K,L;switch(D.type){case 1:{let B=!1;F=!0;const E=D.data;if(H&&E.length>4){
const A=this.readSliceType(E);2!==A&&4!==A&&7!==A&&9!==A||(B=!0)}B&&null!=(J=G)&&J.frame&&!G.key&&(this.pushAccessUnit(G,A),G=this.VideoSample=null),G||(G=this.VideoSample=this.createVideoSample(!0,C.pts,C.dts)),G.frame=!0,G.key=B;break}case 5:F=!0,null!=(E=G)&&E.frame&&!G.key&&(this.pushAccessUnit(G,A),G=this.VideoSample=null),G||(G=this.VideoSample=this.createVideoSample(!0,C.pts,C.dts)),G.key=!0,G.frame=!0;break;case 6:F=!0,ƒÆ(D.data,1,C.pts,B.samples);break;case 7:{F=!0,H=!0
;const B=D.data,C=this.readSPS(B);if(!A.sps||A.width!==C.width||A.height!==C.height||(null==(K=A.pixelRatio)?void 0:K[0])!==C.pixelRatio[0]||(null==(L=A.pixelRatio)?void 0:L[1])!==C.pixelRatio[1]){A.width=C.width,A.height=C.height,A.pixelRatio=C.pixelRatio,A.sps=[B];const D=B.subarray(1,4);let E="avc1.";for(let A=0;A<3;A++){let B=D[A].toString(16);B.length<2&&(B="0"+B),E+=B}A.codec=E}break}case 8:F=!0,A.pps=[D.data];break;case 9:F=!0,A.audFound=!0,null!=(I=G)&&I.frame&&(this.pushAccessUnit(G,A),
G=null),G||(G=this.VideoSample=this.createVideoSample(!1,C.pts,C.dts));break;case 12:F=!0;break;default:F=!1}G&&F&&G.units.push(D)})),D&&G&&(this.pushAccessUnit(G,A),this.VideoSample=null)}getNALuType(A,B){return 31&A[B]}readSliceType(A){const B=new “ô(A);return B.readUByte(),B.readUEG(),B.readUEG()}skipScalingList(A,B){let C,D=8,E=8;for(let F=0;F<A;F++)0!==E&&(C=B.readEG(),E=(D+C+256)%256),D=0===E?D:E}readSPS(A){const B=new “ô(A);let C,D,E,F=0,G=0,H=0,I=0
;const J=B.readUByte.bind(B),K=B.readBits.bind(B),L=B.readUEG.bind(B),M=B.readBoolean.bind(B),N=B.skipBits.bind(B),O=B.skipEG.bind(B),P=B.skipUEG.bind(B),Q=this.skipScalingList.bind(this);J();const R=J();if(K(5),N(3),J(),P(),100===R||110===R||122===R||244===R||44===R||83===R||86===R||118===R||128===R){const A=L();if(3===A&&N(1),P(),P(),N(1),M())for(D=3!==A?8:12,E=0;E<D;E++)M()&&Q(E<6?16:64,B)}P();const S=L();if(0===S)L();else if(1===S)for(N(1),O(),O(),C=L(),E=0;E<C;E++)O();P(),N(1)
;const T=L(),U=L(),V=K(1);0===V&&N(1),N(1),M()&&(F=L(),G=L(),H=L(),I=L());let W=[1,1];if(M()&&M())switch(J()){case 1:W=[1,1];break;case 2:W=[12,11];break;case 3:W=[10,11];break;case 4:W=[16,11];break;case 5:W=[40,33];break;case 6:W=[24,11];break;case 7:W=[20,11];break;case 8:W=[32,11];break;case 9:W=[80,33];break;case 10:W=[18,11];break;case 11:W=[15,11];break;case 12:W=[64,33];break;case 13:W=[160,99];break;case 14:W=[4,3];break;case 15:W=[3,2];break;case 16:W=[2,1];break;case 255:
W=[J()<<8|J(),J()<<8|J()]}return{width:Math.ceil(16*(T+1)-2*F-2*G),height:(2-V)*(U+1)*16-(V?2:4)*(H+I),pixelRatio:W}}}class “õ extends “ò{constructor(...A){super(...A),this.initVPS=null}parsePES(A,B,C,D){const E=this.parseNALu(A,C.data,D);let F,G=this.VideoSample,H=!1;C.data=null,G&&E.length&&!A.audFound&&(this.pushAccessUnit(G,A),G=this.VideoSample=this.createVideoSample(!1,C.pts,C.dts)),E.forEach((D=>{var E,I,J;switch(D.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:
G||(G=this.VideoSample=this.createVideoSample(!1,C.pts,C.dts)),G.frame=!0,F=!0;break;case 16:case 17:case 18:case 21:F=!0,H&&null!=(J=G)&&J.frame&&!G.key&&(this.pushAccessUnit(G,A),G=this.VideoSample=null),G||(G=this.VideoSample=this.createVideoSample(!0,C.pts,C.dts)),G.key=!0,G.frame=!0;break;case 19:case 20:F=!0,null!=(E=G)&&E.frame&&!G.key&&(this.pushAccessUnit(G,A),G=this.VideoSample=null),G||(G=this.VideoSample=this.createVideoSample(!0,C.pts,C.dts)),G.key=!0,G.frame=!0;break;case 39:F=!0,
ƒÆ(D.data,2,C.pts,B.samples);break;case 32:F=!0,A.vps||("object"!=typeof A.params&&(A.params={}),A.params=ƒè(A.params,this.readVPS(D.data)),this.initVPS=D.data),A.vps=[D.data];break;case 33:if(F=!0,H=!0,void 0===A.vps||A.vps[0]===this.initVPS||void 0===A.sps||this.matchSPS(A.sps[0],D.data)||(this.initVPS=A.vps[0],A.sps=A.pps=void 0),!A.sps){const B=this.readSPS(D.data);A.width=B.width,A.height=B.height,A.pixelRatio=B.pixelRatio,A.codec=B.codecString,A.sps=[],
"object"!=typeof A.params&&(A.params={});for(const C in B.params)A.params[C]=B.params[C]}this.pushParameterSet(A.sps,D.data,A.vps),G||(G=this.VideoSample=this.createVideoSample(!0,C.pts,C.dts)),G.key=!0;break;case 34:if(F=!0,"object"==typeof A.params){if(!A.pps){A.pps=[];const B=this.readPPS(D.data);for(const C in B)A.params[C]=B[C]}this.pushParameterSet(A.pps,D.data,A.vps)}break;case 35:F=!0,A.audFound=!0,null!=(I=G)&&I.frame&&(this.pushAccessUnit(G,A),G=null),
G||(G=this.VideoSample=this.createVideoSample(!1,C.pts,C.dts));break;default:F=!1}G&&F&&G.units.push(D)})),D&&G&&(this.pushAccessUnit(G,A),this.VideoSample=null)}pushParameterSet(A,B,C){(C&&C[0]===this.initVPS||!C&&!A.length)&&A.push(B)}getNALuType(A,B){return(126&A[B])>>>1}ebsp2rbsp(A){const B=new Uint8Array(A.byteLength);let C=0;for(let D=0;D<A.byteLength;D++)D>=2&&3===A[D]&&0===A[D-1]&&0===A[D-2]||(B[C]=A[D],C++);return new Uint8Array(B.buffer,0,C)}pushAccessUnit(A,B){
super.pushAccessUnit(A,B),this.initVPS&&(this.initVPS=null)}readVPS(A){const B=new “ô(A);return B.readUByte(),B.readUByte(),B.readBits(4),B.skipBits(2),B.readBits(6),{numTemporalLayers:B.readBits(3)+1,temporalIdNested:B.readBoolean()}}readSPS(A){const B=new “ô(this.ebsp2rbsp(A));B.readUByte(),B.readUByte(),B.readBits(4);const C=B.readBits(3);B.readBoolean()
;const D=B.readBits(2),E=B.readBoolean(),F=B.readBits(5),G=B.readUByte(),H=B.readUByte(),I=B.readUByte(),J=B.readUByte(),K=B.readUByte(),L=B.readUByte(),M=B.readUByte(),N=B.readUByte(),O=B.readUByte(),P=B.readUByte(),Q=B.readUByte(),R=[],S=[];for(let A=0;A<C;A++)R.push(B.readBoolean()),S.push(B.readBoolean());if(C>0)for(let A=C;A<8;A++)B.readBits(2);for(let A=0;A<C;A++)R[A]&&(B.readUByte(),B.readUByte(),B.readUByte(),B.readUByte(),B.readUByte(),B.readUByte(),B.readUByte(),B.readUByte(),
B.readUByte(),B.readUByte(),B.readUByte()),S[A]&&B.readUByte();B.readUEG();const T=B.readUEG();3==T&&B.skipBits(1);const U=B.readUEG(),V=B.readUEG(),W=B.readBoolean();let X=0,Y=0,Z=0,a=0;W&&(X+=B.readUEG(),Y+=B.readUEG(),Z+=B.readUEG(),a+=B.readUEG());const b=B.readUEG(),c=B.readUEG(),d=B.readUEG();for(let A=B.readBoolean()?0:C;A<=C;A++)B.skipUEG(),B.skipUEG(),B.skipUEG();if(B.skipUEG(),B.skipUEG(),B.skipUEG(),B.skipUEG(),B.skipUEG(),B.skipUEG(),
B.readBoolean()&&B.readBoolean())for(let A=0;A<4;A++)for(let C=0;C<(3===A?2:6);C++)if(B.readBoolean()){const C=Math.min(64,1<<4+(A<<1));A>1&&B.readEG();for(let A=0;A<C;A++)B.readEG()}else B.readUEG();B.readBoolean(),B.readBoolean(),B.readBoolean()&&(B.readUByte(),B.skipUEG(),B.skipUEG(),B.readBoolean());const e=B.readUEG();let f=0;for(let A=0;A<e;A++){let C=!1;if(0!==A&&(C=B.readBoolean()),C){A===e&&B.readUEG(),B.readBoolean(),B.readUEG();let C=0;for(let A=0;A<=f;A++){const A=B.readBoolean()
;let D=!1;A||(D=B.readBoolean()),(A||D)&&C++}f=C}else{const A=B.readUEG(),C=B.readUEG();f=A+C;for(let C=0;C<A;C++)B.readUEG(),B.readBoolean();for(let A=0;A<C;A++)B.readUEG(),B.readBoolean()}}if(B.readBoolean()){const A=B.readUEG();for(let C=0;C<A;C++){for(let A=0;A<d+4;A++)B.readBits(1);B.readBits(1)}}let g=0,h=1,i=1,j=!0,k=1,l=0;B.readBoolean(),B.readBoolean();let m=!1;if(B.readBoolean()){if(B.readBoolean()){const A=B.readUByte();A>0&&A<16?(h=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][A-1],
i=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][A-1]):255===A&&(h=B.readBits(16),i=B.readBits(16))}if(B.readBoolean()&&B.readBoolean(),B.readBoolean()&&(B.readBits(3),B.readBoolean(),B.readBoolean()&&(B.readUByte(),B.readUByte(),B.readUByte())),B.readBoolean()&&(B.readUEG(),B.readUEG()),B.readBoolean(),B.readBoolean(),B.readBoolean(),m=B.readBoolean(),m&&(X+=B.readUEG(),Y+=B.readUEG(),Z+=B.readUEG(),a+=B.readUEG()),B.readBoolean()&&(k=B.readBits(32),l=B.readBits(32),B.readBoolean()&&B.readUEG(),
B.readBoolean())){const A=B.readBoolean(),D=B.readBoolean();let E=!1;(A||D)&&(E=B.readBoolean(),E&&(B.readUByte(),B.readBits(5),B.readBoolean(),B.readBits(5)),B.readBits(4),B.readBits(4),E&&B.readBits(4),B.readBits(5),B.readBits(5),B.readBits(5));for(let F=0;F<=C;F++){j=B.readBoolean();let C=!1;j||B.readBoolean()?B.readEG():C=B.readBoolean();const F=C?1:B.readUEG()+1;if(A)for(let A=0;A<F;A++)B.readUEG(),B.readUEG(),E&&(B.readUEG(),B.readUEG()),B.skipBits(1);if(D)for(let A=0;A<F;A++)B.readUEG(),
B.readUEG(),E&&(B.readUEG(),B.readUEG()),B.skipBits(1)}}B.readBoolean()&&(B.readBoolean(),B.readBoolean(),B.readBoolean(),g=B.readUEG())}let n=U,o=V;if(W||m){let A=1,B=1;1===T?A=B=2:2==T&&(A=2),n=U-A*Y-A*X,o=V-B*a-B*Z}const p=D?["A","B","C"][D]:"",q=G<<24|H<<16|I<<8|J;let r=0;for(let A=0;A<32;A++)r=(r|(q>>A&1)<<31-A)>>>0;let s=r.toString(16);return 1===F&&"2"===s&&(s="6"),{codecString:`hvc1.${p}${F}.${s}.${E?"H":"L"}${Q}.B0`,params:{general_tier_flag:E,general_profile_idc:F,
general_profile_space:D,general_profile_compatibility_flags:[G,H,I,J],general_constraint_indicator_flags:[K,L,M,N,O,P],general_level_idc:Q,bit_depth:b+8,bit_depth_luma_minus8:b,bit_depth_chroma_minus8:c,min_spatial_segmentation_idc:g,chroma_format_idc:T,frame_rate:{fixed:j,fps:l/k}},width:n,height:o,pixelRatio:[h,i]}}readPPS(A){const B=new “ô(this.ebsp2rbsp(A));B.readUByte(),B.readUByte(),B.skipUEG(),B.skipUEG(),B.skipBits(2),B.skipBits(3),B.skipBits(2),B.skipUEG(),B.skipUEG(),B.skipEG(),
B.skipBits(2),B.readBoolean()&&B.skipUEG(),B.skipEG(),B.skipEG(),B.skipBits(4);const C=B.readBoolean(),D=B.readBoolean();let E=1;return D&&C?E=0:D?E=3:C&&(E=2),{parallelismType:E}}matchSPS(A,B){return String.fromCharCode.apply(null,A).substr(3)===String.fromCharCode.apply(null,B).substr(3)}}const “ú=188;class “ù{constructor(A,B,C,D){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,
this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=A,this.config=B,this.typeSupported=C,this.logger=D,this.videoParser=null}static probe(A,B){const C=“ù.syncOffset(A);return C>0&&B.warn("MPEG2-TS detected but first sync word found @ offset "+C),-1!==C}static syncOffset(A){const B=A.length;let C=Math.min(940,B-“ú)+1,D=0;for(;D<C;){
let E=!1,F=-1,G=0;for(let H=D;H<B;H+=“ú){if(71!==A[H]||B-H!==“ú&&71!==A[H+“ú]){if(G)return-1;break}if(G++,-1===F&&(F=H,0!==F&&(C=Math.min(F+18612,A.length-“ú)+1)),E||(E=0===∆¢(A,H)),E&&G>1&&(0===F&&G>2||H+“ú>C))return F}D++}return-1}static createTrack(A,B){return{container:"video"===A||"audio"===A?"video/mp2t":void 0,type:A,id:—ä[A],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===A?B:void 0}}resetInitSegment(A,B,C,D){this.pmtParsed=!1,this._pmtId=-1,
this._videoTrack=“ù.createTrack("video"),this._videoTrack.duration=D,this._audioTrack=“ù.createTrack("audio",D),this._id3Track=“ù.createTrack("id3"),this._txtTrack=“ù.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=B,this.videoCodec=C}resetTimeStamp(){}resetContiguity(){const{_audioTrack:A,_videoTrack:B,_id3Track:C}=this;A&&(A.pesData=null),B&&(B.pesData=null),C&&(C.pesData=null),this.aacOverFlow=null,this.remainderData=null}
demux(A,B,C=!1,D=!1){let E;C||(this.sampleAes=null);const F=this._videoTrack,G=this._audioTrack,H=this._id3Track,I=this._txtTrack;let J=F.pid,K=F.pesData,L=G.pid,M=H.pid,N=G.pesData,O=H.pesData,P=null,Q=this.pmtParsed,R=this._pmtId,S=A.length;if(this.remainderData&&(S=(A=ƒ™(this.remainderData,A)).length,this.remainderData=null),S<“ú&&!D)return this.remainderData=A,{audioTrack:G,videoTrack:F,id3Track:H,textTrack:I};const T=Math.max(0,“ù.syncOffset(A));S-=(S-T)%“ú,
S<A.byteLength&&!D&&(this.remainderData=new Uint8Array(A.buffer,S,A.buffer.byteLength-S));let U=0;for(let B=T;B<S;B+=“ú)if(71===A[B]){const D=!!(64&A[B+1]),S=∆¢(A,B);let U;if((48&A[B+3])>>4>1){if(U=B+5+A[B+4],U===B+“ú)continue}else U=B+4;switch(S){case J:if(D){if(K&&(E=∆ß(K,this.logger))){if(null===this.videoParser)switch(F.segmentCodec){case"avc":this.videoParser=new “ö;break;case"hevc":this.videoParser=new “õ}null!==this.videoParser&&this.videoParser.parsePES(F,I,E,!1)}K={data:[],size:0}}
K&&(K.data.push(A.subarray(U,B+“ú)),K.size+=B+“ú-U);break;case L:if(D){if(N&&(E=∆ß(N,this.logger)))switch(G.segmentCodec){case"aac":this.parseAACPES(G,E);break;case"mp3":this.parseMPEGPES(G,E);break;case"ac3":this.parseAC3PES(G,E)}N={data:[],size:0}}N&&(N.data.push(A.subarray(U,B+“ú)),N.size+=B+“ú-U);break;case M:D&&(O&&(E=∆ß(O,this.logger))&&this.parseID3PES(H,E),O={data:[],size:0}),O&&(O.data.push(A.subarray(U,B+“ú)),O.size+=B+“ú-U);break;case 0:D&&(U+=A[U]+1),R=this._pmtId=∆£(A,U);break;case R:{
D&&(U+=A[U]+1);const E=∆§(A,U,this.typeSupported,C,this.observer,this.logger);J=E.videoPid,J>0&&(F.pid=J,F.segmentCodec=E.segmentVideoCodec),L=E.audioPid,L>0&&(G.pid=L,G.segmentCodec=E.segmentAudioCodec),M=E.id3Pid,M>0&&(H.pid=M),null===P||Q||(this.logger.warn(`MPEG-TS PMT found at ${B} after unknown PID '${P}'. Backtracking to sync byte @${T} to parse all TS packets.`),P=null,B=T-188),Q=this.pmtParsed=!0;break}case 17:case 8191:break;default:P=S}}else U++
;U>0&&∆•(this.observer,Error(`Found ${U} TS packet/s that do not start with 0x47`),void 0,this.logger),F.pesData=K,G.pesData=N,H.pesData=O;const V={audioTrack:G,videoTrack:F,id3Track:H,textTrack:I};return D&&this.extractRemainingSamples(V),V}flush(){const{remainderData:A}=this;let B;return this.remainderData=null,B=A?this.demux(A,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(B),
this.sampleAes?this.decrypt(B,this.sampleAes):B}extractRemainingSamples(A){const{audioTrack:B,videoTrack:C,id3Track:D,textTrack:E}=A,F=C.pesData,G=B.pesData,H=D.pesData;let I;if(F&&(I=∆ß(F,this.logger))){if(null===this.videoParser)switch(C.segmentCodec){case"avc":this.videoParser=new “ö;break;case"hevc":this.videoParser=new “õ}null!==this.videoParser&&(this.videoParser.parsePES(C,E,I,!0),C.pesData=null)}else C.pesData=F;if(G&&(I=∆ß(G,this.logger))){switch(B.segmentCodec){case"aac":
this.parseAACPES(B,I);break;case"mp3":this.parseMPEGPES(B,I);break;case"ac3":this.parseAC3PES(B,I)}B.pesData=null}else null!=G&&G.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),B.pesData=G;H&&(I=∆ß(H,this.logger))?(this.parseID3PES(D,I),D.pesData=null):D.pesData=H}demuxSampleAes(A,B,C){const D=this.demux(A,C,!0,!this.config.progressive),E=this.sampleAes=new “ó(this.observer,this.config,B);return this.decrypt(D,E)}decrypt(A,B){return new Promise((C=>{
const{audioTrack:D,videoTrack:E}=A;D.samples&&"aac"===D.segmentCodec?B.decryptAacSamples(D.samples,0,(()=>{E.samples?B.decryptAvcSamples(E.samples,0,0,(()=>{C(A)})):C(A)})):E.samples&&B.decryptAvcSamples(E.samples,0,0,(()=>{C(A)}))}))}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(A,B){
let C=0;const D=this.aacOverFlow;let E,F,G,H=B.data;if(D){this.aacOverFlow=null;const B=D.missing,E=D.sample.unit.byteLength;if(-1===B)H=ƒ™(D.sample.unit,H);else{const F=E-B;D.sample.unit.set(H.subarray(0,B),F),A.samples.push(D.sample),C=D.missing}}for(E=C,F=H.length;E<F-1&&!∆å(H,E);E++);if(E!==C){let A;const B=E<F-1;if(A=B?"AAC PES did not start with ADTS header,offset:"+E:"No ADTS header found in AAC PES",∆•(this.observer,Error(A),B,this.logger),!B)return}
if(∆é(A,this.observer,H,E,this.audioCodec),void 0!==B.pts)G=B.pts;else{if(!D)return void this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");{const B=∆è(A.samplerate);G=D.sample.pts+B}}let I,J=0;for(;E<F;){if(I=∆ê(A,H,E,G,J),E+=I.length,I.missing){this.aacOverFlow=I;break}for(J++;E<F-1&&!∆å(H,E);E++);}}parseMPEGPES(A,B){const C=B.data,D=C.length;let E=0,F=0;const G=B.pts;if(void 0!==G)for(;F<D;)if(∆û(C,F)){const B=∆õ(A,C,F,G,E);if(!B)break;F+=B.length,E++
}else F++;else this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseAC3PES(A,B){{const C=B.data,D=B.pts;if(void 0===D)return void this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");const E=C.length;let F,G=0,H=0;for(;H<E&&(F=∆†(A,C,H,D,G++))>0;)H+=F}}parseID3PES(A,B){if(void 0===B.pts)return void this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");const C=ƒè({},B,{type:this._videoTrack?“å.emsg:“å.audioId3,duration:1/0});A.samples.push(C)}}class “û{static getSilentFrame(A,B){
if("mp4a.40.2"===A){if(1===B)return new Uint8Array([0,200,0,128,35,128]);if(2===B)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===B)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===B)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===B)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===B)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])
}else{if(1===B)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===B)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])
;if(3===B)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}class “ü{static init(){let A;for(A in “ü.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],
stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},“ü.types)“ü.types.hasOwnProperty(A)&&(“ü.types[A]=[A.charCodeAt(0),A.charCodeAt(1),A.charCodeAt(2),A.charCodeAt(3)]);const B=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),C=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);“ü.HDLR_TYPES={video:B,audio:C}
;const D=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),E=new Uint8Array([0,0,0,0,0,0,0,0]);“ü.STTS=“ü.STSC=“ü.STCO=E,“ü.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),“ü.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),“ü.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),“ü.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const F=new Uint8Array([105,115,111,109]),G=new Uint8Array([97,118,99,49]),H=new Uint8Array([0,0,0,1]);“ü.FTYP=“ü.box(“ü.types.ftyp,F,H,F,G),“ü.DINF=“ü.box(“ü.types.dinf,“ü.box(“ü.types.dref,D))
}static box(A,...B){let C=8,D=B.length;const E=D;for(;D--;)C+=B[D].byteLength;const F=new Uint8Array(C);for(F[0]=C>>24&255,F[1]=C>>16&255,F[2]=C>>8&255,F[3]=255&C,F.set(A,4),D=0,C=8;D<E;D++)F.set(B[D],C),C+=B[D].byteLength;return F}static hdlr(A){return “ü.box(“ü.types.hdlr,“ü.HDLR_TYPES[A])}static mdat(A){return “ü.box(“ü.types.mdat,A)}static mdhd(A,B){const C=Math.floor((B*=A)/4294967296),D=Math.floor(B%4294967296)
;return “ü.box(“ü.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,A>>24&255,A>>16&255,A>>8&255,255&A,C>>24,C>>16&255,C>>8&255,255&C,D>>24,D>>16&255,D>>8&255,255&D,85,196,0,0]))}static mdia(A){return “ü.box(“ü.types.mdia,“ü.mdhd(A.timescale||0,A.duration||0),“ü.hdlr(A.type),“ü.minf(A))}static mfhd(A){return “ü.box(“ü.types.mfhd,new Uint8Array([0,0,0,0,A>>24,A>>16&255,A>>8&255,255&A]))}static minf(A){
return"audio"===A.type?“ü.box(“ü.types.minf,“ü.box(“ü.types.smhd,“ü.SMHD),“ü.DINF,“ü.stbl(A)):“ü.box(“ü.types.minf,“ü.box(“ü.types.vmhd,“ü.VMHD),“ü.DINF,“ü.stbl(A))}static moof(A,B,C){return “ü.box(“ü.types.moof,“ü.mfhd(A),“ü.traf(C,B))}static moov(A){let B=A.length;const C=[];for(;B--;)C[B]=“ü.trak(A[B]);return “ü.box.apply(null,[“ü.types.moov,“ü.mvhd(A[0].timescale||0,A[0].duration||0)].concat(C).concat(“ü.mvex(A)))}static mvex(A){let B=A.length;const C=[];for(;B--;)C[B]=“ü.trex(A[B])
;return “ü.box.call(null,“ü.types.mvex,...C)}static mvhd(A,B){const C=Math.floor((B*=A)/4294967296),D=Math.floor(B%4294967296),E=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,A>>24&255,A>>16&255,A>>8&255,255&A,C>>24,C>>16&255,C>>8&255,255&C,D>>24,D>>16&255,D>>8&255,255&D,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return “ü.box(“ü.types.mvhd,E)}static sdtp(A){
const B=A.samples||[],C=new Uint8Array(4+B.length);let D,E;for(D=0;D<B.length;D++)E=B[D].flags,C[D+4]=E.dependsOn<<4|E.isDependedOn<<2|E.hasRedundancy;return “ü.box(“ü.types.sdtp,C)}static stbl(A){return “ü.box(“ü.types.stbl,“ü.stsd(A),“ü.box(“ü.types.stts,“ü.STTS),“ü.box(“ü.types.stsc,“ü.STSC),“ü.box(“ü.types.stsz,“ü.STSZ),“ü.box(“ü.types.stco,“ü.STCO))}static avc1(A){let B,C,D,E=[],F=[];for(B=0;B<A.sps.length;B++)C=A.sps[B],D=C.byteLength,E.push(D>>>8&255),E.push(255&D),
E=E.concat(Array.prototype.slice.call(C));for(B=0;B<A.pps.length;B++)C=A.pps[B],D=C.byteLength,F.push(D>>>8&255),F.push(255&D),F=F.concat(Array.prototype.slice.call(C));const G=“ü.box(“ü.types.avcC,new Uint8Array([1,E[3],E[4],E[5],255,224|A.sps.length].concat(E).concat([A.pps.length]).concat(F))),H=A.width,I=A.height,J=A.pixelRatio[0],K=A.pixelRatio[1]
;return “ü.box(“ü.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,H>>8&255,255&H,I>>8&255,255&I,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),G,“ü.box(“ü.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),“ü.box(“ü.types.pasp,new Uint8Array([J>>24,J>>16&255,J>>8&255,255&J,K>>24,K>>16&255,K>>8&255,255&K])))}static esds(A){const B=A.config
;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...B,6,1,2])}static audioStsd(A){const B=A.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,A.channelCount||0,0,16,0,0,0,0,B>>8&255,255&B,0,0])}static mp4a(A){return “ü.box(“ü.types.mp4a,“ü.audioStsd(A),“ü.box(“ü.types.esds,“ü.esds(A)))}static mp3(A){return “ü.box(“ü.types[".mp3"],“ü.audioStsd(A))}static ac3(A){return “ü.box(“ü.types["ac-3"],“ü.audioStsd(A),“ü.box(“ü.types.dac3,A.config))}static stsd(A){
const{segmentCodec:B}=A;if("audio"===A.type){if("aac"===B)return “ü.box(“ü.types.stsd,“ü.STSD,“ü.mp4a(A));if("ac3"===B&&A.config)return “ü.box(“ü.types.stsd,“ü.STSD,“ü.ac3(A));if("mp3"===B&&"mp3"===A.codec)return “ü.box(“ü.types.stsd,“ü.STSD,“ü.mp3(A))}else{if(!A.pps||!A.sps)throw Error("video track missing pps or sps");if("avc"===B)return “ü.box(“ü.types.stsd,“ü.STSD,“ü.avc1(A));if("hevc"===B&&A.vps)return “ü.box(“ü.types.stsd,“ü.STSD,“ü.hvc1(A))}throw Error(`unsupported ${A.type} segment codec (${B}/${A.codec})`)
}static tkhd(A){const B=A.id,C=(A.duration||0)*(A.timescale||0),D=A.width||0,E=A.height||0,F=Math.floor(C/4294967296),G=Math.floor(C%4294967296);return “ü.box(“ü.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,B>>24&255,B>>16&255,B>>8&255,255&B,0,0,0,0,F>>24,F>>16&255,F>>8&255,255&F,G>>24,G>>16&255,G>>8&255,255&G,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,D>>8&255,255&D,0,0,E>>8&255,255&E,0,0]))}static traf(A,B){
const C=“ü.sdtp(A),D=A.id,E=Math.floor(B/4294967296),F=Math.floor(B%4294967296);return “ü.box(“ü.types.traf,“ü.box(“ü.types.tfhd,new Uint8Array([0,0,0,0,D>>24,D>>16&255,D>>8&255,255&D])),“ü.box(“ü.types.tfdt,new Uint8Array([1,0,0,0,E>>24,E>>16&255,E>>8&255,255&E,F>>24,F>>16&255,F>>8&255,255&F])),“ü.trun(A,C.length+16+20+8+16+8+8),C)}static trak(A){return A.duration=A.duration||4294967295,“ü.box(“ü.types.trak,“ü.tkhd(A),“ü.mdia(A))}static trex(A){const B=A.id
;return “ü.box(“ü.types.trex,new Uint8Array([0,0,0,0,B>>24,B>>16&255,B>>8&255,255&B,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(A,B){const C=A.samples||[],D=C.length,E=12+16*D,F=new Uint8Array(E);let G,H,I,J,K,L;for(B+=8+E,F.set(["video"===A.type?1:0,0,15,1,D>>>24&255,D>>>16&255,D>>>8&255,255&D,B>>>24&255,B>>>16&255,B>>>8&255,255&B],0),G=0;G<D;G++)H=C[G],I=H.duration,J=H.size,K=H.flags,L=H.cts,
F.set([I>>>24&255,I>>>16&255,I>>>8&255,255&I,J>>>24&255,J>>>16&255,J>>>8&255,255&J,K.isLeading<<2|K.dependsOn,K.isDependedOn<<6|K.hasRedundancy<<4|K.paddingValue<<1|K.isNonSync,61440&K.degradPrio,15&K.degradPrio,L>>>24&255,L>>>16&255,L>>>8&255,255&L],12+16*G);return “ü.box(“ü.types.trun,F)}static initSegment(A){“ü.types||“ü.init();const B=“ü.moov(A);return ƒ™(“ü.FTYP,B)}static hvc1(A){
const B=A.params,C=[A.vps,A.sps,A.pps],D=new Uint8Array([1,B.general_profile_space<<6|(B.general_tier_flag?32:0)|B.general_profile_idc,B.general_profile_compatibility_flags[0],B.general_profile_compatibility_flags[1],B.general_profile_compatibility_flags[2],B.general_profile_compatibility_flags[3],B.general_constraint_indicator_flags[0],B.general_constraint_indicator_flags[1],B.general_constraint_indicator_flags[2],B.general_constraint_indicator_flags[3],B.general_constraint_indicator_flags[4],B.general_constraint_indicator_flags[5],B.general_level_idc,240|B.min_spatial_segmentation_idc>>8,255&B.min_spatial_segmentation_idc,252|B.parallelismType,252|B.chroma_format_idc,248|B.bit_depth_luma_minus8,248|B.bit_depth_chroma_minus8,0,parseInt(B.frame_rate.fps),3|B.temporal_id_nested<<2|B.num_temporal_layers<<3|(B.frame_rate.fixed?64:0),C.length])
;let E=D.length;for(let A=0;A<C.length;A+=1){E+=3;for(let B=0;B<C[A].length;B+=1)E+=2+C[A][B].length}const F=new Uint8Array(E);F.set(D,0),E=D.length;const G=C.length-1;for(let A=0;A<C.length;A+=1){F.set(new Uint8Array([32+A|(A===G?128:0),0,C[A].length]),E),E+=3;for(let B=0;B<C[A].length;B+=1)F.set(new Uint8Array([C[A][B].length>>8,255&C[A][B].length]),E),E+=2,F.set(C[A][B],E),E+=C[A][B].length}const H=“ü.box(“ü.types.hvcC,F),I=A.width,J=A.height,K=A.pixelRatio[0],L=A.pixelRatio[1]
;return “ü.box(“ü.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,I>>8&255,255&I,J>>8&255,255&J,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),H,“ü.box(“ü.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),“ü.box(“ü.types.pasp,new Uint8Array([K>>24,K>>16&255,K>>8&255,255&K,L>>24,L>>16&255,L>>8&255,255&L])))}}“ü.types=void 0,“ü.HDLR_TYPES=void 0,“ü.STTS=void 0,
“ü.STSC=void 0,“ü.STCO=void 0,“ü.STSZ=void 0,“ü.VMHD=void 0,“ü.SMHD=void 0,“ü.STSD=void 0,“ü.FTYP=void 0,“ü.DINF=void 0;let “†,“°=null,“¢=null;class “£{constructor(A,B,C,D){if(this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=A,this.config=B,
this.typeSupported=C,this.logger=D,this.ISGenerated=!1,null===“°){const A=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);“°=A?parseInt(A[1]):0}if(null===“¢){const A=navigator.userAgent.match(/Safari\/(\d+)/i);“¢=A?parseInt(A[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(A){this.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=A}resetNextTimestamp(){this.logger.log("[mp4-remuxer]: reset next timestamp"),
this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(A){let B=!1;const C=A[0].pts,D=A.reduce(((A,D)=>{let E=D.pts,F=E-A;return F<-4294967296&&(B=!0,E=∆´(E,C),F=E-A),F>0?A:E}),C);return B&&this.logger.debug("PTS rollover detected"),D}remux(A,B,C,D,E,F,G,H){let I,J,K,L,M,N,O=E,P=E
;const Q=A.pid>-1,R=B.pid>-1,S=B.samples.length,T=A.samples.length>0,U=G&&S>0||S>1;if((!Q||T)&&(!R||U)||this.ISGenerated||G){if(this.ISGenerated){var V,W,X,Y;const A=this.videoTrackConfig;(A&&(B.width!==A.width||B.height!==A.height||(null==(V=B.pixelRatio)?void 0:V[0])!==(null==(W=A.pixelRatio)?void 0:W[0])||(null==(X=B.pixelRatio)?void 0:X[1])!==(null==(Y=A.pixelRatio)?void 0:Y[1]))||!A&&U||null===this.nextAudioPts&&T)&&this.resetInitSegment()}this.ISGenerated||(K=this.generateIS(A,B,E,F))
;const C=this.isVideoContiguous;let D,G=-1;if(U&&(G=function(A){for(let B=0;B<A.length;B++)if(A[B].key)return B;return-1}(B.samples),!C&&this.config.forceKeyFrameOnDiscontinuity))if(N=!0,G>0){this.logger.warn(`[mp4-remuxer]: Dropped ${G} out of ${S} video samples due to a missing keyframe`);const A=this.getVideoStartPts(B.samples);B.samples=B.samples.slice(G),B.dropped+=G,P+=(B.samples[0].pts-A)/B.inputTimeScale,D=P
}else-1===G&&(this.logger.warn(`[mp4-remuxer]: No keyframe found out of ${S} video samples`),N=!1);if(this.ISGenerated){if(T&&U){const C=this.getVideoStartPts(B.samples),D=(∆´(A.samples[0].pts,C)-C)/B.inputTimeScale;O+=Math.max(0,D),P+=Math.max(0,-D)}if(T){if(A.samplerate||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),K=this.generateIS(A,B,E,F)),J=this.remuxAudio(A,O,this.isAudioContiguous,F,R||U||H===»∂?P:void 0),U){const D=J?J.endPTS-J.startPTS:0
;B.inputTimeScale||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),K=this.generateIS(A,B,E,F)),I=this.remuxVideo(B,P,C,D)}}else U&&(I=this.remuxVideo(B,P,C,0));I&&(I.firstKeyFrame=G,I.independent=-1!==G,I.firstKeyFramePTS=D)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(C.samples.length&&(M=∆¨(C,E,this._initPTS,this._initDTS)),D.samples.length&&(L=∆≠(D,E,this._initPTS))),{audio:J,video:I,initSegment:K,independent:N,text:L,id3:M}}generateIS(A,B,C,D){
const E=A.samples,F=B.samples,G=this.typeSupported,H={},I=this._initPTS;let J,K,L,M,N=!I||D,O="audio/mp4";if(N&&(J=K=1/0),A.config&&E.length){switch(A.timescale=A.samplerate,A.segmentCodec){case"mp3":G.mpeg?(O="audio/mpeg",A.codec=""):G.mp3&&(A.codec="mp3");break;case"ac3":A.codec="ac-3"}H.audio={id:"audio",container:O,codec:A.codec,initSegment:"mp3"===A.segmentCodec&&G.mpeg?new Uint8Array(0):“ü.initSegment([A]),metadata:{channelCount:A.channelCount}},N&&(M=A.id,L=A.inputTimeScale,
I&&L===I.timescale?N=!1:J=K=E[0].pts-Math.round(L*C))}if(B.sps&&B.pps&&F.length){if(B.timescale=B.inputTimeScale,H.video={id:"main",container:"video/mp4",codec:B.codec,initSegment:“ü.initSegment([B]),metadata:{width:B.width,height:B.height}},N)if(M=B.id,L=B.inputTimeScale,I&&L===I.timescale)N=!1;else{const A=this.getVideoStartPts(F),B=Math.round(L*C);K=Math.min(K,∆´(F[0].dts,A)-B),J=Math.min(J,A-B)}this.videoTrackConfig={width:B.width,height:B.height,pixelRatio:B.pixelRatio}}
if(Object.keys(H).length)return this.ISGenerated=!0,N?(this._initPTS={baseTime:J,timescale:L},this._initDTS={baseTime:K,timescale:L}):J=L=void 0,{tracks:H,initPTS:J,timescale:L,trackId:M}}remuxVideo(A,B,C,D){const E=A.inputTimeScale,F=A.samples,G=[],H=F.length,I=this._initPTS;let J,K,L=this.nextAvcDts,M=8,N=this.videoSampleDuration,O=1/0,P=-1/0,Q=!1;if(!C||null===L){const A=B*E,D=F[0].pts-∆´(F[0].dts,F[0].pts);“°&&null!==L&&Math.abs(A-D-L)<15e3?C=!0:L=A-D}const R=I.baseTime*E/I.timescale
;for(let A=0;A<H;A++){const B=F[A];B.pts=∆´(B.pts-R,L),B.dts=∆´(B.dts-R,L),B.dts<F[A>0?A-1:A].dts&&(Q=!0)}Q&&F.sort((function(A,B){const C=A.dts-B.dts,D=A.pts-B.pts;return C||D})),J=F[0].dts,K=F[F.length-1].dts;const S=K-J,T=S?Math.round(S/(H-1)):N||A.inputTimeScale/30;if(C){const C=J-L,D=C>T,E=C<-1
;if((D||E)&&(D?this.logger.warn(`${(A.segmentCodec||"").toUpperCase()}: ${∆©(C,!0)} ms (${C}dts) hole between fragments detected at ${B.toFixed(3)}`):this.logger.warn(`${(A.segmentCodec||"").toUpperCase()}: ${∆©(-C,!0)} ms (${C}dts) overlapping between fragments detected at ${B.toFixed(3)}`),!E||L>=F[0].pts||“°)){J=L;const A=F[0].pts-C;if(D)F[0].dts=J,F[0].pts=A;else{let B=!0;for(let D=0;D<F.length&&!(F[D].dts>A&&B);D++){const A=F[D].pts;if(F[D].dts-=C,F[D].pts-=C,D<F.length-1){const C=F[D+1].pts
;B=C<=F[D].pts==C<=A}}}this.logger.log(`Video: Initial PTS/DTS adjusted: ${∆©(A,!0)}/${∆©(J,!0)}, delta: ${∆©(C,!0)} ms`)}}J=Math.max(0,J);let U=0,V=0,W=J;for(let A=0;A<H;A++){const B=F[A],C=B.units,D=C.length;let E=0;for(let A=0;A<D;A++)E+=C[A].data.length;V+=E,U+=D,B.length=E,B.dts<W?(B.dts=W,W+=T/4|0||1):W=B.dts,O=Math.min(B.pts,O),P=Math.max(B.pts,P)}K=F[H-1].dts;const X=V+4*U+8;let Y;try{Y=new Uint8Array(X)}catch(A){return void this.observer.emit(–ª.ERROR,–ª.ERROR,{type:–π.MUX_ERROR,
details:–∫.REMUX_ALLOC_ERROR,fatal:!1,error:A,bytes:X,reason:"fail allocating video mdat "+X})}const Z=new DataView(Y.buffer);Z.setUint32(0,X),Y.set(“ü.types.mdat,4);let a=!1,b=1/0,c=1/0,d=-1/0,e=-1/0;for(let A=0;A<H;A++){const B=F[A],C=B.units;let I,J=0;for(let A=0,B=C.length;A<B;A++){const B=C[A],D=B.data,E=B.data.byteLength;Z.setUint32(M,E),M+=4,Y.set(D,M),M+=E,J+=4+E}if(A<H-1)N=F[A+1].dts-B.dts,I=F[A+1].pts-B.pts;else{const C=this.config,G=A>0?B.dts-F[A-1].dts:T;if(I=A>0?B.pts-F[A-1].pts:T,
C.stretchShortVideoTrack&&null!==this.nextAudioPts){const A=Math.floor(C.maxBufferHole*E),F=(D?O+D*E:this.nextAudioPts)-B.pts;F>A?(N=F-G,N<0?N=G:a=!0,this.logger.log(`[mp4-remuxer]: It is approximately ${F/90} ms to the next segment; using duration ${N/90} ms for the last video frame.`)):N=G}else N=G}const K=Math.round(B.pts-B.dts);b=Math.min(b,N),d=Math.max(d,N),c=Math.min(c,I),e=Math.max(e,I),G.push(∆™(B.key,N,J,K))}if(G.length)if(“°){if(“°<70){const A=G[0].flags;A.dependsOn=2,A.isNonSync=0}
}else if(“¢&&e-c<d-b&&T/d<.025&&0===G[0].cts){this.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let A=J;for(let B=0,C=G.length;B<C;B++){const D=A+G[B].duration,E=A+G[B].cts;if(B<C-1){const A=D+G[B+1].cts;G[B].duration=A-E}else G[B].duration=B?G[B-1].duration:T;G[B].cts=0,A=D}}N=a||!N?T:N,this.nextAvcDts=L=K+N,this.videoSampleDuration=N,this.isVideoContiguous=!0;const f={data1:“ü.moof(A.sequenceNumber++,J,ƒè(A,{samples:G})),
data2:Y,startPTS:O/E,endPTS:(P+N)/E,startDTS:J/E,endDTS:L/E,type:"video",hasAudio:!1,hasVideo:!0,nb:G.length,dropped:A.dropped};return A.samples=[],A.dropped=0,f}getSamplesPerFrame(A){switch(A.segmentCodec){case"mp3":return 1152;case"ac3":return 1536;default:return 1024}}remuxAudio(A,B,C,D,E){const F=A.inputTimeScale,G=F/(A.samplerate?A.samplerate:F),H=this.getSamplesPerFrame(A),I=H*G,J=this._initPTS,K="mp3"===A.segmentCodec&&this.typeSupported.mpeg,L=[],M=void 0!==E
;let N=A.samples,O=K?0:8,P=this.nextAudioPts||-1;const Q=B*F,R=J.baseTime*F/J.timescale;if(this.isAudioContiguous=C=C||N.length&&P>0&&(D&&Math.abs(Q-P)<9e3||Math.abs(∆´(N[0].pts-R,Q)-P)<20*I),N.forEach((function(A){A.pts=∆´(A.pts-R,Q)})),!C||P<0){if(N=N.filter((A=>A.pts>=0)),!N.length)return;P=0===E?0:D&&!M?Math.max(0,Q):N[0].pts}if("aac"===A.segmentCodec){const B=this.config.maxAudioFramesDrift;for(let C=0,D=P;C<N.length;C++){const E=N[C],G=E.pts,H=G-D,J=Math.abs(1e3*H/F)
;if(H<=-B*I&&M)0===C&&(this.logger.warn(`Audio frame @ ${(G/F).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*H/F)} ms.`),this.nextAudioPts=P=D=G);else if(H>=B*I&&J<1e4&&M){let B=Math.round(H/I);D=G-B*I,D<0&&(B--,D+=I),0===C&&(this.nextAudioPts=P=D),this.logger.warn(`[mp4-remuxer]: Injecting ${B} audio frame @ ${(D/F).toFixed(3)}s due to ${Math.round(1e3*H/F)} ms gap.`);for(let F=0;F<B;F++){const B=Math.max(D,0)
;let F=“û.getSilentFrame(A.parsedCodec||A.manifestCodec||A.codec,A.channelCount);F||(this.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),F=E.unit.subarray()),N.splice(C,0,{unit:F,pts:B}),D+=I,C++}}E.pts=D,D+=I}}let S,T=null,U=null,V=0,W=N.length;for(;W--;)V+=N[W].unit.byteLength;for(let B=0,D=N.length;B<D;B++){const D=N[B],E=D.unit;let F=D.pts;if(null!==U)L[B-1].duration=Math.round((F-U)/G);else{if(C&&"aac"===A.segmentCodec&&(F=P),
T=F,!(V>0))return;V+=O;try{S=new Uint8Array(V)}catch(A){return void this.observer.emit(–ª.ERROR,–ª.ERROR,{type:–π.MUX_ERROR,details:–∫.REMUX_ALLOC_ERROR,fatal:!1,error:A,bytes:V,reason:"fail allocating audio mdat "+V})}K||(new DataView(S.buffer).setUint32(0,V),S.set(“ü.types.mdat,4))}S.set(E,O);const I=E.byteLength;O+=I,L.push(∆™(!0,H,I,0)),U=F}const X=L.length;if(!X)return;const Y=L[L.length-1];this.nextAudioPts=P=U+G*Y.duration;const Z=K?new Uint8Array(0):“ü.moof(A.sequenceNumber++,T/G,ƒè({},A,{
samples:L}));A.samples=[];const a=T/F,b=P/F,c={data1:Z,data2:S,startPTS:a,endPTS:b,startDTS:a,endDTS:b,type:"audio",hasAudio:!0,hasVideo:!1,nb:X};return this.isAudioContiguous=!0,c}}try{“†=self.performance.now.bind(self.performance)}catch(»ï){“†=Date.now}const “§=[{demux:class{constructor(A,B){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=B}resetTimeStamp(){}resetInitSegment(A,B,C,D){
const E=this.videoTrack=∆ö("video",1),F=this.audioTrack=∆ö("audio",1),G=this.txtTrack=∆ö("text",1);if(this.id3Track=∆ö("id3",1),this.timeOffset=0,null==A||!A.byteLength)return;const H=ƒ£(A);if(H.video){const{id:A,timescale:B,codec:C,supplemental:D}=H.video;E.id=A,E.timescale=G.timescale=B,E.codec=C,E.supplemental=D}if(H.audio){const{id:A,timescale:B,codec:C}=H.audio;F.id=A,F.timescale=B,F.codec=C}G.id=—ä.text,E.sampleDuration=0,E.duration=F.duration=D}resetContiguity(){this.remainderData=null}
static probe(A){return function(A){const B=A.byteLength;for(let C=0;C<B;){const D=ƒù(A,C);if(D>8&&109===A[C+4]&&111===A[C+5]&&111===A[C+6]&&102===A[C+7])return!0;C=D>1?C+D:B}return!1}(A)}demux(A,B){this.timeOffset=B;let C=A;const D=this.videoTrack,E=this.txtTrack;if(this.config.progressive){this.remainderData&&(C=ƒ™(this.remainderData,A));const B=function(A){const B={valid:null,remainder:null},C=ƒ°(A,["moof"]);if(C.length<2)return B.remainder=A,B;const D=C[C.length-1]
;return B.valid=A.slice(0,D.byteOffset-8),B.remainder=A.slice(D.byteOffset-8),B}(C);this.remainderData=B.remainder,D.samples=B.valid||new Uint8Array}else D.samples=C;const F=this.extractID3Track(D,B);return E.samples=ƒ´(B,D),{videoTrack:D,audioTrack:this.audioTrack,id3Track:F,textTrack:this.txtTrack}}flush(){const A=this.timeOffset,B=this.videoTrack,C=this.txtTrack;B.samples=this.remainderData||new Uint8Array,this.remainderData=null;const D=this.extractID3Track(B,this.timeOffset)
;return C.samples=ƒ´(A,B),{videoTrack:B,audioTrack:∆ö(),id3Track:D,textTrack:∆ö()}}extractID3Track(A,B){const C=this.id3Track;if(A.samples.length){const D=ƒ°(A.samples,["emsg"]);D&&D.forEach((A=>{const D=function(A){const B=A[0];let C="",D="",E=0,F=0,G=0,H=0,I=0,J=0;if(0===B){for(;"\0"!==ƒõ(A.subarray(J,J+1));)C+=ƒõ(A.subarray(J,J+1)),J+=1;for(C+=ƒõ(A.subarray(J,J+1)),J+=1;"\0"!==ƒõ(A.subarray(J,J+1));)D+=ƒõ(A.subarray(J,J+1)),J+=1;D+=ƒõ(A.subarray(J,J+1)),J+=1,E=ƒù(A,12),F=ƒù(A,16),H=ƒù(A,20),I=ƒù(A,24),J=28
}else if(1===B){J+=4,E=ƒù(A,J),J+=4;const B=ƒù(A,J);J+=4;const F=ƒù(A,J);for(J+=4,G=2**32*B+F,–∑(G)||(G=Number.MAX_SAFE_INTEGER,—Ç.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),H=ƒù(A,J),J+=4,I=ƒù(A,J),J+=4;"\0"!==ƒõ(A.subarray(J,J+1));)C+=ƒõ(A.subarray(J,J+1)),J+=1;for(C+=ƒõ(A.subarray(J,J+1)),J+=1;"\0"!==ƒõ(A.subarray(J,J+1));)D+=ƒõ(A.subarray(J,J+1)),J+=1;D+=ƒõ(A.subarray(J,J+1)),J+=1}return{schemeIdUri:C,value:D,timeScale:E,presentationTime:G,
presentationTimeDelta:F,eventDuration:H,id:I,payload:A.subarray(J,A.byteLength)}}(A);if(“ñ.test(D.schemeIdUri)){const A=∆°(D,B);let E=4294967295===D.eventDuration?1/0:D.eventDuration/D.timeScale;E<=.001&&(E=1/0);const F=D.payload;C.samples.push({data:F,len:F.byteLength,dts:A,pts:A,type:“å.emsg,duration:E})}else if(this.config.enableEmsgKLVMetadata&&D.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const A=∆°(D,B);C.samples.push({data:D.payload,len:D.payload.byteLength,dts:A,pts:A,type:“å.misbklv,
duration:1/0})}}))}return C}demuxSampleAes(A,B,C){return Promise.reject(Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}},remux:class{constructor(A,B,C,D){this.logger=void 0,this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1,
this.logger=D}destroy(){}resetTimeStamp(A){this.initPTS=A,this.lastEndTime=null}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(A,B,C,D){this.audioCodec=B,this.videoCodec=C,this.generateInitSegment(function(A,B){if(!A||!B)return A;const C=B.keyId;return C&&B.isCommonEncryption&&ƒ°(A,["moov","trak"]).forEach((A=>{const B=ƒ°(A,["mdia","minf","stbl","stsd"])[0].subarray(8);let D=ƒ°(B,["enca"]);const E=D.length>0;E||(D=ƒ°(B,["encv"])),D.forEach((A=>{
ƒ°(E?A.subarray(28):A.subarray(78),["sinf"]).forEach((A=>{const B=ƒ©(A);if(B){const A=B.subarray(8,24);A.some((A=>0!==A))||(—Ç.log(`[eme] Patching keyId in 'enc${E?"a":"v"}>sinf>>tenc' box: ${—É(A)} -> ${—É(C)}`),B.set(C,8))}}))}))})),A}(A,D)),this.emitInitSegment=!0}generateInitSegment(A){let{audioCodec:B,videoCodec:C}=this;if(null==A||!A.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const D=this.initData=ƒ£(A);D.audio&&(B=∆Ø(D.audio,»ª,this.logger)),
D.video&&(C=∆Ø(D.video,»º,this.logger));const E={};D.audio&&D.video?E.audiovideo={container:"video/mp4",codec:B+","+C,supplemental:D.video.supplemental,initSegment:A,id:"main"}:D.audio?E.audio={container:"audio/mp4",codec:B,initSegment:A,id:"audio"}:D.video?E.video={container:"video/mp4",codec:C,supplemental:D.video.supplemental,initSegment:A,id:"main"}:this.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=E}remux(A,B,C,D,E,F){var G,H
;let{initPTS:I,lastEndTime:J}=this;const K={audio:void 0,video:void 0,text:D,id3:C,initSegment:void 0};–∂(J)||(J=this.lastEndTime=E||0);const L=B.samples;if(null==L||!L.length)return K;const M={initPTS:void 0,timescale:void 0,trackId:void 0};let N=this.initData;if(null!=(G=N)&&G.length||(this.generateInitSegment(L),N=this.initData),null==(H=N)||!H.length)return this.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),K;this.emitInitSegment&&(M.tracks=this.initTracks,
this.emitInitSegment=!1);const O=function(A,B,C){const D={},E=ƒ°(A,["moof","traf"]);for(let A=0;A<E.length;A++){const F=E[A],G=ƒ°(F,["tfhd"])[0],H=ƒù(G,4),I=B[H];if(!I)continue;const J=D[H]||(D[H]={start:NaN,duration:0,sampleCount:0,timescale:I.timescale,type:I.type}),K=ƒ°(F,["tfdt"])[0];if(K){const A=K[0];let B=ƒù(K,4);1===A&&(B===—à?C.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(B*=4294967296,B+=ƒù(K,8))),–∂(B)&&(!–∂(J.start)||B<J.start)&&(J.start=B)}
const L=I.default,M=ƒù(G,0)|(null==L?void 0:L.flags);let N=(null==L?void 0:L.duration)||0;8&M&&(N=ƒù(G,2&M?12:8));const O=ƒ°(F,["trun"]);let P=J.start||0,Q=0,R=N;for(let A=0;A<O.length;A++){const B=O[A],C=ƒù(B,4),D=J.sampleCount;J.sampleCount+=C;const E=1&B[3],F=4&B[3],G=1&B[2],H=2&B[2],I=4&B[2],K=8&B[2];let L=8,M=C;for(E&&(L+=4),F&&C&&(1&B[L+1]||void 0!==J.keyFrameIndex||(J.keyFrameIndex=D),L+=4,G?(R=ƒù(B,L),L+=4):R=N,H&&(L+=4),K&&(L+=4),P+=R,Q+=R,M--);M--;)G?(R=ƒù(B,L),L+=4):R=N,H&&(L+=4),
I&&(1&B[L+1]||void 0===J.keyFrameIndex&&(J.keyFrameIndex=J.sampleCount-(M+1),J.keyFrameStart=P),L+=4),K&&(L+=4),P+=R,Q+=R;!Q&&N&&(Q+=N*C)}J.duration+=Q}if(!Object.keys(D).some((A=>D[A].duration))){let B=1/0,C=0;const E=ƒ°(A,["sidx"]);for(let A=0;A<E.length;A++){const D=ƒ¢(E[A]);if(null!=D&&D.references){B=Math.min(B,D.earliestPresentationTime/D.timescale);const A=D.references.reduce(((A,B)=>A+B.info.duration||0),0);C=Math.max(C,A+D.earliestPresentationTime/D.timescale)}}
C&&–∂(C)&&Object.keys(D).forEach((A=>{D[A].duration||(D[A].duration=C*D[A].timescale-D[A].start)}))}return D}(L,N,this.logger),P=N.audio?O[N.audio.id]:null,Q=N.video?O[N.video.id]:null,R=∆Æ(Q,1/0),S=∆Æ(P,1/0),T=∆Æ(Q,0,!0),U=∆Æ(P,0,!0);let V,W=E,X=0;if(P&&(!Q||!I&&S<R||I&&I.trackId===N.audio.id)?(M.trackId=N.audio.id,V=P,X=U-S):Q&&(M.trackId=N.video.id,V=Q,X=T-R),V){const A=V.timescale;W=V.start/A,M.timescale=A,I||(M.initPTS=V.start-E*A,this.initPTS=I={baseTime:M.initPTS,timescale:A,trackId:M.trackId
})}!F&&I||!function(A,B,C,D){if(null===A)return!0;const E=Math.max(D,1),F=B-A.baseTime/A.timescale;return Math.abs(F-C)>E}(I,W,E,X)&&M.timescale===I.timescale||(M.initPTS=W-E,I&&1===I.timescale&&this.logger.warn(`Adjusting initPTS @${E} from ${I.baseTime/I.timescale} to ${M.initPTS}`),this.initPTS=I={baseTime:M.initPTS,timescale:1});const Y=A?W-I.baseTime/I.timescale:J;!function(A,B,C){ƒ°(B,["moof","traf"]).forEach((B=>{ƒ°(B,["tfhd"]).forEach((D=>{const E=ƒù(D,4),F=A[E];if(!F)return
;const G=F.timescale||9e4;ƒ°(B,["tfdt"]).forEach((A=>{const B=A[0],D=C*G;if(D){let C=ƒù(A,4);if(0===B)C-=D,C=Math.max(C,0),ƒ†(A,4,C);else{C*=4294967296,C+=ƒù(A,8),C-=D,C=Math.max(C,0);const B=Math.floor(C/4294967296),E=Math.floor(C%4294967296);ƒ†(A,4,B),ƒ†(A,8,E)}}}))}))}))}(N,L,I.baseTime/I.timescale);const Z=Y+X;X>0?this.lastEndTime=Z:(this.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const a=!!N.audio,b=!!N.video;let c="";a&&(c+="audio"),
b&&(c+="video");const d={data1:L,startPTS:Y,startDTS:Y,endPTS:Z,endDTS:Z,type:c,hasAudio:a,hasVideo:b,nb:1,dropped:0};K.audio=a&&!b?d:void 0,K.video=b?d:void 0;const e=null==Q?void 0:Q.sampleCount;if(e){const A=Q.keyFrameIndex,B=-1!==A;d.nb=e,d.dropped=0===A||this.isVideoContiguous?0:B?A:e,d.independent=B,d.firstKeyFrame=A,B&&Q.keyFrameStart&&(d.firstKeyFramePTS=Q.keyFrameStart-I.baseTime/I.timescale),this.isVideoContiguous||(K.independent=B),this.isVideoContiguous||(this.isVideoContiguous=B),
d.dropped&&this.logger.warn(`fmp4 does not start with IDR: firstIDR ${A}/${e} dropped: ${d.dropped} pts: ${d.firstKeyFramePTS||"NA"}`)}return K.initSegment=M,K.id3=∆¨(C,E,I,I),D.samples.length&&(K.text=∆≠(D,E,I)),K}}},{demux:“ù,remux:“£},{demux:class extends “ç{constructor(A,B){super(),this.observer=void 0,this.config=void 0,this.observer=A,this.config=B}resetInitSegment(A,B,C,D){super.resetInitSegment(A,B,C,D),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,
segmentCodec:"aac",samples:[],manifestCodec:B,duration:D,inputTimeScale:9e4,dropped:0}}static probe(A,B){if(!A)return!1;const C=∆à(A,0);let D=(null==C?void 0:C.length)||0;if(∆ü(A,D))return!1;for(let C=A.length;D<C;D++)if(∆ç(A,D))return B.log("ADTS sync word found !"),!0;return!1}canParse(A,B){return function(A,B){return function(A,B){return B+5<A.length}(A,B)&&∆â(A,B)&&∆ã(A,B)<=A.length-B}(A,B)}appendFrame(A,B,C){∆é(A,this.observer,B,C,A.manifestCodec);const D=∆ê(A,B,C,this.basePTS,this.frameIndex)
;if(D&&0===D.missing)return D}},remux:“£},{demux:class extends “ç{resetInitSegment(A,B,C,D){super.resetInitSegment(A,B,C,D),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:B,duration:D,inputTimeScale:9e4,dropped:0}}static probe(A){if(!A)return!1;const B=∆à(A,0);let C=(null==B?void 0:B.length)||0;if(B&&11===A[C]&&119===A[C+1]&&void 0!==∆ô(B)&&“î(A,C)<=16)return!1
;for(let B=A.length;C<B;C++)if(∆ü(A,C))return —Ç.log("MPEG Audio sync word found !"),!0;return!1}canParse(A,B){return function(A,B){return ∆ù(A,B)&&4<=A.length-B}(A,B)}appendFrame(A,B,C){if(null!==this.basePTS)return ∆õ(A,B,C,this.basePTS,this.frameIndex)}},remux:“£}];“§.splice(2,0,{demux:“ï,remux:“£});class “•{constructor(A,B,C,D,E,F){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,
this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=A,this.typeSupported=B,this.config=C,this.id=E,this.logger=F}configure(A){this.transmuxConfig=A,this.decrypter&&this.decrypter.reset()}push(A,B,C,D){const E=C.transmuxing;E.executeStart=“†();let F=new Uint8Array(A);const{currentTransmuxState:G,transmuxConfig:H}=this;D&&(this.currentTransmuxState=D)
;const{contiguous:I,discontinuity:J,trackSwitch:K,accurateTimeOffset:L,timeOffset:M,initSegmentChange:N}=D||G,{audioCodec:O,videoCodec:P,defaultInitPts:Q,duration:R,initSegmentData:S}=H,T=function(A,B){let C=null;return A.byteLength>0&&null!=(null==B?void 0:B.key)&&null!==B.iv&&null!=B.method&&(C=B),C}(F,B);if(T&&≈ü(T.method)){const A=this.getDecrypter(),B=≈†(T.method);if(!A.isSync())return this.asyncResult=!0,this.decryptionPromise=A.webCryptoDecrypt(F,T.key.buffer,T.iv.buffer,B).then((A=>{
const B=this.push(A,null,C);return this.decryptionPromise=null,B})),this.decryptionPromise;{let D=A.softwareDecrypt(F,T.key.buffer,T.iv.buffer,B);if(C.part>-1){const B=A.flush();D=B?B.buffer:B}if(!D)return E.executeEnd=“†(),“¶(C);F=new Uint8Array(D)}}const U=this.needsProbing(J,K);if(U){const A=this.configureTransmuxer(F);if(A)return this.logger.warn("[transmuxer] "+A.message),this.observer.emit(–ª.ERROR,–ª.ERROR,{type:–π.MEDIA_ERROR,details:–∫.FRAG_PARSING_ERROR,fatal:!1,error:A,reason:A.message}),
E.executeEnd=“†(),“¶(C)}(J||K||N||U)&&this.resetInitSegment(S,O,P,R,B),(J||N||U)&&this.resetInitialTimestamp(Q),I||this.resetContiguity();const V=this.transmux(F,T,M,L,C);this.asyncResult=∆∞(V);const W=this.currentTransmuxState;return W.contiguous=!0,W.discontinuity=!1,W.trackSwitch=!1,E.executeEnd=“†(),V}flush(A){const B=A.transmuxing;B.executeStart=“†();const{decrypter:C,currentTransmuxState:D,decryptionPromise:E}=this;if(E)return this.asyncResult=!0,E.then((()=>this.flush(A)))
;const F=[],{timeOffset:G}=D;if(C){const B=C.flush();B&&F.push(this.push(B.buffer,null,A))}const{demuxer:H,remuxer:I}=this;if(!H||!I){B.executeEnd=“†();const C=[“¶(A)];return this.asyncResult?Promise.resolve(C):C}const J=H.flush(G);return ∆∞(J)?(this.asyncResult=!0,J.then((B=>(this.flushRemux(F,B,A),F)))):(this.flushRemux(F,J,A),this.asyncResult?Promise.resolve(F):F)}flushRemux(A,B,C){
const{audioTrack:D,videoTrack:E,id3Track:F,textTrack:G}=B,{accurateTimeOffset:H,timeOffset:I}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${C.sn}${C.part>-1?" part: "+C.part:""} of ${this.id===»µ?"level":"track"} ${C.level}`);const J=this.remuxer.remux(D,E,F,G,I,H,!0,this.id);A.push({remuxResult:J,chunkMeta:C}),C.transmuxing.executeEnd=“†()}resetInitialTimestamp(A){const{demuxer:B,remuxer:C}=this;B&&C&&(B.resetTimeStamp(A),C.resetTimeStamp(A))}
resetContiguity(){const{demuxer:A,remuxer:B}=this;A&&B&&(A.resetContiguity(),B.resetNextTimestamp())}resetInitSegment(A,B,C,D,E){const{demuxer:F,remuxer:G}=this;F&&G&&(F.resetInitSegment(A,B,C,D),G.resetInitSegment(A,B,C,E))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(A,B,C,D,E){let F;return F=B&&"SAMPLE-AES"===B.method?this.transmuxSampleAes(A,B,C,D,E):this.transmuxUnencrypted(A,C,D,E),F}
transmuxUnencrypted(A,B,C,D){const{audioTrack:E,videoTrack:F,id3Track:G,textTrack:H}=this.demuxer.demux(A,B,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(E,F,G,H,B,C,!1,this.id),chunkMeta:D}}transmuxSampleAes(A,B,C,D,E){return this.demuxer.demuxSampleAes(A,B,C).then((A=>({remuxResult:this.remuxer.remux(A.audioTrack,A.videoTrack,A.id3Track,A.textTrack,C,D,!1,this.id),chunkMeta:E})))}configureTransmuxer(A){const{config:B,observer:C,typeSupported:D}=this;let E
;for(let B=0,C=“§.length;B<C;B++){var F;if(null!=(F=“§[B].demux)&&F.probe(A,this.logger)){E=“§[B];break}}if(!E)return Error("Failed to find demuxer by probing fragment data");const G=this.demuxer,H=this.remuxer,I=E.remux,J=E.demux;H&&H instanceof I||(this.remuxer=new I(C,B,D,this.logger)),G&&G instanceof J||(this.demuxer=new J(C,B,D,this.logger),this.probe=J.probe)}needsProbing(A,B){return!this.demuxer||!this.remuxer||A||B}getDecrypter(){let A=this.decrypter
;return A||(A=this.decrypter=new —õ(this.config)),A}}const “¶=A=>({remuxResult:{},chunkMeta:A});class “ß{constructor(A,B,C,D,E){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=A,this.videoCodec=B,this.initSegmentData=C,this.duration=D,this.defaultInitPts=E||null}}class “®{constructor(A,B,C,D,E,F){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,
this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=A,this.contiguous=B,this.accurateTimeOffset=C,this.trackSwitch=D,this.timeOffset=E,this.initSegmentChange=F}}let “©=0;class “™{constructor(A,B,C,D){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=“©++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=A=>{
const B=A.data,C=this.hls;if(C&&null!=B&&B.event&&B.instanceNo===this.instanceNo)switch(B.event){case"init":{var D;const A=null==(D=this.workerContext)?void 0:D.objectURL;A&&self.URL.revokeObjectURL(A);break}case"transmuxComplete":this.handleTransmuxComplete(B.data);break;case"flush":this.onFlush(B.data);break;case"workerLog":C.logger[B.data.logType]&&C.logger[B.data.logType](B.data.message);break;default:B.data=B.data||{},B.data.frag=this.frag,B.data.part=this.part,B.data.id=this.id,
C.trigger(B.event,B.data)}},this.onWorkerError=A=>{if(!this.hls)return;const B=Error(`${A.message}  (${A.filename}:${A.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(–ª.ERROR,{type:–π.OTHER_ERROR,details:–∫.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:B})};const E=A.config;this.hls=A,this.id=B,this.useWorker=!!E.enableWorker,this.onTransmuxComplete=C,this.onFlush=D;const F=(A,B)=>{
(B=B||{}).frag=this.frag||void 0,A===–ª.ERROR&&(B.parent=this.id,B.part=this.part,this.error=B.error),this.hls.trigger(A,B)};this.observer=new …ö,this.observer.on(–ª.FRAG_DECRYPTED,F),this.observer.on(–ª.ERROR,F);const G=ƒª(E.preferManagedMediaSource);if(this.useWorker&&"undefined"!=typeof Worker){const C=this.hls.logger;if(E.workerPath||"function"==typeof __HLS_WORKER_BUNDLE__){try{E.workerPath?(C.log(`loading Web Worker ${E.workerPath} for "${B}"`),this.workerContext=function(A){const B=“ã[A]
;if(B)return B.clientCount++,B;const C=new self.URL(A,self.location.href).href,D={worker:new self.Worker(C),scriptURL:C,clientCount:1};return “ã[A]=D,D}(E.workerPath)):(C.log(`injecting Web Worker for "${B}"`),this.workerContext=function(){const A=“ã[“ä];if(A)return A.clientCount++,A;const B=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),C=self.URL.createObjectURL(B),D={
worker:new self.Worker(C),objectURL:C,clientCount:1};return “ã[“ä]=D,D}());const{worker:A}=this.workerContext;A.addEventListener("message",this.onWorkerMessage),A.addEventListener("error",this.onWorkerError),A.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:G,id:B,config:—ï(E)})}catch(D){C.warn(`Error setting up "${B}" Web Worker, fallback to inline`,D),this.terminateWorker(),this.error=null,this.transmuxer=new “•(this.observer,G,E,"",B,A.logger)}return}}
this.transmuxer=new “•(this.observer,G,E,"",B,A.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const A=this.instanceNo;this.instanceNo=“©++;const B=this.hls.config,C=ƒª(B.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:A,typeSupported:C,id:this.id,config:—ï(B)})}}terminateWorker(){if(this.workerContext){const{worker:A}=this.workerContext;this.workerContext=null,A.removeEventListener("message",this.onWorkerMessage),
A.removeEventListener("error",this.onWorkerError),function(A){const B=“ã[A||“ä];if(B&&1===B.clientCount--){const{worker:C,objectURL:D}=B;delete “ã[A||“ä],D&&self.URL.revokeObjectURL(D),C.terminate()}}(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const A=this.transmuxer;A&&(A.destroy(),this.transmuxer=null)}const A=this.observer;A&&A.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,
this.hls=null}push(A,B,C,D,E,F,G,H,I,J){var K,L;I.transmuxing.start=self.performance.now();const{instanceNo:M,transmuxer:N}=this,O=F?F.start:E.start,P=E.decryptdata,Q=this.frag,R=!(Q&&E.cc===Q.cc),S=!(Q&&I.level===Q.level),T=Q?I.sn-Q.sn:-1,U=this.part?I.part-this.part.index:-1,V=0===T&&I.id>1&&I.id===(null==Q?void 0:Q.stats.chunkCount),W=!S&&(1===T||0===T&&(1===U||V&&U<=0)),X=self.performance.now();(S||T||0===E.stats.parsing.start)&&(E.stats.parsing.start=X),!F||!U&&W||(F.stats.parsing.start=X)
;const Y=!(Q&&(null==(K=E.initSegment)?void 0:K.url)===(null==(L=Q.initSegment)?void 0:L.url)),Z=new “®(R,W,H,S,O,Y);if(!W||R||Y){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${E.type} sn: ${I.sn}${I.part>-1?" part: "+I.part:""} ${this.id===»µ?"level":"track"}: ${I.level} id: ${I.id}\n        discontinuity: ${R}\n        trackSwitch: ${S}\n        contiguous: ${W}\n        accurateTimeOffset: ${H}\n        timeOffset: ${O}\n        initSegmentChange: ${Y}`)
;const A=new “ß(C,D,B,G,J);this.configureTransmuxer(A)}if(this.frag=E,this.part=F,this.workerContext)this.workerContext.worker.postMessage({instanceNo:M,cmd:"demux",data:A,decryptdata:P,chunkMeta:I,state:Z},A instanceof ArrayBuffer?[A]:[]);else if(N){const B=N.push(A,P,I,Z);∆∞(B)?B.then((A=>{this.handleTransmuxComplete(A)})).catch((A=>{this.transmuxerError(A,I,"transmuxer-interface push error")})):this.handleTransmuxComplete(B)}}flush(A){A.transmuxing.start=self.performance.now()
;const{instanceNo:B,transmuxer:C}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:B,cmd:"flush",chunkMeta:A});else if(C){const B=C.flush(A);∆∞(B)?B.then((B=>{this.handleFlushResult(B,A)})).catch((B=>{this.transmuxerError(B,A,"transmuxer-interface flush error")})):this.handleFlushResult(B,A)}}transmuxerError(A,B,C){this.hls&&(this.error=A,this.hls.trigger(–ª.ERROR,{type:–π.MEDIA_ERROR,details:–∫.FRAG_PARSING_ERROR,chunkMeta:B,frag:this.frag||void 0,part:this.part||void 0,
fatal:!1,error:A,err:A,reason:C}))}handleFlushResult(A,B){A.forEach((A=>{this.handleTransmuxComplete(A)})),this.onFlush(B)}configureTransmuxer(A){const{instanceNo:B,transmuxer:C}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:B,cmd:"configure",config:A}):C&&C.configure(A)}handleTransmuxComplete(A){A.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(A)}}class “´ extends –æ{constructor(A,B){super(B,A.logger),this.hls=void 0,this.canLoad=!1,
this.timer=-1,this.hls=A}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(A,B,C){const D=null==B?void 0:B.renditionReports;if(D){let E=-1;for(let C=0;C<D.length;C++){const F=D[C];let G;try{G=new self.URL(F.URI,B.url).href}catch(A){this.warn("Could not construct new URL for Rendition Report: "+A),
G=F.URI||""}if(G===A){E=C;break}G===A.substring(0,G.length)&&(E=C)}if(-1!==E){const A=D[E],F=parseInt(A["LAST-MSN"])||(null==B?void 0:B.lastPartSn);let G=parseInt(A["LAST-PART"])||(null==B?void 0:B.lastPartIndex);if(this.hls.config.lowLatencyMode){const A=Math.min(B.age-B.partTarget,B.targetduration);G>=0&&A>B.partTarget&&(G+=1)}const H=C&&≈Ä(C);return new —ì(F,G>=0?G:void 0,H)}}}loadPlaylist(A){this.clearTimer()}loadingPlaylist(A,B){this.clearTimer()}shouldLoadPlaylist(A){
return this.canLoad&&!!A&&!!A.url&&(!A.details||A.details.live)}getUrlWithDirectives(A,B){if(B)try{return B.addDirectives(A)}catch(A){this.warn("Could not construct new URL with HLS Delivery Directives: "+A)}return A}playlistLoaded(A,B,C){const{details:D,stats:E}=B,F=self.performance.now(),G=E.loading.first?Math.max(0,F-E.loading.first):0;D.advancedDateTime=Date.now()-G;const H=this.hls.config.timelineOffset;if(H!==D.appliedTimelineOffset){const A=Math.max(H||0,0);D.appliedTimelineOffset=A,
D.fragments.forEach((B=>{B.start=B.playlistOffset+A}))}if(D.live||null!=C&&C.live){const H="levelInfo"in B?B.levelInfo:B.track;if(D.reloaded(C),C&&D.fragments.length>0){≈∂(C,D);const A=D.playlistParsingError;if(A){this.warn(A);const C=this.hls;if(!C.config.ignorePlaylistParsingErrors){var I;const{networkDetails:F}=B;return void C.trigger(–ª.ERROR,{type:–π.NETWORK_ERROR,details:–∫.LEVEL_PARSING_ERROR,fatal:!1,url:D.url,error:A,reason:A.message,level:B.level||void 0,
parent:null==(I=D.fragments[0])?void 0:I.type,networkDetails:F,stats:E})}D.playlistParsingError=null}}-1===D.requestScheduled&&(D.requestScheduled=E.loading.start);const J=this.hls.mainForwardBufferInfo,K=J?J.end-J.len:0,L=≈∫(D,1e3*(D.edge-K));if(D.requestScheduled+L<F?D.requestScheduled=F:D.requestScheduled+=L,this.log(`live playlist ${A} ${D.advanced?"REFRESHED "+D.lastPartSn+"-"+D.lastPartIndex:D.updated?"UPDATED":"MISSED"}`),!this.canLoad||!D.live)return;let M,N,O
;if(D.canBlockReload&&D.endSN&&D.advanced){const A=this.hls.config.lowLatencyMode,E=D.lastPartSn,G=D.endSN,I=D.lastPartIndex,J=E===G;-1!==I?J?(N=G+1,O=A?0:I):(N=E,O=A?I+1:D.maxPartIndex):N=G+1;const K=D.age,L=K+D.ageHeader;let P=Math.min(L-D.partTarget,1.5*D.targetduration);if(P>0){if(L>3*D.targetduration)this.log(`Playlist last advanced ${K.toFixed(2)}s ago. Omitting segment and part directives.`),N=void 0,
O=void 0;else if(null!=C&&C.tuneInGoal&&L-D.partTarget>C.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${C.tuneInGoal} to: ${P} with playlist age: ${D.age}`),P=0;else{const A=Math.floor(P/D.targetduration);N+=A,void 0!==O&&(O+=Math.round(P%D.targetduration/D.partTarget)),this.log(`CDN Tune-in age: ${D.ageHeader}s last advanced ${K.toFixed(2)}s goal: ${P} skip sn ${A} to part ${O}`)}D.tuneInGoal=P}if(M=this.getDeliveryDirectives(D,B.deliveryDirectives,N,O),
A||!J)return D.requestScheduled=F,void this.loadingPlaylist(H,M)}else(D.canBlockReload||D.canSkipUntil)&&(M=this.getDeliveryDirectives(D,B.deliveryDirectives,N,O));M&&void 0!==N&&D.canBlockReload&&(D.requestScheduled=E.loading.first+Math.max(L-2*G,L/2)),this.scheduleLoading(H,M,D)}else this.clearTimer()}scheduleLoading(A,B,C){const D=C||A.details;if(!D)return void this.loadingPlaylist(A,B);const E=self.performance.now(),F=D.requestScheduled;if(E>=F)return void this.loadingPlaylist(A,B)
;const G=F-E;this.log(`reload live playlist ${A.name||A.bitrate+"bps"} in ${Math.round(G)} ms`),this.clearTimer(),this.timer=self.setTimeout((()=>this.loadingPlaylist(A,B)),G)}getDeliveryDirectives(A,B,C,D){let E=≈Ä(A);return null!=B&&B.skip&&A.deltaUpdateFailed&&(C=B.msn,D=B.part,E=»æ),new —ì(C,D,E)}checkRetry(A){const B=A.details,C=≈è(A),D=A.errorAction,{action:E,retryCount:F=0,retryConfig:G}=D||{},H=!!D&&!!G&&(E===…Ñ||!D.resolved&&E===…Ç);if(H){var I;if(F>=G.maxNumRetry)return!1
;if(C&&null!=(I=A.context)&&I.deliveryDirectives)this.warn(`Retrying playlist loading ${F+1}/${G.maxNumRetry} after "${B}" without delivery-directives`),this.loadPlaylist();else{const A=≈ë(G,F);this.clearTimer(),this.timer=self.setTimeout((()=>this.loadPlaylist()),A),this.warn(`Retrying playlist loading ${F+1}/${G.maxNumRetry} after "${B}" in ${A}ms`)}A.levelRetry=!0,D.resolved=!0}return H}}class “¨{constructor(A){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=A}
destroy(){this.tracks=this.queues=null}append(A,B,C){if(null===this.queues||null===this.tracks)return;const D=this.queues[B];D.push(A),1!==D.length||C||this.executeNext(B)}appendBlocker(A){return new Promise((B=>{const C={label:"async-blocker",execute:B,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(C,A)}))}prependBlocker(A){return new Promise((B=>{if(this.queues){const C={label:"async-blocker-prepend",execute:B,onStart:()=>{},onComplete:()=>{},onError:()=>{}}
;this.queues[A].unshift(C)}}))}removeBlockers(){null!==this.queues&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach((A=>{var B;const C=null==(B=A[0])?void 0:B.label;"async-blocker"!==C&&"async-blocker-prepend"!==C||(A[0].execute(),A.splice(0,1))}))}unblockAudio(A){null!==this.queues&&this.queues.audio[0]===A&&this.shiftAndExecuteNext("audio")}executeNext(A){if(null===this.queues||null===this.tracks)return;const B=this.queues[A];if(B.length){const D=B[0];try{D.execute()
}catch(B){var C;if(D.onError(B),null===this.queues||null===this.tracks)return;const E=null==(C=this.tracks[A])?void 0:C.buffer;null!=E&&E.updating||this.shiftAndExecuteNext(A)}}}shiftAndExecuteNext(A){null!==this.queues&&(this.queues[A].shift(),this.executeNext(A))}current(A){var B;return(null==(B=this.queues)?void 0:B[A][0])||null}toString(){const{queues:A,tracks:B}=this;return null===A||null===B?"<destroyed>":`\n${this.list("video")}\n${this.list("audio")}\n${this.list("audiovideo")}}`}
list(A){var B,C;return null!=(B=this.queues)&&B[A]||null!=(C=this.tracks)&&C[A]?`${A}: (${this.listSbInfo(A)}) ${this.listOps(A)}`:""}listSbInfo(A){var B;const C=null==(B=this.tracks)?void 0:B[A],D=null==C?void 0:C.buffer;return D?`SourceBuffer${D.updating?" updating":""}${C.ended?" ended":""}${C.ending?" ending":""}`:"none"}listOps(A){var B;return(null==(B=this.queues)?void 0:B[A].map((A=>A.label)).join(", "))||""}}
const “≠=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,“Æ="HlsJsTrackRemovedError";class “Ø extends Error{constructor(A){super(A),this.name=“Æ}}class “∞{constructor(A){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=A,this.autoLevelCapping=1/0,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,
this.registerListeners()}setStreamController(A){this.streamController=A}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:A}=this;A.on(–ª.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),A.on(–ª.MEDIA_ATTACHING,this.onMediaAttaching,this),A.on(–ª.MANIFEST_PARSED,this.onManifestParsed,this),A.on(–ª.LEVELS_UPDATED,this.onLevelsUpdated,this),
A.on(–ª.BUFFER_CODECS,this.onBufferCodecs,this),A.on(–ª.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:A}=this;A.off(–ª.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),A.off(–ª.MEDIA_ATTACHING,this.onMediaAttaching,this),A.off(–ª.MANIFEST_PARSED,this.onManifestParsed,this),A.off(–ª.LEVELS_UPDATED,this.onLevelsUpdated,this),A.off(–ª.BUFFER_CODECS,this.onBufferCodecs,this),A.off(–ª.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(A,B){
const C=this.hls.levels[B.droppedLevel];this.isLevelAllowed(C)&&this.restrictedLevels.push({bitrate:C.bitrate,height:C.height,width:C.width})}onMediaAttaching(A,B){this.media=B.media instanceof HTMLVideoElement?B.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(A,B){const C=this.hls;this.restrictedLevels=[],this.firstLevel=B.firstLevel,C.config.capLevelToPlayerSize&&B.video&&this.startCapping()}onLevelsUpdated(A,B){
this.timer&&–∂(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(A,B){this.hls.config.capLevelToPlayerSize&&B.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);const A=this.hls.levels;if(A.length){const B=this.hls,C=this.getMaxLevel(A.length-1)
;C!==this.autoLevelCapping&&B.logger.log(`Setting autoLevelCapping to ${C}: ${A[C].height}p@${A[C].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),B.autoLevelCapping=C,B.autoLevelEnabled&&B.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=B.autoLevelCapping}}}getMaxLevel(A){const B=this.hls.levels;if(!B.length)return-1;const C=B.filter(((B,C)=>this.isLevelAllowed(B)&&C<=A));return this.clientRect=null,
“∞.getMaxLevelByMediaSize(C,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=1/0,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=1/0,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const A=this.media,B={width:0,height:0};if(A){
const C=A.getBoundingClientRect();B.width=C.width,B.height=C.height,B.width||B.height||(B.width=C.right-C.left||A.width||0,B.height=C.bottom-C.top||A.height||0)}return this.clientRect=B,B}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let A=1;if(!this.hls.config.ignoreDevicePixelRatio)try{A=self.devicePixelRatio}catch(A){}
return Math.min(A,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(A){return!this.restrictedLevels.some((B=>A.bitrate===B.bitrate&&A.width===B.width&&A.height===B.height))}static getMaxLevelByMediaSize(A,B,C){if(null==A||!A.length)return-1;let D=A.length-1;const E=Math.max(B,C);for(let B=0;B<A.length;B+=1){const C=A[B];if((C.width>=E||C.height>=E)&&(F=C,!(G=A[B+1])||F.width!==G.width||F.height!==G.height)){D=B;break}}var F,G;return D}}const “±={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",
INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},“≤={HLS:"h"},“≥="CMCD-Object",“¥="CMCD-Request",“µ="CMCD-Session",“∂="CMCD-Status",“∑={[“≥]:["br","d","ot","tb"],[“¥]:["bl","dl","mtp","nor","nrr","su"],[“µ]:["cid","pr","sf","sid","st","v"],[“∂]:["bs","rtp"]};class “∏{constructor(A,B){Array.isArray(A)&&(A=A.map((A=>A instanceof “∏?A:new “∏(A)))),this.value=A,this.params=B}}class “π{constructor(A){this.description=A}}const “∫="Bare Item",“ª=/[\x00-\x1f\x7f]+/,“º=A=>Math.round(A),“Ω=A=>100*“º(A/100),“æ={br:“º,
d:“º,bl:“Ω,dl:“Ω,mtp:“Ω,nor:(A,B)=>((null==B?void 0:B.baseUrl)&&(A=function(A,B){const C=new URL(A),D=new URL(B);if(C.origin!==D.origin)return A;const E=C.pathname.split("/").slice(1),F=D.pathname.split("/").slice(1,-1);for(;E[0]===F[0];)E.shift(),F.shift();for(;F.length;)F.shift(),E.unshift("..");return E.join("/")}(A,B.baseUrl)),encodeURIComponent(A)),rtp:“Ω,tb:“º},“ø=/CMCD=[^&#]+/;class ”Ä extends –æ{constructor(A){super("eme",A.logger),this.hls=void 0,this.config=void 0,this.media=null,
this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=”Ä.CDMCleanupPromise?[”Ä.CDMCleanupPromise]:[],this.onMediaEncrypted=A=>{const{initDataType:B,initData:C}=A,D=`"${A.type}" event: init data type: "${B}"`;if(this.debug(D),null!==C){if(!this.keyFormatPromise){let A=Object.keys(this.keySystemAccessPromises);A.length||(A=≈ß(this.config))
;const B=A.map(≈¶).filter((A=>!!A));this.keyFormatPromise=this.getKeyFormatPromise(B)}this.keyFormatPromise.then((E=>{const F=≈§(E);let G,H;if("sinf"===B){if(F!==…é.FAIRPLAY)return void this.warn(`Ignoring unexpected "${A.type}" event with init data type: "${B}" for selected key-system ${F}`);const E=ƒõ(new Uint8Array(C));try{const A=ƒ©(≈°(JSON.parse(E).sinf));if(!A)throw Error("'schm' box missing or not cbcs/cenc with schi > tenc");G=new Uint8Array(A.subarray(8,24)),H=…é.FAIRPLAY}catch(A){
return void this.warn(`${D} Failed to parse sinf: ${A}`)}}else{if(F!==…é.WIDEVINE&&F!==…é.PLAYREADY)return void this.warn(`Ignoring unexpected "${A.type}" event with init data type: "${B}" for selected key-system ${F}`);const E=function(A){const B=[];if(A instanceof ArrayBuffer){const C=A.byteLength;let D=0;for(;D+32<C;){const C=ƒ±(new DataView(A,D));B.push(C),D+=C.size}}return B}(C),I=E.filter((A=>!!A.systemId&&≈•(A.systemId)===F))
;I.length>1&&this.warn(`${D} Using first of ${I.length} pssh found for selected key-system ${F}`);const J=I[0];if(!J)return void(0===E.length||E.some((A=>!A.systemId))?this.warn(D+" contains incomplete or invalid pssh data"):this.log(`ignoring ${D} for ${E.map((A=>≈•(A.systemId))).join(",")} pssh data in favor of playlist keys`));if(H=≈•(J.systemId),0===J.version&&J.data)if(H===…é.WIDEVINE){const A=J.data.length-22;G=new Uint8Array(J.data.subarray(A,A+16))}else H===…é.PLAYREADY&&(G=≈®(J.data))}
if(!H||!G)return;const I=—É(G),{keyIdToKeySessionPromise:J,mediaKeySessions:K}=this;let L=J[I];for(let A=0;A<K.length;A++){const D=K[A],E=D.decryptdata;if(!E.keyId)continue;const F=—É(E.keyId);if(I===F||-1!==E.uri.replace(/-/g,"").indexOf(I)){if(L=J[F],E.pssh)break;delete J[F],E.pssh=new Uint8Array(C),E.keyId=G,L=J[I]=L.then((()=>this.generateRequestWithPreferredKeySession(D,B,C,"encrypted-event-key-match"))),L.catch((A=>this.handleError(A)));break}}if(!L){
if(H!==F)return void this.log(`Ignoring "${A.type}" event with ${H} init data for selected key-system ${F}`);L=J[I]=this.getKeySystemSelectionPromise([H]).then((({keySystem:A,mediaKeys:D})=>{var E;this.throwIfDestroyed();const F=new —¨("ISO-23001-7",I,null!=(E=≈¶(A))?E:"");return F.pssh=new Uint8Array(C),F.keyId=G,this.attemptSetMediaKeys(A,D).then((()=>{this.throwIfDestroyed();const E=this.createMediaKeySessionContext({decryptdata:F,keySystem:A,mediaKeys:D})
;return this.generateRequestWithPreferredKeySession(E,B,C,"encrypted-event-no-match")}))})),L.catch((A=>this.handleError(A)))}}))}},this.onWaitingForKey=A=>{this.log(`"${A.type}" event`)},this.hls=A,this.config=A.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const A=this.config;A.requestMediaKeySystemAccessFunc=null,A.licenseXhrSetup=A.licenseResponseCallback=void 0,A.drmSystems=A.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,
this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(–ª.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(–ª.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(–ª.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(–ª.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(–ª.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(–ª.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(–ª.MEDIA_DETACHED,this.onMediaDetached,this),
this.hls.off(–ª.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(–ª.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(–ª.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(A){const{drmSystems:B,widevineLicenseUrl:C}=this.config,D=B[A];return D?D.licenseUrl:A===…é.WIDEVINE&&C?C:void 0}getLicenseServerUrlOrThrow(A){const B=this.getLicenseServerUrl(A);if(void 0===B)throw Error(`no license server URL configured for key-system "${A}"`);return B}getServerCertificateUrl(A){
const{drmSystems:B}=this.config,C=B[A];if(C)return C.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${A}"]`)}attemptKeySystemAccess(A){const B=this.hls.levels,C=(A,B,C)=>!!A&&C.indexOf(A)===B,D=B.map((A=>A.audioCodec)).filter(C),E=B.map((A=>A.videoCodec)).filter(C);return D.length+E.length===0&&E.push("avc1.42e01e"),new Promise(((B,C)=>{const F=A=>{const G=A.shift();this.getMediaKeysPromise(G,D,E).then((A=>B({keySystem:G,mediaKeys:A}))).catch((B=>{
A.length?F(A):C(B instanceof ”Å?B:new ”Å({type:–π.KEY_SYSTEM_ERROR,details:–∫.KEY_SYSTEM_NO_ACCESS,error:B,fatal:!0},B.message))}))};F(A)}))}requestMediaKeySystemAccess(A,B){const{requestMediaKeySystemAccessFunc:C}=this.config;if("function"!=typeof C){let A="Configured requestMediaKeySystemAccess is not a function "+C;return null===—™&&"http:"===self.location.protocol&&(A="navigator.requestMediaKeySystemAccess is not available over insecure protocol "+location.protocol),Promise.reject(Error(A))}
return C(A,B)}getMediaKeysPromise(A,B,C){const D=function(A,B,C,D){let E;switch(A){case …é.FAIRPLAY:E=["cenc","sinf"];break;case …é.WIDEVINE:case …é.PLAYREADY:E=["cenc"];break;case …é.CLEARKEY:E=["cenc","keyids"];break;default:throw Error("Unknown key-system: "+A)}return function(A,B,C,D){return[{initDataTypes:A,persistentState:D.persistentState||"optional",distinctiveIdentifier:D.distinctiveIdentifier||"optional",sessionTypes:D.sessionTypes||[D.sessionType||"temporary"],
audioCapabilities:B.map((A=>({contentType:"audio/mp4; codecs="+A,robustness:D.audioRobustness||"",encryptionScheme:D.audioEncryptionScheme||null}))),videoCapabilities:C.map((A=>({contentType:"video/mp4; codecs="+A,robustness:D.videoRobustness||"",encryptionScheme:D.videoEncryptionScheme||null})))}]}(E,B,C,D)}(A,B,C,this.config.drmSystemOptions),E=this.keySystemAccessPromises[A];let F=null==E?void 0:E.keySystemAccess;if(!F){
this.log(`Requesting encrypted media "${A}" key-system access with config: ${—ï(D)}`),F=this.requestMediaKeySystemAccess(A,D);const B=this.keySystemAccessPromises[A]={keySystemAccess:F};return F.catch((B=>{this.log(`Failed to obtain access to key-system "${A}": ${B}`)})),F.then((C=>{this.log(`Access for key-system "${C.keySystem}" obtained`);const D=this.fetchServerCertificate(A);return this.log(`Create media-keys for "${A}"`),
B.mediaKeys=C.createMediaKeys().then((C=>(this.log(`Media-keys created for "${A}"`),B.hasMediaKeys=!0,D.then((B=>B?this.setMediaKeysServerCertificate(C,A,B):C))))),B.mediaKeys.catch((B=>{this.error(`Failed to create media-keys for "${A}"}: ${B}`)})),B.mediaKeys}))}return F.then((()=>E.mediaKeys))}createMediaKeySessionContext({decryptdata:A,keySystem:B,mediaKeys:C}){this.log(`Creating key-system session "${B}" keyId: ${—É(A.keyId||[])}`);const D=C.createSession(),E={decryptdata:A,keySystem:B,
mediaKeys:C,mediaKeysSession:D,keyStatus:"status-pending"};return this.mediaKeySessions.push(E),E}renewKeySession(A){const B=A.decryptdata;if(B.pssh){const C=this.createMediaKeySessionContext(A),D=this.getKeyIdString(B),E="cenc";this.keyIdToKeySessionPromise[D]=this.generateRequestWithPreferredKeySession(C,E,B.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(A)}getKeyIdString(A){
if(!A)throw Error("Could not read keyId of undefined decryptdata");if(null===A.keyId)throw Error("keyId is null");return —É(A.keyId)}updateKeySession(A,B){var C;const D=A.mediaKeysSession;return this.log(`Updating key-session "${D.sessionId}" for keyID ${—É((null==(C=A.decryptdata)?void 0:C.keyId)||[])}\n      } (data length: ${B?B.byteLength:B})`),D.update(B)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map((A=>({keySystem:A,
hasMediaKeys:this.keySystemAccessPromises[A].hasMediaKeys}))).filter((({hasMediaKeys:A})=>!!A)).map((({keySystem:A})=>≈¶(A))).filter((A=>!!A))}getKeySystemAccess(A){return this.getKeySystemSelectionPromise(A).then((({keySystem:A,mediaKeys:B})=>this.attemptSetMediaKeys(A,B)))}selectKeySystem(A){return new Promise(((B,C)=>this.getKeySystemSelectionPromise(A).then((({keySystem:A})=>{const D=≈¶(A);D?B(D):C(Error(`Unable to find format for key-system "${A}"`))})).catch(C)))}selectKeySystemFormat(A){
const B=Object.keys(A.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${A.sn} ${A.type}: ${A.level}) key formats ${B.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(B)),this.keyFormatPromise}getKeyFormatPromise(A){const B=≈ß(this.config),C=A.map(≈§).filter((A=>!!A&&-1!==B.indexOf(A)));return this.selectKeySystem(C)}loadKey(A){
const B=A.keyInfo.decryptdata,C=this.getKeyIdString(B),D=`(keyId: ${C} format: "${B.keyFormat}" method: ${B.method} uri: ${B.uri})`;this.log("Starting session for key "+D);let E=this.keyIdToKeySessionPromise[C];return E||(E=this.getKeySystemForKeyPromise(B).then((({keySystem:C,mediaKeys:E})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${A.frag.sn} ${A.frag.type}: ${A.frag.level} using key ${D}`),this.attemptSetMediaKeys(C,E).then((()=>(this.throwIfDestroyed(),
this.createMediaKeySessionContext({keySystem:C,mediaKeys:E,decryptdata:B}))))))),(this.keyIdToKeySessionPromise[C]=E.then((A=>{const C=B.pssh?B.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(A,"cenc",C,"playlist-key")}))).catch((A=>this.handleError(A)))),E}throwIfDestroyed(A="Invalid state"){if(!this.hls)throw Error("invalid state")}handleError(A){this.hls&&(this.error(A.message),A instanceof ”Å?this.hls.trigger(–ª.ERROR,A.data):this.hls.trigger(–ª.ERROR,{
type:–π.KEY_SYSTEM_ERROR,details:–∫.KEY_SYSTEM_NO_KEYS,error:A,fatal:!0}))}getKeySystemForKeyPromise(A){const B=this.getKeyIdString(A),C=this.keyIdToKeySessionPromise[B];if(!C){const B=≈§(A.keyFormat),C=B?[B]:≈ß(this.config);return this.attemptKeySystemAccess(C)}return C}getKeySystemSelectionPromise(A){if(A.length||(A=≈ß(this.config)),0===A.length)throw new ”Å({type:–π.KEY_SYSTEM_ERROR,details:–∫.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},"Missing key-system license configuration options "+—ï({
drmSystems:this.config.drmSystems}));return this.attemptKeySystemAccess(A)}attemptSetMediaKeys(A,B){if(this.mediaKeys===B)return Promise.resolve();const C=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${A}"`);const D=Promise.all(C).then((()=>{if(!this.media)throw this.mediaKeys=null,Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(B)}));return this.mediaKeys=B,this.setMediaKeysQueue.push(D),D.then((()=>{
this.log(`Media-keys set for "${A}"`),C.push(D),this.setMediaKeysQueue=this.setMediaKeysQueue.filter((A=>-1===C.indexOf(A)))}))}generateRequestWithPreferredKeySession(A,B,C,D){var E,F,G;const H=null==(E=this.config.drmSystems)||null==(F=E[A.keySystem])?void 0:F.generateRequest;if(H)try{const D=H.call(this.hls,B,C,A);if(!D)throw Error("Invalid response from configured generateRequest filter");B=D.initDataType,C=D.initData?D.initData:null,A.decryptdata.pssh=C?new Uint8Array(C):null}catch(A){
if(this.warn(A.message),null!=(G=this.hls)&&G.config.debug)throw A}if(null===C)return this.log(`Skipping key-session request for "${D}" (no initData)`),Promise.resolve(A);const I=this.getKeyIdString(A.decryptdata);this.log(`Generating key-session request for "${D}": ${I} (init data type: ${B} length: ${C?C.byteLength:null})`);const J=new …ö,K=A._onmessage=B=>{const C=A.mediaKeysSession;if(!C)return void J.emit("error",Error("invalid state"));const{messageType:D,message:E}=B
;this.log(`"${D}" message event for session "${C.sessionId}" message size: ${E.byteLength}`),"license-request"===D||"license-renewal"===D?this.renewLicense(A,E).catch((A=>{J.eventNames().length?J.emit("error",A):this.handleError(A)})):"license-release"===D?A.keySystem===…é.FAIRPLAY&&(this.updateKeySession(A,≈¢("acknowledged")),this.removeSession(A)):this.warn(`unhandled media key message type "${D}"`)},L=A._onkeystatuseschange=()=>{
if(!A.mediaKeysSession)return void J.emit("error",Error("invalid state"));this.onKeyStatusChange(A);const B=A.keyStatus;J.emit("keyStatus",B),"expired"===B&&(this.warn(`${A.keySystem} expired for key ${I}`),this.renewKeySession(A))};«à(A.mediaKeysSession,"message",K),«à(A.mediaKeysSession,"keystatuseschange",L);const M=new Promise(((A,B)=>{J.on("error",B),J.on("keyStatus",(C=>{C.startsWith("usable")?A():"output-restricted"===C?B(new ”Å({type:–π.KEY_SYSTEM_ERROR,
details:–∫.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===C?B(new ”Å({type:–π.KEY_SYSTEM_ERROR,details:–∫.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${C}"`)):"expired"===C?B(Error("key expired while generating request")):this.warn(`unhandled key status change "${C}"`)}))}));return A.mediaKeysSession.generateRequest(B,C).then((()=>{var B
;this.log(`Request generated for key-session "${null==(B=A.mediaKeysSession)?void 0:B.sessionId}" keyId: ${I}`)})).catch((A=>{throw new ”Å({type:–π.KEY_SYSTEM_ERROR,details:–∫.KEY_SYSTEM_NO_SESSION,error:A,fatal:!1},"Error generating key-session request: "+A)})).then((()=>M)).catch((B=>{throw J.removeAllListeners(),this.removeSession(A),B})).then((()=>(J.removeAllListeners(),A)))}onKeyStatusChange(A){A.mediaKeysSession.keyStatuses.forEach(((B,C)=>{if("string"==typeof C&&"object"==typeof B){
const A=C;C=B,B=A}this.log(`key status change "${B}" for keyStatuses keyId: ${—É("buffer"in C?new Uint8Array(C.buffer,C.byteOffset,C.byteLength):new Uint8Array(C))} session keyId: ${—É(new Uint8Array(A.decryptdata.keyId||[]))} uri: ${A.decryptdata.uri}`),A.keyStatus=B}))}fetchServerCertificate(A){const B=this.config,C=new(0,B.loader)(B),D=this.getServerCertificateUrl(A);return D?(this.log(`Fetching server certificate for "${A}"`),new Promise(((E,F)=>{const G={responseType:"arraybuffer",url:D
},H=B.certLoadPolicy.default,I={loadPolicy:H,timeout:H.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},J={onSuccess:A=>{E(A.data)},onError:(B,C,E)=>{F(new ”Å({type:–π.KEY_SYSTEM_ERROR,details:–∫.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:E,response:ƒë({url:G.url,data:void 0},B)},`"${A}" certificate request failed (${D}). Status: ${B.code} (${B.text})`))},onTimeout:(B,C,E)=>{F(new ”Å({type:–π.KEY_SYSTEM_ERROR,details:–∫.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,
fatal:!0,networkDetails:E,response:{url:G.url,data:void 0}},`"${A}" certificate request timed out (${D})`))},onAbort:()=>{F(Error("aborted"))}};C.load(G,I,J)}))):Promise.resolve()}setMediaKeysServerCertificate(A,B,C){return new Promise(((D,E)=>{A.setServerCertificate(C).then((E=>{this.log(`setServerCertificate ${E?"success":"not supported by CDM"} (${null==C?void 0:C.byteLength}) on "${B}"`),D(A)})).catch((A=>{E(new ”Å({type:–π.KEY_SYSTEM_ERROR,
details:–∫.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:A,fatal:!0},A.message))}))}))}renewLicense(A,B){return this.requestLicense(A,new Uint8Array(B)).then((B=>this.updateKeySession(A,new Uint8Array(B)).catch((A=>{throw new ”Å({type:–π.KEY_SYSTEM_ERROR,details:–∫.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:A,fatal:!0},A.message)}))))}unpackPlayReadyKeyMessage(A,B){const C=String.fromCharCode.apply(null,new Uint16Array(B.buffer))
;if(!C.includes("PlayReadyKeyMessage"))return A.setRequestHeader("Content-Type","text/xml; charset=utf-8"),B;const D=(new DOMParser).parseFromString(C,"application/xml"),E=D.querySelectorAll("HttpHeader");if(E.length>0){let B;for(let C=0,D=E.length;C<D;C++){var F,G;B=E[C];const D=null==(F=B.querySelector("name"))?void 0:F.textContent,H=null==(G=B.querySelector("value"))?void 0:G.textContent;D&&H&&A.setRequestHeader(D,H)}}const H=D.querySelector("Challenge"),I=null==H?void 0:H.textContent
;if(!I)throw Error("Cannot find <Challenge> in key message");return ≈¢(atob(I))}setupLicenseXHR(A,B,C,D){const E=this.config.licenseXhrSetup;return E?Promise.resolve().then((()=>{if(!C.decryptdata)throw Error("Key removed");return E.call(this.hls,A,B,C,D)})).catch((F=>{if(!C.decryptdata)throw F;return A.open("POST",B,!0),E.call(this.hls,A,B,C,D)})).then((C=>(A.readyState||A.open("POST",B,!0),{xhr:A,licenseChallenge:C||D}))):(A.open("POST",B,!0),Promise.resolve({xhr:A,licenseChallenge:D}))}
requestLicense(A,B){const C=this.config.keyLoadPolicy.default;return new Promise(((D,E)=>{const F=this.getLicenseServerUrlOrThrow(A.keySystem);this.log("Sending license request to URL: "+F);const G=new XMLHttpRequest;G.responseType="arraybuffer",G.onreadystatechange=()=>{if(!this.hls||!A.mediaKeysSession)return E(Error("invalid state"));if(4===G.readyState)if(200===G.status){this._requestLicenseFailureCount=0;let B=G.response
;this.log("License received "+(B instanceof ArrayBuffer?B.byteLength:B));const C=this.config.licenseResponseCallback;if(C)try{B=C.call(this.hls,G,F,A)}catch(A){this.error(A)}D(B)}else{const H=C.errorRetry,I=H?H.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>I||G.status>=400&&G.status<500)E(new ”Å({type:–π.KEY_SYSTEM_ERROR,details:–∫.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:G,response:{url:F,data:void 0,code:G.status,text:G.statusText}
},`License Request XHR failed (${F}). Status: ${G.status} (${G.statusText})`));else{const C=I-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${C} attempts left`),this.requestLicense(A,B).then(D,E)}}},A.licenseXhr&&A.licenseXhr.readyState!==XMLHttpRequest.DONE&&A.licenseXhr.abort(),A.licenseXhr=G,this.setupLicenseXHR(G,F,A,B).then((({xhr:B,licenseChallenge:C})=>{A.keySystem==…é.PLAYREADY&&(C=this.unpackPlayReadyKeyMessage(B,C)),B.send(C)}))}))}onDestroying(){
this.unregisterListeners(),this._clear()}onMediaAttached(A,B){if(!this.config.emeEnabled)return;const C=B.media;this.media=C,«à(C,"encrypted",this.onMediaEncrypted),«à(C,"waitingforkey",this.onWaitingForKey)}onMediaDetached(){const A=this.media;A&&(«â(A,"encrypted",this.onMediaEncrypted),«â(A,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var A;if(this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},
!this.mediaKeys&&!this.mediaKeySessions.length)return;const B=this.media,C=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,—¨.clearKeyUriToKeyIdMap();const D=C.length;”Ä.CDMCleanupPromise=Promise.all(C.map((A=>this.removeSession(A))).concat(null==B||null==(A=B.setMediaKeys(null))?void 0:A.catch((A=>{var B;this.log("Could not clear media keys: "+A),null==(B=this.hls)||B.trigger(–ª.ERROR,{type:–π.OTHER_ERROR,details:–∫.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,
error:Error("Could not clear media keys: "+A)})})))).catch((A=>{var B;this.log("Could not close sessions and clear media keys: "+A),null==(B=this.hls)||B.trigger(–ª.ERROR,{type:–π.OTHER_ERROR,details:–∫.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:Error("Could not close sessions and clear media keys: "+A)})})).then((()=>{D&&this.log("finished closing key sessions and clearing media keys")}))}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(A,{sessionKeys:B}){
if(B&&this.config.emeEnabled&&!this.keyFormatPromise){const A=B.reduce(((A,B)=>(-1===A.indexOf(B.keyFormat)&&A.push(B.keyFormat),A)),[]);this.log("Selecting key-system from session-keys "+A.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(A)}}removeSession(A){const{mediaKeysSession:B,licenseXhr:C}=A;if(B){this.log("Remove licenses and keys and close session "+B.sessionId),A._onmessage&&(B.removeEventListener("message",A._onmessage),A._onmessage=void 0),
A._onkeystatuseschange&&(B.removeEventListener("keystatuseschange",A._onkeystatuseschange),A._onkeystatuseschange=void 0),C&&C.readyState!==XMLHttpRequest.DONE&&C.abort(),A.mediaKeysSession=A.decryptdata=A.licenseXhr=void 0;const D=this.mediaKeySessions.indexOf(A);D>-1&&this.mediaKeySessions.splice(D,1);const{drmSystemOptions:E}=this.config,F=function(A){var B;return"persistent-license"===A.sessionType||!(null==(B=A.sessionTypes)||!B.some((A=>"persistent-license"===A)))}(E)?new Promise(((A,C)=>{
self.setTimeout((()=>C(Error("MediaKeySession.remove() timeout"))),8e3),B.remove().then(A)})):Promise.resolve();return F.catch((A=>{var B;this.log("Could not remove session: "+A),null==(B=this.hls)||B.trigger(–ª.ERROR,{type:–π.OTHER_ERROR,details:–∫.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:Error("Could not remove session: "+A)})})).then((()=>B.close())).catch((A=>{var B;this.log("Could not close session: "+A),null==(B=this.hls)||B.trigger(–ª.ERROR,{type:–π.OTHER_ERROR,
details:–∫.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:Error("Could not close session: "+A)})}))}}}”Ä.CDMCleanupPromise=void 0;class ”Å extends Error{constructor(A,B){super(B),this.data=void 0,A.error||(A.error=Error(B)),this.data=A,A.err=A.error}}const ”Ç=.025;let ”É=function(A){return A[A.Point=0]="Point",A[A.Range=1]="Range",A}({});class ”Ñ{constructor(A,B){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,
this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=B,this.dateRange=A,this.setDateRange(A)}setDateRange(A){this.dateRange=A,this.resumeOffset=A.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),
this.playoutLimit=A.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=A.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=A.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var A;this.appendInPlaceStarted=!1,null==(A=this.assetListLoader)||A.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(A){var B
;if(A>0&&A>=this.assetList.length)return!0;const C=this.playoutLimit;return!(A<=0||isNaN(C))&&(0===C||((null==(B=this.assetList[A])?void 0:B.startOffset)||0)>C)}findAssetIndex(A){return this.assetList.indexOf(A)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const A=this.dateRange.startTime;if(this.snapOptions.out){const B=this.dateRange.tagAnchor;if(B)return «ë(A,B)}return A}get startOffset(){return this.cue.pre?0:this.startTime}
get startIsAligned(){if(0===this.startTime||this.snapOptions.out)return!0;const A=this.dateRange.tagAnchor;if(A){const B=this.dateRange.startTime;return B-«ë(B,A)<.1}return!1}get resumptionOffset(){const A=this.resumeOffset,B=–∂(A)?A:this.duration;return this.cumulativeDuration+B}get resumeTime(){const A=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const B=this.resumeAnchor;if(B)return «ë(A,B)}return A}get appendInPlace(){
return!!this.appendInPlaceStarted||!this.appendInPlaceDisabled&&!(this.cue.once||this.cue.pre||!this.startIsAligned||!(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<”Ç))}set appendInPlace(A){this.appendInPlaceStarted?this.resetOnResume=!A:this.appendInPlaceDisabled=!A}get timelineStart(){return null!==this._timelineStart?this._timelineStart:this.startTime}set timelineStart(A){this._timelineStart=A}get duration(){
const A=this.playoutLimit;let B;return B=null!==this._duration?this._duration:this.dateRange.duration?this.dateRange.duration:this.dateRange.plannedDuration||0,!isNaN(A)&&A<B&&(B=A),B}set duration(A){this._duration=A}get cue(){return this.dateRange.cue}get timelineOccupancy(){return"RANGE"===this.dateRange.attr["X-TIMELINE-OCCUPIES"]?”É.Range:”É.Point}get supplementsPrimary(){return"PRIMARY"===this.dateRange.attr["X-TIMELINE-STYLE"]}get contentMayVary(){
return"NO"!==this.dateRange.attr["X-CONTENT-MAY-VARY"]}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||null!==this.assetListResponse}toString(){return`["${(A=this).identifier}" ${A.cue.pre?"<pre>":A.cue.post?"<post>":""}${A.timelineStart.toFixed(2)}-${A.resumeTime.toFixed(2)}]`;var A}}class ”Ö{constructor(A,B,C,D){this.hls=void 0,
this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls.trigger(–ª.PLAYOUT_LIMIT_REACHED,{})};const E=this.hls=new A(B);this.interstitial=C,this.assetItem=D;let F=D.uri;try{F=«í(F,B.primarySessionId).href}catch(A){}E.loadSource(F);const G=()=>{this.hasDetails=!0};E.once(–ª.LEVEL_LOADED,G),E.once(–ª.AUDIO_TRACK_LOADED,G),
E.once(–ª.SUBTITLE_TRACK_LOADED,G),E.on(–ª.MEDIA_ATTACHING,((A,{media:B})=>{this.removeMediaListeners(),this.mediaAttached=B,this.interstitial.playoutLimit&&(B.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&E.on(–ª.BUFFER_APPENDED,(()=>{const A=this.bufferedEnd;this.reachedPlayout(A)&&(this._bufferedEosTime=A,E.trigger(–ª.BUFFERED_TO_END,void 0))})))}))}get appendInPlace(){var A;return(null==(A=this.interstitial)?void 0:A.appendInPlace)||!1}bufferedInPlaceToEnd(A){var B
;if(!this.appendInPlace)return!1;if(null!=(B=this.hls)&&B.bufferedToEnd)return!0;if(!A||!this._bufferedEosTime)return!1;const C=this.timelineOffset,D=—¢.bufferInfo(A,C,0);return this.getAssetTime(D.end)>=this._bufferedEosTime-.02}reachedPlayout(A){const B=this.interstitial.playoutLimit;return this.startOffset+A>=B}get destroyed(){var A;return!(null!=(A=this.hls)&&A.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){
var A;return(null==(A=this.hls)?void 0:A.media)||null}get bufferedEnd(){const A=this.media||this.mediaAttached;if(!A)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const B=—¢.bufferInfo(A,A.currentTime,.001);return this.getAssetTime(B.end)}get currentTime(){const A=this.media||this.mediaAttached;return A?this.getAssetTime(A.currentTime):this._currentTime||0}get duration(){const A=this.assetItem.duration;return A||0}get remaining(){const A=this.duration
;return A?Math.max(0,A-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var A;return(null==(A=this.hls)?void 0:A.config.timelineOffset)||0}set timelineOffset(A){const B=this.timelineOffset;if(A!==B&&Math.abs(A-B)>1/9e4){if(this.hasDetails)throw Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=A}}getAssetTime(A){const B=this.timelineOffset,C=this.duration;return Math.min(Math.max(0,A-B),C)}
removeMediaListeners(){const A=this.mediaAttached;A&&(this._currentTime=A.currentTime,this.bufferSnapShot(),A.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){var A;this.mediaAttached&&null!=(A=this.hls)&&A.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}destroy(){this.removeMediaListeners(),this.hls.destroy(),this.hls=this.interstitial=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(A){this.hls.attachMedia(A)}detachMedia(){
this.removeMediaListeners(),this.mediaAttached=null,this.hls.detachMedia()}resumeBuffering(){this.hls.resumeBuffering()}pauseBuffering(){this.hls.pauseBuffering()}transferMedia(){return this.bufferSnapShot(),this.hls.transferMedia()}resetDetails(){const A=this.hls;if(this.hasDetails){A.stopLoad();const B=A=>delete A.details;A.levels.forEach(B),A.allAudioTracks.forEach(B),A.allSubtitleTracks.forEach(B),this.hasDetails=!1}}on(A,B,C){this.hls.on(A,B)}once(A,B,C){this.hls.once(A,B)}off(A,B,C){
this.hls.off(A,B)}toString(){var A;return`HlsAssetPlayer: ${«î(this.assetItem)} ${null==(A=this.hls)?void 0:A.sessionId} ${this.appendInPlace?"append-in-place":""}`}}class ”Ü extends –æ{constructor(A,B){super("interstitials-sched",B),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=A}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),
this.events&&this.events.forEach((A=>A.reset())),this.events=this.items=null}resetErrorsInRange(A,B){return this.events?this.events.reduce(((C,D)=>A<=D.startOffset&&B>D.startOffset?(delete D.error,C+1):C),0):0}get duration(){const A=this.items;return A?A[A.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(A){return A&&this.eventMap[A]||null}hasEvent(A){return A in this.eventMap}findItemIndex(A,B){if(A.event)return this.findEventIndex(A.event.identifier);let C=-1
;A.nextEvent?C=this.findEventIndex(A.nextEvent.identifier)-1:A.previousEvent&&(C=this.findEventIndex(A.previousEvent.identifier)+1);const D=this.items;if(D)for(D[C]||(void 0===B&&(B=A.start),C=this.findItemIndexAtTime(B));C>=0&&null!=(E=D[C])&&E.event;){var E;C--}return C}findItemIndexAtTime(A,B){const C=this.items;if(C)for(let D=0;D<C.length;D++){let E=C[D];if(B&&"primary"!==B&&(E=E[B]),A===E.start||A>E.start&&A<E.end)return D}return-1}findJumpRestrictedIndex(A,B){const C=this.items
;if(C)for(let D=A;D<=B&&C[D];D++){const A=C[D].event;if(null!=A&&A.restrictions.jump&&!A.appendInPlace)return D}return-1}findEventIndex(A){const B=this.items;if(B)for(let D=B.length;D--;){var C;if((null==(C=B[D].event)?void 0:C.identifier)===A)return D}return-1}findAssetIndex(A,B){const C=A.assetList,D=C.length;if(D>1)for(let A=0;A<D;A++){const D=C[A];if(!D.error){const C=D.timelineStart;if(B===C||B>C&&B<C+(D.duration||0))return A}}return 0}get assetIdAtEnd(){var A,B
;const C=null==(A=this.items)||null==(B=A[this.length-1])?void 0:B.event;if(C){const A=C.assetList,B=A[A.length-1];if(B)return B.identifier}return null}parseInterstitialDateRanges(A,B){const C=A.main.details,{dateRanges:D}=C,E=this.events,F=this.parseDateRanges(D,{url:C.url},B),G=Object.keys(D),H=E?E.filter((A=>!G.includes(A.identifier))):[];F.length&&F.sort(((A,B)=>{const C=A.cue.pre,D=A.cue.post,E=B.cue.pre,F=B.cue.post;if(C&&!E)return-1;if(E&&!C)return 1;if(D&&!F)return 1;if(F&&!D)return-1
;if(!(C||E||D||F)){const C=A.startTime,D=B.startTime;if(C!==D)return C-D}return A.dateRange.tagOrder-B.dateRange.tagOrder})),this.events=F,H.forEach((A=>{this.removeEvent(A)})),this.updateSchedule(A,H)}updateSchedule(A,B=[]){const C=this.events||[];if(C.length||B.length||this.length<2){const D=this.items,E=this.parseSchedule(C,A),F=B.length||(null==D?void 0:D.length)!==E.length||E.some(((A,B)=>Math.abs(A.playout.start-D[B].playout.start)>.005||Math.abs(A.playout.end-D[B].playout.end)>.005))
;F&&(this.items=E,this.onScheduleUpdate(B,D))}}parseDateRanges(A,B,C){const D=[],E=Object.keys(A);for(let F=0;F<E.length;F++){const G=E[F],H=A[G];if(H.isInterstitial){let A=this.eventMap[G];A?A.setDateRange(H):(A=new ”Ñ(H,B),this.eventMap[G]=A,!1===C&&(A.appendInPlace=C)),D.push(A)}}return D}parseSchedule(A,B){const C=[],D=B.main.details,E=D.live?1/0:D.edge;let F=0;if((A=A.filter((A=>!(A.error||A.cue.once&&A.hasPlayed)))).length){this.resolveOffsets(A,B);let D=0,H=0;if(A.forEach(((B,G)=>{
const I=B.cue.pre,J=B.cue.post,K=A[G-1]||null,L=B.appendInPlace,M=J?E:B.startOffset,N=B.duration,O=B.timelineOccupancy===”É.Range?N:0,P=B.resumptionOffset,Q=(null==K?void 0:K.startTime)===M,R=M+B.cumulativeDuration;let S=L?R+N:M+P;if(I||!J&&M<=0){const A=H;H+=O,B.timelineStart=R;const D=F;F+=N,C.push({event:B,start:R,end:S,playout:{start:D,end:F},integrated:{start:A,end:H}})}else{if(!(M<=E))return;{if(!Q){const E=M-D;if(E>.033){const I=D,J=H;H+=E;const K=F;F+=E;const L={
previousEvent:A[G-1]||null,nextEvent:B,start:I,end:I+E,playout:{start:K,end:F},integrated:{start:J,end:H}};C.push(L)}else E>0&&K&&(K.cumulativeDuration+=E,C[C.length-1].end=M)}J&&(S=R),B.timelineStart=R;const E=H;H+=O;const I=F;F+=N,C.push({event:B,start:R,end:S,playout:{start:I,end:F},integrated:{start:E,end:H}})}}const T=B.resumeTime;D=J||T>E?E:T})),D<E){var G;const A=D,B=H,I=E-D;H+=I;const J=F;F+=I,C.push({previousEvent:(null==(G=C[C.length-1])?void 0:G.event)||null,nextEvent:null,start:D,
end:A+I,playout:{start:J,end:F},integrated:{start:B,end:H}})}this.setDurations(E,F,H)}else{const A=0;C.push({previousEvent:null,nextEvent:null,start:A,end:E,playout:{start:A,end:E},integrated:{start:A,end:E}}),this.setDurations(E,E,E)}return C}setDurations(A,B,C){this.durations={primary:A,playout:B,integrated:C}}resolveOffsets(A,B){const C=B.main.details,D=C.live?1/0:C.edge;let E=0,F=-1;A.forEach(((G,H)=>{const I=G.cue.pre,J=G.cue.post,K=I?0:J?D:G.startTime;this.updateAssetDurations(G),
F===K?G.cumulativeDuration=E:(E=0,F=K),!J&&G.snapOptions.in&&(G.resumeAnchor=≈ã(null,C.fragments,G.startOffset+G.resumptionOffset,0,0)||void 0),G.appendInPlace&&!G.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(G,B)||(G.appendInPlace=!1)),!G.appendInPlace&&H+1<A.length&&A[H+1].startTime-A[H].resumeTime<.033&&(A[H+1].appendInPlace=!1,A[H+1].appendInPlace&&this.warn("Could not change append strategy for abutting event "+G));const L=–∂(G.resumeOffset)?G.resumeOffset:G.duration;E+=L}))}
primaryCanResumeInPlaceAt(A,B){const C=A.resumeTime,D=A.startTime+A.resumptionOffset;return Math.abs(C-D)>”Ç?(this.log(`"${A.identifier}" resumption ${C} not aligned with estimated timeline end ${D}`),!1):B?!Object.keys(B).some((D=>{const E=B[D].details,F=E.edge;if(C>=F)return this.log(`"${A.identifier}" resumption ${C} past ${D} playlist end ${F}`),!1;const G=≈ã(null,E.fragments,C)
;if(!G)return this.log(`"${A.identifier}" resumption ${C} does not align with any fragments in ${D} playlist (${E.fragStart}-${E.fragmentEnd})`),!0;const H="audio"===D?.175:0;return!(Math.abs(G.start-C)<”Ç+H||Math.abs(G.end-C)<”Ç+H||(this.log(`"${A.identifier}" resumption ${C} not aligned with ${D} fragment bounds (${G.start}-${G.end} sn: ${G.sn} cc: ${G.cc})`),0))})):(this.log(`"${A.identifier}" resumption ${C} can not be aligned with media (none selected)`),!1)}updateAssetDurations(A){
if(!A.assetListLoaded)return;const B=A.timelineStart;let C=0,D=!1,E=!1;A.assetList.forEach((A=>{const F=B+C;A.startOffset=C,A.timelineStart=F,D||(D=null===A.duration),E||(E=!!A.error);const G=A.error?0:A.duration||0;C+=G})),A.duration=D&&!E?Math.max(C,A.duration):C}removeEvent(A){A.reset(),delete this.eventMap[A.identifier]}}class ”á{constructor(A){this.hls=void 0,this.hls=A}destroy(){this.hls=null}loadAssetList(A,B){const C=A.assetListUrl;let D;try{D=«í(C,this.hls.sessionId,A.baseUrl)}catch(B){
const D=this.assignAssetListError(A,–∫.ASSET_LIST_LOAD_ERROR,B,C);return void this.hls.trigger(–ª.ERROR,D)}B&&"data:"!==D.protocol&&D.searchParams.set("_HLS_start_offset",""+B);const E=this.hls.config,F=new(0,E.loader)(E),G={responseType:"json",url:D.href},H=E.interstitialAssetListLoadPolicy.default,I={loadPolicy:H,timeout:H.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},J={onSuccess:(B,C,D,E)=>{const F=B.data,G=null==F?void 0:F.ASSETS;if(Array.isArray(G))A.assetListResponse=F,
this.hls.trigger(–ª.ASSET_LIST_LOADED,{event:A,assetListResponse:F,networkDetails:E});else{const B=this.assignAssetListError(A,–∫.ASSET_LIST_PARSING_ERROR,Error("Invalid interstitial asset list"),D.url,C,E);this.hls.trigger(–ª.ERROR,B)}},onError:(B,C,D,E)=>{const F=this.assignAssetListError(A,–∫.ASSET_LIST_LOAD_ERROR,Error(`Error loading X-ASSET-LIST: HTTP status ${B.code} ${B.text} (${C.url})`),C.url,E,D);this.hls.trigger(–ª.ERROR,F)},onTimeout:(B,C,D)=>{
const E=this.assignAssetListError(A,–∫.ASSET_LIST_LOAD_TIMEOUT,Error(`Timeout loading X-ASSET-LIST (${C.url})`),C.url,B,D);this.hls.trigger(–ª.ERROR,E)}};return F.load(G,I,J),this.hls.trigger(–ª.ASSET_LIST_LOADING,{event:A}),F}assignAssetListError(A,B,C,D,E,F){return A.error=C,{type:–π.NETWORK_ERROR,details:B,fatal:!1,interstitial:A,url:D,error:C,networkDetails:F,stats:E}}}class ”à{constructor(A){this.buffered=void 0;const B=(B,C,D)=>{
if((C>>>=0)>D-1)throw new DOMException(`Failed to execute '${B}' on 'TimeRanges': The index provided (${C}) is greater than the maximum bound (${D})`);return A[C][B]};this.buffered={get length(){return A.length},end:C=>B("end",C,A.length),start:C=>B("start",C,A.length)}}}const ”â={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,
145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,
206:9495,207:9499},”ä=A=>String.fromCharCode(”â[A]||A),”ã=15,”å=100,”ç={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},”é={17:2,18:4,21:6,22:8,23:10,19:13,20:15},”è={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},”ê={25:2,26:4,29:6,30:8,31:10,27:13,28:15},”ë=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class ”í{constructor(){this.time=null,this.verboseLevel=0}log(A,B){if(this.verboseLevel>=A){const C="function"==typeof B?B():B;—Ç.log(`${this.time} [${A}] ${C}`)}}}
const ”ì=function(A){const B=[];for(let C=0;C<A.length;C++)B.push(A[C].toString(16));return B};class ”î{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(A){const B=["foreground","underline","italics","background","flash"];for(let C=0;C<B.length;C++){const D=B[C];A.hasOwnProperty(D)&&(this[D]=A[D])}}isDefault(){
return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(A){return this.foreground===A.foreground&&this.underline===A.underline&&this.italics===A.italics&&this.background===A.background&&this.flash===A.flash}copy(A){this.foreground=A.foreground,this.underline=A.underline,this.italics=A.italics,this.background=A.background,this.flash=A.flash}toString(){
return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class ”ï{constructor(){this.uchar=" ",this.penState=new ”î}reset(){this.uchar=" ",this.penState.reset()}setChar(A,B){this.uchar=A,this.penState.copy(B)}setPenState(A){this.penState.copy(A)}equals(A){return this.uchar===A.uchar&&this.penState.equals(A.penState)}copy(A){this.uchar=A.uchar,this.penState.copy(A.penState)}isEmpty(){
return" "===this.uchar&&this.penState.isDefault()}}class ”ñ{constructor(A){this.chars=[],this.pos=0,this.currPenState=new ”î,this.cueStartTime=null,this.logger=void 0;for(let A=0;A<”å;A++)this.chars.push(new ”ï);this.logger=A}equals(A){for(let B=0;B<”å;B++)if(!this.chars[B].equals(A.chars[B]))return!1;return!0}copy(A){for(let B=0;B<”å;B++)this.chars[B].copy(A.chars[B])}isEmpty(){let A=!0;for(let B=0;B<”å;B++)if(!this.chars[B].isEmpty()){A=!1;break}return A}setCursor(A){this.pos!==A&&(this.pos=A),
this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>”å&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=”å)}moveCursor(A){const B=this.pos+A;if(A>1)for(let A=this.pos+1;A<B+1;A++)this.chars[A].setPenState(this.currPenState);this.setCursor(B)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(A){A>=144&&this.backSpace();const B=”ä(A)
;this.pos>=”å?this.logger.log(0,(()=>"Cannot insert "+A.toString(16)+" ("+B+") at position "+this.pos+". Skipping it!")):(this.chars[this.pos].setChar(B,this.currPenState),this.moveCursor(1))}clearFromPos(A){let B;for(B=A;B<”å;B++)this.chars[B].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const A=[];let B=!0;for(let C=0;C<”å;C++){const D=this.chars[C].uchar;" "!==D&&(B=!1),A.push(D)}return B?"":A.join("")}
setPenStyles(A){this.currPenState.setStyles(A),this.chars[this.pos].setPenState(this.currPenState)}}class ”ó{constructor(A){this.rows=[],this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let B=0;B<”ã;B++)this.rows.push(new ”ñ(A));this.logger=A}reset(){for(let A=0;A<”ã;A++)this.rows[A].clear();this.currRow=14}equals(A){let B=!0;for(let C=0;C<”ã;C++)if(!this.rows[C].equals(A.rows[C])){B=!1;break}return B}copy(A){for(let B=0;B<”ã;B++)this.rows[B].copy(A.rows[B])}
isEmpty(){let A=!0;for(let B=0;B<”ã;B++)if(!this.rows[B].isEmpty()){A=!1;break}return A}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(A){this.rows[this.currRow].insertChar(A)}setPen(A){this.rows[this.currRow].setPenStyles(A)}moveCursor(A){this.rows[this.currRow].moveCursor(A)}setCursor(A){this.logger.log(2,"setCursor: "+A),this.rows[this.currRow].setCursor(A)}setPAC(A){this.logger.log(2,(()=>"pacData = "+—ï(A)));let B=A.row-1
;if(this.nrRollUpRows&&B<this.nrRollUpRows-1&&(B=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==B){for(let A=0;A<”ã;A++)this.rows[A].clear();const A=this.currRow+1-this.nrRollUpRows,C=this.lastOutputScreen;if(C){const D=C.rows[A].cueStartTime,E=this.logger.time;if(null!==D&&null!==E&&D<E)for(let D=0;D<this.nrRollUpRows;D++)this.rows[B-this.nrRollUpRows+D+1].copy(C.rows[A+D])}}this.currRow=B;const C=this.rows[this.currRow];if(null!==A.indent){const B=A.indent,D=Math.max(B-1,0)
;C.setCursor(A.indent),A.color=C.chars[D].penState.foreground}const D={foreground:A.color,underline:A.underline,italics:A.italics,background:"black",flash:!1};this.setPen(D)}setBkgData(A){this.logger.log(2,(()=>"bkgData = "+—ï(A))),this.backSpace(),this.setPen(A),this.insertChar(32)}setRollUpRows(A){this.nrRollUpRows=A}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,(()=>this.getDisplayText()))
;const A=this.currRow+1-this.nrRollUpRows,B=this.rows.splice(A,1)[0];B.clear(),this.rows.splice(this.currRow,0,B),this.logger.log(2,"Rolling up")}getDisplayText(A){A=A||!1;const B=[];let C="",D=-1;for(let C=0;C<”ã;C++){const E=this.rows[C].getTextString();E&&(D=C+1,A?B.push("Row "+D+": '"+E+"'"):B.push(E.trim()))}return B.length>0&&(C=A?"["+B.join(" | ")+"]":B.join("\n")),C}getTextAndFormat(){return this.rows}}class ”ò{constructor(A,B,C){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,
this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=A,this.outputFilter=B,this.mode=null,this.verbose=0,this.displayedMemory=new ”ó(C),this.nonDisplayedMemory=new ”ó(C),this.lastOutputScreen=new ”ó(C),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=C}
reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(A){this.outputFilter=A}setPAC(A){this.writeScreen.setPAC(A)}setBkgData(A){this.writeScreen.setBkgData(A)}setMode(A){A!==this.mode&&(this.mode=A,this.logger.log(2,(()=>"MODE="+A)),
"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=A)}insertChars(A){for(let B=0;B<A.length;B++)this.writeScreen.insertChar(A[B]);const B=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,(()=>B+": "+this.writeScreen.getDisplayText(!0))),
"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,(()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0))),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),
this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(A){this.logger.log(2,"RU("+A+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(A)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}
ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const A=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=A,
this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,(()=>"DISP: "+this.displayedMemory.getDisplayText()))}this.outputDataUpdate(!0)}ccTO(A){this.logger.log(2,"TO("+A+") - Tab Offset"),this.writeScreen.moveCursor(A)}ccMIDROW(A){const B={flash:!1};if(B.underline=A%2==1,B.italics=A>=46,B.italics)B.foreground="white";else{const C=Math.floor(A/2)-16,D=["white","green","blue","cyan","red","yellow","magenta"];B.foreground=D[C]}this.logger.log(2,"MIDROW: "+—ï(B)),this.writeScreen.setPen(B)}
outputDataUpdate(A=!1){const B=this.logger.time;null!==B&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,B,this.lastOutputScreen),A&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:B):this.cueStartTime=B,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(A){
this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,A,this.displayedMemory),this.cueStartTime=A))}}class ”ô{constructor(A,B,C){this.channels=void 0,this.currentChannel=0,this.cmdHistory={a:null,b:null},this.logger=void 0;const D=this.logger=new ”í;this.channels=[null,new ”ò(A,B,D),new ”ò(A+1,C,D)]}getHandler(A){return this.channels[A].getHandler()}setHandler(A,B){this.channels[A].setHandler(B)}addData(A,B){this.logger.time=A
;for(let A=0;A<B.length;A+=2){const C=127&B[A],D=127&B[A+1];let E=!1,F=null;if(0===C&&0===D)continue;this.logger.log(3,(()=>"["+”ì([B[A],B[A+1]])+"] -> ("+”ì([C,D])+")"));const G=this.cmdHistory;if(C>=16&&C<=31){if(«ò(C,D,G)){«ó(null,null,G),this.logger.log(3,(()=>"Repeated command ("+”ì([C,D])+") is dropped"));continue}«ó(C,D,this.cmdHistory),E=this.parseCmd(C,D),E||(E=this.parseMidrow(C,D)),E||(E=this.parsePAC(C,D)),E||(E=this.parseBackgroundAttributes(C,D))}else «ó(null,null,G)
;if(!E&&(F=this.parseChars(C,D),F)){const A=this.currentChannel;A&&A>0?this.channels[A].insertChars(F):this.logger.log(2,"No channel found yet. TEXT-MODE?")}E||F||this.logger.log(2,(()=>"Couldn't parse cleaned data "+”ì([C,D])+" orig: "+”ì([B[A],B[A+1]])))}}parseCmd(A,B){if(!((20===A||28===A||21===A||29===A)&&B>=32&&B<=47||(23===A||31===A)&&B>=33&&B<=35))return!1;const C=20===A||21===A||23===A?1:2,D=this.channels[C]
;return 20===A||21===A||28===A||29===A?32===B?D.ccRCL():33===B?D.ccBS():34===B?D.ccAOF():35===B?D.ccAON():36===B?D.ccDER():37===B?D.ccRU(2):38===B?D.ccRU(3):39===B?D.ccRU(4):40===B?D.ccFON():41===B?D.ccRDC():42===B?D.ccTR():43===B?D.ccRTD():44===B?D.ccEDM():45===B?D.ccCR():46===B?D.ccENM():47===B&&D.ccEOC():D.ccTO(B-32),this.currentChannel=C,!0}parseMidrow(A,B){let C=0;if((17===A||25===A)&&B>=32&&B<=47){if(C=17===A?1:2,
C!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const D=this.channels[C];return!!D&&(D.ccMIDROW(B),this.logger.log(3,(()=>"MIDROW ("+”ì([A,B])+")")),!0)}return!1}parsePAC(A,B){let C;if(!((A>=17&&A<=23||A>=25&&A<=31)&&B>=64&&B<=127||(16===A||24===A)&&B>=64&&B<=95))return!1;const D=A<=23?1:2;C=B>=64&&B<=95?1===D?”ç[A]:”è[A]:1===D?”é[A]:”ê[A];const E=this.channels[D];return!!E&&(E.setPAC(this.interpretPAC(C,B)),this.currentChannel=D,!0)}interpretPAC(A,B){let C
;const D={color:null,italics:!1,indent:null,underline:!1,row:A};return C=B>95?B-96:B-64,D.underline=!(1&~C),C<=13?D.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(C/2)]:C<=15?(D.italics=!0,D.color="white"):D.indent=4*Math.floor((C-16)/2),D}parseChars(A,B){let C,D=null,E=null;if(A>=25?(C=2,E=A-8):(C=1,E=A),E>=17&&E<=19){let A;A=17===E?B+80:18===E?B+112:B+144,this.logger.log(2,(()=>"Special char '"+”ä(A)+"' in channel "+C)),D=[A]
}else A>=32&&A<=127&&(D=0===B?[A]:[A,B]);return D&&this.logger.log(3,(()=>"Char codes =  "+”ì(D).join(","))),D}parseBackgroundAttributes(A,B){if(!((16===A||24===A)&&B>=32&&B<=47||(23===A||31===A)&&B>=45&&B<=47))return!1;let C;const D={};16===A||24===A?(C=Math.floor((B-32)/2),D.background=”ë[C],B%2==1&&(D.background=D.background+"_semi")):45===B?D.background="transparent":(D.foreground="black",47===B&&(D.underline=!0));const E=A<=23?1:2;return this.channels[E].setBkgData(D),!0}reset(){
for(let A=0;A<Object.keys(this.channels).length;A++){const B=this.channels[A];B&&B.reset()}«ó(null,null,this.cmdHistory)}cueSplitAtTime(A){for(let B=0;B<this.channels.length;B++){const C=this.channels[B];C&&C.cueSplitAtTime(A)}}}…õ=function(){function A(A,B){if("string"!=typeof B)return!1;if(!Array.isArray(A))return!1;const C=B.toLowerCase();return!!~A.indexOf(C)&&C}function B(B){return A(F,B)}function C(A){let B=1;for(;B<arguments.length;B++){const C=arguments[B];for(const B in C)A[B]=C[B]}
return A}function D(D,F,G){const H=this,I={enumerable:!0};H.hasBeenReset=!1;let J="",K=!1,L=D,M=F,N=G,O=null,P="",Q=!0,R="auto",S="start",T=50,U="middle",V=50,W="middle";Object.defineProperty(H,"id",C({},I,{get:function(){return J},set:function(A){J=""+A}})),Object.defineProperty(H,"pauseOnExit",C({},I,{get:function(){return K},set:function(A){K=!!A}})),Object.defineProperty(H,"startTime",C({},I,{get:function(){return L},set:function(A){
if("number"!=typeof A)throw new TypeError("Start time must be set to a number.");L=A,this.hasBeenReset=!0}})),Object.defineProperty(H,"endTime",C({},I,{get:function(){return M},set:function(A){if("number"!=typeof A)throw new TypeError("End time must be set to a number.");M=A,this.hasBeenReset=!0}})),Object.defineProperty(H,"text",C({},I,{get:function(){return N},set:function(A){N=""+A,this.hasBeenReset=!0}})),Object.defineProperty(H,"region",C({},I,{get:function(){return O},set:function(A){O=A,
this.hasBeenReset=!0}})),Object.defineProperty(H,"vertical",C({},I,{get:function(){return P},set:function(B){const C=function(B){return A(E,B)}(B);if(!1===C)throw new SyntaxError("An invalid or illegal string was specified.");P=C,this.hasBeenReset=!0}})),Object.defineProperty(H,"snapToLines",C({},I,{get:function(){return Q},set:function(A){Q=!!A,this.hasBeenReset=!0}})),Object.defineProperty(H,"line",C({},I,{get:function(){return R},set:function(A){
if("number"!=typeof A&&"auto"!==A)throw new SyntaxError("An invalid number or illegal string was specified.");R=A,this.hasBeenReset=!0}})),Object.defineProperty(H,"lineAlign",C({},I,{get:function(){return S},set:function(A){const C=B(A);if(!C)throw new SyntaxError("An invalid or illegal string was specified.");S=C,this.hasBeenReset=!0}})),Object.defineProperty(H,"position",C({},I,{get:function(){return T},set:function(A){if(A<0||A>100)throw Error("Position must be between 0 and 100.");T=A,
this.hasBeenReset=!0}})),Object.defineProperty(H,"positionAlign",C({},I,{get:function(){return U},set:function(A){const C=B(A);if(!C)throw new SyntaxError("An invalid or illegal string was specified.");U=C,this.hasBeenReset=!0}})),Object.defineProperty(H,"size",C({},I,{get:function(){return V},set:function(A){if(A<0||A>100)throw Error("Size must be between 0 and 100.");V=A,this.hasBeenReset=!0}})),Object.defineProperty(H,"align",C({},I,{get:function(){return W},set:function(A){const C=B(A)
;if(!C)throw new SyntaxError("An invalid or illegal string was specified.");W=C,this.hasBeenReset=!0}})),H.displayState=void 0}if(null!=—©&&—©.VTTCue)return self.VTTCue;const E=["","lr","rl"],F=["start","middle","end","left","right"];return D.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},D}();class ”ö{decode(A,B){if(!A)return"";if("string"!=typeof A)throw Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(A))}}class ”õ{
constructor(){this.values=Object.create(null)}set(A,B){this.get(A)||""===B||(this.values[A]=B)}get(A,B,C){return C?this.has(A)?this.values[A]:B[C]:this.has(A)?this.values[A]:B}has(A){return A in this.values}alt(A,B,C){for(let D=0;D<C.length;++D)if(B===C[D]){this.set(A,B);break}}integer(A,B){/^-?\d+$/.test(B)&&this.set(A,parseInt(B,10))}percent(A,B){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(B)){const C=parseFloat(B);if(C>=0&&C<=100)return this.set(A,C),!0}return!1}}
const ”ú=new …õ(0,0,""),”ù="middle"===”ú.align?"middle":"center";class ”û{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new ”ö,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(A){function B(){let A=C.buffer,B=0;for(A=«ú(A);B<A.length&&"\r"!==A[B]&&"\n"!==A[B];)++B;const D=A.slice(0,B);return"\r"===A[B]&&++B,"\n"===A[B]&&++B,C.buffer=A.slice(B),D}const C=this;A&&(C.buffer+=C.decoder.decode(A,{stream:!0}));try{let A=""
;if("INITIAL"===C.state){if(!/\r\n|\n/.test(C.buffer))return this;A=B();const D=A.match(/^(√Ø¬ª¬ø)?WEBVTT([ \t].*)?$/);if(null==D||!D[0])throw Error("Malformed WebVTT signature.");C.state="HEADER"}let D=!1;for(;C.buffer;){if(!/\r\n|\n/.test(C.buffer))return this;switch(D?D=!1:A=B(),C.state){case"HEADER":/:/.test(A)?«ö(A,(function(){}),/:/):A||(C.state="ID");continue;case"NOTE":A||(C.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(A)){C.state="NOTE";break}if(!A)continue;if(C.cue=new …õ(0,0,""),
C.state="CUE",-1===A.indexOf("-->")){C.cue.id=A;continue}case"CUE":if(!C.cue){C.state="BADCUE";continue}try{«õ(A,C.cue,C.regionList)}catch(A){C.cue=null,C.state="BADCUE";continue}C.state="CUETEXT";continue;case"CUETEXT":{const B=-1!==A.indexOf("-->");if(!A||B&&(D=!0)){C.oncue&&C.cue&&C.oncue(C.cue),C.cue=null,C.state="ID";continue}if(null===C.cue)continue;C.cue.text&&(C.cue.text+="\n"),C.cue.text+=A}continue;case"BADCUE":A||(C.state="ID")}}}catch(A){
"CUETEXT"===C.state&&C.cue&&C.oncue&&C.oncue(C.cue),C.cue=null,C.state="INITIAL"===C.state?"BADWEBVTT":"BADCUE"}return this}flush(){const A=this;try{if((A.cue||"HEADER"===A.state)&&(A.buffer+="\n\n",A.parse()),"INITIAL"===A.state||"BADWEBVTT"===A.state)throw Error("Malformed WebVTT signature.")}catch(B){A.onparsingerror&&A.onparsingerror(B)}return A.onflush&&A.onflush(),this}}const ”ü=/\r\n|\n\r|\n|\r/g,”†=function(A,B,C=0){return A.slice(C,C+B.length)===B
},”°="stpp.ttml.im1t",”¢=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,”£=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,”§={left:"start",center:"center",right:"end",start:"start",end:"end"};class ”•{constructor(A,B){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=A,this.trackName=B}dispatchCue(){
null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(A,B,C){(null===this.startTime||this.startTime>A)&&(this.startTime=A),this.endTime=B,this.screen=C,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}const ”¶=/\s/,”ß={newCue(A,B,C,D){const E=[];let F,G,H,I,J;const K=self.VTTCue||self.TextTrackCue
;for(let M=0;M<D.rows.length;M++)if(F=D.rows[M],H=!0,I=0,J="",!F.isEmpty()){var L;for(let A=0;A<F.chars.length;A++)”¶.test(F.chars[A].uchar)&&H?I++:(J+=F.chars[A].uchar,H=!1);F.cueStartTime=B,B===C&&(C+=1e-4),I>=16?I--:I++;const D=«ú(J.trim()),N=«ù(B,C,D);null!=A&&null!=(L=A.cues)&&L.getCueById(N)||(G=new K(B,C,D),G.id=N,G.line=M+1,G.align="left",G.position=10+Math.min(80,10*Math.floor(8*I/32)),E.push(G))}
return A&&E.length&&(E.sort(((A,B)=>"auto"===A.line||"auto"===B.line?0:A.line>8&&B.line>8?B.line-A.line:A.line-B.line)),E.forEach((B=>«ã(A,B)))),E}},”®=/(\d+)-(\d+)\/(\d+)/;class ”©{constructor(A){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=A.fetchSetup||«©,this.controller=new self.AbortController,this.stats=new —Ñ}destroy(){
this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var A;this.abortInternal(),null!=(A=this.callbacks)&&A.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(A,B,C){const D=this.stats;if(D.loading.start)throw Error("Loader can only be used once.")
;D.loading.start=self.performance.now();const E=function(A,B){const C={method:"GET",mode:"cors",credentials:"same-origin",signal:B,headers:new self.Headers(ƒè({},A.headers))};return A.rangeEnd&&C.headers.set("Range","bytes="+A.rangeStart+"-"+(A.rangeEnd-1)),C}(A,this.controller.signal),F="arraybuffer"===A.responseType,G=F?"byteLength":"length",{maxTimeToFirstByteMs:H,maxLoadTimeMs:I}=B.loadPolicy;this.context=A,this.config=B,this.callbacks=C,this.request=this.fetchSetup(A,E),
self.clearTimeout(this.requestTimeout),B.timeout=H&&–∂(H)?H:I,this.requestTimeout=self.setTimeout((()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(D,A,this.response))}),B.timeout),(∆∞(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then((C=>{var E;this.response=this.loader=C;const G=Math.max(self.performance.now(),D.loading.start);if(self.clearTimeout(this.requestTimeout),B.timeout=I,this.requestTimeout=self.setTimeout((()=>{
this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(D,A,this.response))}),I-(G-D.loading.start)),!C.ok){const{status:A,statusText:B}=C;throw new ”™(B||"fetch, bad network response",A,C)}D.loading.first=G,D.total=«®(C.headers)||D.total;const H=null==(E=this.callbacks)?void 0:E.onProgress;return H&&–∂(B.highWaterMark)?this.loadProgressively(C,D,A,B.highWaterMark,H):F?C.arrayBuffer():"json"===A.responseType?C.json():C.text()})).then((C=>{var E,F;const H=this.response
;if(!H)throw Error("loader destroyed");self.clearTimeout(this.requestTimeout),D.loading.end=Math.max(self.performance.now(),D.loading.first);const I=C[G];I&&(D.loaded=D.total=I);const J={url:H.url,data:C,code:H.status},K=null==(E=this.callbacks)?void 0:E.onProgress;K&&!–∂(B.highWaterMark)&&K(D,A,C,H),null==(F=this.callbacks)||F.onSuccess(J,D,A,H)})).catch((B=>{var C;if(self.clearTimeout(this.requestTimeout),D.aborted)return;const E=B&&B.code||0,F=B?B.message:null
;null==(C=this.callbacks)||C.onError({code:E,text:F},A,B?B.details:null,D)}))}getCacheAge(){let A=null;if(this.response){const B=this.response.headers.get("age");A=B?parseFloat(B):null}return A}getResponseHeader(A){return this.response?this.response.headers.get(A):null}loadProgressively(A,B,C,D=0,E){const F=new “Å,G=A.body.getReader(),H=()=>G.read().then((G=>{if(G.done)return F.dataLength&&E(B,C,F.flush().buffer,A),Promise.resolve(new ArrayBuffer(0));const I=G.value,J=I.length;return B.loaded+=J,
J<D||F.dataLength?(F.push(I),F.dataLength>=D&&E(B,C,F.flush().buffer,A)):E(B,C,I.buffer,A),H()})).catch((()=>Promise.reject()));return H()}}class ”™ extends Error{constructor(A,B,C){super(A),this.code=void 0,this.details=void 0,this.code=B,this.details=C}}const ”´=/^age:\s*[\d.]+\s*$/im;class ”¨{constructor(A){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,
this.xhrSetup=A&&A.xhrSetup||null,this.stats=new —Ñ,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const A=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),A&&(A.onreadystatechange=null,A.onprogress=null,4!==A.readyState&&(this.stats.aborted=!0,A.abort()))}abort(){var A;this.abortInternal(),
null!=(A=this.callbacks)&&A.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(A,B,C){if(this.stats.loading.start)throw Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=A,this.config=B,this.callbacks=C,this.loadInternal()}loadInternal(){const{config:A,context:B}=this;if(!A||!B)return;const C=this.loader=new self.XMLHttpRequest,D=this.stats;D.loading.first=0,D.loaded=0,D.aborted=!1;const E=this.xhrSetup
;E?Promise.resolve().then((()=>{if(this.loader===C&&!this.stats.aborted)return E(C,B.url)})).catch((()=>{if(this.loader===C&&!this.stats.aborted)return C.open("GET",B.url,!0),E(C,B.url)})).then((()=>{this.loader!==C||this.stats.aborted||this.openAndSendXhr(C,B,A)})).catch((A=>{var E;null==(E=this.callbacks)||E.onError({code:C.status,text:A.message},B,C,D)})):this.openAndSendXhr(C,B,A)}openAndSendXhr(A,B,C){A.readyState||A.open("GET",B.url,!0)
;const D=B.headers,{maxTimeToFirstByteMs:E,maxLoadTimeMs:F}=C.loadPolicy;if(D)for(const B in D)A.setRequestHeader(B,D[B]);B.rangeEnd&&A.setRequestHeader("Range","bytes="+B.rangeStart+"-"+(B.rangeEnd-1)),A.onreadystatechange=this.readystatechange.bind(this),A.onprogress=this.loadprogress.bind(this),A.responseType=B.responseType,self.clearTimeout(this.requestTimeout),C.timeout=E&&–∂(E)?E:F,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),C.timeout),A.send()}readystatechange(){
var A,B,C;const{context:D,loader:E,stats:F}=this;if(!D||!E)return;const G=E.readyState,H=this.config;if(!F.aborted&&G>=2&&(0===F.loading.first&&(F.loading.first=Math.max(self.performance.now(),F.loading.start),H.timeout!==H.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),H.timeout=H.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),H.loadPolicy.maxLoadTimeMs-(F.loading.first-F.loading.start)))),4===G)){
self.clearTimeout(this.requestTimeout),E.onreadystatechange=null,E.onprogress=null;const G=E.status,I="text"===E.responseType?E.responseText:null;if(G>=200&&G<300){const C=null!=I?I:E.response;if(null!=C){F.loading.end=Math.max(self.performance.now(),F.loading.first);const H="arraybuffer"===E.responseType?C.byteLength:C.length;F.loaded=F.total=H,F.bwEstimate=8e3*F.total/(F.loading.end-F.loading.first);const I=null==(A=this.callbacks)?void 0:A.onProgress;I&&I(F,D,C,E);const J={url:E.responseURL,
data:C,code:G};return void(null==(B=this.callbacks)||B.onSuccess(J,F,D,E))}}const J=H.loadPolicy.errorRetry;≈ì(J,F.retry,!1,{url:D.url,data:void 0,code:G})?this.retry(J):(—Ç.error(`${G} while loading ${D.url}`),null==(C=this.callbacks)||C.onError({code:G,text:E.statusText},D,E,F))}}loadtimeout(){if(!this.config)return;const A=this.config.loadPolicy.timeoutRetry;if(≈ì(A,this.stats.retry,!0))this.retry(A);else{var B;—Ç.warn("timeout while loading "+(null==(B=this.context)?void 0:B.url))
;const A=this.callbacks;A&&(this.abortInternal(),A.onTimeout(this.stats,this.context,this.loader))}}retry(A){const{context:B,stats:C}=this;this.retryDelay=≈ë(A,C.retry),C.retry++,—Ç.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${null==B?void 0:B.url}, retrying ${C.retry}/${A.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}
loadprogress(A){const B=this.stats;B.loaded=A.loaded,A.lengthComputable&&(B.total=A.total)}getCacheAge(){let A=null;if(this.loader&&”´.test(this.loader.getAllResponseHeaders())){const B=this.loader.getResponseHeader("age");A=B?parseFloat(B):null}return A}getResponseHeader(A){return this.loader&&RegExp(`^${A}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(A):null}}const ”≠=ƒë(ƒë({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,
capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:1/0,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:6e7,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,
liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:”¨,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,
licenseResponseCallback:void 0,abrController:class extends –æ{constructor(A){super("abr",A.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.bwEstimator=void 0,this._abandonRulesCheck=A=>{var B
;const{fragCurrent:C,partCurrent:D,hls:E}=this,{autoLevelEnabled:F,media:G}=E;if(!C||!G)return;const H=performance.now(),I=D?D.stats:C.stats,J=D?D.duration:C.duration,K=H-I.loading.start,L=E.minAutoLevel,M=C.level,N=this._nextAutoLevel;if(I.aborted||I.loaded&&I.loaded===I.total||M<=L)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!F)return;const O=N>-1&&N!==M,P=!!A||O;if(!P&&(G.paused||!G.playbackRate||!G.readyState))return;const Q=E.mainForwardBufferInfo;if(!P&&null===Q)return
;const R=this.bwEstimator.getEstimateTTFB(),S=Math.abs(G.playbackRate);if(K<=Math.max(R,J/(2*S)*1e3))return;const T=Q?Q.len/S:0,U=I.loading.first?I.loading.first-I.loading.start:-1,V=I.loaded&&U>-1,W=this.getBwEstimate(),X=E.levels,Y=X[M],Z=Math.max(I.loaded,Math.round(J*(C.bitrate||Y.averageBitrate)/8));let a=V?K-U:K;a<1&&V&&(a=Math.min(K,8*I.loaded/W));const b=V?1e3*I.loaded/a:0,c=R/1e3,d=b?(Z-I.loaded)/b:8*Z/W+c;if(d<=T)return
;const e=b?8*b:W,f=!0===(null==(B=(null==A?void 0:A.details)||this.hls.latestLevelDetails)?void 0:B.live),g=this.hls.config.abrBandWidthUpFactor;let h,i=1/0;for(h=M-1;h>L;h--){const A=X[h].maxBitrate,B=!X[h].details||f;if(i=this.getTimeToLoadFrag(c,e,J*A,B),i<Math.min(T,J+c))break}if(i>=d)return;if(i>10*J)return;V?this.bwEstimator.sample(K-Math.min(R,U),I.loaded):this.bwEstimator.sampleTTFB(K);const j=X[h].maxBitrate;this.getBwEstimate()*g>j&&this.resetEstimator(j)
;const k=this.findBestLevel(j,L,h,0,T,1,1)
;k>-1&&(h=k),this.warn(`Fragment ${C.sn}${D?" part "+D.index:""} of level ${M} is loading too slowly;\n      Fragment duration: ${C.duration.toFixed(3)}\n      Time to underbuffer: ${T.toFixed(3)} s\n      Estimated load time for current fragment: ${d.toFixed(3)} s\n      Estimated load time for down switch fragment: ${i.toFixed(3)} s\n      TTFB estimate: ${0|U} ms\n      Current BW estimate: ${–∂(W)?0|W:"Unknown"} bps\n      New BW estimate: ${0|this.getBwEstimate()} bps\n      Switching to level ${h} @ ${0|j} bps`),
E.nextLoadLevel=E.nextAutoLevel=h,this.clearTimer();const l=()=>{if(this.clearTimer(),this.fragCurrent===C&&this.hls.loadLevel===h&&h>0){const A=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${h>0?"and switching down":""}\n      Fragment duration: ${C.duration.toFixed(3)} s\n      Time to underbuffer: ${A.toFixed(3)} s`),C.abortRequests(),this.fragCurrent=this.partCurrent=null,h>L){let B=this.findBestLevel(this.hls.levels[L].bitrate,L,h,0,A,1,1);-1===B&&(B=L),
this.hls.nextLoadLevel=this.hls.nextAutoLevel=B,this.resetEstimator(this.hls.levels[B].bitrate)}}};O||d>2*i?l():this.timer=self.setInterval(l,1e3*i),E.trigger(–ª.FRAG_LOAD_EMERGENCY_ABORTED,{frag:C,part:D,stats:I})},this.hls=A,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(A){A&&(this.log("setting initial bwe to "+A),this.hls.config.abrEwmaDefaultEstimate=A),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const A=this.hls.config
;return new –Ω(A.abrEwmaSlowVoD,A.abrEwmaFastVoD,A.abrEwmaDefaultEstimate)}registerListeners(){const{hls:A}=this;A.on(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.on(–ª.FRAG_LOADING,this.onFragLoading,this),A.on(–ª.FRAG_LOADED,this.onFragLoaded,this),A.on(–ª.FRAG_BUFFERED,this.onFragBuffered,this),A.on(–ª.LEVEL_SWITCHING,this.onLevelSwitching,this),A.on(–ª.LEVEL_LOADED,this.onLevelLoaded,this),A.on(–ª.LEVELS_UPDATED,this.onLevelsUpdated,this),
A.on(–ª.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),A.on(–ª.ERROR,this.onError,this)}unregisterListeners(){const{hls:A}=this;A&&(A.off(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.off(–ª.FRAG_LOADING,this.onFragLoading,this),A.off(–ª.FRAG_LOADED,this.onFragLoaded,this),A.off(–ª.FRAG_BUFFERED,this.onFragBuffered,this),A.off(–ª.LEVEL_SWITCHING,this.onLevelSwitching,this),A.off(–ª.LEVEL_LOADED,this.onLevelLoaded,this),A.off(–ª.LEVELS_UPDATED,this.onLevelsUpdated,this),
A.off(–ª.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),A.off(–ª.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(A,B){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){
this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(A,B){const C=B.frag;var D;this.ignoreFragment(C)||(C.bitrateTest||(this.fragCurrent=C,this.partCurrent=null!=(D=B.part)?D:null),this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100))}
onLevelSwitching(A,B){this.clearTimer()}onError(A,B){if(!B.fatal)switch(B.details){case –∫.BUFFER_ADD_CODEC_ERROR:case –∫.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case –∫.FRAG_LOAD_TIMEOUT:{const A=B.frag,{fragCurrent:C,partCurrent:D}=this;if(A&&C&&A.sn===C.sn&&A.level===C.level){const B=performance.now(),C=D?D.stats:A.stats,E=B-C.loading.start,F=C.loading.first?C.loading.first-C.loading.start:-1;if(C.loaded&&F>-1){const A=this.bwEstimator.getEstimateTTFB()
;this.bwEstimator.sample(E-Math.min(A,F),C.loaded)}else this.bwEstimator.sampleTTFB(E)}break}}}getTimeToLoadFrag(A,B,C,D){return A+C/B+(D?A+this.lastLevelLoadSec:0)}onLevelLoaded(A,B){const C=this.hls.config,{loading:D}=B.stats,E=D.end-D.first;–∂(E)&&(this.lastLevelLoadSec=E/1e3),B.details.live?this.bwEstimator.update(C.abrEwmaSlowLive,C.abrEwmaFastLive):this.bwEstimator.update(C.abrEwmaSlowVoD,C.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(B.levelInfo)}onFragLoaded(A,{frag:B,part:C}){
const D=C?C.stats:B.stats;if(B.type===»µ&&this.bwEstimator.sampleTTFB(D.loading.first-D.loading.start),!this.ignoreFragment(B)){if(this.clearTimer(),B.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const A=C?C.duration:B.duration,E=this.hls.levels[B.level],F=(E.loaded?E.loaded.bytes:0)+D.loaded,G=(E.loaded?E.loaded.duration:0)+A;E.loaded={bytes:F,duration:G},E.realBitrate=Math.round(8*F/G)}if(B.bitrateTest){const A={stats:D,
frag:B,part:C,id:B.type};this.onFragBuffered(–ª.FRAG_BUFFERED,A),B.bitrateTest=!1}else this.lastLoadedFragLevel=B.level}}onFragBuffered(A,B){const{frag:C,part:D}=B,E=null!=D&&D.stats.loaded?D.stats:C.stats;if(E.aborted)return;if(this.ignoreFragment(C))return;const F=E.parsing.end-E.loading.start-Math.min(E.loading.first-E.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(F,E.loaded),E.bwEstimate=this.getBwEstimate(),
C.bitrateTest?this.bitrateTestDelay=F/1e3:this.bitrateTestDelay=0}ignoreFragment(A){return A.type!==»µ||"initSegment"===A.sn}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:A,minAutoLevel:B}=this.hls,C=this.getBwEstimate(),D=this.hls.config.maxStarvationDelay,E=this.findBestLevel(C,B,A,0,D,1,1);if(E>-1)return E;const F=this.hls.firstLevel,G=Math.min(Math.max(F,B),A)
;return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${F} clamped to ${G}`),G}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const A=this.forcedAutoLevel,B=this.bwEstimator.canEstimate(),C=this.lastLoadedFragLevel>-1;if(!(-1===A||B&&C&&this.nextAutoLevelKey!==this.getAutoLevelKey()))return A;const D=B&&C?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==A){const B=this.hls.levels
;if(B.length>Math.max(A,D)&&B[A].loadError<=B[D].loadError)return A}return this._nextAutoLevel=D,this.nextAutoLevelKey=this.getAutoLevelKey(),D}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:A,partCurrent:B,hls:C}=this;if(C.levels.length<=1)return C.loadLevel;const{maxAutoLevel:D,config:E,minAutoLevel:F}=C,G=B?B.duration:A?A.duration:0,H=this.getBwEstimate(),I=this.getStarvationDelay()
;let J=E.abrBandWidthFactor,K=E.abrBandWidthUpFactor;if(I){const A=this.findBestLevel(H,F,D,I,0,J,K);if(A>=0)return this.rebufferNotice=-1,A}let L=G?Math.min(G,E.maxStarvationDelay):E.maxStarvationDelay;if(!I){const A=this.bitrateTestDelay;A&&(L=(G?Math.min(G,E.maxLoadingDelay):E.maxLoadingDelay)-A,this.info(`bitrate test took ${Math.round(1e3*A)}ms, set first fragment max fetchDuration to ${Math.round(1e3*L)} ms`),J=K=1)}const M=this.findBestLevel(H,F,D,I,L,J,K)
;if(this.rebufferNotice!==M&&(this.rebufferNotice=M,this.info(`${I?"rebuffering expected":"buffer is empty"}, optimal quality level ${M}`)),M>-1)return M;const N=C.levels[F],O=C.loadLevelObj;return O&&(null==N?void 0:N.bitrate)<O.bitrate?F:C.loadLevel}getStarvationDelay(){const A=this.hls,B=A.media;if(!B)return 1/0;const C=B&&0!==B.playbackRate?Math.abs(B.playbackRate):1,D=A.mainForwardBufferInfo;return(D?D.len:0)/C}getBwEstimate(){
return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(A,B,C,D,E,F,G){var H,I;const J=D+E,K=this.lastLoadedFragLevel,L=-1===K?this.hls.firstLevel:K,{fragCurrent:M,partCurrent:N}=this,{levels:O,allAudioTracks:P,loadLevel:Q,config:R}=this.hls;if(1===O.length)return 0;const S=O[L],T=!(null==(H=this.hls.latestLevelDetails)||!H.live),U=-1===Q||-1===K;let V,W="SDR",X=(null==S?void 0:S.frameRate)||0
;const{audioPreference:Y,videoPreference:Z}=R,a=this.audioTracksByGroup||(this.audioTracksByGroup=≈Ñ(P));let b=-1;if(U){if(-1!==this.firstSelection)return this.firstSelection;const D=this.codecTiers||(this.codecTiers=function(A,B,C,D){return A.slice(C,D+1).reduce(((A,C,D)=>{if(!C.codecSet)return A;const E=C.audioGroups;let F=A[C.codecSet];F||(A[C.codecSet]=F={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:D,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!E,fragmentError:0
}),F.minBitrate=Math.min(F.minBitrate,C.bitrate);const G=Math.min(C.height,C.width);return F.minHeight=Math.min(F.minHeight,G),F.minFramerate=Math.min(F.minFramerate,C.frameRate),F.minIndex=Math.min(F.minIndex,D),F.maxScore=Math.max(F.maxScore,C.score),F.fragmentError+=C.fragmentError,F.videoRanges[C.videoRange]=(F.videoRanges[C.videoRange]||0)+1,E&&E.forEach((A=>{if(!A)return;const C=B.groups[A]
;C&&(F.hasDefaultAudio=F.hasDefaultAudio||B.hasDefaultAudio?C.hasDefault:C.hasAutoSelect||!B.hasDefaultAudio&&!B.hasAutoSelectAudio,Object.keys(C.channels).forEach((A=>{F.channels[A]=(F.channels[A]||0)+C.channels[A]})))})),A}),{})}(O,a,B,C)),E=function(A,B,C,D,E){const F=Object.keys(A),G=null==D?void 0:D.channels,H=null==D?void 0:D.audioCodec,I=null==E?void 0:E.videoCodec,J=G&&2===parseInt(G);let K=!1,L=!1,M=1/0,N=1/0,O=1/0,P=1/0,Q=0,R=[];const{preferHDR:S,allowedVideoRanges:T}=≈Ç(B,E)
;for(let B=F.length;B--;){const C=A[F[B]];K||(K=C.channels[2]>0),M=Math.min(M,C.minHeight),N=Math.min(N,C.minFramerate),O=Math.min(O,C.minBitrate),T.filter((A=>C.videoRanges[A]>0)).length>0&&(L=!0)}M=–∂(M)?M:0,N=–∂(N)?N:0;const U=Math.max(1080,M),V=Math.max(30,N);O=–∂(O)?O:C,C=Math.max(O,C),L||(B=void 0);const W=F.length>1;return{codecSet:F.reduce(((B,D)=>{const E=A[D];if(D===B)return B;if(R=L?T.filter((A=>E.videoRanges[A]>0)):[],W){
if(E.minBitrate>C)return ≈É(D,`min bitrate of ${E.minBitrate} > current estimate of ${C}`),B;if(!E.hasDefaultAudio)return ≈É(D,"no renditions with default or auto-select sound found"),B;if(H&&D.indexOf(H.substring(0,4))%5!=0)return ≈É(D,`audio codec preference "${H}" not found`),B;if(G&&!J){if(!E.channels[G])return ≈É(D,`no renditions with ${G} channel sound found (channels options: ${Object.keys(E.channels)})`),B
}else if((!H||J)&&K&&0===E.channels[2])return ≈É(D,"no renditions with stereo sound found"),B;if(E.minHeight>U)return ≈É(D,`min resolution of ${E.minHeight} > maximum of ${U}`),B;if(E.minFramerate>V)return ≈É(D,`min framerate of ${E.minFramerate} > maximum of ${V}`),B;if(!R.some((A=>E.videoRanges[A]>0)))return ≈É(D,`no variants with VIDEO-RANGE of ${—ï(R)} found`),B;if(I&&D.indexOf(I.substring(0,4))%5!=0)return ≈É(D,`video codec preference "${I}" not found`),B
;if(E.maxScore<Q)return ≈É(D,`max score of ${E.maxScore} < selected max of ${Q}`),B}return B&&(ƒ∑(D)>=ƒ∑(B)||E.fragmentError>A[B].fragmentError)?B:(P=E.minIndex,Q=E.maxScore,D)}),void 0),videoRanges:R,preferHDR:S,minFramerate:N,minBitrate:O,minIndex:P}}(D,W,A,Y,Z),{codecSet:F,videoRanges:G,minFramerate:H,minBitrate:I,minIndex:J,preferHDR:K}=E;b=J,V=F,W=K?G[G.length-1]:G[0],X=H,A=Math.max(A,I),this.log("picked start tier "+—ï(E))}else V=null==S?void 0:S.codecSet,W=null==S?void 0:S.videoRange
;const c=N?N.duration:M?M.duration:0,d=this.bwEstimator.getEstimateTTFB()/1e3,e=[];for(let H=C;H>=B;H--){const B=O[H],M=H>L;if(!B)continue;if(R.useMediaCapabilities&&!B.supportedResult&&!B.supportedPromise){const C=navigator.mediaCapabilities;"function"==typeof(null==C?void 0:C.decodingInfo)&&(ƒæ(B,a,W,X,A,Y)||ƒ¨(B.videoCodec))?(B.supportedPromise=ƒø(B,a,C),B.supportedPromise.then((A=>{if(!this.hls)return;B.supportedResult=A;const C=this.hls.levels,D=C.indexOf(B)
;A.error?this.warn(`MediaCapabilities decodingInfo error: "${A.error}" for level ${D} ${—ï(A)}`):A.supported||(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${D} ${—ï(A)}`),D>-1&&C.length>1&&(this.log("Removing unsupported level "+D),this.hls.removeLevel(D),-1===this.hls.loadLevel&&(this.hls.nextLoadLevel=0)))}))):B.supportedResult=—è}
if((V&&B.codecSet!==V||W&&B.videoRange!==W||M&&X>B.frameRate||!M&&X>0&&X<B.frameRate||B.supportedResult&&(null==(I=B.supportedResult.decodingInfoResults)||!I[0].smooth))&&(!U||H!==b)){e.push(H);continue}const P=B.details,S=(N?null==P?void 0:P.partTarget:null==P?void 0:P.averagetargetduration)||c;let Z;Z=M?G*A:F*A;const f=c&&D>=2*c&&0===E?B.averageBitrate:B.maxBitrate,g=this.getTimeToLoadFrag(d,Z,f*S,void 0===P)
;if(Z>=f&&(H===K||0===B.loadError&&0===B.fragmentError)&&(g<=d||!–∂(g)||T&&!this.bitrateTestDelay||g<J)){const A=this.forcedAutoLevel;return H===Q||-1!==A&&A===Q||(e.length&&this.trace(`Skipped level(s) ${e.join(",")} of ${C} max with CODECS and VIDEO-RANGE:"${O[e[0]].codecs}" ${O[e[0]].videoRange}; not compatible with "${V}" ${W}`),
this.info(`switch candidate:${L}->${H} adjustedbw(${Math.round(Z)})-bitrate=${Math.round(Z-f)} ttfb:${d.toFixed(1)} avgDuration:${S.toFixed(1)} maxFetchDuration:${J.toFixed(1)} fetchDuration:${g.toFixed(1)} firstSelection:${U} codecSet:${B.codecSet} videoRange:${B.videoRange} hls.loadLevel:${Q}`)),U&&(this.firstSelection=H),H}}return-1}set nextAutoLevel(A){const B=this.deriveNextAutoLevel(A);this._nextAutoLevel!==B&&(this.nextAutoLevelKey="",this._nextAutoLevel=B)}deriveNextAutoLevel(A){
const{maxAutoLevel:B,minAutoLevel:C}=this.hls;return Math.min(Math.max(A,C),B)}},bufferController:class extends –æ{constructor(A,B){var C;super("buffer-controller",A.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,
this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=()=>{var A;this.hls&&"open"===(null==(A=this.mediaSource)?void 0:A.readyState)&&this.hls.pauseBuffering()},this._onStartStreaming=()=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=A=>{const{media:B,mediaSource:C}=this;A&&this.log("Media source opened"),B&&C&&(C.removeEventListener("sourceopen",this._onMediaSourceOpen),
B.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(–ª.MEDIA_ATTACHED,{media:B,mediaSource:C}),null!==this.mediaSource&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:A,_objectUrl:B}=this;A!==B&&this.error(`Media element src was set while attaching MediaSource (${B} > ${A})`)},this.hls=A,this.fragmentTracker=B,
this.appendSource=(C=ƒî(A.config.preferManagedMediaSource),"undefined"!=typeof self&&C===self.ManagedMediaSource),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,
this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:A}=this;A.on(–ª.MEDIA_ATTACHING,this.onMediaAttaching,this),A.on(–ª.MEDIA_DETACHING,this.onMediaDetaching,this),A.on(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.on(–ª.MANIFEST_PARSED,this.onManifestParsed,this),A.on(–ª.BUFFER_RESET,this.onBufferReset,this),A.on(–ª.BUFFER_APPENDING,this.onBufferAppending,this),
A.on(–ª.BUFFER_CODECS,this.onBufferCodecs,this),A.on(–ª.BUFFER_EOS,this.onBufferEos,this),A.on(–ª.BUFFER_FLUSHING,this.onBufferFlushing,this),A.on(–ª.LEVEL_UPDATED,this.onLevelUpdated,this),A.on(–ª.FRAG_PARSED,this.onFragParsed,this),A.on(–ª.FRAG_CHANGED,this.onFragChanged,this),A.on(–ª.ERROR,this.onError,this)}unregisterListeners(){const{hls:A}=this;A.off(–ª.MEDIA_ATTACHING,this.onMediaAttaching,this),A.off(–ª.MEDIA_DETACHING,this.onMediaDetaching,this),
A.off(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.off(–ª.MANIFEST_PARSED,this.onManifestParsed,this),A.off(–ª.BUFFER_RESET,this.onBufferReset,this),A.off(–ª.BUFFER_APPENDING,this.onBufferAppending,this),A.off(–ª.BUFFER_CODECS,this.onBufferCodecs,this),A.off(–ª.BUFFER_EOS,this.onBufferEos,this),A.off(–ª.BUFFER_FLUSHING,this.onBufferFlushing,this),A.off(–ª.LEVEL_UPDATED,this.onLevelUpdated,this),A.off(–ª.FRAG_PARSED,this.onFragParsed,this),A.off(–ª.FRAG_CHANGED,this.onFragChanged,this),
A.off(–ª.ERROR,this.onError,this)}transferMedia(){const{media:A,mediaSource:B}=this;if(!A)return null;const C={};if(this.operationQueue){const A=this.isUpdating();A||this.operationQueue.removeBlockers();const B=this.isQueued();(A||B)&&this.warn(`Transfering MediaSource with${B?" operations in queue":""}${A?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const D=this.transferData
;return!this.sourceBufferCount&&D&&D.mediaSource===B?ƒè(C,D.tracks):this.sourceBuffers.forEach((A=>{const[B]=A;B&&(C[B]=ƒè({},this.tracks[B]),this.removeBuffer(B)),A[0]=A[1]=null})),{media:A,mediaSource:B,tracks:C}}initTracks(){this.sourceBuffers=[[null,null],[null,null]],this.tracks={},this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(A,B){
var C;let D=2;(B.audio&&!B.video||!B.altAudio)&&(D=1),this.bufferCodecEventsTotal=D,this.log(D+" bufferCodec event(s) expected."),null!=(C=this.transferData)&&C.mediaSource&&this.sourceBufferCount&&D&&this.bufferCreated()}onMediaAttaching(A,B){const C=this.media=B.media,D=ƒî(this.appendSource);if(this.transferData=this.overrides=void 0,C&&D){const A=!!B.mediaSource;(A||B.overrides)&&(this.transferData=B,this.overrides=B.overrides);const E=this.mediaSource=B.mediaSource||new D
;if(this.assignMediaSource(E),A)this._objectUrl=C.src,this.attachTransferred();else{const A=this._objectUrl=self.URL.createObjectURL(E);if(this.appendSource)try{C.removeAttribute("src");const B=self.ManagedMediaSource;C.disableRemotePlayback=C.disableRemotePlayback||B&&E instanceof B,∆¥(C),function(A,B){const C=self.document.createElement("source");C.type="video/mp4",C.src=B,A.appendChild(C)}(C,A),C.load()}catch(B){C.src=A}else C.src=A}C.addEventListener("emptied",this._onMediaEmptied)}}
assignMediaSource(A){var B,C;this.log(`${(null==(B=this.transferData)?void 0:B.mediaSource)===A?"transferred":"created"} media source: ${null==(C=A.constructor)?void 0:C.name}`),A.addEventListener("sourceopen",this._onMediaSourceOpen),A.addEventListener("sourceended",this._onMediaSourceEnded),A.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(A.addEventListener("startstreaming",this._onStartStreaming),A.addEventListener("endstreaming",this._onEndStreaming))}
attachTransferred(){const A=this.media,B=this.transferData;if(!B||!A)return;const C=this.tracks,D=B.tracks,E=D?Object.keys(D):null,F=E?E.length:0,G=()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()};if(D&&E&&F){if(!this.tracksReady)return this.hls.config.startFragPrefetch=!0,void this.log("attachTransferred: waiting for SourceBuffer track info")
;if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})\nrequired tracks: ${—ï(C,((A,B)=>"initSegment"===A?void 0:B))};\ntransfer tracks: ${—ï(D,((A,B)=>"initSegment"===A?void 0:B))}}`),!ƒï(D,C)){B.mediaSource=null,B.tracks=void 0;const E=A.currentTime,F=this.details,G=Math.max(E,(null==F?void 0:F.fragments[0].start)||0)
;return G-E>1?void this.log(`attachTransferred: waiting for playback to reach new tracks start time ${E} -> ${G}`):(this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(D)}"->"${Object.keys(C)}") start time: ${G} currentTime: ${E}`),this.onMediaDetaching(–ª.MEDIA_DETACHING,{}),this.onMediaAttaching(–ª.MEDIA_ATTACHING,B),void(A.currentTime=G))}this.transferData=void 0,E.forEach((A=>{const B=A,C=D[B];if(C){const A=C.buffer;if(A){
const D=this.fragmentTracker,E=C.id;if(D.hasFragments(E)||D.hasParts(E)){const C=—¢.getBuffered(A);D.detectEvictedFragments(B,C,E,null,!0)}const F=∆µ(B),G=[B,A];this.sourceBuffers[F]=G,A.updating&&this.operationQueue&&this.operationQueue.prependBlocker(B),this.trackSourceBuffer(B,C)}}})),G(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),G()}get mediaSourceOpenOrEnded(){var A;const B=null==(A=this.mediaSource)?void 0:A.readyState
;return"open"===B||"ended"===B}onMediaDetaching(A,B){const C=!!B.transferMedia;this.transferData=this.overrides=void 0;const{media:D,mediaSource:E,_objectUrl:F}=this;if(E){if(this.log("media source "+(C?"transferring":"detaching")),C)this.sourceBuffers.forEach((([A])=>{A&&this.removeBuffer(A)})),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const A="open"===E.readyState;try{const B=E.sourceBuffers;for(let C=B.length;C--;)A&&B[C].abort(),E.removeSourceBuffer(B[C]);A&&E.endOfStream()
}catch(A){this.warn(`onMediaDetaching: ${A.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}E.removeEventListener("sourceopen",this._onMediaSourceOpen),E.removeEventListener("sourceended",this._onMediaSourceEnded),E.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(E.removeEventListener("startstreaming",this._onStartStreaming),E.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}
D&&(D.removeEventListener("emptied",this._onMediaEmptied),C||(F&&self.URL.revokeObjectURL(F),this.mediaSrc===F?(D.removeAttribute("src"),this.appendSource&&∆¥(D),D.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(–ª.MEDIA_DETACHED,B)}onBufferReset(){this.sourceBuffers.forEach((([A])=>{A&&this.resetBuffer(A)})),this.initTracks()}resetBuffer(A){var B,C;const D=null==(B=this.tracks[A])?void 0:B.buffer;if(this.removeBuffer(A),D)try{
null!=(C=this.mediaSource)&&C.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(D)}catch(B){this.warn("onBufferReset "+A,B)}delete this.tracks[A]}removeBuffer(A){this.removeBufferListeners(A),this.sourceBuffers[∆µ(A)]=[null,null];const B=this.tracks[A];B&&(B.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new “¨(this.tracks)}onBufferCodecs(A,B){const C=this.tracks,D=Object.keys(B)
;this.log(`BUFFER_CODECS: "${D}" (current SB count ${this.sourceBufferCount})`);const E="audiovideo"in B&&(C.audio||C.video)||C.audiovideo&&("audio"in B||"video"in B),F=!E&&this.sourceBufferCount&&this.media&&D.some((A=>!C[A]));E||F?this.warn(`Unsupported transition between "${Object.keys(C)}" and "${D}" SourceBuffers`):(D.forEach((A=>{var D,E,F;const G=B[A],{id:H,codec:I,levelCodec:J,container:K,metadata:L,supplemental:M}=G;let N=C[A]
;const O=null==(D=this.transferData)||null==(E=D.tracks)?void 0:E[A],P=null!=O&&O.buffer?O:N,Q=(null==P?void 0:P.pendingCodec)||(null==P?void 0:P.codec),R=null==P?void 0:P.levelCodec;N||(N=C[A]={buffer:void 0,listeners:[],codec:I,supplemental:M,container:K,levelCodec:J,metadata:L,id:H});const S=ƒπ(Q,R),T=null==S?void 0:S.replace(“≠,"$1");let U=ƒπ(I,J);const V=null==(F=U)?void 0:F.replace(“≠,"$1");U&&S&&T!==V&&("audio"===A.slice(0,5)&&(U=ƒ∏(U,this.appendSource)),
this.log(`switching codec ${Q} to ${U}`),U!==(N.pendingCodec||N.codec)&&(N.pendingCodec=U),N.container=K,this.appendChangeType(A,K,U))})),(this.tracksReady||this.sourceBufferCount)&&(B.tracks=this.sourceBufferTracks),this.sourceBufferCount||this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce(((A,B)=>{const C=this.tracks[B];return A[B]={id:C.id,container:C.container,codec:C.codec,levelCodec:C.levelCodec},A}),{})}
appendChangeType(A,B,C){const D=`${B};codecs=${C}`,E={label:"change-type="+D,execute:()=>{const E=this.tracks[A];if(E){const F=E.buffer;null!=F&&F.changeType&&(this.log(`changing ${A} sourceBuffer type to ${D}`),F.changeType(D),E.codec=C,E.container=B)}this.shiftAndExecuteNext(A)},onStart:()=>{},onComplete:()=>{},onError:B=>{this.warn(`Failed to change ${A} SourceBuffer type`,B)}};this.append(E,A,this.isPending(this.tracks[A]))}blockAudio(A){var B;const C=A.start,D=C+.05*A.duration
;if(!0===(null==(B=this.fragmentTracker.getAppendedFrag(C,»µ))?void 0:B.gap))return;const E={label:"block-audio",execute:()=>{var A;const B=this.tracks.video;(this.lastVideoAppendEnd>D||null!=B&&B.buffer&&—¢.isBuffered(B.buffer,D)||!0===(null==(A=this.fragmentTracker.getAppendedFrag(D,»µ))?void 0:A.gap))&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:A=>{this.warn("Error executing block-audio operation",A)}};this.blockedAudioAppend={op:E,
frag:A},this.append(E,"audio",!0)}unblockAudio(){const{blockedAudioAppend:A,operationQueue:B}=this;A&&B&&(this.blockedAudioAppend=null,B.unblockAudio(A.op))}onBufferAppending(A,B){const{tracks:C}=this,{data:D,type:E,parent:F,frag:G,part:H,chunkMeta:I}=B,J=I.buffering[E],K=G.sn,L=self.performance.now();J.start=L;const M=G.stats.buffering,N=H?H.stats.buffering:null;0===M.start&&(M.start=L),N&&0===N.start&&(N.start=L);const O=C.audio;let P=!1
;"audio"===E&&"audio/mpeg"===(null==O?void 0:O.container)&&(P=!this.lastMpegAudioChunk||1===I.id||this.lastMpegAudioChunk.sn!==I.sn,this.lastMpegAudioChunk=I);const Q=this.tracks.video,R=null==Q?void 0:Q.buffer;if(R&&"initSegment"!==K){const A=H||G,B=this.blockedAudioAppend;if("audio"!==E||"main"===F||this.blockedAudioAppend){if("video"===E){const C=A.end;if(B){const A=B.frag.start;(C>A||C<this.lastVideoAppendEnd||—¢.isBuffered(R,A))&&this.unblockAudio()}this.lastVideoAppendEnd=C}}else{
const B=A.start+.05*A.duration,C=R.buffered,D=this.currentOp("video");C.length||D?!D&&!—¢.isBuffered(R,B)&&this.lastVideoAppendEnd<B&&this.blockAudio(A):this.blockAudio(A)}}const S=(H||G).start,T={label:"append-"+E,execute:()=>{if(J.executeStart=self.performance.now(),P){const A=this.tracks[E];if(A){const B=A.buffer;if(B){const A=S-B.timestampOffset;Math.abs(A)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${S} (delta: ${A}) sn: ${K})`),B.timestampOffset=S)}}}
this.appendExecutor(D,E)},onStart:()=>{},onComplete:()=>{const A=self.performance.now();J.executeEnd=J.end=A,0===M.first&&(M.first=A),N&&0===N.first&&(N.first=A);const B={};this.sourceBuffers.forEach((([A,C])=>{A&&(B[A]=—¢.getBuffered(C))})),this.appendErrors[E]=0,"audio"===E||"video"===E?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(–ª.BUFFER_APPENDED,{type:E,frag:G,part:H,chunkMeta:I,parent:G.type,timeRanges:B})},onError:A=>{var B;const C={
type:–π.MEDIA_ERROR,parent:G.type,details:–∫.BUFFER_APPEND_ERROR,sourceBufferName:E,frag:G,part:H,chunkMeta:I,error:A,err:A,fatal:!1},D=null==(B=this.media)?void 0:B.error;if(A.code===DOMException.QUOTA_EXCEEDED_ERR)C.details=–∫.BUFFER_FULL_ERROR;else if(A.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!D)C.errorAction=≈î(!0);else if(A.name===“Æ&&0===this.sourceBufferCount)C.errorAction=≈î(!0);else{const A=++this.appendErrors[E]
;this.warn(`Failed ${A}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${E}" sourceBuffer (${D||"no media error"})`),(A>=this.hls.config.appendErrorMaxRetry||D)&&(C.fatal=!0)}this.hls.trigger(–ª.ERROR,C)}};this.append(T,E,this.isPending(this.tracks[E]))}getFlushOp(A,B,C){return this.log(`queuing "${A}" remove ${B}-${C}`),{label:"remove",execute:()=>{this.removeExecutor(A,B,C)},onStart:()=>{},onComplete:()=>{this.hls.trigger(–ª.BUFFER_FLUSHED,{type:A})},onError:D=>{
this.warn(`Failed to remove ${B}-${C} from "${A}" SourceBuffer`,D)}}}onBufferFlushing(A,B){const{type:C,startOffset:D,endOffset:E}=B;C?this.append(this.getFlushOp(C,D,E),C):this.sourceBuffers.forEach((([A])=>{A&&this.append(this.getFlushOp(A,D,E),A)}))}onFragParsed(A,B){const{frag:C,part:D}=B,E=[],F=D?D.elementaryStreams:C.elementaryStreams;F[»Ω]?E.push("audiovideo"):(F[»ª]&&E.push("audio"),F[»º]&&E.push("video")),
0===E.length&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${C.type} level: ${C.level} sn: ${C.sn}`),this.blockBuffers((()=>{const A=self.performance.now();C.stats.buffering.end=A,D&&(D.stats.buffering.end=A);const B=D?D.stats:C.stats;this.hls.trigger(–ª.FRAG_BUFFERED,{frag:C,part:D,stats:B,id:C.type})}),E).catch((A=>{this.warn("Fragment buffered callback "+A),this.stepOperationQueue(this.sourceBufferTypes)}))}onFragChanged(A,B){this.trimBuffers()}
get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some((([A])=>{var B,C;return A&&(!(null!=(B=this.tracks[A])&&B.ended)||(null==(C=this.tracks[A])?void 0:C.ending))}))}onBufferEos(A,B){var C;this.sourceBuffers.forEach((([A])=>{if(A){const C=this.tracks[A];B.type&&B.type!==A||(C.ending=!0,C.ended||(C.ended=!0,this.log(A+" buffer reached EOS")))}}));const D=!1!==(null==(C=this.overrides)?void 0:C.endOfStream);this.sourceBufferCount>0&&!this.sourceBuffers.some((([A])=>{var B
;return A&&!(null!=(B=this.tracks[A])&&B.ended)}))&&(D?(this.log("Queueing EOS"),this.blockUntilOpen((()=>{this.tracksEnded();const{mediaSource:A}=this;A&&"open"===A.readyState?(this.log("Calling mediaSource.endOfStream()"),A.endOfStream(),this.hls.trigger(–ª.BUFFERED_TO_END,void 0)):A&&this.log("Could not call mediaSource.endOfStream(). mediaSource.readyState: "+A.readyState)}))):(this.tracksEnded(),this.hls.trigger(–ª.BUFFERED_TO_END,void 0)))}tracksEnded(){this.sourceBuffers.forEach((([A])=>{
if(null!==A){const B=this.tracks[A];B&&(B.ending=!1)}}))}onLevelUpdated(A,{details:B}){B.fragments.length&&(this.details=B,this.updateDuration())}updateDuration(){const A=this.getDurationAndRange();A&&this.blockUntilOpen((()=>this.updateMediaSource(A)))}onError(A,B){if(B.details===–∫.BUFFER_APPEND_ERROR&&B.frag){var C;const A=null==(C=B.errorAction)?void 0:C.nextAutoLevel;–∂(A)&&A!==B.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}
trimBuffers(){const{hls:A,details:B,media:C}=this;if(!C||null===B)return;if(!this.sourceBufferCount)return;const D=A.config,E=C.currentTime,F=B.levelTargetDuration,G=B.live&&null!==D.liveBackBufferLength?D.liveBackBufferLength:D.backBufferLength;if(–∂(G)&&G>=0){const A=Math.max(G,F),B=Math.floor(E/F)*F-A;this.flushBackBuffer(E,F,B)}if(–∂(D.frontBufferFlushThreshold)&&D.frontBufferFlushThreshold>0){const A=Math.max(D.maxBufferLength,D.frontBufferFlushThreshold),B=Math.max(A,F),C=Math.floor(E/F)*F+B
;this.flushFrontBuffer(E,F,C)}}flushBackBuffer(A,B,C){this.sourceBuffers.forEach((([A,B])=>{if(B){const E=—¢.getBuffered(B);if(E.length>0&&C>E.start(0)){var D;this.hls.trigger(–ª.BACK_BUFFER_REACHED,{bufferEnd:C});const B=this.tracks[A];if(null!=(D=this.details)&&D.live)this.hls.trigger(–ª.LIVE_BACK_BUFFER_REACHED,{bufferEnd:C});else if(null!=B&&B.ended)return void this.log(`Cannot flush ${A} back buffer while SourceBuffer is in ended state`);this.hls.trigger(–ª.BUFFER_FLUSHING,{startOffset:0,
endOffset:C,type:A})}}}))}flushFrontBuffer(A,B,C){this.sourceBuffers.forEach((([B,D])=>{if(D){const E=—¢.getBuffered(D),F=E.length;if(F<2)return;const G=E.start(F-1),H=E.end(F-1);if(C>G||A>=G&&A<=H)return;this.hls.trigger(–ª.BUFFER_FLUSHING,{startOffset:G,endOffset:1/0,type:B})}}))}getDurationAndRange(){var A;const{details:B,mediaSource:C}=this;if(!B||!this.media||"open"!==(null==C?void 0:C.readyState))return null;const D=B.edge;if(B.live&&this.hls.config.liveDurationInfinity){
if(B.fragments.length&&B.live&&C.setLiveSeekableRange){const A=Math.max(0,B.fragmentStart);return{duration:1/0,start:A,end:Math.max(A,D)}}return{duration:1/0}}const E=null==(A=this.overrides)?void 0:A.duration;if(E)return –∂(E)?{duration:E}:null;const F=this.media.duration;return D>(–∂(C.duration)?C.duration:0)&&D>F||!–∂(F)?{duration:D}:null}updateMediaSource({duration:A,start:B,end:C}){const D=this.mediaSource
;this.media&&D&&"open"===D.readyState&&(D.duration!==A&&(–∂(A)&&this.log("Updating MediaSource duration to "+A.toFixed(3)),D.duration=A),void 0!==B&&void 0!==C&&(this.log(`MediaSource duration is set to ${D.duration}. Setting seekable range to ${B}-${C}.`),D.setLiveSeekableRange(B,C)))}get tracksReady(){const A=this.pendingTrackCount;return A>0&&(A>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){
const{bufferCodecEventsTotal:A,pendingTrackCount:B,tracks:C}=this;if(this.log(`checkPendingTracks (pending: ${B} codec events expected: ${A}) ${—ï(C)}`),this.tracksReady){var D;const A=null==(D=this.transferData)?void 0:D.tracks;A&&Object.keys(A).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const A={};this.sourceBuffers.forEach((([B,C])=>{if(B){const D=this.tracks[B];A[B]={buffer:C,container:D.container,codec:D.codec,
supplemental:D.supplemental,levelCodec:D.levelCodec,id:D.id,metadata:D.metadata}}})),this.hls.trigger(–ª.BUFFER_CREATED,{tracks:A}),this.log("SourceBuffers created. Running queue: "+this.operationQueue),this.sourceBuffers.forEach((([A])=>{this.executeNext(A)}))}else{const A=Error("could not create source buffer for media codec(s)");this.hls.trigger(–ª.ERROR,{type:–π.MEDIA_ERROR,details:–∫.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:A,reason:A.message})}}createSourceBuffers(){
const{tracks:A,sourceBuffers:B,mediaSource:C}=this;if(!C)throw Error("createSourceBuffers called when mediaSource was null");for(const E in A){const F=E,G=A[F];if(this.isPending(G)){const A=this.getTrackCodec(G,F),E=`${G.container};codecs=${A}`;G.codec=A,this.log(`creating sourceBuffer(${E})${this.currentOp(F)?" Queued":""} ${—ï(G)}`);try{const A=C.addSourceBuffer(E),D=∆µ(F),H=[F,A];B[D]=H,G.buffer=A}catch(A){var D;return this.error("error while trying to add sourceBuffer: "+A.message),
this.shiftAndExecuteNext(F),null==(D=this.operationQueue)||D.removeBlockers(),delete this.tracks[F],void this.hls.trigger(–ª.ERROR,{type:–π.MEDIA_ERROR,details:–∫.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:A,sourceBufferName:F,mimeType:E,parent:G.id})}this.trackSourceBuffer(F,G)}}this.bufferCreated()}getTrackCodec(A,B){const C=A.supplemental;let D=A.codec;C&&("video"===B||"audiovideo"===B)&&ƒ≥(C,"video")&&(D=function(A,B){const C=[];if(A){const B=A.split(",")
;for(let A=0;A<B.length;A++)ƒ≤(B[A],"video")||C.push(B[A])}return B&&C.push(B),C.join(",")}(D,C));const E=ƒπ(D,A.levelCodec);return E?"audio"===B.slice(0,5)?ƒ∏(E,this.appendSource):E:""}trackSourceBuffer(A,B){const C=B.buffer;if(!C)return;const D=this.getTrackCodec(B,A);this.tracks[A]={buffer:C,codec:D,container:B.container,levelCodec:B.levelCodec,supplemental:B.supplemental,metadata:B.metadata,id:B.id,listeners:[]},this.removeBufferListeners(A),
this.addBufferListener(A,"updatestart",this.onSBUpdateStart),this.addBufferListener(A,"updateend",this.onSBUpdateEnd),this.addBufferListener(A,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(A,"bufferedchange",((A,B)=>{const C=B.removedRanges;null!=C&&C.length&&this.hls.trigger(–ª.BUFFER_FLUSHED,{type:A})}))}get mediaSrc(){var A,B;const C=(null==(A=this.media)||null==(B=A.querySelector)?void 0:B.call(A,"source"))||this.media;return null==C?void 0:C.src}onSBUpdateStart(A){
const B=this.currentOp(A);B&&B.onStart()}onSBUpdateEnd(A){var B;if("closed"===(null==(B=this.mediaSource)?void 0:B.readyState))return void this.resetBuffer(A);const C=this.currentOp(A);C&&(C.onComplete(),this.shiftAndExecuteNext(A))}onSBUpdateError(A,B){var C;const D=Error(`${A} SourceBuffer error. MediaSource readyState: ${null==(C=this.mediaSource)?void 0:C.readyState}`);this.error(""+D,B),this.hls.trigger(–ª.ERROR,{type:–π.MEDIA_ERROR,details:–∫.BUFFER_APPENDING_ERROR,sourceBufferName:A,error:D,
fatal:!1});const E=this.currentOp(A);E&&E.onError(D)}removeExecutor(A,B,C){const{media:D,mediaSource:E}=this,F=this.tracks[A],G=null==F?void 0:F.buffer;if(!D||!E||!G)return this.warn(`Attempting to remove from the ${A} SourceBuffer, but it does not exist`),void this.shiftAndExecuteNext(A);const H=–∂(D.duration)?D.duration:1/0,I=–∂(E.duration)?E.duration:1/0,J=Math.max(0,B),K=Math.min(C,H,I);K>J&&(!F.ending||F.ended)?(F.ended=!1,this.log(`Removing [${J},${K}] from the ${A} SourceBuffer`),
G.remove(J,K)):this.shiftAndExecuteNext(A)}appendExecutor(A,B){const C=this.tracks[B],D=null==C?void 0:C.buffer;if(!D)throw new “Ø(`Attempting to append to the ${B} SourceBuffer, but it does not exist`);C.ending=!1,C.ended=!1,D.appendBuffer(A)}blockUntilOpen(A){if(this.isUpdating()||this.isQueued())this.blockBuffers(A).catch((A=>{this.warn("SourceBuffer blocked callback "+A),this.stepOperationQueue(this.sourceBufferTypes)}));else try{A()}catch(A){
this.warn(`Callback run without blocking ${this.operationQueue} ${A}`)}}isUpdating(){return this.sourceBuffers.some((([A,B])=>A&&B.updating))}isQueued(){return this.sourceBuffers.some((([A])=>A&&!!this.currentOp(A)))}isPending(A){return!!A&&!A.buffer}blockBuffers(A,B=this.sourceBufferTypes){if(!B.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(A);const{operationQueue:C}=this,D=B.map((A=>this.appendBlocker(A)))
;return B.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(D).then((()=>{C===this.operationQueue&&(A(),this.stepOperationQueue(this.sourceBufferTypes))}))}stepOperationQueue(A){A.forEach((A=>{var B;const C=null==(B=this.tracks[A])?void 0:B.buffer;C&&!C.updating&&this.shiftAndExecuteNext(A)}))}append(A,B,C){this.operationQueue&&this.operationQueue.append(A,B,C)}appendBlocker(A){if(this.operationQueue)return this.operationQueue.appendBlocker(A)}currentOp(A){
return this.operationQueue?this.operationQueue.current(A):null}executeNext(A){A&&this.operationQueue&&this.operationQueue.executeNext(A)}shiftAndExecuteNext(A){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(A)}get pendingTrackCount(){return Object.keys(this.tracks).reduce(((A,B)=>A+(this.isPending(this.tracks[B])?1:0)),0)}get sourceBufferCount(){return this.sourceBuffers.reduce(((A,[B])=>A+(B?1:0)),0)}get sourceBufferTypes(){
return this.sourceBuffers.map((([A])=>A)).filter((A=>!!A))}addBufferListener(A,B,C){const D=this.tracks[A];if(!D)return;const E=D.buffer;if(!E)return;const F=C.bind(this,A);D.listeners.push({event:B,listener:F}),E.addEventListener(B,F)}removeBufferListeners(A){const B=this.tracks[A];if(!B)return;const C=B.buffer;C&&(B.listeners.forEach((A=>{C.removeEventListener(A.event,A.listener)})),B.listeners.length=0)}},capLevelController:“∞,errorController:class extends –æ{constructor(A){
super("error-controller",A.logger),this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.hls=A,this.registerListeners()}registerListeners(){const A=this.hls;A.on(–ª.ERROR,this.onError,this),A.on(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.on(–ª.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const A=this.hls;A&&(A.off(–ª.ERROR,this.onError,this),A.off(–ª.ERROR,this.onErrorOut,this),A.off(–ª.MANIFEST_LOADING,this.onManifestLoading,this),
A.off(–ª.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(A){}stopLoad(){this.playlistError=0}getVariantLevelIndex(A){return(null==A?void 0:A.type)===»µ?A.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(A,B){var C,D,E,F;if(B.fatal)return;const G=this.hls,H=B.context;switch(B.details){case –∫.FRAG_LOAD_ERROR:
case –∫.FRAG_LOAD_TIMEOUT:case –∫.KEY_LOAD_ERROR:case –∫.KEY_LOAD_TIMEOUT:return void(B.errorAction=this.getFragRetryOrSwitchAction(B));case –∫.FRAG_PARSING_ERROR:if(null!=(C=B.frag)&&C.gap)return void(B.errorAction=≈î());case –∫.FRAG_GAP:case –∫.FRAG_DECRYPT_ERROR:return B.errorAction=this.getFragRetryOrSwitchAction(B),void(B.errorAction.action=…Ç);case –∫.LEVEL_EMPTY_ERROR:case –∫.LEVEL_PARSING_ERROR:{const A=B.parent===»µ?B.level:G.loadLevel
;B.details===–∫.LEVEL_EMPTY_ERROR&&null!=(D=B.context)&&null!=(E=D.levelDetails)&&E.live?B.errorAction=this.getPlaylistRetryOrSwitchAction(B,A):(B.levelRetry=!1,B.errorAction=this.getLevelSwitchAction(B,A))}return;case –∫.LEVEL_LOAD_ERROR:case –∫.LEVEL_LOAD_TIMEOUT:return void("number"==typeof(null==H?void 0:H.level)&&(B.errorAction=this.getPlaylistRetryOrSwitchAction(B,H.level)));case –∫.AUDIO_TRACK_LOAD_ERROR:case –∫.AUDIO_TRACK_LOAD_TIMEOUT:case –∫.SUBTITLE_LOAD_ERROR:
case –∫.SUBTITLE_TRACK_LOAD_TIMEOUT:if(H){const A=G.loadLevelObj;if(A&&(H.type===»≥&&A.hasAudioGroup(H.groupId)||H.type===»¥&&A.hasSubtitleGroup(H.groupId)))return B.errorAction=this.getPlaylistRetryOrSwitchAction(B,G.loadLevel),B.errorAction.action=…Ç,void(B.errorAction.flags=…Ü)}return;case –∫.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const A=G.loadLevelObj,C=null==A?void 0:A.attrs["HDCP-LEVEL"];C?B.errorAction={action:…Ç,flags:…á,hdcpLevel:C}:this.keySystemError(B)}return;case –∫.BUFFER_ADD_CODEC_ERROR:
case –∫.REMUX_ALLOC_ERROR:case –∫.BUFFER_APPEND_ERROR:return void(B.errorAction||(B.errorAction=this.getLevelSwitchAction(B,null!=(F=B.level)?F:G.loadLevel)));case –∫.INTERNAL_EXCEPTION:case –∫.BUFFER_APPENDING_ERROR:case –∫.BUFFER_FULL_ERROR:case –∫.LEVEL_SWITCH_ERROR:case –∫.BUFFER_STALLED_ERROR:case –∫.BUFFER_SEEK_OVER_HOLE:case –∫.BUFFER_NUDGE_ON_STALL:return void(B.errorAction=≈î())}B.type===–π.KEY_SYSTEM_ERROR&&this.keySystemError(B)}keySystemError(A){const B=this.getVariantLevelIndex(A.frag)
;A.levelRetry=!1,A.errorAction=this.getLevelSwitchAction(A,B)}getPlaylistRetryOrSwitchAction(A,B){const C=≈ê(this.hls.config.playlistLoadPolicy,A),D=this.playlistError++;if(≈ì(C,D,≈è(A),A.response))return{action:…Ñ,flags:…Ö,retryConfig:C,retryCount:D};const E=this.getLevelSwitchAction(A,B);return C&&(E.retryConfig=C,E.retryCount=D),E}getFragRetryOrSwitchAction(A){
const B=this.hls,C=this.getVariantLevelIndex(A.frag),D=B.levels[C],{fragLoadPolicy:E,keyLoadPolicy:F}=B.config,G=≈ê(A.details.startsWith("key")?F:E,A),H=B.levels.reduce(((A,B)=>A+B.fragmentError),0);if(D&&(A.details!==–∫.FRAG_GAP&&D.fragmentError++,≈ì(G,H,≈è(A),A.response)))return{action:…Ñ,flags:…Ö,retryConfig:G,retryCount:H};const I=this.getLevelSwitchAction(A,C);return G&&(I.retryConfig=G,I.retryCount=H),I}getLevelSwitchAction(A,B){var C,D,E,F;const G=this.hls;null==B&&(B=G.loadLevel)
;const H=this.hls.levels[B];if(H){const B=A.details;H.loadError++,B===–∫.BUFFER_APPEND_ERROR&&H.fragmentError++;let I=-1;const{levels:J,loadLevel:K,minAutoLevel:L,maxAutoLevel:M}=G;G.autoLevelEnabled||G.config.preserveManualLevelOnError||(G.loadLevel=-1)
;const N=null==(C=A.frag)?void 0:C.type,O=(N===»∂&&B===–∫.FRAG_PARSING_ERROR||"audio"===A.sourceBufferName&&(B===–∫.BUFFER_ADD_CODEC_ERROR||B===–∫.BUFFER_APPEND_ERROR))&&J.some((({audioCodec:A})=>H.audioCodec!==A)),P="video"===A.sourceBufferName&&(B===–∫.BUFFER_ADD_CODEC_ERROR||B===–∫.BUFFER_APPEND_ERROR)&&J.some((({codecSet:A,audioCodec:B})=>H.codecSet!==A&&H.audioCodec===B)),{type:Q,groupId:R}=null!=(D=A.context)?D:{};for(let C=J.length;C--;){const D=(C+K)%J.length
;if(D!==K&&D>=L&&D<=M&&0===J[D].loadError){const C=J[D];if(B===–∫.FRAG_GAP&&N===»µ&&A.frag){const B=J[D].details;if(B){const C=≈ã(A.frag,B.fragments,A.frag.start);if(null!=C&&C.gap)continue}}else{if(Q===»≥&&C.hasAudioGroup(R)||Q===»¥&&C.hasSubtitleGroup(R))continue;if(N===»∂&&null!=(E=H.audioGroups)&&E.some((A=>C.hasAudioGroup(A)))||N===»∑&&null!=(F=H.subtitleGroups)&&F.some((A=>C.hasSubtitleGroup(A)))||O&&H.audioCodec===C.audioCodec||!O&&H.audioCodec!==C.audioCodec||P&&H.codecSet===C.codecSet)continue
}I=D;break}}if(I>-1&&G.loadLevel!==I)return A.levelRetry=!0,this.playlistError=0,{action:…Ç,flags:…Ö,nextAutoLevel:I}}return{action:…Ç,flags:…Ü}}onErrorOut(A,B){var C;switch(null==(C=B.errorAction)?void 0:C.action){case …Å:break;case …Ç:this.sendAlternateToPenaltyBox(B),B.errorAction.resolved||B.details===–∫.FRAG_GAP?/MediaSource readyState: ended/.test(B.error.message)&&(this.warn(`MediaSource ended after "${B.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),
this.hls.recoverMediaError()):B.fatal=!0}B.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(A){const B=this.hls,C=A.errorAction;if(!C)return;const{flags:D,hdcpLevel:E,nextAutoLevel:F}=C;switch(D){case …Ö:this.switchLevel(A,F);break;case …á:E&&(B.maxHdcpLevel=—ë[—ë.indexOf(E)-1],C.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${B.maxHdcpLevel}" or lower`)}C.resolved||this.switchLevel(A,F)}switchLevel(A,B){
if(void 0!==B&&A.errorAction&&(this.warn(`switching to level ${B} after ${A.details}`),this.hls.nextAutoLevel=B,A.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,A.details===–∫.BUFFER_ADD_CODEC_ERROR&&A.mimeType&&"audiovideo"!==A.sourceBufferName)){const B=ƒº(A.mimeType),C=this.hls.levels;for(let D=C.length;D--;)C[D][A.sourceBufferName+"Codec"]===B&&this.hls.removeLevel(D)}}},fpsController:class{constructor(A){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,
this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=A,this.registerListeners()}setStreamController(A){this.streamController=A}registerListeners(){this.hls.on(–ª.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(–ª.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(–ª.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(–ª.MEDIA_DETACHING,this.onMediaDetaching,this)}
destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(A,B){const C=this.hls.config;if(C.capLevelOnFPSDrop){const A=B.media instanceof self.HTMLVideoElement?B.media:null;this.media=A,A&&"function"==typeof A.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),C.fpsDroppedMonitoringPeriod)}}
onMediaDetaching(){this.media=null}checkFPS(A,B,C){const D=performance.now();if(B){if(this.lastTime){const A=D-this.lastTime,E=C-this.lastDroppedFrames,F=B-this.lastDecodedFrames,G=1e3*E/A,H=this.hls;if(H.trigger(–ª.FPS_DROP,{currentDropped:E,currentDecoded:F,totalDroppedFrames:C}),G>0&&E>H.config.fpsDroppedMonitoringThreshold*F){let A=H.currentLevel;H.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+A),A>0&&(-1===H.autoLevelCapping||H.autoLevelCapping>=A)&&(A-=1,
H.trigger(–ª.FPS_DROP_LEVEL_CAPPING,{level:A,droppedLevel:H.currentLevel}),H.autoLevelCapping=A,this.streamController.nextLevelSwitch())}}this.lastTime=D,this.lastDroppedFrames=C,this.lastDecodedFrames=B}}checkFPSInterval(){const A=this.media;if(A)if(this.isVideoPlaybackQualityAvailable){const B=A.getVideoPlaybackQuality();this.checkFPS(A,B.totalVideoFrames,B.droppedVideoFrames)}else this.checkFPS(A,A.webkitDecodedFrameCount,A.webkitDroppedFrameCount)}},stretchShortVideoTrack:!1,
maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:—™,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,
cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,
backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}
},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,
timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:”ß,enableWebVTT:!0,
enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:class extends “Ä{constructor(A,B,C){super(A,B,C,"subtitle-stream-controller",»∑),this.currentTrackId=-1,
this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:A}=this;A.on(–ª.LEVEL_LOADED,this.onLevelLoaded,this),A.on(–ª.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),A.on(–ª.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),A.on(–ª.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),
A.on(–ª.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),A.on(–ª.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:A}=this;A.off(–ª.LEVEL_LOADED,this.onLevelLoaded,this),A.off(–ª.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),A.off(–ª.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),A.off(–ª.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),A.off(–ª.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),
A.off(–ª.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(A,B){this.stopLoad(),this.state=—µ,this.setInterval(500),this.nextLoadPosition=this.lastCurrentTime=A+this.timelineOffset,this.startPosition=B?-1:A,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(A,B){this.tracksBuffered=[],super.onMediaDetaching(A,B)}onLevelLoaded(A,B){this.mainDetails=B.details}onSubtitleFragProcessed(A,B){const{frag:C,success:D}=B;if(ƒò(C)&&(this.fragPrevious=C),
this.state=—µ,!D)return;const E=this.tracksBuffered[this.currentTrackId];if(!E)return;let F;const G=C.start;for(let A=0;A<E.length;A++)if(G>=E[A].start&&G<=E[A].end){F=E[A];break}const H=C.start+C.duration;F?F.end=H:(F={start:G,end:H},E.push(F)),this.fragmentTracker.fragBuffered(C),this.fragBufferedComplete(C,null),this.media&&this.tick()}onBufferFlushing(A,B){const{startOffset:C,endOffset:D}=B;if(0===C&&D!==1/0){const A=D-1;if(A<=0)return;B.endOffsetSubtitles=Math.max(0,A),
this.tracksBuffered.forEach((B=>{for(let C=0;C<B.length;)if(B[C].end<=A)B.shift();else{if(!(B[C].start<A))break;B[C].start=A,C++}})),this.fragmentTracker.removeFragmentsInRange(C,A,»∑)}}onError(A,B){const C=B.frag;(null==C?void 0:C.type)===»∑&&(B.details===–∫.FRAG_GAP&&this.fragmentTracker.fragBuffered(C,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==—¥&&(this.state=—µ))}onSubtitleTracksUpdated(A,{subtitleTracks:B}){
this.levels&&∆±(this.levels,B)?this.levels=B.map((A=>new —î(A))):(this.tracksBuffered=[],this.levels=B.map((A=>{const B=new —î(A);return this.tracksBuffered[B.id]=[],B})),this.fragmentTracker.removeFragmentsInRange(0,1/0,»∑),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(A,B){var C;if(this.currentTrackId=B.id,null==(C=this.levels)||!C.length||-1===this.currentTrackId)return void this.clearInterval();const D=this.levels[this.currentTrackId]
;null!=D&&D.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,D&&this.state!==—¥&&this.setInterval(500)}onSubtitleTrackLoaded(A,B){var C,D;const{currentTrackId:E,levels:F}=this,{details:G,id:H}=B;if(!F)return void this.warn("Subtitle tracks were reset while loading level "+H);const I=F[H];if(H>=F.length||!I)return;this.log(`Subtitle track ${H} loaded [${G.startSN},${G.endSN}]${G.lastPartSn?`[part-${G.lastPartSn}-${G.lastPartIndex}]`:""},duration:${G.totalduration}`),
this.mediaBuffer=this.mediaBufferTimeRanges;let J=0;if(G.live||null!=(C=I.details)&&C.live){const A=this.mainDetails;if(G.deltaUpdateFailed||!A)return;const B=A.fragments[0];I.details?(J=this.alignPlaylists(G,I.details,null==(D=this.levelLastLoaded)?void 0:D.details),0===J&&B&&(J=B.start,≈π(G,J))):G.hasProgramDateTime&&A.hasProgramDateTime?(∆É(G,A),J=G.fragmentStart):B&&(J=B.start,≈π(G,J))}I.details=G,this.levelLastLoaded=I,H===E&&(this.hls.trigger(–ª.SUBTITLE_TRACK_UPDATED,{details:G,id:H,
groupId:B.groupId}),this.tick(),G.live&&!this.fragCurrent&&this.media&&this.state===—µ)&&(≈ã(null,G.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),I.details=void 0))}_handleFragmentLoadComplete(A){const{frag:B,payload:C}=A,D=B.decryptdata,E=this.hls;if(!this.fragContextChanged(B)&&C&&C.byteLength>0&&null!=D&&D.key&&D.iv&&≈ü(D.method)){const A=performance.now();this.decrypter.decrypt(new Uint8Array(C),D.key.buffer,D.iv.buffer,≈†(D.method)).catch((A=>{
throw E.trigger(–ª.ERROR,{type:–π.MEDIA_ERROR,details:–∫.FRAG_DECRYPT_ERROR,fatal:!1,error:A,reason:A.message,frag:B}),A})).then((C=>{const D=performance.now();E.trigger(–ª.FRAG_DECRYPTED,{frag:B,payload:C,stats:{tstart:A,tdecrypt:D}})})).catch((A=>{this.warn(`${A.name}: ${A.message}`),this.state=—µ}))}}doTick(){if(this.media){if(this.state===—µ){const{currentTrackId:A,levels:B}=this,C=null==B?void 0:B[A];if(!C||!B.length||!C.details)return;if(this.waitForLive(C))return
;const{config:D}=this,E=this.getLoadPosition(),F=—¢.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],E,D.maxBufferHole),{end:G,len:H}=F,I=C.details;if(H>this.hls.maxBufferLength+I.levelTargetDuration)return;const J=I.fragments,K=J.length,L=I.edge;let M=null;const N=this.fragPrevious;if(G<L){const A=D.maxFragLookUpTolerance,B=G>L-A?0:A;M=≈ã(N,J,Math.max(J[0].start,G),B),!M&&N&&N.start<J[0].start&&(M=J[0])}else M=J[K-1];if(M=this.filterReplacedPrimary(M,C.details),!M)return
;const O=J[M.sn-I.startSN-1];if(O&&O.cc===M.cc&&this.fragmentTracker.getState(O)===…à&&(M=O),this.fragmentTracker.getState(M)===…à){const A=this.mapToInitFragWhenRequired(M);A&&this.loadFragment(A,C,G)}}}else this.state=—µ}loadFragment(A,B,C){ƒò(A)?super.loadFragment(A,B,C):this._loadInitSegment(A,B)}get mediaBufferTimeRanges(){return new ”à(this.tracksBuffered[this.currentTrackId]||[])}},subtitleTrackController:class extends “´{constructor(A){super(A,"subtitle-track-controller"),this.media=null,
this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let A=null
;const B=«é(this.media.textTracks);for(let C=0;C<B.length;C++)if("hidden"===B[C].mode)A=B[C];else if("showing"===B[C].mode){A=B[C];break}const C=this.findTrackForTextTrack(A);this.subtitleTrack!==C&&this.setSubtitleTrack(C)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}
set subtitleDisplay(A){this._subtitleDisplay=A,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:A}=this;A.on(–ª.MEDIA_ATTACHED,this.onMediaAttached,this),A.on(–ª.MEDIA_DETACHING,this.onMediaDetaching,this),A.on(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.on(–ª.MANIFEST_PARSED,this.onManifestParsed,this),A.on(–ª.LEVEL_LOADING,this.onLevelLoading,this),A.on(–ª.LEVEL_SWITCHING,this.onLevelSwitching,this),A.on(–ª.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),
A.on(–ª.ERROR,this.onError,this)}unregisterListeners(){const{hls:A}=this;A.off(–ª.MEDIA_ATTACHED,this.onMediaAttached,this),A.off(–ª.MEDIA_DETACHING,this.onMediaDetaching,this),A.off(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.off(–ª.MANIFEST_PARSED,this.onManifestParsed,this),A.off(–ª.LEVEL_LOADING,this.onLevelLoading,this),A.off(–ª.LEVEL_SWITCHING,this.onLevelSwitching,this),A.off(–ª.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),A.off(–ª.ERROR,this.onError,this)}onMediaAttached(A,B){
this.media=B.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(A){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,A)}
onMediaDetaching(A,B){const C=this.media;if(!C)return;const D=!!B.transferMedia;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||C.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,D||«é(C.textTracks).forEach((A=>{«å(A)}))}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}
onManifestParsed(A,B){this.tracks=B.subtitleTracks}onSubtitleTrackLoaded(A,B){const{id:C,groupId:D,details:E}=B,F=this.tracksInGroup[C];if(!F||F.groupId!==D)return void this.warn(`Subtitle track with id:${C} and group:${D} not found in active group ${null==F?void 0:F.groupId}`);const G=F.details;F.details=B.details,this.log(`Subtitle track ${C} "${F.name}" lang:${F.lang} group:${D} loaded [${E.startSN}-${E.endSN}]`),C===this.trackId&&this.playlistLoaded(C,B,G)}onLevelLoading(A,B){
this.switchLevel(B.level)}onLevelSwitching(A,B){this.switchLevel(B.level)}switchLevel(A){const B=this.hls.levels[A];if(!B)return;const C=B.subtitleGroups||null,D=this.groupIds;let E=this.currentTrack;if(!C||(null==D?void 0:D.length)!==(null==C?void 0:C.length)||null!=C&&C.some((A=>-1===(null==D?void 0:D.indexOf(A))))){this.groupIds=C,this.trackId=-1,this.currentTrack=null;const A=this.tracks.filter((A=>!C||-1!==C.indexOf(A.groupId)))
;if(A.length)this.selectDefaultTrack&&!A.some((A=>A.default))&&(this.selectDefaultTrack=!1),A.forEach(((A,B)=>{A.id=B}));else if(!E&&!this.tracksInGroup.length)return;this.tracksInGroup=A;const B=this.hls.config.subtitlePreference;if(!E&&B){this.selectDefaultTrack=!1;const C=≈Ü(B,A);if(C>-1)E=A[C];else{const A=≈Ü(B,this.tracks);E=this.tracks[A]}}let D=this.findTrackId(E);-1===D&&E&&(D=this.findTrackId(null));const F={subtitleTracks:A}
;this.log(`Updating subtitle tracks, ${A.length} track(s) found in "${null==C?void 0:C.join(",")}" group-id`),this.hls.trigger(–ª.SUBTITLE_TRACKS_UPDATED,F),-1!==D&&-1===this.trackId&&this.setSubtitleTrack(D)}}findTrackId(A){const B=this.tracksInGroup,C=this.selectDefaultTrack;for(let D=0;D<B.length;D++){const E=B[D];if((!C||E.default)&&(C||A)&&(!A||≈á(E,A)))return D}if(A){for(let C=0;C<B.length;C++){const D=B[C];if(∆≤(A.attrs,D.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return C}
for(let C=0;C<B.length;C++){const D=B[C];if(∆≤(A.attrs,D.attrs,["LANGUAGE"]))return C}}return-1}findTrackForTextTrack(A){if(A){const B=this.tracksInGroup;for(let C=0;C<B.length;C++)if(∆≥(B[C],A))return C}return-1}onError(A,B){!B.fatal&&B.context&&(B.context.type!==»¥||B.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(B.context.groupId)||this.checkRetry(B))}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){
return this.trackId}set subtitleTrack(A){this.selectDefaultTrack=!1,this.setSubtitleTrack(A)}setSubtitleOption(A){if(this.hls.config.subtitlePreference=A,A){if(-1===A.id)return this.setSubtitleTrack(-1),null;const B=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,B.length){const C=this.currentTrack;if(C&&≈á(A,C))return C;const D=≈Ü(A,this.tracksInGroup);if(D>-1){const A=this.tracksInGroup[D];return this.setSubtitleTrack(D),A}if(C)return null;{const C=≈Ü(A,B);if(C>-1)return B[C]}}}return null}
loadPlaylist(A){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,A)}loadingPlaylist(A,B){super.loadingPlaylist(A,B);const C=A.id,D=A.groupId,E=this.getUrlWithDirectives(A.url,B),F=A.details,G=null==F?void 0:F.age;this.log(`Loading subtitle ${C} "${A.name}" lang:${A.lang} group:${D}${void 0!==(null==B?void 0:B.msn)?" at sn "+B.msn+" part "+B.part:""}${G&&F.live?" age "+G.toFixed(1)+(F.type?" "+F.type||0:""):""} ${E}`),
this.hls.trigger(–ª.SUBTITLE_TRACK_LOADING,{url:E,id:C,groupId:D,deliveryDirectives:B||null,track:A})}toggleTrackModes(){const{media:A}=this;if(!A)return;const B=«é(A.textTracks),C=this.currentTrack;let D;if(C&&(D=B.filter((A=>∆≥(C,A)))[0],D||this.warn(`Unable to find subtitle TextTrack with name "${C.name}" and language "${C.lang}"`)),[].slice.call(B).forEach((A=>{"disabled"!==A.mode&&A!==D&&(A.mode="disabled")})),D){const A=this.subtitleDisplay?"showing":"hidden";D.mode!==A&&(D.mode=A)}}
setSubtitleTrack(A){const B=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=A);if(A<-1||A>=B.length||!–∂(A))return void this.warn("Invalid subtitle track id: "+A);this.selectDefaultTrack=!1;const C=this.currentTrack,D=B[A]||null;if(this.trackId=A,this.currentTrack=D,this.toggleTrackModes(),!D)return void this.hls.trigger(–ª.SUBTITLE_TRACK_SWITCH,{id:A});const E=!!D.details&&!D.details.live;if(A===this.trackId&&D===C&&E)return
;this.log("Switching to subtitle-track "+A+(D?` "${D.name}" lang:${D.lang} group:${D.groupId}`:""));const{id:F,groupId:G="",name:H,type:I,url:J}=D;this.hls.trigger(–ª.SUBTITLE_TRACK_SWITCH,{id:F,groupId:G,name:H,type:I,url:J});const K=this.switchParams(D.url,null==C?void 0:C.details,D.details);this.loadPlaylist(K)}},timelineController:class{constructor(A){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],
this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=A,this.config=A.config,this.Cues=A.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,
languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},A.on(–ª.MEDIA_ATTACHING,this.onMediaAttaching,this),A.on(–ª.MEDIA_DETACHING,this.onMediaDetaching,this),
A.on(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.on(–ª.MANIFEST_LOADED,this.onManifestLoaded,this),A.on(–ª.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),A.on(–ª.FRAG_LOADING,this.onFragLoading,this),A.on(–ª.FRAG_LOADED,this.onFragLoaded,this),A.on(–ª.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),A.on(–ª.FRAG_DECRYPTED,this.onFragDecrypted,this),A.on(–ª.INIT_PTS_FOUND,this.onInitPtsFound,this),A.on(–ª.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),
A.on(–ª.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:A}=this;A.off(–ª.MEDIA_ATTACHING,this.onMediaAttaching,this),A.off(–ª.MEDIA_DETACHING,this.onMediaDetaching,this),A.off(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.off(–ª.MANIFEST_LOADED,this.onManifestLoaded,this),A.off(–ª.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),A.off(–ª.FRAG_LOADING,this.onFragLoading,this),A.off(–ª.FRAG_LOADED,this.onFragLoaded,this),
A.off(–ª.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),A.off(–ª.FRAG_DECRYPTED,this.onFragDecrypted,this),A.off(–ª.INIT_PTS_FOUND,this.onInitPtsFound,this),A.off(–ª.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),A.off(–ª.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const A=new ”•(this,"textTrack1"),B=new ”•(this,"textTrack2"),C=new ”•(this,"textTrack3"),D=new ”•(this,"textTrack4")
;this.cea608Parser1=new ”ô(1,A,B),this.cea608Parser2=new ”ô(3,C,D)}addCues(A,B,C,D,E){let F=!1;for(let A=E.length;A--;){const D=E[A],J=(G=D[0],H=D[1],I=B,Math.min(H,C)-Math.max(G,I));if(J>=0&&(D[0]=Math.min(D[0],B),D[1]=Math.max(D[1],C),F=!0,J/(C-B)>.5))return}var G,H,I;if(F||E.push([B,C]),this.config.renderTextTracksNatively){const E=this.captionsTracks[A];this.Cues.newCue(E,B,C,D)}else{const E=this.Cues.newCue(null,B,C,D);this.hls.trigger(–ª.CUES_PARSED,{type:"captions",cues:E,track:A})}}
onInitPtsFound(A,{frag:B,id:C,initPTS:D,timescale:E}){const{unparsedVttFrags:F}=this;C===»µ&&(this.initPTS[B.cc]={baseTime:D,timescale:E}),F.length&&(this.unparsedVttFrags=[],F.forEach((A=>{this.onFragLoaded(–ª.FRAG_LOADED,A)})))}getExistingTrack(A,B){const{media:C}=this;if(C)for(let D=0;D<C.textTracks.length;D++){const E=C.textTracks[D];if(«ß(E,{name:A,lang:B,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return E}return null}createCaptionsTrack(A){
this.config.renderTextTracksNatively?this.createNativeTrack(A):this.createNonNativeTrack(A)}createNativeTrack(A){if(this.captionsTracks[A])return;const{captionsProperties:B,captionsTracks:C,media:D}=this,{label:E,languageCode:F}=B[A],G=this.getExistingTrack(E,F);if(G)C[A]=G,«å(C[A]),«ä(C[A],D);else{const B=this.createTextTrack("captions",E,F);B&&(B[A]=!0,C[A]=B)}}createNonNativeTrack(A){if(this.nonNativeCaptionsTracks[A])return;const B=this.captionsProperties[A];if(!B)return;const C={_id:A,
label:B.label,kind:"captions",default:!!B.media&&!!B.media.default,closedCaptions:B.media};this.nonNativeCaptionsTracks[A]=C,this.hls.trigger(–ª.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[C]})}createTextTrack(A,B,C){const D=this.media;if(D)return D.addTextTrack(A,B,C)}onMediaAttaching(A,B){this.media=B.media,B.mediaSource||this._cleanTracks()}onMediaDetaching(A,B){const C=!!B.transferMedia;if(this.media=null,C)return;const{captionsTracks:D}=this;Object.keys(D).forEach((A=>{«å(D[A]),delete D[A]})),
this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:A}=this;if(!A)return
;const B=A.textTracks;if(B)for(let A=0;A<B.length;A++)«å(B[A])}onSubtitleTracksUpdated(A,B){const C=B.subtitleTracks||[],D=C.some((A=>A.textCodec===”°));if(this.config.enableWebVTT||D&&this.config.enableIMSC1){if(∆±(this.tracks,C))return void(this.tracks=C);if(this.textTracks=[],this.tracks=C,this.config.renderTextTracksNatively){const A=this.media,B=A?«é(A.textTracks):null;if(this.tracks.forEach((A=>{let C;if(B){let D=null;for(let C=0;C<B.length;C++)if(B[C]&&«ß(B[C],A)){D=B[C],B[C]=null;break}
D&&(C=D)}if(C)«å(C);else{const B=«¶(A);C=this.createTextTrack(B,A.name,A.lang),C&&(C.mode="disabled")}C&&this.textTracks.push(C)})),null!=B&&B.length){const A=B.filter((A=>null!==A)).map((A=>A.label));A.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${A.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const A=this.tracks.map((A=>({label:A.name,kind:A.type.toLowerCase(),default:A.default,
subtitleTrack:A})));this.hls.trigger(–ª.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:A})}}}onManifestLoaded(A,B){this.config.enableCEA708Captions&&B.captions&&B.captions.forEach((A=>{const B=/(?:CC|SERVICE)([1-4])/.exec(A.instreamId);if(!B)return;const C="textTrack"+B[1],D=this.captionsProperties[C];D&&(D.label=A.name,A.lang&&(D.languageCode=A.lang),D.media=A)}))}closedCaptionsForLevel(A){const B=this.hls.levels[A.level];return null==B?void 0:B.attrs["CLOSED-CAPTIONS"]}onFragLoading(A,B){
if(this.enabled&&B.frag.type===»µ){var C,D;const{cea608Parser1:A,cea608Parser2:E,lastSn:F}=this,{cc:G,sn:H}=B.frag,I=null!=(C=null==(D=B.part)?void 0:D.index)?C:-1;A&&E&&(H!==F+1||H===F&&I!==this.lastPartIndex+1||G!==this.lastCc)&&(A.reset(),E.reset()),this.lastCc=G,this.lastSn=H,this.lastPartIndex=I}}onFragLoaded(A,B){const{frag:C,payload:D}=B;if(C.type===»∑)if(D.byteLength){const A=C.decryptdata,E="stats"in B;if(null==A||!A.encrypted||E){const A=this.tracks[C.level],E=this.vttCCs
;E[C.cc]||(E[C.cc]={start:C.start,prevCC:this.prevCC,new:!0},this.prevCC=C.cc),A&&A.textCodec===”°?this._parseIMSC1(C,D):this._parseVTTs(B)}}else this.hls.trigger(–ª.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:C,error:Error("Empty subtitle payload")})}_parseIMSC1(A,B){const C=this.hls;«ü(B,this.initPTS[A.cc],(B=>{this._appendCues(B,A.level),C.trigger(–ª.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:A})}),(B=>{C.logger.log("Failed to parse IMSC1: "+B),C.trigger(–ª.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:A,
error:B})}))}_parseVTTs(A){var B;const{frag:C,payload:D}=A,{initPTS:E,unparsedVttFrags:F}=this,G=E.length-1;if(!E[C.cc]&&-1===G)return void F.push(A);const H=this.hls;«û(null!=(B=C.initSegment)&&B.data?ƒ™(C.initSegment.data,new Uint8Array(D)).buffer:D,this.initPTS[C.cc],this.vttCCs,C.cc,C.start,(A=>{this._appendCues(A,C.level),H.trigger(–ª.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:C})}),(B=>{const E="Missing initPTS for VTT MPEGTS"===B.message;E?F.push(A):this._fallbackToIMSC1(C,D),
H.logger.log("Failed to parse VTT cue: "+B),E&&G>C.cc||H.trigger(–ª.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:C,error:B})}))}_fallbackToIMSC1(A,B){const C=this.tracks[A.level];C.textCodec||«ü(B,this.initPTS[A.cc],(()=>{C.textCodec=”°,this._parseIMSC1(A,B)}),(()=>{C.textCodec="wvtt"}))}_appendCues(A,B){const C=this.hls;if(this.config.renderTextTracksNatively){const C=this.textTracks[B];if(!C||"disabled"===C.mode)return;A.forEach((A=>«ã(C,A)))}else{const D=this.tracks[B];if(!D)return
;const E=D.default?"default":"subtitles"+B;C.trigger(–ª.CUES_PARSED,{type:"subtitles",cues:A,track:E})}}onFragDecrypted(A,B){const{frag:C}=B;C.type===»∑&&this.onFragLoaded(–ª.FRAG_LOADED,B)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(A,B){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:C,samples:D}=B;if(C.type!==»µ||"NONE"!==this.closedCaptionsForLevel(C))for(let A=0;A<D.length;A++){const B=D[A].bytes;if(B){
this.cea608Parser1||this.initCea608Parsers();const C=this.extractCea608Data(B);this.cea608Parser1.addData(D[A].pts,C[0]),this.cea608Parser2.addData(D[A].pts,C[1])}}}onBufferFlushing(A,{startOffset:B,endOffset:C,endOffsetSubtitles:D,type:E}){const{media:F}=this;if(F&&!(F.currentTime<C)){if(!E||"video"===E){const{captionsTracks:A}=this;Object.keys(A).forEach((D=>«ç(A[D],B,C)))}if(this.config.renderTextTracksNatively&&0===B&&void 0!==D){const{textTracks:A}=this
;Object.keys(A).forEach((C=>«ç(A[C],B,D)))}}}extractCea608Data(A){const B=[[],[]],C=31&A[0];let D=2;for(let E=0;E<C;E++){const C=A[D++],E=127&A[D++],F=127&A[D++];if((0!==E||0!==F)&&4&C){const A=3&C;0!==A&&1!==A||(B[A].push(E),B[A].push(F))}}return B}},audioStreamController:class extends “Ä{constructor(A,B,C){super(A,B,C,"audio-stream-controller",»∂),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,
this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:A}=this;A.on(–ª.LEVEL_LOADED,this.onLevelLoaded,this),
A.on(–ª.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),A.on(–ª.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),A.on(–ª.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),A.on(–ª.BUFFER_RESET,this.onBufferReset,this),A.on(–ª.BUFFER_CREATED,this.onBufferCreated,this),A.on(–ª.BUFFER_FLUSHING,this.onBufferFlushing,this),A.on(–ª.BUFFER_FLUSHED,this.onBufferFlushed,this),A.on(–ª.INIT_PTS_FOUND,this.onInitPtsFound,this),A.on(–ª.FRAG_LOADING,this.onFragLoading,this),
A.on(–ª.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:A}=this;A&&(super.unregisterListeners(),A.off(–ª.LEVEL_LOADED,this.onLevelLoaded,this),A.off(–ª.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),A.off(–ª.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),A.off(–ª.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),A.off(–ª.BUFFER_RESET,this.onBufferReset,this),A.off(–ª.BUFFER_CREATED,this.onBufferCreated,this),A.off(–ª.BUFFER_FLUSHING,this.onBufferFlushing,this),
A.off(–ª.BUFFER_FLUSHED,this.onBufferFlushed,this),A.off(–ª.INIT_PTS_FOUND,this.onInitPtsFound,this),A.off(–ª.FRAG_LOADING,this.onFragLoading,this),A.off(–ª.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(A,{frag:B,id:C,initPTS:D,timescale:E}){if(C===»µ){const A=B.cc,C=this.fragCurrent;if(this.initPTS[A]={baseTime:D,timescale:E},this.log(`InitPTS for cc: ${A} found from main: ${D}/${E}`),this.mainAnchor=B,this.state===—æ){const C=this.waitingData
;(!C&&!this.loadingParts||C&&C.frag.cc!==A)&&this.syncWithAnchor(B,null==C?void 0:C.frag)}else!this.hls.hasEnoughToStart&&C&&C.cc!==A?(C.abortRequests(),this.syncWithAnchor(B,C)):this.state===—µ&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(A,B){var C;const D=(null==(C=this.mainFragLoading)?void 0:C.frag)||null;if(B&&(null==D?void 0:D.cc)===B.cc)return
;const E=(D||A).cc,F=≈é(this.getLevelDetails(),E,this.getLoadPosition());F&&(this.log(`Waiting fragment cc (${null==B?void 0:B.cc}) cancelled because video is at cc ${A.cc}`),this.startFragRequested=!1,this.nextLoadPosition=F.start,this.resetLoadingState(),this.state===—µ&&this.doTickIdle())}startLoad(A,B){if(!this.levels)return this.startPosition=A,void(this.state=—¥);const C=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),
C>0&&-1===A?(this.log("Override startPosition with lastCurrentTime @"+C.toFixed(3)),A=C,this.state=—µ):this.state=—π,this.nextLoadPosition=this.lastCurrentTime=A+this.timelineOffset,this.startPosition=B?-1:A,this.tick()}doTick(){switch(this.state){case —µ:this.doTickIdle();break;case —π:{const{levels:A,trackId:B}=this,C=null==A?void 0:A[B],D=null==C?void 0:C.details;if(D&&!this.waitForLive(C)){if(this.waitForCdnTuneIn(D))break;this.state=—æ}break}case —∏:{var A
;const B=performance.now(),C=this.retryDate;if(!C||B>=C||null!=(A=this.media)&&A.seeking){const{levels:A,trackId:B}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((null==A?void 0:A[B])||null),this.state=—µ}break}case —æ:{const A=this.waitingData;if(A){const{frag:B,part:C,cache:D,complete:E}=A,F=this.mainAnchor;if(void 0!==this.initPTS[B.cc]){this.waitingData=null,this.state=—∑;const A={frag:B,part:C,payload:D.flush().buffer,networkDetails:null}
;this._handleFragmentLoadProgress(A),E&&super._handleFragmentLoadComplete(A)}else F&&F.cc!==A.frag.cc&&this.syncWithAnchor(F,A.frag)}else this.state=—µ}}this.onTickEnd()}resetLoadingState(){const A=this.waitingData;A&&(this.fragmentTracker.removeFragment(A.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:A}=this;null!=A&&A.readyState&&(this.lastCurrentTime=A.currentTime)}doTickIdle(){var A;const{hls:B,levels:C,media:D,trackId:E}=this,F=B.config
;if(!this.buffering||!D&&!this.primaryPrefetch&&(this.startFragRequested||!F.startFragPrefetch)||null==C||!C[E])return;const G=C[E],H=G.details;if(!H||this.waitForLive(G)||this.waitForCdnTuneIn(H))return this.state=—π,void(this.startFragRequested=!1);const I=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&I&&(this.bufferFlushed=!1,this.afterBufferFlushed(I,»ª,»∂));const J=this.getFwdBufferInfo(I,»∂);if(null===J)return
;if(!this.switchingTrack&&this._streamEnded(J,H))return B.trigger(–ª.BUFFER_EOS,{type:"audio"}),void(this.state=—º);const K=J.len,L=B.maxBufferLength,M=H.fragments,N=M[0].start,O=this.getLoadPosition(),P=this.flushing?O:J.end;if(this.switchingTrack&&D){const A=O;H.PTSKnown&&A<N&&(J.end>N||J.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),D.currentTime=N+.05)}if(K>=L&&!this.switchingTrack&&P<M[M.length-1].start)return;let Q=this.getNextFragment(P,H)
;if(Q&&this.isLoopLoading(Q,P)&&(Q=this.getNextFragmentLoopLoading(Q,H,J,»µ,L)),!Q)return void(this.bufferFlushed=!0);let R=(null==(A=this.mainFragLoading)?void 0:A.frag)||null;if(!this.audioOnly&&this.startFragRequested&&R&&ƒò(Q)&&!Q.endList&&(!H.live||!this.loadingParts&&P<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(R)===…ã&&(this.mainFragLoading=R=null),R&&ƒò(R))){if(Q.start>R.end){const A=this.fragmentTracker.getFragAtPos(P,»µ);A&&A.end>R.end&&(R=A,this.mainFragLoading={frag:A,
targetBufferTime:null})}if(Q.start>R.end)return}this.loadFragment(Q,G,P)}onMediaDetaching(A,B){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(A,B)}onAudioTracksUpdated(A,{audioTracks:B}){this.resetTransmuxer(),this.levels=B.map((A=>new —î(A)))}onAudioTrackSwitching(A,B){const C=!!B.url;this.trackId=B.id;const{fragCurrent:D}=this;D&&(D.abortRequests(),this.removeUnbufferedFrags(D.start)),this.resetLoadingState(),C?(this.switchingTrack=B,this.flushAudioIfNeeded(B),
this.state!==—¥&&(this.setInterval(100),this.state=—µ,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=B,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(A,B){this.mainDetails=B.details;const C=this.cachedTrackLoadedData;C&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(–ª.AUDIO_TRACK_LOADED,C))}onAudioTrackLoaded(A,B){var C,D
;const{levels:E}=this,{details:F,id:G,groupId:H,track:I}=B;if(!E)return void this.warn(`Audio tracks reset while loading track ${G} "${I.name}" of "${H}"`);const J=this.mainDetails;if(!J||F.endCC>J.endCC||J.expired)return this.cachedTrackLoadedData=B,void(this.state!==—¥&&(this.state=—π));this.cachedTrackLoadedData=null,this.log(`Audio track ${G} "${I.name}" of "${H}" loaded [${F.startSN},${F.endSN}]${F.lastPartSn?`[part-${F.lastPartSn}-${F.lastPartIndex}]`:""},duration:${F.totalduration}`)
;const K=E[G];let L=0;if(F.live||null!=(C=K.details)&&C.live){if(this.checkLiveUpdate(F),F.deltaUpdateFailed)return;K.details&&(L=this.alignPlaylists(F,K.details,null==(D=this.levelLastLoaded)?void 0:D.details)),F.alignedSliding||(∆Ç(F,J),F.alignedSliding||∆É(F,J),L=F.fragmentStart)}K.details=F,this.levelLastLoaded=K,this.startFragRequested||this.setStartPosition(J,L),this.hls.trigger(–ª.AUDIO_TRACK_UPDATED,{details:F,id:G,groupId:B.groupId}),
this.state!==—π||this.waitForCdnTuneIn(F)||(this.state=—µ),this.tick()}_handleFragmentLoadProgress(A){var B;const C=A.frag,{part:D,payload:E}=A,{config:F,trackId:G,levels:H}=this;if(!H)return void this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${C.sn} of level ${C.level} will not be buffered`);const I=H[G];if(!I)return void this.warn("Audio track is undefined on fragment load progress");const J=I.details
;if(!J)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(C.start);const K=F.defaultAudioCodec||I.audioCodec||"mp4a.40.2";let L=this.transmuxer;L||(L=this.transmuxer=new “™(this.hls,»∂,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const M=this.initPTS[C.cc],N=null==(B=C.initSegment)?void 0:B.data;if(void 0!==M){const A=!1,B=D?D.index:-1,F=-1!==B,G=new —†(C.level,C.sn,C.stats.chunkCount,E.byteLength,B,F)
;L.push(E,N,K,"",C,D,J.totalduration,A,G,M)}else{this.log(`Unknown video PTS for cc ${C.cc}, waiting for video PTS before demuxing audio frag ${C.sn} of [${J.startSN} ,${J.endSN}],track ${G}`);const{cache:A}=this.waitingData=this.waitingData||{frag:C,part:D,cache:new “Å,complete:!1};A.push(new Uint8Array(E)),this.state!==—¥&&(this.state=—æ)}}_handleFragmentLoadComplete(A){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(A)}onBufferReset(){this.mediaBuffer=null}
onBufferCreated(A,B){this.bufferFlushed=this.flushing=!1;const C=B.tracks.audio;C&&(this.mediaBuffer=C.buffer||null)}onFragLoading(A,B){!this.audioOnly&&B.frag.type===»µ&&ƒò(B.frag)&&(this.mainFragLoading=B,this.state===—µ&&this.tick())}onFragBuffered(A,B){const{frag:C,part:D}=B
;if(C.type===»∂)if(this.fragContextChanged(C))this.warn(`Fragment ${C.sn}${D?" p: "+D.index:""} of level ${C.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);else{if(ƒò(C)){this.fragPrevious=C;const A=this.switchingTrack;A&&(this.bufferedTrack=A,this.switchingTrack=null,this.hls.trigger(–ª.AUDIO_TRACK_SWITCHED,ƒë({},A)))}this.fragBufferedComplete(C,D),this.media&&this.tick()
}else this.audioOnly||C.type!==»µ||C.elementaryStreams.video||C.elementaryStreams.audiovideo||(this.audioOnly=!0,this.mainFragLoading=null)}onError(A,B){var C;if(B.fatal)this.state=—Ω;else switch(B.details){case –∫.FRAG_GAP:case –∫.FRAG_PARSING_ERROR:case –∫.FRAG_DECRYPT_ERROR:case –∫.FRAG_LOAD_ERROR:case –∫.FRAG_LOAD_TIMEOUT:case –∫.KEY_LOAD_ERROR:case –∫.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(»∂,B);break;case –∫.AUDIO_TRACK_LOAD_ERROR:case –∫.AUDIO_TRACK_LOAD_TIMEOUT:case –∫.LEVEL_PARSING_ERROR:
B.levelRetry||this.state!==—π||(null==(C=B.context)?void 0:C.type)!==»≥||(this.state=—µ);break;case –∫.BUFFER_ADD_CODEC_ERROR:case –∫.BUFFER_APPEND_ERROR:if("audio"!==B.parent)return;this.resetLoadingState();break;case –∫.BUFFER_FULL_ERROR:if("audio"!==B.parent)return;this.reduceLengthAndFlushBuffer(B)&&(this.bufferedTrack=null,super.flushMainBuffer(0,1/0,"audio"));break;case –∫.INTERNAL_EXCEPTION:this.recoverWorkerError(B)}}onBufferFlushing(A,{type:B}){B!==»º&&(this.flushing=!0)}
onBufferFlushed(A,{type:B}){if(B!==»º){this.flushing=!1,this.bufferFlushed=!0,this.state===—º&&(this.state=—µ);const A=this.mediaBuffer||this.media;A&&(this.afterBufferFlushed(A,B,»∂),this.tick())}}_handleTransmuxComplete(A){var B;const C="audio",{hls:D}=this,{remuxResult:E,chunkMeta:F}=A,G=this.getCurrentContext(F);if(!G)return void this.resetWhenMissingContext(F);const{frag:H,part:I,level:J}=G,{details:K}=J,{audio:L,text:M,id3:N,initSegment:O}=E;if(!this.fragContextChanged(H)&&K){if(this.state=—∫,
this.switchingTrack&&L&&this.completeAudioSwitch(this.switchingTrack),null!=O&&O.tracks){const A=H.initSegment||H;this._bufferInitSegment(J,O.tracks,A,F),D.trigger(–ª.FRAG_PARSING_INIT_SEGMENT,{frag:A,id:C,tracks:O.tracks})}if(L){const{startPTS:A,endPTS:B,startDTS:C,endDTS:D}=L;I&&(I.elementaryStreams[»ª]={startPTS:A,endPTS:B,startDTS:C,endDTS:D}),H.setElementaryStreamInfo(»ª,A,B,C,D),this.bufferFragmentData(L,H,I,F)}if(null!=N&&null!=(B=N.samples)&&B.length){const A=ƒè({id:C,frag:H,details:K},N)
;D.trigger(–ª.FRAG_PARSING_METADATA,A)}if(M){const A=ƒè({id:C,frag:H,details:K},M);D.trigger(–ª.FRAG_PARSING_USERDATA,A)}}else this.fragmentTracker.removeFragment(H)}_bufferInitSegment(A,B,C,D){if(this.state!==—∫)return;if(B.video&&delete B.video,B.audiovideo&&delete B.audiovideo,!B.audio)return;const E=B.audio;E.id=»∂;const F=A.audioCodec;this.log(`Init audio buffer, container:${E.container}, codecs[level/parsed]=[${F}/${E.codec}]`),F&&1===F.split(",").length&&(E.levelCodec=F),
this.hls.trigger(–ª.BUFFER_CODECS,B);const G=E.initSegment;if(null!=G&&G.byteLength){const A={type:"audio",frag:C,part:null,chunkMeta:D,parent:C.type,data:G};this.hls.trigger(–ª.BUFFER_APPENDING,A)}this.tickImmediate()}loadFragment(A,B,C){const D=this.fragmentTracker.getState(A);var E;if(this.switchingTrack||D===…à||D===…ä)if(ƒò(A))if(null!=(E=B.details)&&E.live&&!this.initPTS[A.cc]){
this.log(`Waiting for video PTS in continuity counter ${A.cc} of live stream before loading audio fragment ${A.sn} of level ${this.trackId}`),this.state=—æ;const C=this.mainDetails;C&&C.fragmentStart!==B.details.fragmentStart&&∆É(B.details,C)}else super.loadFragment(A,B,C);else this._loadInitSegment(A,B);else this.clearTrackerIfNeeded(A)}flushAudioIfNeeded(A){if(this.media&&this.bufferedTrack){const{name:B,lang:C,assocLang:D,characteristics:E,audioCodec:F,channels:G}=this.bufferedTrack;≈á({name:B,
lang:C,assocLang:D,characteristics:E,audioCodec:F,channels:G},A,≈à)||(≈ä(A.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,1/0,"audio"),this.bufferedTrack=null):this.bufferedTrack=A)}}completeAudioSwitch(A){const{hls:B}=this;this.flushAudioIfNeeded(A),this.bufferedTrack=A,this.switchingTrack=null,B.trigger(–ª.AUDIO_TRACK_SWITCHED,ƒë({},A))}},audioTrackController:class extends “´{constructor(A){super(A,"audio-track-controller"),this.tracks=[],
this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:A}=this;A.on(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.on(–ª.MANIFEST_PARSED,this.onManifestParsed,this),A.on(–ª.LEVEL_LOADING,this.onLevelLoading,this),A.on(–ª.LEVEL_SWITCHING,this.onLevelSwitching,this),A.on(–ª.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),A.on(–ª.ERROR,this.onError,this)}unregisterListeners(){const{hls:A}=this
;A.off(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.off(–ª.MANIFEST_PARSED,this.onManifestParsed,this),A.off(–ª.LEVEL_LOADING,this.onLevelLoading,this),A.off(–ª.LEVEL_SWITCHING,this.onLevelSwitching,this),A.off(–ª.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),A.off(–ª.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,
this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(A,B){this.tracks=B.audioTracks||[]}onAudioTrackLoaded(A,B){const{id:C,groupId:D,details:E}=B,F=this.tracksInGroup[C];if(!F||F.groupId!==D)return void this.warn(`Audio track with id:${C} and group:${D} not found in active group ${null==F?void 0:F.groupId}`);const G=F.details;F.details=B.details,this.log(`Audio track ${C} "${F.name}" lang:${F.lang} group:${D} loaded [${E.startSN}-${E.endSN}]`),
C===this.trackId&&this.playlistLoaded(C,B,G)}onLevelLoading(A,B){this.switchLevel(B.level)}onLevelSwitching(A,B){this.switchLevel(B.level)}switchLevel(A){const B=this.hls.levels[A];if(!B)return;const C=B.audioGroups||null,D=this.groupIds;let E=this.currentTrack;if(!C||(null==D?void 0:D.length)!==(null==C?void 0:C.length)||null!=C&&C.some((A=>-1===(null==D?void 0:D.indexOf(A))))){this.groupIds=C,this.trackId=-1,this.currentTrack=null;const A=this.tracks.filter((A=>!C||-1!==C.indexOf(A.groupId)))
;if(A.length)this.selectDefaultTrack&&!A.some((A=>A.default))&&(this.selectDefaultTrack=!1),A.forEach(((A,B)=>{A.id=B}));else if(!E&&!this.tracksInGroup.length)return;this.tracksInGroup=A;const B=this.hls.config.audioPreference;if(!E&&B){const C=≈Ü(B,A,≈à);if(C>-1)E=A[C];else{const A=≈Ü(B,this.tracks);E=this.tracks[A]}}let D=this.findTrackId(E);-1===D&&E&&(D=this.findTrackId(null));const G={audioTracks:A}
;this.log(`Updating audio tracks, ${A.length} track(s) found in group(s): ${null==C?void 0:C.join(",")}`),this.hls.trigger(–ª.AUDIO_TRACKS_UPDATED,G);const H=this.trackId;if(-1!==D&&-1===H)this.setAudioTrack(D);else if(A.length&&-1===H){var F;const B=Error(`No audio track selected for current audio group-ID(s): ${null==(F=this.groupIds)?void 0:F.join(",")} track count: ${A.length}`);this.warn(B.message),this.hls.trigger(–ª.ERROR,{type:–π.MEDIA_ERROR,details:–∫.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:B
})}}}onError(A,B){!B.fatal&&B.context&&(B.context.type!==»≥||B.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(B.context.groupId)||this.checkRetry(B))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(A){this.selectDefaultTrack=!1,this.setAudioTrack(A)}setAudioOption(A){const B=this.hls;if(B.config.audioPreference=A,A){const C=this.allAudioTracks;if(this.selectDefaultTrack=!1,C.length){
const D=this.currentTrack;if(D&&≈á(A,D,≈à))return D;const E=≈Ü(A,this.tracksInGroup,≈à);if(E>-1){const A=this.tracksInGroup[E];return this.setAudioTrack(E),A}if(D){let D=B.loadLevel;-1===D&&(D=B.firstAutoLevel);const E=function(A,B,C,D,E){const F=B[D],G=B.reduce(((A,B,C)=>{const D=B.uri;return(A[D]||(A[D]=[])).push(C),A}),{})[F.uri];G.length>1&&(D=Math.max.apply(Math,G));const H=F.videoRange,I=F.frameRate,J=F.codecSet.substring(0,4),K=≈â(B,D,(B=>{
if(B.videoRange!==H||B.frameRate!==I||B.codecSet.substring(0,4)!==J)return!1;const D=B.audioGroups,F=C.filter((A=>!D||-1!==D.indexOf(A.groupId)));return ≈Ü(A,F,E)>-1}));return K>-1?K:≈â(B,D,(B=>{const D=B.audioGroups,F=C.filter((A=>!D||-1!==D.indexOf(A.groupId)));return ≈Ü(A,F,E)>-1}))}(A,B.levels,C,D,≈à);if(-1===E)return null;B.nextLoadLevel=E}if(A.channels||A.audioCodec){const B=≈Ü(A,C);if(B>-1)return C[B]}}}return null}setAudioTrack(A){const B=this.tracksInGroup
;if(A<0||A>=B.length)return void this.warn("Invalid audio track id: "+A);this.selectDefaultTrack=!1;const C=this.currentTrack,D=B[A],E=D.details&&!D.details.live;if(A===this.trackId&&D===C&&E)return;if(this.log(`Switching to audio-track ${A} "${D.name}" lang:${D.lang} group:${D.groupId} channels:${D.channels}`),this.trackId=A,this.currentTrack=D,this.hls.trigger(–ª.AUDIO_TRACK_SWITCHING,ƒë({},D)),E)return;const F=this.switchParams(D.url,null==C?void 0:C.details,D.details);this.loadPlaylist(F)}
findTrackId(A){const B=this.tracksInGroup;for(let C=0;C<B.length;C++){const D=B[C];if((!this.selectDefaultTrack||D.default)&&(!A||≈á(A,D,≈à)))return C}if(A){const{name:C,lang:D,assocLang:E,characteristics:F,audioCodec:G,channels:H}=A;for(let A=0;A<B.length;A++)if(≈á({name:C,lang:D,assocLang:E,characteristics:F,audioCodec:G,channels:H},B[A],≈à))return A;for(let C=0;C<B.length;C++){const D=B[C];if(∆≤(A.attrs,D.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return C}for(let C=0;C<B.length;C++){
const D=B[C];if(∆≤(A.attrs,D.attrs,["LANGUAGE"]))return C}}return-1}loadPlaylist(A){super.loadPlaylist();const B=this.currentTrack;this.shouldLoadPlaylist(B)&&≈ä(B.url,this.hls)&&this.scheduleLoading(B,A)}loadingPlaylist(A,B){super.loadingPlaylist(A,B);const C=A.id,D=A.groupId,E=this.getUrlWithDirectives(A.url,B),F=A.details,G=null==F?void 0:F.age
;this.log(`Loading audio-track ${C} "${A.name}" lang:${A.lang} group:${D}${void 0!==(null==B?void 0:B.msn)?" at sn "+B.msn+" part "+B.part:""}${G&&F.live?" age "+G.toFixed(1)+(F.type?" "+F.type||0:""):""} ${E}`),this.hls.trigger(–ª.AUDIO_TRACK_LOADING,{url:E,id:C,groupId:D,deliveryDirectives:B||null,track:A})}},emeController:”Ä,cmcdController:class{constructor(A){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,
this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=A=>{try{this.apply(A,{ot:“±.MANIFEST,su:!this.initialized})}catch(A){this.hls.logger.warn("Could not generate manifest CMCD data.",A)}},this.applyFragmentData=A=>{try{
const{frag:B,part:C}=A,D=this.hls.levels[B.level],E=this.getObjectType(B),F={d:1e3*(C||B).duration,ot:E};E!==“±.VIDEO&&E!==“±.AUDIO&&E!=“±.MUXED||(F.br=D.bitrate/1e3,F.tb=this.getTopBandwidth(E)/1e3,F.bl=this.getBufferLength(E));const G=C?this.getNextPart(C):this.getNextFrag(B);null!=G&&G.url&&G.url!==B.url&&(F.nor=G.url),this.apply(A,F)}catch(A){this.hls.logger.warn("Could not generate segment CMCD data.",A)}},this.hls=A;const B=this.config=A.config,{cmcd:C}=B
;null!=C&&(B.pLoader=this.createPlaylistLoader(),B.fLoader=this.createFragmentLoader(),this.sid=C.sessionId||A.sessionId,this.cid=C.contentId,this.useHeaders=!0===C.useHeaders,this.includeKeys=C.includeKeys,this.registerListeners())}registerListeners(){const A=this.hls;A.on(–ª.MEDIA_ATTACHED,this.onMediaAttached,this),A.on(–ª.MEDIA_DETACHED,this.onMediaDetached,this),A.on(–ª.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const A=this.hls
;A.off(–ª.MEDIA_ATTACHED,this.onMediaAttached,this),A.off(–ª.MEDIA_DETACHED,this.onMediaDetached,this),A.off(–ª.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(A,B){this.media=B.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){
this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(A,B){var C,D;this.audioBuffer=null==(C=B.tracks.audio)?void 0:C.buffer,this.videoBuffer=null==(D=B.tracks.video)?void 0:D.buffer}createData(){var A;return{v:1,sf:“≤.HLS,sid:this.sid,cid:this.cid,pr:null==(A=this.media)?void 0:A.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(A,B={}){ƒè(B,this.createData())
;const C=B.ot===“±.INIT||B.ot===“±.VIDEO||B.ot===“±.MUXED;this.starved&&C&&(B.bs=!0,B.su=!0,this.starved=!1),null==B.su&&(B.su=this.buffering);const{includeKeys:D}=this;D&&(B=Object.keys(B).reduce(((A,C)=>(D.includes(C)&&(A[C]=B[C]),A)),{}));const E={baseUrl:A.url};this.useHeaders?(A.headers||(A.headers={}),«Ñ(A.headers,B,E)):A.url=«Ö(A.url,B,E)}getNextFrag(A){var B;const C=null==(B=this.hls.levels[A.level])?void 0:B.details;if(C){const B=A.sn-C.startSN;return C.fragments[B+1]}}getNextPart(A){var B,C
;const{index:D,fragment:E}=A,F=null==(B=this.hls.levels[E.level])||null==(C=B.details)?void 0:C.partList;if(F){const{sn:A}=E;for(let B=F.length-1;B>=0;B--){const C=F[B];if(C.index===D&&C.fragment.sn===A)return F[B+1]}}}getObjectType(A){const{type:B}=A;return"subtitle"===B?“±.TIMED_TEXT:"initSegment"===A.sn?“±.INIT:"audio"===B?“±.AUDIO:"main"===B?this.hls.audioTracks.length?“±.VIDEO:“±.MUXED:void 0}getTopBandwidth(A){let B,C=0;const D=this.hls;if(A===“±.AUDIO)B=D.audioTracks;else{
const A=D.maxAutoLevel,C=A>-1?A+1:D.levels.length;B=D.levels.slice(0,C)}return B.forEach((A=>{A.bitrate>C&&(C=A.bitrate)})),C>0?C:NaN}getBufferLength(A){const B=this.media,C=A===“±.AUDIO?this.audioBuffer:this.videoBuffer;return C&&B?1e3*—¢.bufferInfo(C,B.currentTime,this.config.maxBufferHole).len:NaN}createPlaylistLoader(){const{pLoader:A}=this.config,B=this.applyPlaylistData,C=A||this.config.loader;return class{constructor(A){this.loader=void 0,this.loader=new C(A)}get stats(){
return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(A,C,D){B(A),this.loader.load(A,C,D)}}}createFragmentLoader(){const{fLoader:A}=this.config,B=this.applyFragmentData,C=A||this.config.loader;return class{constructor(A){this.loader=void 0,this.loader=new C(A)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(A,C,D){B(A),
this.loader.load(A,C,D)}}}},contentSteeringController:class extends –æ{constructor(A){super("content-steering",A.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=A,this.registerListeners()}registerListeners(){const A=this.hls
;A.on(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.on(–ª.MANIFEST_LOADED,this.onManifestLoaded,this),A.on(–ª.MANIFEST_PARSED,this.onManifestParsed,this),A.on(–ª.ERROR,this.onError,this)}unregisterListeners(){const A=this.hls;A&&(A.off(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.off(–ª.MANIFEST_LOADED,this.onManifestLoaded,this),A.off(–ª.MANIFEST_PARSED,this.onManifestParsed,this),A.off(–ª.ERROR,this.onError,this))}pathways(){
return(this.levels||[]).reduce(((A,B)=>(-1===A.indexOf(B.pathwayId)&&A.push(B.pathwayId),A)),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(A){this.updatePathwayPriority(A)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const A=1e3*this.timeToLoad-(performance.now()-this.updated);if(A>0)return void this.scheduleRefresh(this.uri,A)}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,
this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(A){const B=this.levels;B&&(this.levels=B.filter((B=>B!==A)))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",
this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(A,B){const{contentSteering:C}=B;null!==C&&(this.pathwayId=C.pathwayId,this.uri=C.uri,this.started&&this.startLoad())}onManifestParsed(A,B){this.audioTracks=B.audioTracks,this.subtitleTracks=B.subtitleTracks}onError(A,B){const{errorAction:C}=B;if((null==C?void 0:C.action)===…Ç&&C.flags===…Ü){const A=this.levels;let D=this._pathwayPriority,E=this.pathwayId;if(B.context){const{groupId:C,pathwayId:D,type:F}=B.context
;C&&A?E=this.getPathwayForGroupId(C,F,E):D&&(E=D)}E in this.penalizedPathways||(this.penalizedPathways[E]=performance.now()),!D&&A&&(D=this.pathways()),D&&D.length>1&&(this.updatePathwayPriority(D),C.resolved=this.pathwayId!==E),C.resolved||this.warn(`Could not resolve ${B.details} ("${B.error.message}") with content-steering for Pathway: ${E} levels: ${A?A.length:A} priorities: ${—ï(D)} penalized: ${—ï(this.penalizedPathways)}`)}}filterParsedLevels(A){this.levels=A
;let B=this.getLevelsForPathway(this.pathwayId);if(0===B.length){const C=A[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${C}"`),B=this.getLevelsForPathway(C),this.pathwayId=C}return B.length!==A.length&&this.log(`Found ${B.length}/${A.length} levels in Pathway "${this.pathwayId}"`),B}getLevelsForPathway(A){return null===this.levels?[]:this.levels.filter((B=>A===B.pathwayId))}updatePathwayPriority(A){let B;this._pathwayPriority=A
;const C=this.penalizedPathways,D=performance.now();Object.keys(C).forEach((A=>{D-C[A]>3e5&&delete C[A]}));for(let D=0;D<A.length;D++){const E=A[D];if(E in C)continue;if(E===this.pathwayId)return;const F=this.hls.nextLoadLevel,G=this.hls.levels[F];if(B=this.getLevelsForPathway(E),B.length>0){this.log(`Setting Pathway to "${E}"`),this.pathwayId=E,≈æ(B),this.hls.trigger(–ª.LEVELS_UPDATED,{levels:B});const A=this.hls.levels[F]
;G&&A&&this.levels&&(A.attrs["STABLE-VARIANT-ID"]!==G.attrs["STABLE-VARIANT-ID"]&&A.bitrate!==G.bitrate&&this.log(`Unstable Pathways change from bitrate ${G.bitrate} to ${A.bitrate}`),this.hls.nextLoadLevel=F);break}}}getPathwayForGroupId(A,B,C){const D=this.getLevelsForPathway(C).concat(this.levels||[]);for(let C=0;C<D.length;C++)if(B===»≥&&D[C].hasAudioGroup(A)||B===»¥&&D[C].hasSubtitleGroup(A))return D[C].pathwayId;return C}clonePathways(A){const B=this.levels;if(!B)return;const C={},D={}
;A.forEach((A=>{const{ID:E,"BASE-ID":F,"URI-REPLACEMENT":G}=A;if(B.some((A=>A.pathwayId===E)))return;const H=this.getLevelsForPathway(F).map((A=>{const B=new —¶(A.attrs);B["PATHWAY-ID"]=E;const F=B.AUDIO&&`${B.AUDIO}_clone_${E}`,H=B.SUBTITLES&&`${B.SUBTITLES}_clone_${E}`;F&&(C[B.AUDIO]=F,B.AUDIO=F),H&&(D[B.SUBTITLES]=H,B.SUBTITLES=H);const I=«á(A.uri,B["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",G),J=new —î({attrs:B,audioCodec:A.audioCodec,bitrate:A.bitrate,height:A.height,name:A.name,url:I,
videoCodec:A.videoCodec,width:A.width});if(A.audioGroups)for(let B=1;B<A.audioGroups.length;B++)J.addGroupId("audio",`${A.audioGroups[B]}_clone_${E}`);if(A.subtitleGroups)for(let B=1;B<A.subtitleGroups.length;B++)J.addGroupId("text",`${A.subtitleGroups[B]}_clone_${E}`);return J}));B.push(...H),«Ü(this.audioTracks,C,G,E),«Ü(this.subtitleTracks,D,G,E)}))}loadSteeringManifest(A){const B=this.hls.config,C=B.loader;let D;this.loader&&this.loader.destroy(),this.loader=new C(B);try{D=new self.URL(A)
}catch(B){return this.enabled=!1,void this.log("Failed to parse Steering Manifest URI: "+A)}if("data:"!==D.protocol){const A=0|(this.hls.bandwidthEstimate||B.abrEwmaDefaultEstimate);D.searchParams.set("_HLS_pathway",this.pathwayId),D.searchParams.set("_HLS_throughput",""+A)}const E={responseType:"json",url:D.href},F=B.steeringManifestLoadPolicy.default,G=F.errorRetry||F.timeoutRetry||{},H={loadPolicy:F,timeout:F.maxLoadTimeMs,maxRetry:G.maxNumRetry||0,retryDelay:G.retryDelayMs||0,
maxRetryDelay:G.maxRetryDelayMs||0},I={onSuccess:(A,B,C)=>{this.log(`Loaded steering manifest: "${D}"`);const E=A.data;if(1!==(null==E?void 0:E.VERSION))return void this.log(`Steering VERSION ${E.VERSION} not supported!`);this.updated=performance.now(),this.timeToLoad=E.TTL;const{"RELOAD-URI":F,"PATHWAY-CLONES":G,"PATHWAY-PRIORITY":H}=E;if(F)try{this.uri=new self.URL(F,D).href}catch(A){return this.enabled=!1,void this.log("Failed to parse Steering Manifest RELOAD-URI: "+F)}
this.scheduleRefresh(this.uri||C.url),G&&this.clonePathways(G);const I={steeringManifest:E,url:D.toString()};this.hls.trigger(–ª.STEERING_MANIFEST_LOADED,I),H&&this.updatePathwayPriority(H)},onError:(A,B)=>{if(this.log(`Error loading steering manifest: ${A.code} ${A.text} (${B.url})`),this.stopLoad(),410===A.code)return this.enabled=!1,void this.log(`Steering manifest ${B.url} no longer available`);let C=1e3*this.timeToLoad;if(429!==A.code)this.scheduleRefresh(this.uri||B.url,C);else{
const A=this.loader;if("function"==typeof(null==A?void 0:A.getResponseHeader)){const B=A.getResponseHeader("Retry-After");B&&(C=1e3*parseFloat(B))}this.log(`Steering manifest ${B.url} rate limited`)}},onTimeout:(A,B)=>{this.log(`Timeout loading steering manifest (${B.url})`),this.scheduleRefresh(this.uri||B.url)}};this.log("Requesting steering manifest: "+D),this.loader.load(E,H,I)}scheduleRefresh(A,B=1e3*this.timeToLoad){this.clearTimeout(),this.reloadTimer=self.setTimeout((()=>{var B
;const C=null==(B=this.hls)?void 0:B.media;!C||C.ended?this.scheduleRefresh(A,1e3*this.timeToLoad):this.loadSteeringManifest(A)}),B)}},interstitialsController:class extends –æ{constructor(A,B){super("interstitials",A.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,
this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const A=this.currentTime;if(void 0===A||this.playbackDisabled)return;const B=A-this.timelinePos;if(Math.abs(B)<1/7056e5)return;const C=B<=-.01;this.timelinePos=A,this.bufferedPos=A;const D=this.playingItem
;if(!D)return void this.checkBuffer();if(C&&this.schedule.resetErrorsInRange(A,A-B)&&this.updateSchedule(),this.checkBuffer(),C&&A<D.start||A>=D.end){var E;const A=this.schedule.findItemIndexAtTime(this.timelinePos);if(!this.isInterstitial(D)&&null!=(E=this.media)&&E.paused&&(this.shouldPlay=!1),!C){const B=this.findItemIndex(D);if(A>B){const C=this.schedule.findJumpRestrictedIndex(B+1,A);if(C>B)return void this.setSchedulePosition(C)}}return void this.setSchedulePosition(A)}
const F=this.playingAsset;if(!F){if(this.playingLastItem&&this.isInterstitial(D)){const B=D.event.assetList[0];B&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(A,B))}return}const G=F.timelineStart,H=F.duration||0;(C&&A<G||A>=G+H)&&this.setScheduleToAssetAtTime(A,F)},this.onTimeupdate=()=>{const A=this.currentTime;if(void 0===A||this.playbackDisabled)return;if(!(A>this.timelinePos))return;this.timelinePos=A,A>this.bufferedPos&&this.checkBuffer()
;const B=this.playingItem;if(!B||this.playingLastItem)return;if(A>=B.end){this.timelinePos=B.end;const A=this.findItemIndex(B);this.setSchedulePosition(A+1)}const C=this.playingAsset;C&&A>=C.timelineStart+(C.duration||0)&&this.setScheduleToAssetAtTime(A,C)},this.onScheduleUpdate=(A,B)=>{const C=this.schedule,D=this.playingItem,E=C.events||[],F=C.items||[],G=C.durations,H=A.map((A=>A.identifier)),I=!(!E.length&&!H.length)
;(I||B)&&this.log(`INTERSTITIALS_UPDATED (${E.length}): ${E}\nSchedule: ${F.map((A=>«ï(A)))} pos: ${this.timelinePos}`),H.length&&this.log("Removed events "+H),this.playerQueue.forEach((A=>{if(A.interstitial.appendInPlace){const B=A.assetItem.timelineStart,C=A.timelineOffset-B;if(C)try{A.timelineOffset=B}catch(D){Math.abs(C)>”Ç&&this.warn(`${D} ("${A.assetId}" ${A.timelineOffset}->${B})`)}}}));let J=null;if(D){const A=this.updateItem(D,this.timelinePos);this.itemsMatch(D,A)&&(this.playingItem=A,
this.waitingItem=this.endedItem=null,J=()=>this.trimInPlace(A,D))}else this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const K=this.bufferingItem;if(K){const A=this.updateItem(K,this.bufferedPos);this.itemsMatch(K,A)?(this.bufferingItem=A,J||(J=()=>this.trimInPlace(A,K))):K.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(K.event,null))}if(A.forEach((A=>{A.assetList.forEach((A=>{this.clearAssetPlayer(A.identifier,null)}))})),
I||B){if(this.hls.trigger(–ª.INTERSTITIALS_UPDATED,{events:E.slice(0),schedule:F.slice(0),durations:G,removedIds:H}),this.isInterstitial(D)&&H.includes(D.event.identifier))return this.warn(`Interstitial "${D.event.identifier}" removed while playing`),void this.primaryFallback(D.event);J&&J(),this.checkBuffer()}},this.hls=A,this.HlsPlayerClass=B,this.assetListLoader=new ”á(A),this.schedule=new ”Ü(this.onScheduleUpdate,A.logger),this.registerListeners()}registerListeners(){const A=this.hls
;A.on(–ª.MEDIA_ATTACHING,this.onMediaAttaching,this),A.on(–ª.MEDIA_ATTACHED,this.onMediaAttached,this),A.on(–ª.MEDIA_DETACHING,this.onMediaDetaching,this),A.on(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.on(–ª.LEVEL_UPDATED,this.onLevelUpdated,this),A.on(–ª.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),A.on(–ª.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),A.on(–ª.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),A.on(–ª.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),
A.on(–ª.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),A.on(–ª.ASSET_LIST_LOADED,this.onAssetListLoaded,this),A.on(–ª.BUFFER_APPENDED,this.onBufferAppended,this),A.on(–ª.BUFFER_FLUSHED,this.onBufferFlushed,this),A.on(–ª.BUFFERED_TO_END,this.onBufferedToEnd,this),A.on(–ª.MEDIA_ENDED,this.onMediaEnded,this),A.on(–ª.ERROR,this.onError,this),A.on(–ª.DESTROYING,this.onDestroying,this)}unregisterListeners(){const A=this.hls;A&&(A.off(–ª.MEDIA_ATTACHING,this.onMediaAttaching,this),
A.off(–ª.MEDIA_ATTACHED,this.onMediaAttached,this),A.off(–ª.MEDIA_DETACHING,this.onMediaDetaching,this),A.off(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.off(–ª.LEVEL_UPDATED,this.onLevelUpdated,this),A.off(–ª.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),A.off(–ª.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),A.off(–ª.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),A.off(–ª.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),
A.off(–ª.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),A.off(–ª.ASSET_LIST_LOADED,this.onAssetListLoaded,this),A.off(–ª.BUFFER_CODECS,this.onBufferCodecs,this),A.off(–ª.BUFFER_APPENDED,this.onBufferAppended,this),A.off(–ª.BUFFER_FLUSHED,this.onBufferFlushed,this),A.off(–ª.BUFFERED_TO_END,this.onBufferedToEnd,this),A.off(–ª.MEDIA_ENDED,this.onMediaEnded,this),A.off(–ª.ERROR,this.onError,this),A.off(–ª.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){
this.pauseBuffering()}resumeBuffering(){var A;null==(A=this.getBufferingPlayer())||A.resumeBuffering()}pauseBuffering(){var A;null==(A=this.getBufferingPlayer())||A.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.manager=null,
this.hls=this.HlsPlayerClass=this.schedule=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const A=this.primaryMedia||this.media;A&&this.removeMediaListeners(A)}removeMediaListeners(A){«â(A,"play",this.onPlay),«â(A,"pause",this.onPause),«â(A,"seeking",this.onSeeking),«â(A,"timeupdate",this.onTimeupdate)}onMediaAttaching(A,B){const C=this.media=B.media;«à(C,"seeking",this.onSeeking),
«à(C,"timeupdate",this.onTimeupdate),«à(C,"play",this.onPlay),«à(C,"pause",this.onPause)}onMediaAttached(A,B){const C=this.effectivePlayingItem,D=this.detachedData;if(this.detachedData=null,null===C)this.checkStart();else if(!D){this.clearScheduleState();const A=this.findItemIndex(C);this.setSchedulePosition(A)}}clearScheduleState(){this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(A,B){
const C=!!B.transferMedia,D=this.media;if(this.media=null,!C&&(D&&this.removeMediaListeners(D),this.detachedData)){const A=this.getBufferingPlayer();A&&(this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,A.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.manager){if(!this.hls)return null;const A=this,B=()=>A.bufferingItem||A.waitingItem,C=B=>B?A.getAssetPlayer(B.identifier):B,D=(B,D,E,G,H)=>{if(B){
let I=B[D].start;const J=B.event;if(J){if("playout"===D||J.timelineOccupancy!==”É.Point){const A=C(E);(null==A?void 0:A.interstitial)===J&&(I+=A.assetItem.startOffset+A[H])}}else I+=("bufferedPos"===G?F():A[G])-B.start;return I}return 0},E=(B,C)=>{if(0!==B&&"primary"!==C&&A.schedule.length){var D;const E=A.schedule.findItemIndexAtTime(B),F=null==(D=A.schedule.items)?void 0:D[E];if(F)return B+(F[C].start-F.start)}return B},F=()=>{const B=A.bufferedPos
;return B===Number.MAX_VALUE?G("primary"):Math.max(B,0)},G=B=>{var C;return null!=(C=A.primaryDetails)&&C.live?A.primaryDetails.edge:A.schedule.durations[B]},H=(B,E)=>{var F,G,H;const I=A.effectivePlayingItem;if(null!=I&&null!=(F=I.event)&&F.restrictions.skip)return;A.log(`seek to ${B} "${E}"`)
;const J=A.effectivePlayingItem,K=A.schedule.findItemIndexAtTime(B,E),L=null==(G=A.schedule.items)?void 0:G[K],M=A.getBufferingPlayer(),N=null==M?void 0:M.interstitial,O=null==N?void 0:N.appendInPlace,P=J&&A.itemsMatch(J,L);if(J&&(O||P)){const F=C(A.playingAsset),G=(null==F?void 0:F.media)||A.primaryMedia;if(G){const C="primary"===E?G.currentTime:D(J,E,A.playingAsset,"timelinePos","currentTime"),H=B-C,I=(O?C:G.currentTime)+H;if(I>=0&&(!F||O||I<=F.duration))return void(G.currentTime=I)}}if(L){
let C=B;if("primary"!==E){const A=B-L[E].start;C=L.start+A}const D=!A.isInterstitial(L);if(A.isInterstitial(J)&&!J.event.appendInPlace||!D&&!L.event.appendInPlace){if(J){const F=A.findItemIndex(J);if(K>F){const B=A.schedule.findJumpRestrictedIndex(F+1,K);if(B>F)return void A.setSchedulePosition(B)}let G=0;if(D)A.timelinePos=C,A.checkBuffer();else{const A=null==L||null==(H=L.event)?void 0:H.assetList;if(A){const C=B-(L[E]||L).start;for(let B=A.length;B--;){const D=A[B]
;if(D.duration&&C>=D.startOffset&&C<D.startOffset+D.duration){G=B;break}}}}A.setSchedulePosition(K,G)}}else{const B=A.media||(O?null==M?void 0:M.media:null);B&&(B.currentTime=C)}}},I=()=>{const C=A.effectivePlayingItem;if(A.isInterstitial(C))return C;const D=B();return A.isInterstitial(D)?D:null},J={get currentTime(){const B=I(),C=A.effectivePlayingItem;return C&&C===B?D(C,"playout",A.effectivePlayingAsset,"timelinePos","currentTime")-C.playout.start:0},set currentTime(B){
const C=I(),D=A.effectivePlayingItem;D&&D===C&&H(B+D.playout.start,"playout")},get duration(){const A=I();return A?A.playout.end-A.playout.start:0},get assetPlayers(){var B;const C=null==(B=I())?void 0:B.event.assetList;return C?C.map((B=>A.getAssetPlayer(B.identifier))):[]},get playingIndex(){var B;const C=null==(B=I())?void 0:B.event;return C&&A.effectivePlayingAsset?C.findAssetIndex(A.effectivePlayingAsset):-1},get scheduleItem(){return I()}};this.manager={get events(){var B,C
;return(null==(B=A.schedule)||null==(C=B.events)?void 0:C.slice(0))||[]},get schedule(){var B,C;return(null==(B=A.schedule)||null==(C=B.items)?void 0:C.slice(0))||[]},get interstitialPlayer(){return I()?J:null},get playerQueue(){return A.playerQueue.slice(0)},get bufferingAsset(){return A.bufferingAsset},get bufferingItem(){return B()},get bufferingIndex(){const C=B();return A.findItemIndex(C)},get playingAsset(){return A.effectivePlayingAsset},get playingItem(){return A.effectivePlayingItem},
get playingIndex(){const B=A.effectivePlayingItem;return A.findItemIndex(B)},primary:{get bufferedEnd(){return F()},get currentTime(){const B=A.timelinePos;return B>0?B:0},set currentTime(A){H(A,"primary")},get duration(){return G("primary")},get seekableStart(){var B;return(null==(B=A.primaryDetails)?void 0:B.fragmentStart)||0}},integrated:{get bufferedEnd(){return D(B(),"integrated",A.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){
return D(A.effectivePlayingItem,"integrated",A.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(A){H(A,"integrated")},get duration(){return G("integrated")},get seekableStart(){var B;return E((null==(B=A.primaryDetails)?void 0:B.fragmentStart)||0,"integrated")}},skip:()=>{const B=A.effectivePlayingItem,C=null==B?void 0:B.event;if(C&&!C.restrictions.skip){const D=A.findItemIndex(B);if(C.appendInPlace){const A=B.playout.start+B.event.duration;H(A+.001,"playout")
}else A.advanceAfterAssetEnded(C,D,1/0)}}}}return this.manager}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var A;const B=this.playingItem,C=null==(A=this.schedule)?void 0:A.items;return!!(this.playbackStarted&&B&&C)&&this.findItemIndex(B)===C.length-1}get playbackStarted(){return null!==this.effectivePlayingItem}get currentTime(){var A,B,C
;if(null===this.mediaSelection)return;const D=this.waitingItem||this.playingItem;if(this.isInterstitial(D)&&!D.event.appendInPlace)return;let E=this.media;!E&&null!=(A=this.bufferingItem)&&null!=(B=A.event)&&B.appendInPlace&&(E=this.primaryMedia);const F=null==(C=E)?void 0:C.currentTime;return void 0!==F&&–∂(F)?F:void 0}get primaryMedia(){var A;return this.media||(null==(A=this.detachedData)?void 0:A.media)||null}isInterstitial(A){return!(null==A||!A.event)}retreiveMediaSource(A,B){
const C=this.getAssetPlayer(A);C&&this.transferMediaFromPlayer(C,B)}transferMediaFromPlayer(A,B){const C=A.interstitial.appendInPlace,D=A.media;if(C&&D===this.primaryMedia){if(this.bufferingAsset=null,(!B||this.isInterstitial(B)&&!B.event.appendInPlace)&&B&&D)return void(this.detachedData={media:D});const C=A.transferMedia();this.log(`transfer MediaSource from ${A} ${—ï(C)}`),this.detachedData=C}else B&&D&&(this.shouldPlay||(this.shouldPlay=!D.paused))}transferMediaTo(A,B){var C,D
;if(A.media===B)return;let E=null;const F=this.hls,G=A!==F,H=G&&A.interstitial.appendInPlace,I=null==(C=this.detachedData)?void 0:C.mediaSource;let J;if(F.media)H&&(E=F.transferMedia(),this.detachedData=E),J="Primary";else if(I){const A=this.getBufferingPlayer();A?(E=A.transferMedia(),J=""+A):J="detached MediaSource"}else J="detached media";if(!E)if(I)E=this.detachedData,this.log("using detachedData: MediaSource "+—ï(E));else if(!this.detachedData||F.media===B){const A=this.playerQueue
;A.length>1&&A.forEach((A=>{if(G&&A.interstitial.appendInPlace!==H){const B=A.interstitial;this.clearInterstitial(A.interstitial,null),B.appendInPlace=!1,B.appendInPlace&&this.warn("Could not change append strategy for queued assets "+B)}})),this.hls.detachMedia(),this.detachedData={media:B}}const K=E&&"mediaSource"in E&&"closed"!==(null==(D=E.mediaSource)?void 0:D.readyState),L=K&&E?E:B;if(this.log(`${K?"transfering MediaSource":"attaching media"} to ${G?A:"Primary"} from ${J}`),L===E){
const B=G&&A.assetId===this.schedule.assetIdAtEnd;L.overrides={duration:this.schedule.duration,endOfStream:!G||B,cueRemoval:!G}}A.attachMedia(L)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const A=this.schedule,B=A.events;if(!B||this.playbackDisabled||!this.media)return;-1===this.bufferedPos&&(this.bufferedPos=0);const C=this.timelinePos,D=this.effectivePlayingItem;if(-1===C){const C=this.hls.startPosition;if(this.timelinePos=C,B.length&&B[0].cue.pre){
const C=A.findEventIndex(B[0].identifier);this.setSchedulePosition(C)}else if(C>=0||!this.primaryLive){const B=this.timelinePos=C>0?C:0,D=A.findItemIndexAtTime(B);this.setSchedulePosition(D)}}else if(D&&!this.playingItem){const B=A.findItemIndex(D);this.setSchedulePosition(B)}}advanceAfterAssetEnded(A,B,C){const D=«ì(A,C);if(A.isAssetPastPlayoutLimit(D)){const C=this.schedule.items;if(C){const D=B+1;if(D>=C.length)return void this.setSchedulePosition(-1);const E=A.resumeTime
;this.timelinePos<E&&(this.timelinePos=E,this.checkBuffer()),this.setSchedulePosition(D)}}else this.setSchedulePosition(B,D)}setScheduleToAssetAtTime(A,B){const C=this.schedule,D=B.parentIdentifier,E=C.getEvent(D);if(E){const B=C.findEventIndex(D),F=C.findAssetIndex(E,A);this.advanceAfterAssetEnded(E,B,F-1)}}setSchedulePosition(A,B){var C,D;const E=this.schedule.items;if(!E||this.playbackDisabled)return;this.log(`setSchedulePosition ${A}, ${B}`)
;const F=A>=0?E[A]:null,G=this.playingItem,H=this.playingLastItem;if(this.isInterstitial(G)){const I=G.event,J=this.playingAsset,K=null==J?void 0:J.identifier,L=K?this.getAssetPlayer(K):null;if(L&&K&&(!this.eventItemsMatch(G,F)||void 0!==B&&K!==(null==(C=I.assetList)?void 0:C[B].identifier))){const B=I.findAssetIndex(J);this.log(`INTERSTITIAL_ASSET_ENDED ${B+1}/${I.assetList.length} ${«î(J)}`),this.endedAsset=J,this.playingAsset=null,this.hls.trigger(–ª.INTERSTITIAL_ASSET_ENDED,{asset:J,
assetListIndex:B,event:I,schedule:E.slice(0),scheduleIndex:A,player:L}),this.retreiveMediaSource(K,F),!L.media||null!=(D=this.detachedData)&&D.mediaSource||L.detachMedia()}if(!this.eventItemsMatch(G,F)&&(this.endedItem=G,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${I} ${«ï(G)}`),I.hasPlayed=!0,this.hls.trigger(–ª.INTERSTITIAL_ENDED,{event:I,schedule:E.slice(0),scheduleIndex:A}),I.cue.once)){this.updateSchedule();const A=this.schedule.items;if(F&&A){const C=this.schedule.findItemIndex(F)
;this.advanceSchedule(C,A,B,G,H)}return}}this.advanceSchedule(A,E,B,G,H)}advanceSchedule(A,B,C,D,E){const F=A>=0?B[A]:null,G=this.primaryMedia,H=this.playerQueue;if(H.length&&H.forEach((B=>{const C=B.interstitial,D=this.schedule.findEventIndex(C.identifier);(D<A||D>A+1)&&this.clearInterstitial(C,F)})),this.isInterstitial(F)){this.timelinePos=Math.min(Math.max(this.timelinePos,F.start),F.end);const E=F.event;if(void 0===C){const B=«ì(E,(C=this.schedule.findAssetIndex(E,this.timelinePos))-1)
;if(E.isAssetPastPlayoutLimit(B))return void this.advanceAfterAssetEnded(E,A,C);C=B}const H=this.waitingItem;this.assetsBuffered(F,G)||this.setBufferingItem(F);let I=this.preloadAssets(E,C);if(this.eventItemsMatch(F,H||D)||(this.waitingItem=F,this.log(`INTERSTITIAL_STARTED ${«ï(F)} ${E.appendInPlace?"append in place":""}`),this.hls.trigger(–ª.INTERSTITIAL_STARTED,{event:E,schedule:B.slice(0),scheduleIndex:A})),!E.assetListLoaded)return void this.log("Waiting for ASSET-LIST to complete loading "+E)
;if(E.assetListLoader&&(E.assetListLoader.destroy(),E.assetListLoader=void 0),!G)return void this.log("Waiting for attachMedia to start Interstitial "+E);this.waitingItem=this.endedItem=null,this.playingItem=F;const J=E.assetList[C];if(!J){const D=B[A+1],F=this.media;return D&&F&&!this.isInterstitial(D)&&F.currentTime<D.start&&(F.currentTime=this.timelinePos=D.start),void this.advanceAfterAssetEnded(E,A,C||0)}if(I||(I=this.getAssetPlayer(J.identifier)),null===I||I.destroyed){
const A=E.assetList.length;this.warn(`asset ${C+1}/${A} player destroyed ${E}`),I=this.createAssetPlayer(E,J,C)}if(!this.eventItemsMatch(F,this.bufferingItem)&&E.appendInPlace&&this.isAssetBuffered(J))return;this.startAssetPlayer(I,C,B,A,G),this.shouldPlay&&«ñ(I.media)}else null!==F?(this.resumePrimary(F,A,D),this.shouldPlay&&«ñ(this.hls.media)):E&&this.isInterstitial(D)&&(this.endedItem=null,this.playingItem=D,D.event.appendInPlace||this.attachPrimary(this.schedule.durations.primary,null))}
get playbackDisabled(){return!1===this.hls.config.enableInterstitialPlayback}get primaryDetails(){var A,B;return null==(A=this.mediaSelection)||null==(B=A.main)?void 0:B.details}get primaryLive(){var A;return!(null==(A=this.primaryDetails)||!A.live)}resumePrimary(A,B,C){var D;if(this.playingItem=A,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(A),this.log("resuming "+«ï(A)),null==(D=this.detachedData)||!D.mediaSource){let C=this.timelinePos
;(C<A.start||C>=A.end)&&(C=this.getPrimaryResumption(A,B),this.timelinePos=C),this.attachPrimary(C,A)}if(!C)return;const E=this.schedule.items;E&&(this.log("INTERSTITIALS_PRIMARY_RESUMED "+«ï(A)),this.hls.trigger(–ª.INTERSTITIALS_PRIMARY_RESUMED,{schedule:E.slice(0),scheduleIndex:B}),this.checkBuffer())}getPrimaryResumption(A,B){const C=A.start;if(this.primaryLive){const A=this.primaryDetails;if(0===B)return this.hls.startPosition
;if(A&&(C<A.fragmentStart||C>A.edge))return this.hls.liveSyncPosition||-1}return C}isAssetBuffered(A){const B=this.getAssetPlayer(A.identifier);return null!=B&&B.hls?B.hls.bufferedToEnd:—¢.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=A.timelineStart+(A.duration||0)}attachPrimary(A,B,C){B?this.setBufferingItem(B):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const D=this.primaryMedia;if(!D)return;const E=this.hls;E.media?this.checkBuffer():(this.transferMediaTo(E,D),
C&&this.startLoadingPrimaryAt(A,C)),C||(this.timelinePos=A,this.startLoadingPrimaryAt(A,C))}startLoadingPrimaryAt(A,B){var C;const D=this.hls;!D.loadingEnabled||!D.media||Math.abs(((null==(C=D.mainForwardBufferInfo)?void 0:C.start)||D.media.currentTime)-A)>.5?D.startLoad(A,B):D.bufferingEnabled||D.resumeBuffering()}onManifestLoading(){this.stopLoad(),this.schedule.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,
this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(–ª.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(–ª.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(A,B){if(-1===B.level)return;const C=this.hls.levels[B.level],D=ƒë(ƒë({},this.mediaSelection||this.altSelection),{},{main:C});this.mediaSelection=D,this.schedule.parseInterstitialDateRanges(D,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}
onAudioTrackUpdated(A,B){const C=this.hls.audioTracks[B.id],D=this.mediaSelection;if(!D)return void(this.altSelection=ƒë(ƒë({},this.altSelection),{},{audio:C}));const E=ƒë(ƒë({},D),{},{audio:C});this.mediaSelection=E}onSubtitleTrackUpdated(A,B){const C=this.hls.subtitleTracks[B.id],D=this.mediaSelection;if(!D)return void(this.altSelection=ƒë(ƒë({},this.altSelection),{},{subtitles:C}));const E=ƒë(ƒë({},D),{},{subtitles:C});this.mediaSelection=E}onAudioTrackSwitching(A,B){const C=≈Ö(B)
;this.playerQueue.forEach((A=>A.hls.setAudioOption(B)||A.hls.setAudioOption(C)))}onSubtitleTrackSwitch(A,B){const C=≈Ö(B);this.playerQueue.forEach((A=>A.hls.setSubtitleOption(B)||-1!==B.id&&A.hls.setSubtitleOption(C)))}onBufferCodecs(A,B){const C=B.tracks;C&&(this.requiredTracks=C)}onBufferAppended(A,B){this.checkBuffer()}onBufferFlushed(A,B){const C=this.playingItem;if(C&&!this.itemsMatch(C,this.bufferingItem)&&!this.isInterstitial(C)){const A=this.timelinePos;this.bufferedPos=A,
this.checkBuffer()}}onBufferedToEnd(A){const B=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&B){for(let A=0;A<B.length;A++){const D=B[A];if(D.cue.post){var C;const A=this.schedule.findEventIndex(D.identifier),B=null==(C=this.schedule.items)?void 0:C[A];this.isInterstitial(B)&&this.eventItemsMatch(B,this.bufferingItem)&&this.bufferedToItem(B,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(A){const B=this.playingItem;if(!this.playingLastItem&&B){const A=this.findItemIndex(B)
;this.setSchedulePosition(A+1)}else this.shouldPlay=!1}updateItem(A,B){const C=this.schedule.items;return A&&C&&C[this.findItemIndex(A,B)]||null}trimInPlace(A,B){if(this.isInterstitial(A)&&A.event.appendInPlace&&B.end-A.end>.25){A.event.assetList.forEach(((B,C)=>{A.event.isAssetPastPlayoutLimit(C)&&this.clearAssetPlayer(B.identifier,null)}));const B=A.end+.25,C=—¢.bufferInfo(this.primaryMedia,B,0);(C.end>B||(C.nextStart||0)>B)&&(this.attachPrimary(B,null),this.flushFrontBuffer(B))}}
itemsMatch(A,B){return!!B&&(A===B||A.event&&B.event&&this.eventItemsMatch(A,B)||!A.event&&!B.event&&this.findItemIndex(A)===this.findItemIndex(B))}eventItemsMatch(A,B){var C;return!!B&&(A===B||A.event.identifier===(null==(C=B.event)?void 0:C.identifier))}findItemIndex(A,B){return A?this.schedule.findItemIndex(A,B):-1}updateSchedule(){const A=this.mediaSelection;A&&this.schedule.updateSchedule(A,[])}checkBuffer(A){const B=this.schedule.items;if(!B)return
;const C=—¢.bufferInfo(this.primaryMedia,this.timelinePos,0);A&&(this.bufferedPos=this.timelinePos),A||(A=C.len<1),this.updateBufferedPos(C.end,B,A)}updateBufferedPos(A,B,C){const D=this.schedule,E=this.bufferingItem;if(this.bufferedPos>A)return;if(1===B.length&&this.itemsMatch(B[0],E))return void(this.bufferedPos=A);const F=this.playingItem,G=this.findItemIndex(F);let H=D.findItemIndexAtTime(A);if(this.bufferedPos<A){var I,J;const C=this.findItemIndex(E),D=Math.min(C+1,B.length-1),F=B[D]
;if((-1===H&&E&&A>=E.end||null!=(I=F.event)&&I.appendInPlace&&A+.01>=F.start)&&(H=D),D-G>1&&!1===(null==E||null==(J=E.event)?void 0:J.appendInPlace))return;if(this.bufferedPos=A,H>C&&H>G)this.bufferedToItem(F);else{const B=this.primaryDetails;this.primaryLive&&B&&A>B.edge-B.targetduration&&F.start<B.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(F)&&this.preloadAssets(F.event,0)}
}else C&&F&&!this.itemsMatch(F,E)&&(H===G?this.bufferedToItem(F):H===G+1&&this.bufferedToItem(B[H]))}assetsBuffered(A,B){return 0!==A.event.assetList.length&&!A.event.assetList.some((A=>{const C=this.getAssetPlayer(A.identifier);return!(null!=C&&C.bufferedInPlaceToEnd(B))}))}setBufferingItem(A){const B=this.bufferingItem,C=this.schedule;if(this.itemsMatch(A,B))this.bufferingItem!==A&&(this.bufferingItem=A);else{const{items:D,events:E}=C;if(!D||!E)return B
;const F=this.isInterstitial(A),G=this.getBufferingPlayer();this.bufferingItem=A,this.bufferedPos=Math.max(A.start,Math.min(A.end,this.timelinePos));const H=G?G.remaining:B?B.end-this.timelinePos:0;this.log("INTERSTITIALS_BUFFERED_TO_BOUNDARY "+«ï(A)+(B?` (${H.toFixed(2)} remaining)`:"")),this.playbackDisabled||(F?A.event.assetList.forEach((A=>{const B=this.getAssetPlayer(A.identifier);B&&B.resumeBuffering()})):(this.hls.resumeBuffering(),this.playerQueue.forEach((A=>A.pauseBuffering())))),
this.hls.trigger(–ª.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:E.slice(0),schedule:D.slice(0),bufferingIndex:this.findItemIndex(A),playingIndex:this.findItemIndex(this.playingItem)})}return B}bufferedToItem(A,B=0){const C=this.setBufferingItem(A);if(!this.playbackDisabled)if(this.isInterstitial(A))this.bufferedToEvent(A,B);else if(null!==C){this.bufferingAsset=null;const B=this.detachedData;if(B)if(B.mediaSource){const B=!0;this.attachPrimary(A.start,A,B)
}else this.preloadPrimary(A);else this.preloadPrimary(A)}}preloadPrimary(A){const B=this.findItemIndex(A),C=this.getPrimaryResumption(A,B);this.startLoadingPrimaryAt(C)}bufferedToEvent(A,B){const C=A.event,D=0===C.assetList.length&&!C.assetListLoader,E=C.cue.once;if(D||!E){const A=this.preloadAssets(C,B);if(null!=A&&A.interstitial.appendInPlace){const D=C.assetList[B],E=this.primaryMedia;D&&E&&this.bufferAssetPlayer(A,E)}}}preloadAssets(A,B){
const C=A.assetUrl,D=A.assetList.length,E=0===D&&!A.assetListLoader,F=A.cue.once;if(E){const E=A.timelineStart;if(A.appendInPlace){var G;const B=this.playingItem;this.isInterstitial(B)||(null==B||null==(G=B.nextEvent)?void 0:G.identifier)!==A.identifier||this.flushFrontBuffer(E+.25)}let F,H=0;if(!this.playingItem&&this.primaryLive&&(H=this.hls.startPosition,-1===H&&(H=this.hls.liveSyncPosition||0)),H&&!A.cue.pre&&!A.cue.post){const A=H-E;A>0&&(F=Math.round(1e3*A)/1e3)}
if(this.log(`Load interstitial asset ${B+1}/${C?1:D} ${A}${F?` live-start: ${H} start-offset: ${F}`:""}`),C)return this.createAsset(A,0,0,E,A.duration,C);const I=this.assetListLoader.loadAssetList(A,F);I&&(A.assetListLoader=I)}else if(!F&&D){for(let C=B;C<D;C++){const B=A.assetList[C],D=this.getAssetPlayerQueueIndex(B.identifier);-1!==D&&!this.playerQueue[D].destroyed||B.error||this.createAssetPlayer(A,B,C)}return this.getAssetPlayer(A.assetList[B].identifier)}return null}flushFrontBuffer(A){
const B=this.requiredTracks;B&&(this.log("Removing front buffer starting at "+A),Object.keys(B).forEach((B=>{this.hls.trigger(–ª.BUFFER_FLUSHING,{startOffset:A,endOffset:1/0,type:B})})))}getAssetPlayerQueueIndex(A){const B=this.playerQueue;for(let C=0;C<B.length;C++)if(A===B[C].assetId)return C;return-1}getAssetPlayer(A){const B=this.getAssetPlayerQueueIndex(A);return this.playerQueue[B]||null}getBufferingPlayer(){const{playerQueue:A,primaryMedia:B}=this
;if(B)for(let C=0;C<A.length;C++)if(A[C].media===B)return A[C];return null}createAsset(A,B,C,D,E,F){const G={parentIdentifier:A.identifier,identifier:«ê(A,F,B),duration:E,startOffset:C,timelineStart:D,uri:F};return this.createAssetPlayer(A,G,B)}createAssetPlayer(A,B,C){const D=this.hls,E=D.userConfig;let F=E.videoPreference;const G=D.loadLevelObj||D.levels[D.currentLevel];(F||G)&&(F=ƒè({},F),G.videoCodec&&(F.videoCodec=G.videoCodec),G.videoRange&&(F.allowedVideoRanges=[G.videoRange]))
;const H=D.audioTracks[D.audioTrack],I=D.subtitleTracks[D.subtitleTrack];let J=0;if(this.primaryLive||A.appendInPlace){const A=this.timelinePos-B.timelineStart;if(A>1){const C=B.duration;C&&A<C&&(J=A)}}const K=B.identifier,L=ƒë(ƒë({},E),{},{autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:D.sessionId,assetPlayerId:K,abrEwmaDefaultEstimate:D.bandwidthEstimate,interstitialsController:void 0,startPosition:J,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:F,
audioPreference:H||E.audioPreference,subtitlePreference:I||E.subtitlePreference});A.appendInPlace&&(A.appendInPlaceStarted=!0,B.timelineStart&&(L.timelineOffset=B.timelineStart));const M=L.cmcd;null!=M&&M.sessionId&&M.contentId&&(L.cmcd=ƒè({},M,{contentId:«è(B.uri)})),this.getAssetPlayer(K)&&this.warn(`Duplicate date range identifier ${A} and asset ${K}`);const N=new ”Ö(this.HlsPlayerClass,L,A,B);this.playerQueue.push(N),A.assetList[C]=B;const O=D=>{if(D.live){
const B=Error("Interstitials MUST be VOD assets "+A),D={fatal:!0,type:–π.OTHER_ERROR,details:–∫.INTERSTITIAL_ASSET_ITEM_ERROR,error:B};return void this.handleAssetItemError(D,A,this.schedule.findEventIndex(A.identifier),C,B.message)}const E=D.edge-D.fragmentStart,F=B.duration;(null===F||E>F)&&(this.log(`Interstitial asset "${K}" duration change ${F} > ${E}`),B.duration=E,this.updateSchedule())};N.on(–ª.LEVEL_UPDATED,((A,{details:B})=>O(B))),N.on(–ª.LEVEL_PTS_UPDATED,((A,{details:B})=>O(B)))
;const P=(A,B)=>{const C=this.getAssetPlayer(K);if(C&&B.tracks){C.off(–ª.BUFFER_CODECS,P),C.tracks=B.tracks;const A=this.primaryMedia;this.bufferingAsset===C.assetItem&&A&&!C.media&&this.bufferAssetPlayer(C,A)}};N.on(–ª.BUFFER_CODECS,P);const Q=()=>{var C,D;const E=this.getAssetPlayer(K);if(this.log("buffered to end of asset "+E),!E)return;const F=this.schedule.findEventIndex(A.identifier),G=null==(C=this.schedule.items)?void 0:C[F];if(this.isInterstitial(G)){const C=A.findAssetIndex(B),E=«ì(A,C)
;if(A.isAssetPastPlayoutLimit(E)){const A=null==(D=this.schedule.items)?void 0:D[F+1];A&&this.bufferedToItem(A)}else this.bufferedToItem(G,E)}};N.on(–ª.BUFFERED_TO_END,Q);const R=B=>()=>{if(!this.getAssetPlayer(K))return;this.shouldPlay=!0;const C=this.schedule.findEventIndex(A.identifier);this.advanceAfterAssetEnded(A,C,B)};return N.once(–ª.MEDIA_ENDED,R(C)),N.once(–ª.PLAYOUT_LIMIT_REACHED,R(1/0)),N.on(–ª.ERROR,((B,D)=>{const E=this.getAssetPlayer(K)
;if(D.details!==–∫.BUFFER_STALLED_ERROR)this.handleAssetItemError(D,A,this.schedule.findEventIndex(A.identifier),C,`Asset player error ${D.error} ${A}`);else if(null!=E&&E.media){const B=E.currentTime,C=E.duration-B;B&&A.appendInPlace&&C/E.media.playbackRate<.5?(this.log(`Advancing buffer past end of asset ${K} ${A} at ${E.media.currentTime}`),Q()):(this.warn(`Stalled at ${B} of ${B+C} in asset ${K} ${A}`),this.onTimeupdate(),this.checkBuffer(!0))}})),N.on(–ª.DESTROYING,(()=>{
if(!this.getAssetPlayer(K))return;const B=Error("Asset player destroyed unexpectedly "+K),D={fatal:!0,type:–π.OTHER_ERROR,details:–∫.INTERSTITIAL_ASSET_ITEM_ERROR,error:B};this.handleAssetItemError(D,A,this.schedule.findEventIndex(A.identifier),C,B.message)})),this.log("INTERSTITIAL_ASSET_PLAYER_CREATED "+«î(B)),this.hls.trigger(–ª.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:B,assetListIndex:C,event:A,player:N}),N}clearInterstitial(A,B){A.assetList.forEach((A=>{this.clearAssetPlayer(A.identifier,B)})),
A.reset()}resetAssetPlayer(A){const B=this.getAssetPlayerQueueIndex(A);if(-1!==B){this.log(`reset asset player "${A}" after error`);const C=this.playerQueue[B];this.transferMediaFromPlayer(C,null),C.resetDetails()}}clearAssetPlayer(A,B){const C=this.getAssetPlayerQueueIndex(A);if(-1!==C){this.log(`clear asset player "${A}" toSegment: ${B?«ï(B):B}`);const D=this.playerQueue[C];this.transferMediaFromPlayer(D,B),this.playerQueue.splice(C,1),D.destroy()}}emptyPlayerQueue(){let A
;for(;A=this.playerQueue.pop();)A.destroy();this.playerQueue=[]}startAssetPlayer(A,B,C,D,E){const{interstitial:F,assetItem:G,assetId:H}=A,I=F.assetList.length,J=this.playingAsset;this.endedAsset=null,this.playingAsset=G,J&&J.identifier===H||(J&&(this.clearAssetPlayer(J.identifier,C[D]),delete J.error),this.log(`INTERSTITIAL_ASSET_STARTED ${B+1}/${I} ${«î(G)}`),this.hls.trigger(–ª.INTERSTITIAL_ASSET_STARTED,{asset:G,assetListIndex:B,event:F,schedule:C.slice(0),scheduleIndex:D,player:A})),
this.bufferAssetPlayer(A,E)}bufferAssetPlayer(A,B){var C,D;const{interstitial:E,assetItem:F}=A,G=this.schedule.findEventIndex(E.identifier),H=null==(C=this.schedule.items)?void 0:C[G];if(!H)return;this.setBufferingItem(H),this.bufferingAsset=F;const I=this.getBufferingPlayer();if(I===A)return;const J=E.appendInPlace;if(J&&!1===(null==I?void 0:I.interstitial.appendInPlace))return;const K=(null==I?void 0:I.tracks)||(null==(D=this.detachedData)?void 0:D.tracks)||this.requiredTracks
;if(J&&F!==this.playingAsset){if(!A.tracks)return;if(K&&!ƒï(K,A.tracks)){const B=Error(`Asset ${«î(F)} SourceBuffer tracks ('${Object.keys(A.tracks)}') are not compatible with primary content tracks ('${Object.keys(K)}')`),C={fatal:!0,type:–π.OTHER_ERROR,details:–∫.INTERSTITIAL_ASSET_ITEM_ERROR,error:B},D=E.findAssetIndex(F);return void this.handleAssetItemError(C,E,G,D,B.message)}}this.transferMediaTo(A,B)}handleAssetItemError(A,B,C,D,E){if(A.details===–∫.BUFFER_STALLED_ERROR)return
;const F=B.assetList[D];this.warn(`INTERSTITIAL_ASSET_ERROR ${F?«î(F):F} ${A.error}`);const G=null==F?void 0:F.identifier,H=this.getAssetPlayerQueueIndex(G),I=this.playerQueue[H]||null,J=this.schedule.items,K=ƒè({},A,{fatal:!1,errorAction:≈î(!0),asset:F,assetListIndex:D,event:B,schedule:J,scheduleIndex:C,player:I});if(this.hls.trigger(–ª.INTERSTITIAL_ASSET_ERROR,K),!A.fatal)return;const L=this.playingAsset,M=Error(E);if(F&&(this.clearAssetPlayer(G,null),F.error=M),B.assetList.some((A=>!A.error))){
if(B.appendInPlace){for(let A=D;A<B.assetList.length;A++)this.resetAssetPlayer(B.assetList[A].identifier);this.updateSchedule()}}else B.error=M;B.error?this.primaryFallback(B):L&&L.identifier===G&&this.advanceAfterAssetEnded(B,C,D)}primaryFallback(A){const B=A.timelineStart,C=this.effectivePlayingItem;if(this.updateSchedule(),C){this.log(`Fallback to primary from event "${A.identifier}" start: ${B} pos: ${this.timelinePos} playing: ${C?«ï(C):"<none>"} error: ${A.error}`);let D=this.timelinePos
;-1===D&&(D=this.hls.startPosition);const E=this.updateItem(C,D);this.itemsMatch(C,E)&&this.clearInterstitial(A,null),A.appendInPlace&&(this.attachPrimary(B,null),this.flushFrontBuffer(B));const F=this.schedule.findItemIndexAtTime(D);this.setSchedulePosition(F)}else this.checkStart()}onAssetListLoaded(A,B){var C,D;const E=B.event,F=E.identifier,G=B.assetListResponse.ASSETS;if(!this.schedule.hasEvent(F))return;const H=E.timelineStart,I=E.duration;let J=0;G.forEach(((A,B)=>{
const C=parseFloat(A.DURATION);this.createAsset(E,B,J,H+J,C,A.URI),J+=C})),E.duration=J,this.log(`Loaded asset-list with duration: ${J} (was: ${I}) ${E}`);const K=this.waitingItem,L=(null==K?void 0:K.event.identifier)===F;this.updateSchedule();const M=null==(C=this.bufferingItem)?void 0:C.event;if(L){const A=this.schedule.findEventIndex(F),B=null==(D=this.schedule.items)?void 0:D[A];if(B){
if(!this.playingItem&&this.timelinePos>B.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==A)return E.error=Error(`Interstitial no longer within playback range ${this.timelinePos} ${E}`),void this.primaryFallback(E);this.setBufferingItem(B)}this.setSchedulePosition(A)}else if((null==M?void 0:M.identifier)===F&&M.appendInPlace){const A=E.assetList[0],B=this.getAssetPlayer(A.identifier),C=this.primaryMedia;A&&B&&C&&this.bufferAssetPlayer(B,C)}}onError(A,B){switch(B.details){
case –∫.ASSET_LIST_PARSING_ERROR:case –∫.ASSET_LIST_LOAD_ERROR:case –∫.ASSET_LIST_LOAD_TIMEOUT:{const A=B.interstitial;A&&this.primaryFallback(A);break}case –∫.BUFFER_STALLED_ERROR:this.onTimeupdate(),this.checkBuffer(!0)}}}});class ”Æ extends —ü{constructor(A,B){super("gap-controller",A.logger),this.hls=null,this.fragmentTracker=null,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,
this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var A;null!=(A=this.media)&&A.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{var A;this.hls&&(this.ended=(null==(A=this.media)?void 0:A.currentTime)||1,this.hls.trigger(–ª.MEDIA_ENDED,{stalled:!1}))},this.hls=A,this.fragmentTracker=B,this.registerListeners()}registerListeners(){const{hls:A}=this;A&&(A.on(–ª.MEDIA_ATTACHED,this.onMediaAttached,this),
A.on(–ª.MEDIA_DETACHING,this.onMediaDetaching,this),A.on(–ª.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:A}=this;A&&(A.off(–ª.MEDIA_ATTACHED,this.onMediaAttached,this),A.off(–ª.MEDIA_DETACHING,this.onMediaDetaching,this),A.off(–ª.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(A,B){this.setInterval(100),this.mediaSource=B.mediaSource
;const C=this.media=B.media;«à(C,"playing",this.onMediaPlaying),«à(C,"waiting",this.onMediaWaiting),«à(C,"ended",this.onMediaEnded)}onMediaDetaching(A,B){this.clearInterval();const{media:C}=this;C&&(«â(C,"playing",this.onMediaPlaying),«â(C,"waiting",this.onMediaWaiting),«â(C,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(A,B){this.buffered=B.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var A
;if(null==(A=this.media)||!A.readyState||!this.hasBuffered)return;const B=this.media.currentTime;this.poll(B,this.lastCurrentTime),this.lastCurrentTime=B}poll(A,B){var C,D,E;const F=null==(C=this.hls)?void 0:C.config;if(!F)return;const G=this.media;if(!G)return;const{seeking:H}=G,I=this.seeking&&!H,J=!this.seeking&&H,K=G.paused&&!H||G.ended||0===G.playbackRate;if(this.seeking=H,A!==B)return B&&(this.ended=0),this.moved=!0,H||(this.nudgeRetry=0,
F.nudgeOnVideoHole&&!K&&A>B&&this.nudgeOnVideoHole(A,B)),void(0===this.waiting&&this.stallResolved(A));if(J||I)return void(I&&this.stallResolved(A));if(K)return this.nudgeRetry=0,this.stallResolved(A),void(!this.ended&&G.ended&&this.hls&&(this.ended=A||1,this.hls.trigger(–ª.MEDIA_ENDED,{stalled:!1})));if(!—¢.getBuffered(G).length)return void(this.nudgeRetry=0);const L=—¢.bufferInfo(G,A,0),M=L.nextStart||0,N=this.fragmentTracker;if(H&&N&&this.hls){
const B=«¨(this.hls.inFlightFragments,A),C=L.len>2,D=!M||B||M-A>2&&!N.getPartialFragment(A);if(C||D)return;this.moved=!1}const O=null==(D=this.hls)?void 0:D.latestLevelDetails;if(!this.moved&&null!==this.stalled&&N){if(!(L.len>0||M))return;const B=Math.max(M,L.start||0)-A,C=null!=O&&O.live?2*O.targetduration:2,D=N.getPartialFragment(A);if(B>0&&(B<=C||D))return void(G.paused||this._trySkipBufferHole(D))}const P=F.detectStallWithCurrentTimeMs,Q=self.performance.now(),R=this.waiting
;let S=this.stalled;if(null===S){if(!(R>0&&Q-R<P))return void(this.stalled=Q);S=this.stalled=R}const T=Q-S;if(!H&&(T>=P||R)&&this.hls){if("ended"===(null==(E=this.mediaSource)?void 0:E.readyState)&&(null==O||!O.live)&&Math.abs(A-((null==O?void 0:O.edge)||0))<1){if(this.ended)return;return this.ended=A||1,void this.hls.trigger(–ª.MEDIA_ENDED,{stalled:!0})}if(this._reportStall(L),!this.media||!this.hls)return}const U=—¢.bufferInfo(G,A,F.maxBufferHole);this._tryFixBufferStall(U,T,A)}stallResolved(A){
const B=this.stalled;if(B&&this.hls&&(this.stalled=null,this.stallReported)){const C=self.performance.now()-B;this.log(`playback not stuck anymore @${A}, after ${Math.round(C)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(–ª.STALL_RESOLVED,{})}}nudgeOnVideoHole(A,B){var C;const D=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&null!=(C=this.buffered.audio)&&C.length&&D&&D.length>1&&A>D.end(0)){const C=—¢.bufferedInfo(—¢.timeRangesToArray(this.buffered.audio),A,0)
;if(C.len>1&&B>=C.start){const C=—¢.timeRangesToArray(D),E=—¢.bufferedInfo(C,B,0).bufferedIndex;if(E>-1&&E<C.length-1){const B=—¢.bufferedInfo(C,A,0).bufferedIndex,D=C[E].end,F=C[E+1].start;if((-1===B||B>E)&&F-D<1&&A-D<2){const C=Error(`nudging playhead to flush pipeline after video hole. currentTime: ${A} hole: ${D} -> ${F} buffered index: ${B}`);this.warn(C.message),this.media.currentTime+=1e-6;const E=this.fragmentTracker.getPartialFragment(A)||void 0,G=—¢.bufferInfo(this.media,A,0)
;this.hls.trigger(–ª.ERROR,{type:–π.MEDIA_ERROR,details:–∫.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:C,reason:C.message,frag:E,buffer:G.len,bufferInfo:G})}}}}}_tryFixBufferStall(A,B,C){var D,E;const{fragmentTracker:F,media:G}=this,H=null==(D=this.hls)?void 0:D.config;if(!G||!F||!H)return;const I=null==(E=this.hls)?void 0:E.latestLevelDetails,J=F.getPartialFragment(C);if((J||null!=I&&I.live&&C<I.fragmentStart)&&(this._trySkipBufferHole(J)||!this.media))return
;const K=A.buffered,L=this.adjacentTraversal(A,C);(K&&K.length>1&&A.len>H.maxBufferHole||A.nextStart&&(A.nextStart-C<H.maxBufferHole||L))&&(B>1e3*H.highBufferWatchdogPeriod||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(A))}adjacentTraversal(A,B){const C=this.fragmentTracker,D=A.nextStart;if(C&&D){const A=C.getFragAtPos(B,»µ),E=C.getFragAtPos(D,»µ);if(A&&E)return E.sn-A.sn<2}return!1}_reportStall(A){const{hls:B,media:C,stallReported:D,stalled:E}=this
;if(!D&&null!==E&&C&&B){this.stallReported=!0;const D=Error(`Playback stalling at @${C.currentTime} due to low buffer (${—ï(A)})`);this.warn(D.message),B.trigger(–ª.ERROR,{type:–π.MEDIA_ERROR,details:–∫.BUFFER_STALLED_ERROR,fatal:!1,error:D,buffer:A.len,bufferInfo:A,stalled:{start:E}})}}_trySkipBufferHole(A){var B,C;const{fragmentTracker:D,media:E}=this,F=null==(B=this.hls)?void 0:B.config;if(!E||!D||!F)return 0;const G=E.currentTime,H=—¢.bufferInfo(E,G,0),I=G<H.start?H.start:H.nextStart
;if(I&&this.hls){const B=H.len<=F.maxBufferHole,J=H.len>0&&H.len<1&&E.readyState<3,K=I-G;if(K>0&&(B||J)){if(K>F.maxBufferHole){let B=!1;if(0===G){const A=D.getAppendedFrag(0,»µ);A&&I<A.end&&(B=!0)}if(!B){const B=A||D.getAppendedFrag(G,»µ);if(B){if(null==(C=this.hls.loadLevelObj)||!C.details)return 0;if(«¨(this.hls.inFlightFragments,I))return 0;let A=!1,E=B.end;for(;E<I;){const B=D.getPartialFragment(E);if(!B){A=!0;break}E+=B.duration}if(A)return 0}}}const B=Math.max(I+.05,G+.1)
;if(this.warn(`skipping hole, adjusting currentTime from ${G} to ${B}`),this.moved=!0,E.currentTime=B,null==A||!A.gap){const C=Error(`fragment loaded with buffer holes, seeking from ${G} to ${B}`);this.hls.trigger(–ª.ERROR,{type:–π.MEDIA_ERROR,details:–∫.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:C,reason:C.message,frag:A||void 0,buffer:H.len,bufferInfo:H})}return B}}return 0}_tryNudgeBuffer(A){const{hls:B,media:C,nudgeRetry:D}=this,E=null==B?void 0:B.config;if(!C||!E)return 0;const F=C.currentTime
;if(this.nudgeRetry++,D<E.nudgeMaxRetry){const G=F+(D+1)*E.nudgeOffset,H=Error(`Nudging 'currentTime' from ${F} to ${G}`);this.warn(H.message),C.currentTime=G,B.trigger(–ª.ERROR,{type:–π.MEDIA_ERROR,details:–∫.BUFFER_NUDGE_ON_STALL,error:H,fatal:!1,buffer:A.len,bufferInfo:A})}else{const C=Error(`Playhead still not moving while enough data buffered @${F} after ${E.nudgeMaxRetry} nudges`);this.error(C.message),B.trigger(–ª.ERROR,{type:–π.MEDIA_ERROR,details:–∫.BUFFER_STALLED_ERROR,error:C,fatal:!0,
buffer:A.len,bufferInfo:A})}}}const ”Ø=(()=>{const A=«Æ();try{A&&new A(0,1/0,"")}catch(A){return Number.MAX_VALUE}return 1/0})();class ”∞{constructor(A){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(–ª.EVENT_CUE_ENTER,{})},this.hls=A,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null
}_registerListeners(){const{hls:A}=this;A.on(–ª.MEDIA_ATTACHING,this.onMediaAttaching,this),A.on(–ª.MEDIA_ATTACHED,this.onMediaAttached,this),A.on(–ª.MEDIA_DETACHING,this.onMediaDetaching,this),A.on(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.on(–ª.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),A.on(–ª.BUFFER_FLUSHING,this.onBufferFlushing,this),A.on(–ª.LEVEL_UPDATED,this.onLevelUpdated,this),A.on(–ª.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}_unregisterListeners(){const{hls:A}=this
;A.off(–ª.MEDIA_ATTACHING,this.onMediaAttaching,this),A.off(–ª.MEDIA_ATTACHED,this.onMediaAttached,this),A.off(–ª.MEDIA_DETACHING,this.onMediaDetaching,this),A.off(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.off(–ª.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),A.off(–ª.BUFFER_FLUSHING,this.onBufferFlushing,this),A.off(–ª.LEVEL_UPDATED,this.onLevelUpdated,this),A.off(–ª.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}onMediaAttaching(A,B){var C;this.media=B.media,
!1===(null==(C=B.overrides)?void 0:C.cueRemoval)&&(this.removeCues=!1)}onMediaAttached(){const A=this.hls.latestLevelDetails;A&&this.updateDateRangeCues(A)}onMediaDetaching(A,B){this.media=null,B.transferMedia||(this.id3Track&&(this.removeCues&&«å(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(A){const B=this.getID3Track(A.textTracks);return B.mode="hidden",B}getID3Track(A){if(this.media){
for(let B=0;B<A.length;B++){const C=A[B];if("metadata"===C.kind&&"id3"===C.label)return «ä(C,this.media),C}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(A,B){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:C,enableID3MetadataCues:D}}}=this;if(!C&&!D)return;const{samples:E}=B;this.id3Track||(this.id3Track=this.createTrack(this.media));const F=«Æ();if(F)for(let A=0;A<E.length;A++){const B=E[A].type;if(B===“å.emsg&&!C||!D)continue;const G=∆ñ(E[A].data);if(G){
const C=E[A].pts;let D=C+E[A].duration;D>”Ø&&(D=”Ø),D-C<=0&&(D=C+.25);for(let A=0;A<G.length;A++){const E=G[A];if(!∆ó(E)){this.updateId3CueEnds(C,B);const A=«Ø(F,C,D,E,B);A&&this.id3Track.addCue(A)}}}}}updateId3CueEnds(A,B){var C;const D=null==(C=this.id3Track)?void 0:C.cues;if(D)for(let C=D.length;C--;){const E=D[C];E.type===B&&E.startTime<A&&E.endTime===”Ø&&(E.endTime=A)}}onBufferFlushing(A,{startOffset:B,endOffset:C,type:D}){const{id3Track:E,hls:F}=this;if(!F)return
;const{config:{enableEmsgMetadataCues:G,enableID3MetadataCues:H}}=F;if(E&&(G||H)){let A;A="audio"===D?A=>A.type===“å.audioId3&&H:"video"===D?A=>A.type===“å.emsg&&G:A=>A.type===“å.audioId3&&H||A.type===“å.emsg&&G,«ç(E,B,C,A)}}onLevelUpdated(A,{details:B}){this.updateDateRangeCues(B,!0)}onLevelPtsUpdated(A,B){Math.abs(B.drift)>.01&&this.updateDateRangeCues(B.details)}updateDateRangeCues(A,B){var C,D,E;if(!this.media||!A.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return
;const{id3Track:F}=this,{dateRanges:G}=A,H=Object.keys(G);let I=this.dateRangeCuesAppended;if(F&&B)if(null!=(C=F.cues)&&C.length){const A=Object.keys(I).filter((A=>!H.includes(A)));for(let B=A.length;B--;){const C=A[B],D=I[C].cues;delete I[C],Object.keys(D).forEach((A=>{try{const B=D[A];B.removeEventListener("enter",this.onEventCueEnter),F.removeCue(B)}catch(A){}}))}}else I=this.dateRangeCuesAppended={};const J=A.fragments[A.fragments.length-1]
;if(0===H.length||!–∂(null==J?void 0:J.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const K=«Æ();for(let A=0;A<H.length;A++){const B=H[A],C=G[B],F=C.startTime,J=I[B],L=(null==J?void 0:J.cues)||{};let M=(null==J?void 0:J.durationKnown)||!1,N=”Ø;const{duration:O,endDate:P}=C;if(P&&null!==O)N=F+O,M=!0;else if(C.endOnNext&&!M){const A=H.reduce(((A,B)=>{if(B!==C.id){const D=G[B];if(D.class===C.class&&D.startDate>C.startDate&&(!A||C.startDate<A.startDate))return D}
return A}),null);A&&(N=A.startTime,M=!0)}const Q=Object.keys(C.attr);for(let A=0;A<Q.length;A++){const G=Q[A];if("ID"===(E=G)||"CLASS"===E||"CUE"===E||"START-DATE"===E||"DURATION"===E||"END-DATE"===E||"END-ON-NEXT"===E)continue;const H=L[G];if(H)M&&!J.durationKnown?H.endTime=N:Math.abs(H.startTime-F)>.01&&(H.startTime=F,H.endTime=N);else if(K){let A=C.attr[G];≈û(G)&&(D=A,A=Uint8Array.from(D.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer)
;const E=«Ø(K,F,N,{key:G,data:A},“å.dateRange);E&&(E.id=B,this.id3Track.addCue(E),L[G]=E,this.hls.config.interstitialsController&&("X-ASSET-LIST"!==G&&"X-ASSET-URL"!==G||E.addEventListener("enter",this.onEventCueEnter)))}}I[B]={cues:L,dateRange:C,durationKnown:M}}}}class ”±{constructor(A){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:A}=this,B=this.levelDetails
;if(!A||!B)return;this.currentTime=A.currentTime;const C=this.computeLatency();if(null===C)return;this._latency=C;const{lowLatencyMode:D,maxLiveSyncPlaybackRate:E}=this.config;if(!D||1===E||!B.live)return;const F=this.targetLatency;if(null===F)return;const G=C-F;if(G<Math.min(this.maxLatency,F+B.targetduration)&&G>.05&&this.forwardBufferLength>1){const B=Math.min(2,Math.max(1,E)),C=Math.round(2/(1+Math.exp(-.75*G-this.edgeStalled))*20)/20,D=Math.min(B,Math.max(1,C))
;this.changeMediaPlaybackRate(A,D)}else 1!==A.playbackRate&&0!==A.playbackRate&&this.changeMediaPlaybackRate(A,1)},this.hls=A,this.config=A.config,this.registerListeners()}get levelDetails(){var A;return(null==(A=this.hls)?void 0:A.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:A}=this;if(void 0!==A.liveMaxLatencyDuration)return A.liveMaxLatencyDuration;const B=this.levelDetails;return B?A.liveMaxLatencyDurationCount*B.targetduration:0}
get targetLatency(){const A=this.levelDetails;if(null===A||null===this.hls)return null;const{holdBack:B,partHoldBack:C,targetduration:D}=A,{liveSyncDuration:E,liveSyncDurationCount:F,lowLatencyMode:G}=this.config,H=this.hls.userConfig;let I=G&&C||B;(this._targetLatencyUpdated||H.liveSyncDuration||H.liveSyncDurationCount||0===I)&&(I=void 0!==E?E:F*D);const J=D;return I+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,J)}set targetLatency(A){this.stallCount=0,
this.config.liveSyncDuration=A,this._targetLatencyUpdated=!0}get liveSyncPosition(){const A=this.estimateLiveEdge(),B=this.targetLatency;if(null===A||null===B)return null;const C=this.levelDetails;if(null===C)return null;const D=C.edge,E=A-B-this.edgeStalled,F=D-C.totalduration,G=D-(this.config.lowLatencyMode&&C.partTarget||C.targetduration);return Math.min(Math.max(F,E),G)}get drift(){const A=this.levelDetails;return null===A?1:A.drift}get edgeStalled(){const A=this.levelDetails
;if(null===A)return 0;const B=3*(this.config.lowLatencyMode&&A.partTarget||A.targetduration);return Math.max(A.age-B,0)}get forwardBufferLength(){const{media:A}=this,B=this.levelDetails;if(!A||!B)return 0;const C=A.buffered.length;return(C?A.buffered.end(C-1):B.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:A}=this;A&&(A.on(–ª.MEDIA_ATTACHED,this.onMediaAttached,this),
A.on(–ª.MEDIA_DETACHING,this.onMediaDetaching,this),A.on(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.on(–ª.LEVEL_UPDATED,this.onLevelUpdated,this),A.on(–ª.ERROR,this.onError,this))}unregisterListeners(){const{hls:A}=this;A&&(A.off(–ª.MEDIA_ATTACHED,this.onMediaAttached,this),A.off(–ª.MEDIA_DETACHING,this.onMediaDetaching,this),A.off(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.off(–ª.LEVEL_UPDATED,this.onLevelUpdated,this),A.off(–ª.ERROR,this.onError,this))}onMediaAttached(A,B){
this.media=B.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(A,{details:B}){B.advanced&&this.onTimeupdate(),!B.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(A,B){var C;B.details===–∫.BUFFER_STALLED_ERROR&&(this.stallCount++,
this.hls&&null!=(C=this.levelDetails)&&C.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(A,B){var C,D;A.playbackRate!==B&&(null==(C=this.hls)||C.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${null==(D=this.targetLatency)?void 0:D.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${A.playbackRate} to ${B}`),A.playbackRate=B)}
estimateLiveEdge(){const A=this.levelDetails;return null===A?null:A.edge+A.age}computeLatency(){const A=this.estimateLiveEdge();return null===A?null:A-this.currentTime}}class ”≤ extends “´{constructor(A,B){super(A,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=B,this._registerListeners()}
_registerListeners(){const{hls:A}=this;A.on(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.on(–ª.MANIFEST_LOADED,this.onManifestLoaded,this),A.on(–ª.LEVEL_LOADED,this.onLevelLoaded,this),A.on(–ª.LEVELS_UPDATED,this.onLevelsUpdated,this),A.on(–ª.FRAG_BUFFERED,this.onFragBuffered,this),A.on(–ª.ERROR,this.onError,this)}_unregisterListeners(){const{hls:A}=this;A.off(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.off(–ª.MANIFEST_LOADED,this.onManifestLoaded,this),
A.off(–ª.LEVEL_LOADED,this.onLevelLoaded,this),A.off(–ª.LEVELS_UPDATED,this.onLevelsUpdated,this),A.off(–ª.FRAG_BUFFERED,this.onFragBuffered,this),A.off(–ª.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach((A=>{A.loadError=0,A.fragmentError=0})),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],
this._maxAutoLevel=-1}onManifestLoading(A,B){this.resetLevels()}onManifestLoaded(A,B){const C=this.hls.config.preferManagedMediaSource,D=[],E={},F={};let G=!1,H=!1,I=!1;B.levels.forEach((A=>{const B=A.attrs;let{audioCodec:J,videoCodec:K}=A;J&&(A.audioCodec=J=ƒ∏(J,C)||void 0),K&&(K=A.videoCodec=function(A){const B=A.split(",");for(let A=0;A<B.length;A++){const C=B[A].split(".");C.length>2&&"avc1"===C[0]&&(B[A]=`avc1.${parseInt(C[1]).toString(16)}${("000"+parseInt(C[2]).toString(16)).slice(-4)}`)}
return B.join(",")}(K));const{width:L,height:M,unknownCodecs:N}=A;let O=N?N.length:0;if(N)for(let B=O;B--;){const C=N[B];this.isAudioSupported(C)?(A.audioCodec=J=J?`${J},${C}`:C,O--,—å.audio[J.substring(0,4)]=2):this.isVideoSupported(C)&&(A.videoCodec=K=K?`${K},${C}`:C,O--,—å.video[K.substring(0,4)]=2)}if(G||(G=!(!L||!M)),H||(H=!!K),I||(I=!!J),O||J&&!this.isAudioSupported(J)||K&&!this.isVideoSupported(K))return void this.log(`Some or all CODECS not supported "${B.CODECS}"`)
;const{CODECS:P,"FRAME-RATE":Q,"HDCP-LEVEL":R,"PATHWAY-ID":S,RESOLUTION:T,"VIDEO-RANGE":U}=B,V=`${(S||".")+"-"}${A.bitrate}-${T}-${Q}-${P}-${U}-${R}`;if(E[V])if(E[V].uri===A.url||A.attrs["PATHWAY-ID"])E[V].addGroupId("audio",B.AUDIO),E[V].addGroupId("text",B.SUBTITLES);else{const B=F[V]+=1;A.attrs["PATHWAY-ID"]=Array(B+1).join(".");const C=this.createLevel(A);E[V]=C,D.push(C)}else{const B=this.createLevel(A);E[V]=B,F[V]=1,D.push(B)}})),this.filterAndSortMediaOptions(D,B,G,H,I)}createLevel(A){
const B=new —î(A),C=A.supplemental;if(null!=C&&C.videoCodec&&!this.isVideoSupported(C.videoCodec)){const A=Error(`SUPPLEMENTAL-CODECS not supported "${C.videoCodec}"`);this.log(A.message),B.supportedResult=ƒΩ(A,[])}return B}isAudioSupported(A){return ƒ≥(A,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(A){return ƒ≥(A,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(A,B,C,D,E){let F=[],G=[],H=A
;if((C||D)&&E&&(H=H.filter((({videoCodec:A,videoRange:B,width:C,height:D})=>(!!A||!(!C||!D))&&function(A){return!!A&&—í.indexOf(A)>-1}(B)))),0===H.length)return void Promise.resolve().then((()=>{if(this.hls){let A="no level with compatible codecs found in manifest",C=A;B.levels.length&&(C="one or more CODECS in variant not supported: "+—ï(B.levels.map((A=>A.attrs.CODECS)).filter(((A,B,C)=>C.indexOf(A)===B))),this.warn(C),A+=` (${C})`);const D=Error(A);this.hls.trigger(–ª.ERROR,{type:–π.MEDIA_ERROR,
details:–∫.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:B.url,error:D,reason:C})}}));B.audioTracks&&(F=B.audioTracks.filter((A=>!A.audioCodec||this.isAudioSupported(A.audioCodec))),«∞(F)),B.subtitles&&(G=B.subtitles,«∞(G));const I=H.slice(0);H.sort(((A,B)=>{if(A.attrs["HDCP-LEVEL"]!==B.attrs["HDCP-LEVEL"])return(A.attrs["HDCP-LEVEL"]||"")>(B.attrs["HDCP-LEVEL"]||"")?1:-1;if(C&&A.height!==B.height)return A.height-B.height;if(A.frameRate!==B.frameRate)return A.frameRate-B.frameRate
;if(A.videoRange!==B.videoRange)return —í.indexOf(A.videoRange)-—í.indexOf(B.videoRange);if(A.videoCodec!==B.videoCodec){const C=ƒ∂(A.videoCodec),D=ƒ∂(B.videoCodec);if(C!==D)return D-C}if(A.uri===B.uri&&A.codecSet!==B.codecSet){const C=ƒ∑(A.codecSet),D=ƒ∑(B.codecSet);if(C!==D)return D-C}return A.averageBitrate!==B.averageBitrate?A.averageBitrate-B.averageBitrate:0}));let J=I[0];if(this.steering&&(H=this.steering.filterParsedLevels(H),
H.length!==I.length))for(let A=0;A<I.length;A++)if(I[A].pathwayId===H[0].pathwayId){J=I[A];break}this._levels=H;for(let A=0;A<H.length;A++)if(H[A]===J){var K;this._firstLevel=A;const B=J.bitrate,C=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${H.length} level(s) found, first bitrate: ${B}`),void 0===(null==(K=this.hls.userConfig)?void 0:K.abrEwmaDefaultEstimate)){const A=Math.min(B,this.hls.config.abrEwmaDefaultEstimateMax)
;A>C&&C===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=A)}break}const L=E&&!D,M=this.hls.config,N=!(!M.audioStreamController||!M.audioTrackController),O={levels:H,audioTracks:F,subtitleTracks:G,sessionData:B.sessionData,sessionKeys:B.sessionKeys,firstLevel:this._firstLevel,stats:B.stats,audio:E,video:D,altAudio:N&&!L&&F.some((A=>!!A.url))};this.hls.trigger(–ª.MANIFEST_PARSED,O)}get levels(){return 0===this._levels.length?null:this._levels}get loadLevelObj(){
return this.currentLevel}get level(){return this.currentLevelIndex}set level(A){const B=this._levels;if(0===B.length)return;if(A<0||A>=B.length){const C=Error("invalid level idx"),D=A<0;if(this.hls.trigger(–ª.ERROR,{type:–π.OTHER_ERROR,details:–∫.LEVEL_SWITCH_ERROR,level:A,fatal:D,error:C,reason:C.message}),D)return;A=Math.min(A,B.length-1)}const C=this.currentLevelIndex,D=this.currentLevel,E=D?D.attrs["PATHWAY-ID"]:void 0,F=B[A],G=F.attrs["PATHWAY-ID"];if(this.currentLevelIndex=A,
this.currentLevel=F,C===A&&D&&E===G)return;this.log(`Switching to level ${A} (${F.height?F.height+"p ":""}${F.videoRange?F.videoRange+" ":""}${F.codecSet?F.codecSet+" ":""}@${F.bitrate})${G?" with Pathway "+G:""} from level ${C}${E?" with Pathway "+E:""}`);const H={level:A,attrs:F.attrs,details:F.details,bitrate:F.bitrate,averageBitrate:F.averageBitrate,maxBitrate:F.maxBitrate,realBitrate:F.realBitrate,width:F.width,height:F.height,codecSet:F.codecSet,audioCodec:F.audioCodec,
videoCodec:F.videoCodec,audioGroups:F.audioGroups,subtitleGroups:F.subtitleGroups,loaded:F.loaded,loadError:F.loadError,fragmentError:F.fragmentError,name:F.name,id:F.id,uri:F.uri,url:F.url,urlId:0,audioGroupIds:F.audioGroupIds,textGroupIds:F.textGroupIds};this.hls.trigger(–ª.LEVEL_SWITCHING,H);const I=F.details;if(!I||I.live){const A=this.switchParams(F.uri,null==D?void 0:D.details,I);this.loadPlaylist(A)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(A){this.manualLevelIndex=A,
void 0===this._startLevel&&(this._startLevel=A),-1!==A&&(this.level=A)}get firstLevel(){return this._firstLevel}set firstLevel(A){this._firstLevel=A}get startLevel(){if(void 0===this._startLevel){const A=this.hls.config.startLevel;return void 0!==A?A:this.hls.firstAutoLevel}return this._startLevel}set startLevel(A){this._startLevel=A}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}
set pathwayPriority(A){if(this.steering){const B=this.steering.pathways(),C=A.filter((A=>-1!==B.indexOf(A)));if(A.length<1)return void this.warn(`pathwayPriority ${A} should contain at least one pathway from list: ${B}`);this.steering.pathwayPriority=C}}onError(A,B){!B.fatal&&B.context&&B.context.type===»≤&&B.context.level===this.level&&this.checkRetry(B)}onFragBuffered(A,{frag:B}){if(void 0!==B&&B.type===»µ){const A=B.elementaryStreams;if(!Object.keys(A).some((B=>!!A[B])))return
;const C=this._levels[B.level];null!=C&&C.loadError&&(this.log(`Resetting level error count of ${C.loadError} on frag buffered`),C.loadError=0)}}onLevelLoaded(A,B){var C,D;const{level:E,details:F}=B,G=B.levelInfo;if(!G)return this.warn("Invalid level index "+E),void(null!=(D=B.deliveryDirectives)&&D.skip&&(F.deltaUpdateFailed=!0));if(G===this.currentLevel||B.withoutMultiVariant){0===G.fragmentError&&(G.loadError=0);let A=G.details;A===B.details&&A.advanced&&(A=void 0),this.playlistLoaded(E,B,A)
}else null!=(C=B.deliveryDirectives)&&C.skip&&(F.deltaUpdateFailed=!0)}loadPlaylist(A){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,A)}loadingPlaylist(A,B){super.loadingPlaylist(A,B);const C=this.getUrlWithDirectives(A.uri,B),D=this.currentLevelIndex,E=A.attrs["PATHWAY-ID"],F=A.details,G=null==F?void 0:F.age
;this.log(`Loading level index ${D}${void 0!==(null==B?void 0:B.msn)?" at sn "+B.msn+" part "+B.part:""}${E?" Pathway "+E:""}${G&&F.live?" age "+G.toFixed(1)+(F.type?" "+F.type||0:""):""} ${C}`),this.hls.trigger(–ª.LEVEL_LOADING,{url:C,level:D,levelInfo:A,pathwayId:A.attrs["PATHWAY-ID"],id:0,deliveryDirectives:B||null})}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(A){this.level=A,
-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=A)}removeLevel(A){var B;if(1===this._levels.length)return;const C=this._levels.filter(((B,C)=>C!==A||(this.steering&&this.steering.removeLevel(B),B===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,B.details&&B.details.fragments.forEach((A=>A.level=-1))),!1)));≈æ(C),this._levels=C,this.currentLevelIndex>-1&&null!=(B=this.currentLevel)&&B.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),
this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const D=C.length-1;this._firstLevel=Math.min(this._firstLevel,D),this._startLevel&&(this._startLevel=Math.min(this._startLevel,D)),this.hls.trigger(–ª.LEVELS_UPDATED,{levels:C})}onLevelsUpdated(A,{levels:B}){this._levels=B}checkMaxAutoUpdated(){const{autoLevelCapping:A,maxAutoLevel:B,maxHdcpLevel:C}=this.hls;this._maxAutoLevel!==B&&(this._maxAutoLevel=B,this.hls.trigger(–ª.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:A,
levels:this.levels,maxAutoLevel:B,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:C}))}}class ”≥ extends “Ä{constructor(A,B,C){super(A,B,C,"stream-controller",»µ),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{
const A=this.media,B=A?A.currentTime:null;if(null===B||!–∂(B))return;if(this.log("Media seeked to "+B.toFixed(3)),!this.getBufferedFrag(B))return;const C=this.getFwdBufferInfoAtPos(A,B,»µ,0);null!==C&&0!==C.len?this.tick():this.warn(`Main forward buffer length at ${B} on "seeked" event ${C?C.len:"empty"})`)},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:A}=this;A.on(–ª.MANIFEST_PARSED,this.onManifestParsed,this),A.on(–ª.LEVEL_LOADING,this.onLevelLoading,this),
A.on(–ª.LEVEL_LOADED,this.onLevelLoaded,this),A.on(–ª.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),A.on(–ª.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),A.on(–ª.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),A.on(–ª.BUFFER_CREATED,this.onBufferCreated,this),A.on(–ª.BUFFER_FLUSHED,this.onBufferFlushed,this),A.on(–ª.LEVELS_UPDATED,this.onLevelsUpdated,this),A.on(–ª.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners()
;const{hls:A}=this;A.off(–ª.MANIFEST_PARSED,this.onManifestParsed,this),A.off(–ª.LEVEL_LOADED,this.onLevelLoaded,this),A.off(–ª.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),A.off(–ª.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),A.off(–ª.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),A.off(–ª.BUFFER_CREATED,this.onBufferCreated,this),A.off(–ª.BUFFER_FLUSHED,this.onBufferFlushed,this),A.off(–ª.LEVELS_UPDATED,this.onLevelsUpdated,this),
A.off(–ª.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(A,B){if(this.levels){const{lastCurrentTime:C,hls:D}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let A=D.startLevel;-1===A&&(D.config.testBandwidth&&this.levels.length>1?(A=0,this.bitrateTest=!0):A=D.firstAutoLevel),D.nextLoadLevel=A,this.level=D.loadLevel,
this._hasEnoughToStart=!!B}C>0&&-1===A&&!B&&(this.log("Override startPosition with lastCurrentTime @"+C.toFixed(3)),A=C),this.state=—µ,this.nextLoadPosition=this.lastCurrentTime=A+this.timelineOffset,this.startPosition=B?-1:A,this.tick()}else this._forceStartLoad=!0,this.state=—¥}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case —ø:{const{levels:A,level:B}=this,C=null==A?void 0:A[B],D=null==C?void 0:C.details
;if(D&&(!D.live||this.levelLastLoaded===C&&!this.waitForLive(C))){if(this.waitForCdnTuneIn(D))break;this.state=—µ;break}if(this.hls.nextLoadLevel!==this.level){this.state=—µ;break}break}case —∏:{var A;const B=self.performance.now(),C=this.retryDate;if(!C||B>=C||null!=(A=this.media)&&A.seeking){const{levels:A,level:B}=this,C=null==A?void 0:A[B];this.resetStartWhenNotLoaded(C||null),this.state=—µ}}}this.state===—µ&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var A;super.onTickEnd(),
null!=(A=this.media)&&A.readyState&&!1===this.media.seeking&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:A,levelLastLoaded:B,levels:C,media:D}=this;if(null===B||!D&&!this.primaryPrefetch&&(this.startFragRequested||!A.config.startFragPrefetch))return;if(this.altAudio&&this.audioOnly)return;const E=this.buffering?A.nextLoadLevel:A.loadLevel;if(null==C||!C[E])return;const F=C[E],G=this.getMainFwdBufferInfo();if(null===G)return
;const H=this.getLevelDetails();if(H&&this._streamEnded(G,H)){const A={};return 2===this.altAudio&&(A.type="video"),this.hls.trigger(–ª.BUFFER_EOS,A),void(this.state=—º)}if(!this.buffering)return;A.loadLevel!==E&&-1===A.manualLevel&&this.log(`Adapting to level ${E} from level ${this.level}`),this.level=A.nextLoadLevel=E;const I=F.details;if(!I||this.state===—ø||this.waitForLive(F))return this.level=E,this.state=—ø,void(this.startFragRequested=!1);const J=G.len,K=this.getMaxBufferLength(F.maxBitrate)
;if(J>=K)return;this.backtrackFragment&&this.backtrackFragment.start>G.end&&(this.backtrackFragment=null);const L=this.backtrackFragment?this.backtrackFragment.start:G.end;let M=this.getNextFragment(L,I);if(this.couldBacktrack&&!this.fragPrevious&&M&&ƒò(M)&&this.fragmentTracker.getState(M)!==…ã){var N;const A=(null!=(N=this.backtrackFragment)?N:M).sn-I.startSN,B=I.fragments[A-1];B&&M.cc===B.cc&&(M=B,this.fragmentTracker.removeFragment(B))
}else this.backtrackFragment&&G.len&&(this.backtrackFragment=null);if(M&&this.isLoopLoading(M,L)){if(!M.gap){const A=this.audioOnly&&!this.altAudio?»ª:»º,B=(A===»º?this.videoBuffer:this.mediaBuffer)||this.media;B&&this.afterBufferFlushed(B,A,»µ)}M=this.getNextFragmentLoopLoading(M,I,G,»µ,K)}M&&(!M.initSegment||M.initSegment.data||this.bitrateTest||(M=M.initSegment),this.loadFragment(M,F,L))}loadFragment(A,B,C){const D=this.fragmentTracker.getState(A)
;D===…à||D===…ä?ƒò(A)?this.bitrateTest?(this.log(`Fragment ${A.sn} of level ${A.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(A,B)):super.loadFragment(A,B,C):this._loadInitSegment(A,B):this.clearTrackerIfNeeded(A)}getBufferedFrag(A){return this.fragmentTracker.getBufferedFrag(A,»µ)}followingBufferedFrag(A){return A?this.getBufferedFrag(A.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,1/0)}nextLevelSwitch(){
const{levels:A,media:B}=this;if(null!=B&&B.readyState){let C;const D=this.getAppendedFrag(B.currentTime);D&&D.start>1&&this.flushMainBuffer(0,D.start-1);const E=this.getLevelDetails();if(null!=E&&E.live){const A=this.getMainFwdBufferInfo();if(!A||A.len<2*E.targetduration)return}if(!B.paused&&A){const B=A[this.hls.nextLoadLevel],D=this.fragLastKbps;C=D&&this.fragCurrent?this.fragCurrent.duration*B.maxBitrate/(1e3*D)+1:0}else C=0;const F=this.getBufferedFrag(B.currentTime+C);if(F){
const A=this.followingBufferedFrag(F);if(A){this.abortCurrentFrag();const B=A.maxStartPTS?A.maxStartPTS:A.start,C=A.duration,D=Math.max(F.end,B+Math.min(Math.max(C-this.config.maxFragLookUpTolerance,C*(this.couldBacktrack?.5:.125)),C*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(D,1/0)}}}}abortCurrentFrag(){const A=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,A&&(A.abortRequests(),this.fragmentTracker.removeFragment(A)),this.state){case —∂:case —∑:case —∏:case —∫:
case —ª:this.state=—µ}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(A,B){super.flushMainBuffer(A,B,2===this.altAudio?"video":null)}onMediaAttached(A,B){super.onMediaAttached(A,B);const C=B.media;«à(C,"playing",this.onMediaPlaying),«à(C,"seeked",this.onMediaSeeked)}onMediaDetaching(A,B){const{media:C}=this;C&&(«â(C,"playing",this.onMediaPlaying),«â(C,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(A,B),
B.transferMedia||(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(–ª.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(A,B){let C=!1,D=!1;B.levels.forEach((A=>{const B=A.audioCodec;B&&(C=C||-1!==B.indexOf("mp4a.40.2"),D=D||-1!==B.indexOf("mp4a.40.5"))})),this.audioCodecSwitch=C&&D&&!function(){var A;const B=«±()
;return"function"==typeof(null==B||null==(A=B.prototype)?void 0:A.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=B.levels,this.startFragRequested=!1}onLevelLoading(A,B){const{levels:C}=this;if(!C||this.state!==—µ)return;const D=B.levelInfo;(!D.details||D.details.live&&(this.levelLastLoaded!==D||D.details.expired)||this.waitForCdnTuneIn(D.details))&&(this.state=—ø)}onLevelLoaded(A,B){var C,D
;const{levels:E,startFragRequested:F}=this,G=B.level,H=B.details,I=H.totalduration;if(!E)return void this.warn("Levels were reset while loading level "+G);this.log(`Level ${G} loaded [${H.startSN},${H.endSN}]${H.lastPartSn?`[part-${H.lastPartSn}-${H.lastPartIndex}]`:""}, cc [${H.startCC}, ${H.endCC}] duration:${I}`);const J=B.levelInfo,K=this.fragCurrent;!K||this.state!==—∑&&this.state!==—∏||K.level!==B.level&&K.loader&&this.abortCurrentFrag();let L=0;if(H.live||null!=(C=J.details)&&C.live){
if(this.checkLiveUpdate(H),H.deltaUpdateFailed)return;L=this.alignPlaylists(H,J.details,null==(D=this.levelLastLoaded)?void 0:D.details)}if(J.details=H,this.levelLastLoaded=J,F||this.setStartPosition(H,L),this.hls.trigger(–ª.LEVEL_UPDATED,{details:H,level:G}),this.state===—ø){if(this.waitForCdnTuneIn(H))return;this.state=—µ}F&&H.live&&this.synchronizeToLiveEdge(H),this.tick()}synchronizeToLiveEdge(A){const{config:B,media:C}=this;if(!C)return
;const D=this.hls.liveSyncPosition,E=this.getLoadPosition(),F=A.fragmentStart,G=A.edge,H=E>=F-B.maxFragLookUpTolerance&&E<=G;if(null!==D&&C.duration>D&&(E<D||!H)){const F=void 0!==B.liveMaxLatencyDuration?B.liveMaxLatencyDuration:B.liveMaxLatencyDurationCount*A.targetduration;if((!H&&C.readyState<4||E<G-F)&&(this._hasEnoughToStart||(this.nextLoadPosition=D),
C.readyState))if(this.warn(`Playback: ${E.toFixed(3)} is located too far from the end of live sliding playlist: ${G}, reset currentTime to : ${D.toFixed(3)}`),"buffered"===this.config.liveSyncMode){var I;const A=—¢.bufferInfo(C,D,0);if(null==A||null==(I=A.buffered)||!I.length)return void(C.currentTime=D);if(A.start<=E)return void(C.currentTime=D);const{nextStart:B}=—¢.bufferedInfo(A.buffered,E,0);B&&(C.currentTime=B)}else C.currentTime=D}}_handleFragmentLoadProgress(A){var B
;const C=A.frag,{part:D,payload:E}=A,{levels:F}=this;if(!F)return void this.warn(`Levels were reset while fragment load was in progress. Fragment ${C.sn} of level ${C.level} will not be buffered`);const G=F[C.level];if(!G)return void this.warn(`Level ${C.level} not found on progress`);const H=G.details;if(!H)return this.warn(`Dropping fragment ${C.sn} of level ${C.level} after level details were reset`),void this.fragmentTracker.removeFragment(C)
;const I=G.videoCodec,J=H.PTSKnown||!H.live,K=null==(B=C.initSegment)?void 0:B.data,L=this._getAudioCodec(G),M=this.transmuxer=this.transmuxer||new “™(this.hls,»µ,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),N=D?D.index:-1,O=-1!==N,P=new —†(C.level,C.sn,C.stats.chunkCount,E.byteLength,N,O),Q=this.initPTS[C.cc];M.push(E,K,L,I,C,D,H.totalduration,J,P,Q)}onAudioTrackSwitching(A,B){const C=this.hls,D=2===this.altAudio;if(≈ä(B.url,C))this.altAudio=1;else{
if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const A=this.fragCurrent;A&&(this.log("Switching to main audio track, cancel main fragment load"),A.abortRequests(),this.fragmentTracker.removeFragment(A)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(D)return this.fragmentTracker.removeAllFragments(),C.once(–ª.BUFFER_FLUSHED,(()=>{var A
;null==(A=this.hls)||A.trigger(–ª.AUDIO_TRACK_SWITCHED,B)})),void C.trigger(–ª.BUFFER_FLUSHING,{startOffset:0,endOffset:1/0,type:null});C.trigger(–ª.AUDIO_TRACK_SWITCHED,B)}}onAudioTrackSwitched(A,B){const C=≈ä(B.url,this.hls);if(C){const A=this.videoBuffer;A&&this.mediaBuffer!==A&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=A)}this.altAudio=C?2:0,this.tick()}onBufferCreated(A,B){const C=B.tracks;let D,E,F=!1;for(const A in C){
const B=C[A];if("main"===B.id){if(E=A,D=B,"video"===A){const B=C[A];B&&(this.videoBuffer=B.buffer)}}else F=!0}F&&D?(this.log(`Alternate track found, use ${E}.buffered to schedule main fragment loading`),this.mediaBuffer=D.buffer):this.mediaBuffer=this.media}onFragBuffered(A,B){const{frag:C,part:D}=B,E=C.type===»µ;if(E){if(this.fragContextChanged(C))return this.warn(`Fragment ${C.sn}${D?" p: "+D.index:""} of level ${C.level} finished buffering, but was aborted. state: ${this.state}`),
void(this.state===—ª&&(this.state=—µ));const A=D?D.stats:C.stats;this.fragLastKbps=Math.round(8*A.total/(A.buffering.end-A.loading.first)),ƒò(C)&&(this.fragPrevious=C),this.fragBufferedComplete(C,D)}const F=this.media;F&&(!this._hasEnoughToStart&&—¢.getBuffered(F).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),E&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(A,B){var C;if(B.fatal)this.state=—Ω;else switch(B.details){case –∫.FRAG_GAP:case –∫.FRAG_PARSING_ERROR:
case –∫.FRAG_DECRYPT_ERROR:case –∫.FRAG_LOAD_ERROR:case –∫.FRAG_LOAD_TIMEOUT:case –∫.KEY_LOAD_ERROR:case –∫.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(»µ,B);break;case –∫.LEVEL_LOAD_ERROR:case –∫.LEVEL_LOAD_TIMEOUT:case –∫.LEVEL_PARSING_ERROR:B.levelRetry||this.state!==—ø||(null==(C=B.context)?void 0:C.type)!==»≤||(this.state=—µ);break;case –∫.BUFFER_ADD_CODEC_ERROR:case –∫.BUFFER_APPEND_ERROR:if("main"!==B.parent)return;this.resetLoadingState();break;case –∫.BUFFER_FULL_ERROR:if("main"!==B.parent)return
;this.reduceLengthAndFlushBuffer(B)&&this.flushMainBuffer(0,1/0);break;case –∫.INTERNAL_EXCEPTION:this.recoverWorkerError(B)}}onFragLoadEmergencyAborted(){this.state=—µ,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(A,{type:B}){if(B!==»ª||!this.altAudio){const A=(B===»º?this.videoBuffer:this.mediaBuffer)||this.media;A&&(this.afterBufferFlushed(A,B,»µ),this.tick())}}onLevelsUpdated(A,B){
this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,-1===this.level&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=B.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:A}=this;if(!A)return;const B=A.currentTime;let C=this.startPosition;if(C>=0&&B<C){if(A.seeking)return void this.log(`could not seek to ${C}, already seeking at ${B}`);const D=this.timelineOffset;D&&C&&(C+=D)
;const E=this.getLevelDetails(),F=—¢.getBuffered(A),G=F.length?F.start(0):0,H=G-C,I=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||H>0&&(H<I||this.loadingParts&&H<2*((null==E?void 0:E.partTarget)||0)))&&(this.log(`adjusting start position by ${H} to match buffer start`),C+=H,this.startPosition=C),B<C&&(this.log(`seek to target start position ${C} from current time ${B} buffer start ${G}`),A.currentTime=C)}}_getAudioCodec(A){
let B=this.config.defaultAudioCodec||A.audioCodec;return this.audioCodecSwap&&B&&(this.log("Swapping audio codec"),B=-1!==B.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),B}_loadBitrateTestFrag(A,B){A.bitrateTest=!0,this._doFragLoad(A,B).then((A=>{const{hls:C}=this,D=null==A?void 0:A.frag;if(!D||this.fragContextChanged(D))return;B.fragmentError=0,this.state=—µ,this.startFragRequested=!1,this.bitrateTest=!1;const E=D.stats
;E.parsing.start=E.parsing.end=E.buffering.start=E.buffering.end=self.performance.now(),C.trigger(–ª.FRAG_LOADED,A),D.bitrateTest=!1}))}_handleTransmuxComplete(A){var B;const C=this.playlistType,{hls:D}=this,{remuxResult:E,chunkMeta:F}=A,G=this.getCurrentContext(F);if(!G)return void this.resetWhenMissingContext(F);const{frag:H,part:I,level:J}=G,{video:K,text:L,id3:M,initSegment:N}=E,{details:O}=J,P=this.altAudio?void 0:E.audio
;if(this.fragContextChanged(H))this.fragmentTracker.removeFragment(H);else{if(this.state=—∫,N){if(null!=N&&N.tracks){const A=H.initSegment||H;this._bufferInitSegment(J,N.tracks,A,F),D.trigger(–ª.FRAG_PARSING_INIT_SEGMENT,{frag:A,id:C,tracks:N.tracks})}const A=N.initPTS,B=N.timescale;–∂(A)&&(this.initPTS[H.cc]={baseTime:A,timescale:B},D.trigger(–ª.INIT_PTS_FOUND,{frag:H,id:C,initPTS:A,timescale:B}))}if(K&&O){P&&"audiovideo"===K.type&&this.logMuxedErr(H)
;const A=O.fragments[H.sn-1-O.startSN],B=H.sn===O.startSN,C=!A||H.cc>A.cc;if(!1!==E.independent){const{startPTS:A,endPTS:D,startDTS:E,endDTS:G}=K;if(I)I.elementaryStreams[K.type]={startPTS:A,endPTS:D,startDTS:E,endDTS:G};else if(K.firstKeyFrame&&K.independent&&1===F.id&&!C&&(this.couldBacktrack=!0),K.dropped&&K.independent){const E=this.getMainFwdBufferInfo(),F=(E?E.end:this.getLoadPosition())+this.config.maxBufferHole,I=K.firstKeyFramePTS?K.firstKeyFramePTS:A
;if(!B&&F<I-this.config.maxBufferHole&&!C)return void this.backtrack(H);C&&(H.gap=!0),H.setElementaryStreamInfo(K.type,H.start,D,H.start,G,!0)}else B&&A-(O.appliedTimelineOffset||0)>2&&(H.gap=!0);H.setElementaryStreamInfo(K.type,A,D,E,G),this.backtrackFragment&&(this.backtrackFragment=H),this.bufferFragmentData(K,H,I,F,B||C)}else{if(!B&&!C)return void this.backtrack(H);H.gap=!0}}if(P){const{startPTS:A,endPTS:B,startDTS:C,endDTS:D}=P;I&&(I.elementaryStreams[»ª]={startPTS:A,endPTS:B,startDTS:C,
endDTS:D}),H.setElementaryStreamInfo(»ª,A,B,C,D),this.bufferFragmentData(P,H,I,F)}if(O&&null!=M&&null!=(B=M.samples)&&B.length){const A={id:C,frag:H,details:O,samples:M.samples};D.trigger(–ª.FRAG_PARSING_METADATA,A)}if(O&&L){const A={id:C,frag:H,details:O,samples:L.samples};D.trigger(–ª.FRAG_PARSING_USERDATA,A)}}}logMuxedErr(A){this.warn(`${ƒò(A)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${A.url}`)}_bufferInitSegment(A,B,C,D){if(this.state!==—∫)return
;this.audioOnly=!!B.audio&&!B.video,this.altAudio&&!this.audioOnly&&(delete B.audio,B.audiovideo&&this.logMuxedErr(C));const{audio:E,video:F,audiovideo:G}=B;if(E){let C=ƒπ(E.codec,A.audioCodec);"mp4a"===C&&(C="mp4a.40.5");const D=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){C&&(C=-1!==C.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5");const A=E.metadata;A&&"channelCount"in A&&1!==(A.channelCount||1)&&-1===D.indexOf("firefox")&&(C="mp4a.40.5")}
C&&-1!==C.indexOf("mp4a.40.5")&&-1!==D.indexOf("android")&&"audio/mpeg"!==E.container&&(C="mp4a.40.2",this.log("Android: force audio codec to "+C)),A.audioCodec&&A.audioCodec!==C&&this.log(`Swapping manifest audio codec "${A.audioCodec}" for "${C}"`),E.levelCodec=C,E.id=»µ,this.log(`Init audio buffer, container:${E.container}, codecs[selected/level/parsed]=[${C||""}/${A.audioCodec||""}/${E.codec}]`),delete B.audiovideo}if(F){F.levelCodec=A.videoCodec,F.id=»µ;const C=F.codec
;if(4===(null==C?void 0:C.length))switch(C){case"hvc1":case"hev1":F.codec="hvc1.1.6.L120.90";break;case"av01":F.codec="av01.0.04M.08";break;case"avc1":F.codec="avc1.42e01e"}this.log(`Init video buffer, container:${F.container}, codecs[level/parsed]=[${A.videoCodec||""}/${C}]${F.codec!==C?" parsed-corrected="+F.codec:""}${F.supplemental?" supplemental="+F.supplemental:""}`),delete B.audiovideo}
G&&(this.log(`Init audiovideo buffer, container:${G.container}, codecs[level/parsed]=[${A.codecs}/${G.codec}]`),delete B.video,delete B.audio);const H=Object.keys(B);if(H.length){if(this.hls.trigger(–ª.BUFFER_CODECS,B),!this.hls)return;H.forEach((A=>{const E=B[A].initSegment;null!=E&&E.byteLength&&this.hls.trigger(–ª.BUFFER_APPENDING,{type:A,data:E,frag:C,part:null,chunkMeta:D,parent:C.type})}))}this.tickImmediate()}getMainFwdBufferInfo(){
const A=this.mediaBuffer&&2===this.altAudio?this.mediaBuffer:this.media;return this.getFwdBufferInfo(A,»µ)}get maxBufferLength(){const{levels:A,level:B}=this,C=null==A?void 0:A[B];return C?this.getMaxBufferLength(C.maxBitrate):this.config.maxBufferLength}backtrack(A){this.couldBacktrack=!0,this.backtrackFragment=A,this.resetTransmuxer(),this.flushBufferGap(A),this.fragmentTracker.removeFragment(A),this.fragPrevious=null,this.nextLoadPosition=A.start,this.state=—µ}checkFragmentChanged(){
const A=this.media;let B=null;if(A&&A.readyState>1&&!1===A.seeking){const C=A.currentTime;if(—¢.isBuffered(A,C)?B=this.getAppendedFrag(C):—¢.isBuffered(A,C+.1)&&(B=this.getAppendedFrag(C+.1)),B){this.backtrackFragment=null;const A=this.fragPlaying,C=B.level;A&&B.sn===A.sn&&A.level===C||(this.fragPlaying=B,this.hls.trigger(–ª.FRAG_CHANGED,{frag:B}),A&&A.level===C||this.hls.trigger(–ª.LEVEL_SWITCHED,{level:C}))}}}get nextLevel(){const A=this.nextBufferedFrag;return A?A.level:-1}get currentFrag(){var A
;if(this.fragPlaying)return this.fragPlaying;const B=(null==(A=this.media)?void 0:A.currentTime)||this.lastCurrentTime;return –∂(B)?this.getAppendedFrag(B):null}get currentProgramDateTime(){var A;const B=(null==(A=this.media)?void 0:A.currentTime)||this.lastCurrentTime;if(–∂(B)){const A=this.getLevelDetails(),C=this.currentFrag||(A?≈ã(null,A.fragments,B):null);if(C){const A=C.programDateTime;if(null!==A){const D=A+1e3*(B-C.start);return new Date(D)}}}return null}get currentLevel(){
const A=this.currentFrag;return A?A.level:-1}get nextBufferedFrag(){const A=this.currentFrag;return A?this.followingBufferedFrag(A):null}get forceStartLoad(){return this._forceStartLoad}}class ”¥{constructor(A){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=A}abort(A){for(const C in this.keyUriToKeyInfo){const D=this.keyUriToKeyInfo[C].loader;if(D){var B;if(A&&A!==(null==(B=D.context)?void 0:B.frag.type))return;D.abort()}}}detach(){
for(const A in this.keyUriToKeyInfo){const B=this.keyUriToKeyInfo[A];(B.mediaKeySessionContext||B.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[A]}}destroy(){this.detach();for(const A in this.keyUriToKeyInfo){const B=this.keyUriToKeyInfo[A].loader;B&&B.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(A,B=–∫.KEY_LOAD_ERROR,C,D,E){return new —û({type:–π.NETWORK_ERROR,details:B,fatal:!1,frag:A,response:E,error:C,networkDetails:D})}loadClear(A,B){
if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length)if(B.length){const{sn:C,cc:D}=A;for(let A=0;A<B.length;A++){const E=B[A];if(D<=E.cc&&("initSegment"===C||"initSegment"===E.sn||C<E.sn))return this.emeController.selectKeySystemFormat(E).then((A=>{if(E.setKeyFormat(A),this.emeController&&this.config.requireKeySystemAccessOnStart){const B=≈§(A);if(B)return this.emeController.getKeySystemAccess([B])}}))}
}else if(this.config.requireKeySystemAccessOnStart){const A=≈ß(this.config);if(A.length)return this.emeController.getKeySystemAccess(A)}return null}load(A){return!A.decryptdata&&A.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(A).then((B=>this.loadInternal(A,B))):this.loadInternal(A)}loadInternal(A,B){var C,D,E;B&&A.setKeyFormat(B);const F=A.decryptdata;if(!F){
const C=Error(B?"Expected frag.decryptdata to be defined after setting format "+B:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(A,–∫.KEY_LOAD_ERROR,C))}const G=F.uri;if(!G)return Promise.reject(this.createKeyLoadError(A,–∫.KEY_LOAD_ERROR,Error(`Invalid key URI: "${G}"`)));let H=this.keyUriToKeyInfo[G];if(null!=(C=H)&&C.decryptdata.key)return F.key=H.decryptdata.key,Promise.resolve({frag:A,keyInfo:H})
;if(null!=(D=H)&&D.keyLoadPromise)switch(null==(E=H.mediaKeySessionContext)?void 0:E.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return H.keyLoadPromise.then((B=>(F.key=B.keyInfo.decryptdata.key,{frag:A,keyInfo:H})))}switch(H=this.keyUriToKeyInfo[G]={decryptdata:F,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},F.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":
return"identity"===F.keyFormat?this.loadKeyHTTP(H,A):this.loadKeyEME(H,A);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(H,A);default:return Promise.reject(this.createKeyLoadError(A,–∫.KEY_LOAD_ERROR,Error(`Key supplied with unsupported METHOD: "${F.method}"`)))}}loadKeyEME(A,B){const C={frag:B,keyInfo:A};if(this.emeController&&this.config.emeEnabled){const B=this.emeController.loadKey(C);if(B)return(A.keyLoadPromise=B.then((B=>(A.mediaKeySessionContext=B,C)))).catch((B=>{
throw A.keyLoadPromise=null,B}))}return Promise.resolve(C)}loadKeyHTTP(A,B){const C=this.config,D=new(0,C.loader)(C);return B.keyLoader=A.loader=D,A.keyLoadPromise=new Promise(((E,F)=>{const G={keyInfo:A,frag:B,responseType:"arraybuffer",url:A.decryptdata.uri},H=C.keyLoadPolicy.default,I={loadPolicy:H,timeout:H.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},J={onSuccess:(A,B,C,D)=>{const{frag:G,keyInfo:H,url:I}=C
;if(!G.decryptdata||H!==this.keyUriToKeyInfo[I])return F(this.createKeyLoadError(G,–∫.KEY_LOAD_ERROR,Error("after key load, decryptdata unset or changed"),D));H.decryptdata.key=G.decryptdata.key=new Uint8Array(A.data),G.keyLoader=null,H.loader=null,E({frag:G,keyInfo:H})},onError:(A,C,D)=>{this.resetLoader(C),F(this.createKeyLoadError(B,–∫.KEY_LOAD_ERROR,Error(`HTTP Error ${A.code} loading key ${A.text}`),D,ƒë({url:G.url,data:void 0},A)))},onTimeout:(A,C,D)=>{this.resetLoader(C),
F(this.createKeyLoadError(B,–∫.KEY_LOAD_TIMEOUT,Error("key loading timed out"),D))},onAbort:(A,C,D)=>{this.resetLoader(C),F(this.createKeyLoadError(B,–∫.INTERNAL_ABORTED,Error("key loading aborted"),D))}};D.load(G,I,J)}))}resetLoader(A){const{frag:B,keyInfo:C,url:D}=A,E=C.loader;B.keyLoader===E&&(B.keyLoader=null,C.loader=null),delete this.keyUriToKeyInfo[D],E&&E.destroy()}}class ”µ{constructor(A){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,
this.onManifestLoaded=this.checkAutostartLoad,this.hls=A,this.registerListeners()}startLoad(A){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:A}=this;A.on(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.on(–ª.LEVEL_LOADING,this.onLevelLoading,this),A.on(–ª.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),A.on(–ª.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),A.on(–ª.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:A}=this
;A.off(–ª.MANIFEST_LOADING,this.onManifestLoading,this),A.off(–ª.LEVEL_LOADING,this.onLevelLoading,this),A.off(–ª.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),A.off(–ª.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),A.off(–ª.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(A){const B=this.hls.config,C=B.pLoader,D=B.loader,E=new(C||D)(B);return this.loaders[A.type]=E,E}getInternalLoader(A){return this.loaders[A.type]}resetInternalLoader(A){
this.loaders[A]&&delete this.loaders[A]}destroyInternalLoaders(){for(const A in this.loaders){const B=this.loaders[A];B&&B.destroy(),this.resetInternalLoader(A)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(A,B){const{url:C}=B;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:»±,url:C,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(A,B){
const{id:C,level:D,pathwayId:E,url:F,deliveryDirectives:G,levelInfo:H}=B;this.load({id:C,level:D,pathwayId:E,responseType:"text",type:»≤,url:F,deliveryDirectives:G,levelOrTrack:H})}onAudioTrackLoading(A,B){const{id:C,groupId:D,url:E,deliveryDirectives:F,track:G}=B;this.load({id:C,groupId:D,level:null,responseType:"text",type:»≥,url:E,deliveryDirectives:F,levelOrTrack:G})}onSubtitleTrackLoading(A,B){const{id:C,groupId:D,url:E,deliveryDirectives:F,track:G}=B;this.load({id:C,groupId:D,level:null,
responseType:"text",type:»¥,url:E,deliveryDirectives:F,levelOrTrack:G})}onLevelsUpdated(A,B){const C=this.loaders[»≤];if(C){const A=C.context;A&&!B.levels.some((B=>B===A.levelOrTrack))&&(C.abort(),delete this.loaders[»≤])}}load(A){var B;const C=this.hls.config;let D,E=this.getInternalLoader(A);if(E){const B=this.hls.logger,C=E.context
;if(C&&C.levelOrTrack===A.levelOrTrack&&(C.url===A.url||C.deliveryDirectives&&!A.deliveryDirectives))return void(C.url===A.url?B.log(`[playlist-loader]: ignore ${A.url} ongoing request`):B.log(`[playlist-loader]: ignore ${A.url} in favor of ${C.url}`));B.log("[playlist-loader]: aborting previous loader for type: "+A.type),E.abort()}if(D=A.type===»±?C.manifestLoadPolicy.default:ƒè({},C.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),E=this.createInternalLoader(A),
–∂(null==(B=A.deliveryDirectives)?void 0:B.part)){let B;if(A.type===»≤&&null!==A.level?B=this.hls.levels[A.level].details:A.type===»≥&&null!==A.id?B=this.hls.audioTracks[A.id].details:A.type===»¥&&null!==A.id&&(B=this.hls.subtitleTracks[A.id].details),B){const A=B.partTarget,C=B.targetduration;if(A&&C){const B=1e3*Math.max(3*A,.8*C);D=ƒè({},D,{maxTimeToFirstByteMs:Math.min(B,D.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(B,D.maxTimeToFirstByteMs)})}}}const F=D.errorRetry||D.timeoutRetry||{},G={
loadPolicy:D,timeout:D.maxLoadTimeMs,maxRetry:F.maxNumRetry||0,retryDelay:F.retryDelayMs||0,maxRetryDelay:F.maxRetryDelayMs||0},H={onSuccess:(A,B,C,D)=>{const E=this.getInternalLoader(C);this.resetInternalLoader(C.type);const F=A.data;0===F.indexOf("#EXTM3U")?(B.parsing.start=performance.now(),—≤.isMediaPlaylist(F)||C.type!==»±?this.handleTrackOrLevelPlaylist(A,B,C,D||null,E):this.handleMasterPlaylist(A,B,C,D)):this.handleManifestParsingError(A,C,Error("no EXTM3U delimiter"),D||null,B)},
onError:(A,B,C,D)=>{this.handleNetworkError(B,C,!1,A,D)},onTimeout:(A,B,C)=>{this.handleNetworkError(B,C,!0,void 0,A)}};E.load(A,G,H)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:A,startPosition:B},forceStartLoad:C}=this.hls;(A||C)&&(this.hls.logger.log(`${A?"auto":"force"} startLoad with configured startPosition ${B}`),this.hls.startLoad(B))}handleMasterPlaylist(A,B,C,D){const E=this.hls,F=A.data,G=«¥(A,C),H=—≤.parseMasterPlaylist(F,G)
;if(H.playlistParsingError)return void this.handleManifestParsingError(A,C,H.playlistParsingError,D,B);const{contentSteering:I,levels:J,sessionData:K,sessionKeys:L,startTimeOffset:M,variableList:N}=H;this.variableList=N;const{AUDIO:O=[],SUBTITLES:P,"CLOSED-CAPTIONS":Q}=—≤.parseMasterPlaylistMedia(F,G,H)
;O.length&&(O.some((A=>!A.url))||!J[0].audioCodec||J[0].attrs.AUDIO||(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),O.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new —¶({}),bitrate:0,url:""}))),E.trigger(–ª.MANIFEST_LOADED,{levels:J,audioTracks:O,subtitles:P,captions:Q,contentSteering:I,url:G,stats:B,networkDetails:D,sessionData:K,sessionKeys:L,startTimeOffset:M,
variableList:N})}handleTrackOrLevelPlaylist(A,B,C,D,E){const F=this.hls,{id:G,level:H,type:I}=C,J=«¥(A,C),K=–∂(H)?H:–∂(G)?G:0,L=«≥(C),M=—≤.parseLevelPlaylist(A.data,J,K,L,0,this.variableList);if(I===»±){const A={attrs:new —¶({}),bitrate:0,details:M,name:"",url:J};M.requestScheduled=B.loading.start+≈∫(M,0),F.trigger(–ª.MANIFEST_LOADED,{levels:[A],audioTracks:[],url:J,stats:B,networkDetails:D,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}
B.parsing.end=performance.now(),C.levelDetails=M,this.handlePlaylistLoaded(M,A,B,C,D,E)}handleManifestParsingError(A,B,C,D,E){this.hls.trigger(–ª.ERROR,{type:–π.NETWORK_ERROR,details:–∫.MANIFEST_PARSING_ERROR,fatal:B.type===»±,url:A.url,err:C,error:C,reason:C.message,response:A,context:B,networkDetails:D,stats:E})}handleNetworkError(A,B,C=!1,D,E){let F=`A network ${C?"timeout":"error"+(D?" (status "+D.code+")":"")} occurred while loading ${A.type}`
;A.type===»≤?F+=`: ${A.level} id: ${A.id}`:A.type!==»≥&&A.type!==»¥||(F+=` id: ${A.id} group-id: "${A.groupId}"`);const G=Error(F);this.hls.logger.warn("[playlist-loader]: "+F);let H=–∫.UNKNOWN,I=!1;const J=this.getInternalLoader(A);switch(A.type){case »±:H=C?–∫.MANIFEST_LOAD_TIMEOUT:–∫.MANIFEST_LOAD_ERROR,I=!0;break;case »≤:H=C?–∫.LEVEL_LOAD_TIMEOUT:–∫.LEVEL_LOAD_ERROR,I=!1;break;case »≥:H=C?–∫.AUDIO_TRACK_LOAD_TIMEOUT:–∫.AUDIO_TRACK_LOAD_ERROR,I=!1;break;case »¥:
H=C?–∫.SUBTITLE_TRACK_LOAD_TIMEOUT:–∫.SUBTITLE_LOAD_ERROR,I=!1}J&&this.resetInternalLoader(A.type);const K={type:–π.NETWORK_ERROR,details:H,fatal:I,url:A.url,loader:J,context:A,error:G,networkDetails:B,stats:E};if(D){const C=(null==B?void 0:B.url)||A.url;K.response=ƒë({url:C,data:void 0},D)}this.hls.trigger(–ª.ERROR,K)}handlePlaylistLoaded(A,B,C,D,E,F){const G=this.hls,{type:H,level:I,id:J,groupId:K,deliveryDirectives:L}=D,M=«¥(B,D),N=«≥(D),O="number"==typeof D.level&&N===»µ?I:void 0
;if(!A.fragments.length){const F=A.playlistParsingError=Error("No Segments found in Playlist");return void G.trigger(–ª.ERROR,{type:–π.NETWORK_ERROR,details:–∫.LEVEL_EMPTY_ERROR,fatal:!1,url:M,error:F,reason:F.message,response:B,context:D,level:O,parent:N,networkDetails:E,stats:C})}A.targetduration||(A.playlistParsingError=Error("Missing Target Duration"));const P=A.playlistParsingError;if(P){if(this.hls.logger.warn(P),!G.config.ignorePlaylistParsingErrors)return void G.trigger(–ª.ERROR,{
type:–π.NETWORK_ERROR,details:–∫.LEVEL_PARSING_ERROR,fatal:!1,url:M,error:P,reason:P.message,response:B,context:D,level:O,parent:N,networkDetails:E,stats:C});A.playlistParsingError=null}switch(A.live&&F&&(F.getCacheAge&&(A.ageHeader=F.getCacheAge()||0),F.getCacheAge&&!isNaN(A.ageHeader)||(A.ageHeader=0)),H){case »±:case »≤:G.trigger(–ª.LEVEL_LOADED,{details:A,levelInfo:D.levelOrTrack||G.levels[0],level:O||0,id:J||0,stats:C,networkDetails:E,deliveryDirectives:L,withoutMultiVariant:H===»±});break
;case »≥:G.trigger(–ª.AUDIO_TRACK_LOADED,{details:A,track:D.levelOrTrack,id:J||0,groupId:K||"",stats:C,networkDetails:E,deliveryDirectives:L});break;case »¥:G.trigger(–ª.SUBTITLE_TRACK_LOADED,{details:A,track:D.levelOrTrack,id:J||0,groupId:K||"",stats:C,networkDetails:E,deliveryDirectives:L})}}}class ”∂{static get version(){return “ä}static isMSESupported(){return «≤()}static isSupported(){return function(){if(!«≤())return!1;const A=ƒî()
;return"function"==typeof(null==A?void 0:A.isTypeSupported)&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some((B=>A.isTypeSupported(ƒµ(B,"video"))))||["mp4a.40.2","fLaC"].some((B=>A.isTypeSupported(ƒµ(B,"audio")))))}()}static getMediaSource(){return ƒî()}static get Events(){return –ª}static get MetadataSchema(){return “å}static get ErrorTypes(){return –π}static get ErrorDetails(){return –∫}static get DefaultConfig(){return ”∂.defaultConfig?”∂.defaultConfig:”≠}static set DefaultConfig(A){
”∂.defaultConfig=A}constructor(A={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new …ö,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,
this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const B=this.logger=function(A,B,C){const D=ƒí();if("object"==typeof console&&!0===A||"object"==typeof A){const E=["debug","log","info","warn","error"];E.forEach((B=>{D[B]=ƒì(B,A,C)}));try{
D.log(`Debug logs enabled for "${B}" in hls.js version 1.6.4`)}catch(A){return ƒí()}E.forEach((B=>{—Å[B]=ƒì(B,A)}))}else ƒè(—Å,D);return D}(A.debug||!1,"Hls instance",A.assetPlayerId),C=this.config=function(A,B,C){if((B.liveSyncDurationCount||B.liveMaxLatencyDurationCount)&&(B.liveSyncDuration||B.liveMaxLatencyDuration))throw Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration")
;if(void 0!==B.liveMaxLatencyDurationCount&&(void 0===B.liveSyncDurationCount||B.liveMaxLatencyDurationCount<=B.liveSyncDurationCount))throw Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==B.liveMaxLatencyDuration&&(void 0===B.liveSyncDuration||B.liveMaxLatencyDuration<=B.liveSyncDuration))throw Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"')
;const D=«™(A),E=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach((A=>{const F=("level"===A?"playlist":A)+"LoadPolicy",G=void 0===B[F],H=[];E.forEach((C=>{const E=`${A}Loading${C}`,I=B[E];if(void 0!==I&&G){H.push(E);const A=D[F].default;switch(B[F]={default:A},C){case"TimeOut":A.maxLoadTimeMs=I,A.maxTimeToFirstByteMs=I;break;case"MaxRetry":A.errorRetry.maxNumRetry=I,A.timeoutRetry.maxNumRetry=I;break;case"RetryDelay":A.errorRetry.retryDelayMs=I,
A.timeoutRetry.retryDelayMs=I;break;case"MaxRetryTimeout":A.errorRetry.maxRetryDelayMs=I,A.timeoutRetry.maxRetryDelayMs=I}}})),H.length&&C.warn(`hls.js config: "${H.join('", "')}" setting(s) are deprecated, use "${F}": ${—ï(B[F])}`)})),ƒë(ƒë({},D),B)}(”∂.DefaultConfig,A,B);this.userConfig=A,C.progressive&&«´(C,B)
;const{abrController:D,bufferController:E,capLevelController:F,errorController:G,fpsController:H}=C,I=new G(this),J=this.abrController=new D(this),K=new —ó(this),L=C.interstitialsController,M=L?this.interstitialsController=new L(this,”∂):null,N=this.bufferController=new E(this,K),O=this.capLevelController=new F(this),P=new H(this),Q=new ”µ(this),R=C.contentSteeringController,S=R?new R(this):null,T=this.levelController=new ”≤(this,S),U=new ”∞(this),V=new ”¥(this.config),W=this.streamController=new ”≥(this,K,V),X=this.gapController=new ”Æ(this,K)
;O.setStreamController(W),P.setStreamController(W);const Y=[Q,T,W];M&&Y.splice(1,0,M),S&&Y.splice(1,0,S),this.networkControllers=Y;const Z=[J,N,X,O,P,U,K];this.audioTrackController=this.createController(C.audioTrackController,Y);const a=C.audioStreamController;a&&Y.push(this.audioStreamController=new a(this,K,V)),this.subtitleTrackController=this.createController(C.subtitleTrackController,Y);const b=C.subtitleStreamController;b&&Y.push(this.subtititleStreamController=new b(this,K,V)),
this.createController(C.timelineController,Z),V.emeController=this.emeController=this.createController(C.emeController,Z),this.cmcdController=this.createController(C.cmcdController,Z),this.latencyController=this.createController(”±,Z),this.coreComponents=Z,Y.push(I);const c=I.onErrorOut;"function"==typeof c&&this.on(–ª.ERROR,c,I),this.on(–ª.MANIFEST_LOADED,Q.onManifestLoaded,Q)}createController(A,B){if(A){const C=new A(this);return B&&B.push(C),C}return null}on(A,B,C=this){this._emitter.on(A,B,C)}
once(A,B,C=this){this._emitter.once(A,B,C)}removeAllListeners(A){this._emitter.removeAllListeners(A)}off(A,B,C=this,D){this._emitter.off(A,B,C,D)}listeners(A){return this._emitter.listeners(A)}emit(A,B,C){return this._emitter.emit(A,B,C)}trigger(A,B){if(this.config.debug)return this.emit(A,A,B);try{return this.emit(A,A,B)}catch(B){if(this.logger.error("An internal error happened while handling event "+A+'. Error message: "'+B.message+'". Here is a stacktrace:',B),!this.triggeringException){
this.triggeringException=!0;const C=A===–ª.ERROR;this.trigger(–ª.ERROR,{type:–π.OTHER_ERROR,details:–∫.INTERNAL_EXCEPTION,fatal:C,event:A,error:B}),this.triggeringException=!1}}return!1}listenerCount(A){return this._emitter.listenerCount(A)}destroy(){this.logger.log("destroy"),this.trigger(–ª.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach((A=>A.destroy())),this.networkControllers.length=0,
this.coreComponents.forEach((A=>A.destroy())),this.coreComponents.length=0;const A=this.config;A.xhrSetup=A.fetchSetup=void 0,this.userConfig=null}attachMedia(A){if(!A||"media"in A&&!A.media){const B=Error(`attachMedia failed: invalid argument (${A})`);return void this.trigger(–ª.ERROR,{type:–π.OTHER_ERROR,details:–∫.ATTACH_MEDIA_ERROR,fatal:!0,error:B})}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia())
;const B="media"in A,C=B?A.media:A,D=B?A:{media:C};this._media=C,this.trigger(–ª.MEDIA_ATTACHING,D)}detachMedia(){this.logger.log("detachMedia"),this.trigger(–ª.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const A=this.bufferController.transferMedia();return this.trigger(–ª.MEDIA_DETACHING,{transferMedia:A}),A}loadSource(A){this.stopLoad();const B=this.media,C=this._url,D=this._url=»∫.buildAbsoluteURL(self.location.href,A,{alwaysNormalize:!0});this._autoLevelCapping=-1,
this._maxHdcpLevel=null,this.logger.log("loadSource:"+D),B&&C&&(C!==D||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(B)),this.trigger(–ª.MANIFEST_LOADING,{url:A})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(A=-1,B){this.logger.log(`startLoad(${A+(B?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering()
;for(let C=0;C<this.networkControllers.length&&(this.networkControllers[C].startLoad(A,B),this.started&&this.networkControllers);C++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let A=0;A<this.networkControllers.length&&(this.networkControllers[A].stopLoad(),!this.started&&this.networkControllers);A++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){
this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach((A=>{A.resumeBuffering&&A.resumeBuffering()})))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach((A=>{A.pauseBuffering&&A.pauseBuffering()})))}get inFlightFragments(){const A={[»µ]:this.streamController.inFlightFrag};return this.audioStreamController&&(A[»∂]=this.audioStreamController.inFlightFrag),
this.subtititleStreamController&&(A[»∑]=this.subtititleStreamController.inFlightFrag),A}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const A=this._media,B=null==A?void 0:A.currentTime;this.detachMedia(),A&&(this.attachMedia(A),B&&this.startLoad(B))}removeLevel(A){this.levelController.removeLevel(A)}get sessionId(){let A=this._sessionId;return A||(A=this._sessionId=function(){try{
return crypto.randomUUID()}catch(A){try{const A=URL.createObjectURL(new Blob),B=A.toString();return URL.revokeObjectURL(A),B.slice(B.lastIndexOf("/")+1)}catch(A){let B=(new Date).getTime();const C="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(A=>{const C=(B+16*Math.random())%16|0;return B=Math.floor(B/16),("x"==A?C:3&C|8).toString(16)}));return C}}}()),A}get levels(){const A=this.levelController.levels;return A||[]}get latestLevelDetails(){
return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(A){this.logger.log("set currentLevel:"+A),this.levelController.manualLevel=A,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(A){this.logger.log("set nextLevel:"+A),this.levelController.manualLevel=A,this.streamController.nextLevelSwitch()}
get loadLevel(){return this.levelController.level}set loadLevel(A){this.logger.log("set loadLevel:"+A),this.levelController.manualLevel=A}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(A){this.levelController.nextLoadLevel=A}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(A){this.logger.log("set firstLevel:"+A),this.levelController.firstLevel=A}get startLevel(){const A=this.levelController.startLevel
;return-1===A&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:A}set startLevel(A){this.logger.log("set startLevel:"+A),-1!==A&&(A=Math.max(A,this.minAutoLevel)),this.levelController.startLevel=A}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(A){const B=!!A;B!==this.config.capLevelToPlayerSize&&(B?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,
this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=B)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:A}=this.abrController;return A?A.getEstimate():NaN}set bandwidthEstimate(A){this.abrController.resetEstimator(A)}get abrEwmaDefaultEstimate(){const{bwEstimator:A}=this.abrController;return A?A.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:A}=this.abrController;return A?A.getEstimateTTFB():NaN}
set autoLevelCapping(A){this._autoLevelCapping!==A&&(this.logger.log("set autoLevelCapping:"+A),this._autoLevelCapping=A,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(A){(function(A){return —ë.indexOf(A)>-1})(A)&&this._maxHdcpLevel!==A&&(this._maxHdcpLevel=A,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}
get minAutoLevel(){const{levels:A,config:{minAutoBitrate:B}}=this;if(!A)return 0;const C=A.length;for(let D=0;D<C;D++)if(A[D].maxBitrate>=B)return D;return 0}get maxAutoLevel(){const{levels:A,autoLevelCapping:B,maxHdcpLevel:C}=this;let D;if(D=-1===B&&null!=A&&A.length?A.length-1:B,C)for(let B=D;B--;){const D=A[B].attrs["HDCP-LEVEL"];if(D&&D<=C)return B}return D}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}
set nextAutoLevel(A){this.abrController.nextAutoLevel=A}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(A){var B;return(null==(B=this.audioTrackController)?void 0:B.setAudioOption(A))||null}setSubtitleOption(A){var B;return(null==(B=this.subtitleTrackController)?void 0:B.setSubtitleOption(A))||null}
get allAudioTracks(){const A=this.audioTrackController;return A?A.allAudioTracks:[]}get audioTracks(){const A=this.audioTrackController;return A?A.audioTracks:[]}get audioTrack(){const A=this.audioTrackController;return A?A.audioTrack:-1}set audioTrack(A){const B=this.audioTrackController;B&&(B.audioTrack=A)}get allSubtitleTracks(){const A=this.subtitleTrackController;return A?A.allSubtitleTracks:[]}get subtitleTracks(){const A=this.subtitleTrackController;return A?A.subtitleTracks:[]}
get subtitleTrack(){const A=this.subtitleTrackController;return A?A.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(A){const B=this.subtitleTrackController;B&&(B.subtitleTrack=A)}get subtitleDisplay(){const A=this.subtitleTrackController;return!!A&&A.subtitleDisplay}set subtitleDisplay(A){const B=this.subtitleTrackController;B&&(B.subtitleDisplay=A)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(A){this.config.lowLatencyMode=A}get liveSyncPosition(){
return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(A){this.latencyController.targetLatency=A}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){
return this.levelController.pathwayPriority}set pathwayPriority(A){this.levelController.pathwayPriority=A}get bufferedToEnd(){var A;return!(null==(A=this.bufferController)||!A.bufferedToEnd)}get interstitialsManager(){var A;return(null==(A=this.interstitialsController)?void 0:A.interstitialsManager)||null}getMediaDecodingInfo(A,B=this.allAudioTracks){return ƒø(A,≈Ñ(B),navigator.mediaCapabilities)}}”∂.defaultConfig=void 0;const{AES:”∑,Hex:”∏,NTON:”π,UTF_8:”∫,Base64:”ª}=Œ∫;(async({window:A,document:B})=>{
function C(A){const C=B.getElementById(A);if(null!=C)return C;throw Error("Cannot access element: "+A)}function D(A){const C=B.querySelector(A);if(null!=C)return C;throw Error("Cannot access element selector: "+A)}function E(A){null!=A?(b.textContent=A,b.style.display="block"):b.style.display="none"}function F(A){try{return new URL(A)}catch(A){return null}}function G(A){for(let B=A.length-1;B>=0;B--){const C=Math.floor(Math.random()*(B+1));[A[B],A[C]]=[A[C],A[B]]}return A}function H(A){
return A.startsWith(√Ä)?A:√Ä+Œª.c+"?W="+encodeURIComponent(”ª.encode(√ô(”∫.encode(A),{mem:10,level:9})))}function I(A){return new Date(A).toLocaleString("POSIX",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}async function J(A,B){try{const C=await fetch(A,{cache:B||"force-cache",method:"GET"});return C.ok?await C.text():null}catch(A){return null}}async function K(A,B,C){try{const D=new Image(512,512);D.loading="eager",D.decoding="sync",
D.draggable=!1;{const B=URL.createObjectURL(A);D.src=B,await D.decode(),URL.revokeObjectURL(B)}let E=D.naturalWidth,F=D.naturalHeight;{const A=null==C?F/E:C/B;F>=E*A?F=Math.floor(E*A):E=Math.floor(F/A)}if((B=Math.min(B,E))<10||(C=null==C?F:Math.min(C,F))<10)throw Error("Image must have at least 100 pixels.");const G=new OffscreenCanvas(B,C),H=G.getContext("2d",{alpha:!1});if(null==H)throw Error("Failed to initialize canvas context.");return H.imageSmoothingEnabled=!0,
H.imageSmoothingQuality="high",H.drawImage(D,0,0,E,F,0,0,B,C),await G.convertToBlob({type:"image/jpeg",quality:100})}catch(A){return null}}function L(A,B){return new Promise(((C,D)=>{const E=performance.now(),F=function(A,B,C){const D=new ArrayBuffer((C=”π.encode(C)).byteLength+10);new DataView(D,1,8).setFloat64(0,A,!0);{const A=new Uint8Array(D);A[0]=3,A[9]=B,A.set(C,10)}return D}(E,A,B);¬™.send(F,{compress:!0}),n.set(E,[C,D,F])}))}function M(A){p.appendChild(R(A)),q.style.display="block"}
function N(A,B){if(A.startsWith("https://"))return A;let C=√Ä+"g/"+B+"/";if(A.startsWith("/games/flash/")){const B=A.indexOf("/",13);B>13&&(C+=A.slice(B+1))}return C}function P(B,C,D){if("html5"===B&&"string"==typeof C)return R(C);D||=A;const E=performance.now().toString(36),F=R("/player.html?s="+E),G=({data:A,origin:F,source:H})=>{F===D.origin&&A===E&&(null!=H&&H.postMessage({id:B,url:C},{targetOrigin:F}),D.removeEventListener("message",G))};return D.addEventListener("message",G,{passive:!0}),F}
function Q(A){const B=A.date.toString(36),C=A.name,D=d("a");D.href="https://nettleweb.com/"+B,D.title="Play "+C,D.target="_self",D.className="game",D.style.backgroundImage='url("'+√Ä+"p/"+B+'")',D.onclick=B=>{B.ctrlKey||(B.preventDefault(),B.stopPropagation(),√É(A).catch((A=>{√ï(A),E("Failed to launch game. Message: "+A)})))};{const A=d("div");A.textContent=C,D.appendChild(A)}if(A.file.startsWith("https://")){const A=d("img");A.src="/res/cloud.svg",A.alt="Cloud",
A.title="Embedded from third-party servers",A.width=24,A.height=24,A.loading="lazy",A.decoding="async",A.draggable=!1,D.appendChild(A)}switch(A.type){case"html5":{const A=d("span");A.textContent="HTML5",A.style.background="#c04000",D.appendChild(A)}break;case"flash":{const A=d("span");A.textContent="Flash",A.style.background="#008000",D.appendChild(A)}break;case"dos":{const A=d("span");A.textContent="Dos",A.style.background="#0000ff",D.appendChild(A)}break;default:
D.style.backgroundImage='url("/res/preview.svg")'}return D}function R(A){if(A.startsWith("https://")&&!A.startsWith(√Ä)){const C=d("iframe");C.name="Frame",C.width="1024",C.height="768",C.loading="lazy",C.referrerPolicy="no-referrer",C.allowFullscreen=!0,C.setAttribute("sandbox","allow-forms allow-popups allow-scripts allow-same-origin allow-pointer-lock"),C.setAttribute("scrolling","no"),C.setAttribute("frameborder","0"),C.setAttribute("credentialless","true"),
C.setAttribute("allowpaymentrequest","true");{
const D="data:application/xhtml+xml;base64,"+”ª.encode(”∫.encode(`<?xml version="1.0" encoding="utf-8" ?>\n<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml" lang="en">\n\t<head>\n\t\t<meta charset="utf-8" />\n\t\t<meta name="referrer" content="no-referrer" />\n\t\t<meta name="viewport" content="width=device-width,initial-scale=1" />\n\t\t<base href="${origin}" target="_blank" />\n\t\t<link rel="icon" type="image/x-icon" href="res/google.ico" />\n\t\t<link rel="stylesheet" type="text/css" href="data:text/css;base64,Ym9keSxlbWJlZCxpZnJhbWV7cG9zaXRpb246YWJzb2x1dGU7ZGlzcGxheTpibG9jazt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO21hcmdpbjowcHg7cGFkZGluZzowcHg7Ym9yZGVyOm5vbmU7b3ZlcmZsb3c6aGlkZGVuO30K" />\n\t\t<title>Google</title>\n\t</head>\n\t<body>\n\t\t<embed type="text/plain" width="1024" height="768" src="${B=A,
B.replace(/[&<"']/g,(A=>{switch(A){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";default:return""}}))}" />\n\t</body>\n</html>`));C.addEventListener("load",(()=>{const A=C.contentWindow;null!=A?(A.stop(),A.focus(),A.location.replace(D)):C.src=D}),{once:!0,passive:!0}),m.set(C,A)}return C}{const B=d("embed");return B.src=A,B.type="text/html",B.width="1024",B.height="768",B}var B}function S(){√ã=null,¬µ||(B.title="NettleWeb"),a.replaceState(void 0,"","/")}
function T(){const B=A.open(void 0,"_blank","");return null!=B?(B.focus(),B):B}function U(A){const B=T();null!=B?B.location.replace(A):E("Please allow popups in your browser settings and try again.")}function V(A,B){if(null==(B||=T()))return void E("Please allow popups in your browser settings and try again.");const C=B.document
;C.head.innerHTML='<meta charset="utf-8" /><meta name="referrer" content="no-referrer"/><meta name="viewport" content="width=device-width,initial-scale=1"/><base href="'+B.origin+'" target="_blank" /><link rel="icon" type="image/x-icon" href="res/google.ico" /><link rel="stylesheet" type="text/css" href="data:text/css;base64,Ym9keSxlbWJlZCxpZnJhbWV7cG9zaXRpb246YWJzb2x1dGU7ZGlzcGxheTpibG9jazt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO21hcmdpbjowcHg7cGFkZGluZzowcHg7Ym9yZGVyOm5vbmU7b3ZlcmZsb3c6aGlkZGVuO30K"/>',
C.body.appendChild(A),C.title="Google"}function W(){const A=d("iframe");A.name="API Anchor",A.width="1024",A.height="768",A.loading="lazy",A.referrerPolicy="no-referrer",A.allowFullscreen=!0,A.setAttribute("id","anchor"),A.setAttribute("scrolling","no"),A.setAttribute("frameborder","0"),A.setAttribute("credentialless","true"),A.setAttribute("allowpaymentrequest","true"),A.addEventListener("load",(()=>{const B=A.contentWindow;null!=B?(B.stop(),B.focus(),
B.location.replace("https://nettleweb.com/?m=1")):A.src="https://nettleweb.com/?m=1"}),{once:!0,passive:!0}),h.appendChild(A)}const X=”∫.decode([95,90,101,116,116,97]),Y=”∫.decode([95,89,111,116,116,97]),Z=A.location,a=A.history,b=C("error"),c=B.currentScript,d=B.createElementNS.bind(B,"http://www.w3.org/1999/xhtml"),e=C("install"),f=C("content"),g="image/svg+xml"!==B.contentType,h=B.body||f.parentElement,i=await J("/manifest.json","no-cache")
;if(null==i)return void E("Fatal Error: Failed to fetch manifest file.");let j;"complete"!==B.readyState&&await new Promise((A=>{const C=()=>{"complete"===B.readyState&&(B.removeEventListener("readystatechange",C),setTimeout(A,100,null))};B.addEventListener("readystatechange",C,{passive:!0})})),A.focus(),B.title="NettleWeb";try{const √ö=A.top;null!=√ö&&(j=√ö===A?A:√ö.origin===A.origin?√ö:null)}catch(√õ){}if(A!==j){if("null"===Z.ancestorOrigins?.item(0)){const √ú=d("div");return √ú.style.padding="15px",
√ú.textContent="Click here to continue",√ú.onclick=()=>{const A=d("embed");A.type="text/plain",A.width="1280",A.height="720",A.src="https://nettleweb.com/embed.html",V(A)},h.innerHTML="",void h.appendChild(√ú)}if("https://nettleweb.com"!==Z.origin)return void Z.replace("https://nettleweb.com/embed.html")}const k=Object.freeze(Object.setPrototypeOf({length:0,clear:()=>{},setItem:()=>{},getItem:()=>null,removeItem:()=>{}
},null)),l=A!==j||"https://nettleweb.com"!==origin&&"http://localhost:8000"!==origin,m=new WeakMap,n=new Map,o=function(){try{const{localStorage:B}=A;if(null==B)throw Error("Storage interface not available.");const C="___whitespider___",D=Date.now().toString(36);if(B.setItem(C,D),B.getItem(C)!==D)throw Error("Storage test failed: value mismatch");return B}catch(A){return k}
}(),p=C("frame"),q=C("frame-view"),r=C("accn-btn"),s=C("game-btn"),t=C("strm-btn"),u=C("nmsg-btn"),v=C("side-menu"),w=C("bottom-widget");let x,y,z,¬™,¬µ,¬∫,√Ä,√Å,√Ç,√É,√Ñ,√Ö,√â,√ä=[],√ã=null,√å=null,√ç=null,√é=null,√è=null,√ê=null,√ë=null,√í=null,√ì=null,√î=null;if(A.isSecureContext??"https:"===Z.protocol){if(o!==k){const √ù=JSON.parse(i).version;if(√ù!==o.getItem("__mf_version")){h.innerHTML="Updating contents...";for(const √û of await caches.keys())await caches.delete(√û);return o.setItem("__mf_version",√ù),
void Z.reload()}C("version").textContent="v"+√ù,y=o.getItem("__secrets_")||void 0}else E("Warning: Cookies are blocked by your browser. Some features might not work properly, and your game data will NOT be saved.");try{const √ü=A.navigator.serviceWorker;null!=√ü&&(await √ü.register("/sw.js",{type:"classic",scope:"/",updateViaCache:"none"}),await √ü.ready)}catch(√†){}}{const √°=new ”∑(”∏.decode(Œ∫.sha256(i))),√¢=Œª[X],√£=Œª[Y];delete Œª[X],delete Œª[Y]
;for(const √§ of Object.keys(Œª))Œª[√§]=”∫.decode(√°.decryptCTR(”ª.decode(Œª[√§]),”∏.decode(Œ∫.md5(√§))));for(let √•=0;√•<16;√•++)√¢[√•]+=2*(√•%3+1)-2022;if(":("!==Œª._g.slice(6,8))return void E("Keyring decoding error!");Œø._(A,”∫.decode(√°.decryptCTR(√£,√¢)))}const √ï=Œø.$;{const{_a:√¶,_b:√ß,_c:√®,_d:√©,_e:√™,_f:√´,_g:√¨,_h:√≠,_i:√Æ,_j:√Ø,_k:√∞,_l:√±,_m:√≤,_n:√≥,_o:√¥,_p:√µ,_q:√∂,_r:√∏,_s:√π,_t:√∫,_u:√ª,_v:√º,_w:√Ω,_x:√æ,_y:√ø,_z:ƒÄ,_Z:ƒÅ,_Y:ƒÇ}=Œª;if((()=>{√ï(√¶,√ß);const A=new URL(Z.href),C=A.hostname,E=A.origin;switch(A.protocol){case"http:":
if("localhost"!==C)return A.protocol="https:",Z.replace(A.href),!1;break;case"https:":break;default:return!0}{const A=B[√¥](√≠);if(g&&(null==A||A[√Ø](√Æ)!==√±))return!0}for(const A of B[√≤](√≥)){switch(A[√Ø]("type")||""){case"":case"text/javascript":case"application/javascript":break;default:return A.remove(),!0}const B=A[√Ø]("src");if(!B||A.textContent)return A.remove(),!0;const C=new URL(B.startsWith("//")?"https:"+B:B,E);if(C.origin!==E){switch(C.protocol){case"https":
const B=C.host.split("."),D=B.length;if("com"===B[D-1]){const A=B[D-2];if(A.indexOf("google")>=0||A.indexOf("firebase")>=0)continue}break;case"chrome-extension:":A.remove();continue}return A.remove(),!0}}const F=null==c||c[√Ø](√π)!==√∫+√ª||c[√Ø](ƒÄ)!==ƒÅ||c[√Ø](√æ)?.slice(0,7)!==√ø+"-",{q:G,r:H,p:I,s:J,y:K,e:L}=Œª;return null==G||null==H||(Œª.X=G+H+J+L+"3.sha"+K+I+"/",Œª.Y=G+H+Œª.b+"/",g&&D(ƒÇ)[√Ø](√≠.slice(10,14)).slice(0,√®)!==√´||null==B[√¥](√µ)||null==B[√¥](√∂)||B[√∏]!==√¶.slice(2,11)||F)})()){√ï(√™,√∞)
;const ƒÉ=(new DOMParser).parseFromString(√º,"application/xhtml+xml");ƒÉ.title=√¨;const ƒÑ=ƒÉ.body;ƒÑ.innerHTML=√©;{const ƒÖ=d("button");ƒÖ.type="button",ƒÖ.innerHTML=√Ω,ƒÖ.addEventListener("click",(()=>{Z.replace(√´)}),{passive:!0}),ƒÑ.appendChild(ƒÖ)}return void B.documentElement.replaceWith(ƒÉ.documentElement)}for(const ƒÜ of Object.getOwnPropertyNames(Œª))2===ƒÜ.length&&delete Œª[ƒÜ]}A.onerror=(A,B,C,D,E)=>{const F="Unhandled error at "+(B||"unknown source")+" "+(C||"X")+":"+(D||"X")+"\n\n Message: "+E
;b.textContent=F,b.style.display="block"},A.onkeydown=A=>{if(A.ctrlKey&&!A.altKey&&!A.metaKey&&!A.shiftKey)switch(A.key){case"h":case"q":A.preventDefault(),A.stopPropagation(),Z.replace("https://www.google.com/webhp?igu=1");break;case"b":A.preventDefault(),A.stopPropagation(),h.hasAttribute("style")?h.removeAttribute("style"):h.setAttribute("style","filter: blur(15px);")}},A.onpopstate=A=>{A.preventDefault(),A.stopPropagation(),E("Notice: Please press ctrl+Q to leave this website.")},
A.onappinstalled=A=>{A.preventDefault(),A.stopPropagation(),e.style.display="none"},A.onbeforeinstallprompt=A=>{A.preventDefault(),A.stopPropagation(),e.style.display="block",e.onclick=()=>{A.prompt().catch((A=>{E("Failed to show install prompt. Message: "+A)}))}},b.onclick=()=>{b.innerHTML="",b.style.display="none"},C("frame-close").onclick=()=>{p.innerHTML="",q.style.display="none"},C("frame-expand").onclick=A=>{if(B.fullscreenEnabled&&!A.ctrlKey)p.requestFullscreen({navigationUI:"hide"
}).catch((A=>{E("Failed to enter fullscreen mode. Message: "+A)}));else{const A=p.firstElementChild;if(null!=A){const B=m.get(A)||"";B.startsWith("https://")&&V(R(B))}p.innerHTML="",q.style.display="none"}},C("content-page").outerHTML=Œø.l;{const ƒá=g?D("link[rel*='icon']"):null,ƒà=C("overlay"),ƒâ=C("notice"),ƒä=C("status"),ƒã=C("theme"),ƒå=C("image"),ƒç=C("font"),ƒé=C("cdn"),ƒè=C("backend"),ƒê=C("tab-cloaking"),ƒë=C("stealth-mode"),ƒí={path:"/K7e8UQ1JqnTj/",secure:!0,upgrade:!0,protocols:[],
transports:["polling","websocket"],timestampParam:"x",addTrailingSlash:!0,timestampRequests:!0,rejectUnauthorized:!0,closeOnBeforeunload:!0};let ƒì,ƒî,ƒï;function ƒñ(A){¬™=new –µ(A,ƒí),ƒä.innerHTML="Connecting...",ƒä.style.color="#808000",¬™.on("open",(()=>{ƒä.title="",ƒä.innerHTML="‚úìConnected",ƒä.style.color="#008000"})),¬™.on("close",(B=>{ƒä.title=B,ƒä.innerHTML="‚úïDisconnected",ƒä.style.color="#ff0000",setTimeout(ƒñ,5e3,A)})),¬™.on("message",(A=>{const B=new Uint8Array(A,0,A.byteLength);switch(B[0]){case 1:
"string"!=typeof z&&(z=”∫.decode(B.subarray(1))),null!=√å&&√å();break;case 2:null!=√ç&&√ç(”∫.decode(B.subarray(1)));break;case 3:B.byteLength>1&&(ƒâ.textContent=”∫.decode(B.subarray(1)),ƒâ.style.display="block");break;case 4:u.setAttribute("data-unread","");break;case 5:if(null!=√ê){const A=JSON.parse(”∫.decode(B.subarray(1)));√ê(A[0],A[1])}break;case 6:if(null!=√ë){const A=JSON.parse(”∫.decode(B.subarray(1)));√ë(A[0],A[1],A[2])}break;case 7:if(null!=√í){const A=JSON.parse(”∫.decode(B.subarray(1)));√í(A[0],A[1])}
break;case 8:if(null!=√ì){const A=JSON.parse(”∫.decode(B.subarray(1)));√ì(A[0],A[1])}break;case 9:if(null!=√î){const A=JSON.parse(”∫.decode(B.subarray(1)));√î(A[0],A[1],A[2])}break;case 10:null!=√é&&√é(”∫.decode(B.subarray(1)));break;case 11:null!=√è&&√è(”∫.decode(B.subarray(1)));break;case 12:{const C=new DataView(A,1,8).getFloat64(0,!0),D=n.get(C);null!=D&&(D[0](”π.decode(B.subarray(9))),n.delete(C))}break;case 13:{const C=new DataView(A,1,8).getFloat64(0,!0),D=n.get(C)
;null!=D&&(D[1](”∫.decode(B.subarray(9))),n.delete(C))}break;default:√ï("[WARN] Received invalid message ID: ",B[0])}})),¬™.binaryType="arraybuffer",null!=y&&¬™.send(”∫.encode(""+y));for(const[,,A]of n.values())¬™.send(A,{compress:!0})}function ƒó(A){let B;null==ƒì&&(ƒì=Œª.X||""),null!=¬™?(B=¬™.writeBuffer,¬™.close()):B=[],ƒñ(A||ƒì||"https://service.nettleweb.com/")}function ƒò(A){null==ƒî&&(ƒî=Œª.Y||""),√Ä=A||ƒî||"https://cdn.nettleweb.com/Zetta/"}function ƒô(A){
"mono"===A?h.style.fontFamily='"Ubuntu Mono", monospace':h.style.removeProperty("font-family")}function ƒö(A){A.startsWith("data:image/jpeg;base64,")?f.style.background='url("'+A+'")':f.style.removeProperty("background")}function ƒõ(A){switch(null==ƒï&&(ƒï=d("style"),ƒï.setAttribute("type","text/css"),ƒï.textContent='@import url("/index.dark.css");',(B.head||B.documentElement).appendChild(ƒï)),A){case"light":ƒï.textContent="",ƒï.removeAttribute("media");break;case"dark":
ƒï.textContent='@import url("/index.dark.css");',ƒï.removeAttribute("media");break;default:ƒï.textContent='@import url("/index.dark.css");',ƒï.setAttribute("media","all and (prefers-color-scheme: dark)")}}function ƒú(A){switch(A){case"empty":¬µ=!0,B.title="‚Å†",null!=ƒá&&(ƒá.setAttribute("type","image/x-icon"),ƒá.setAttribute("href","/res/empty.ico"));break;case"google":¬µ=!0,B.title="Google",null!=ƒá&&(ƒá.setAttribute("type","image/x-icon"),ƒá.setAttribute("href","/res/google.ico"));break;case"classroom":
¬µ=!0,B.title="Home",null!=ƒá&&(ƒá.setAttribute("type","image/png"),ƒá.setAttribute("href","/res/classroom.png"));break;default:¬µ=!1,B.title="NettleWeb",null!=ƒá&&(ƒá.setAttribute("type","image/x-icon"),ƒá.setAttribute("href","/favicon.ico"))}}function ƒù(A){switch(A){case"blank":B.onblur=B.onmouseleave=A=>{ƒà.hasAttribute("data-x")||(A.preventDefault(),A.stopPropagation(),ƒà.setAttribute("data-x","1"))},B.onmousedown=B.ontouchstart=A=>{ƒà.hasAttribute("data-x")&&(A.preventDefault(),A.stopPropagation(),
ƒà.removeAttribute("data-x"))},ƒà.innerHTML="",ƒà.removeAttribute("data-x");break;case"google":B.onblur=B.onmouseleave=A=>{ƒà.hasAttribute("data-x")||(A.preventDefault(),A.stopPropagation(),ƒà.setAttribute("data-x","1"))},B.onmousedown=B.ontouchstart=A=>{ƒà.hasAttribute("data-x")&&(A.preventDefault(),A.stopPropagation(),ƒà.removeAttribute("data-x"))},
ƒà.innerHTML='<iframe width="1024" height="768" allowfullscreen="true" allowpaymentrequest="true" name="Frame" allow="fullscreen payment" loading="lazy" scrolling="no" frameborder="0" credentialless="true" referrerpolicy="no-referrer" src="https://www.google.com/webhp?igu=1"></iframe>',ƒà.removeAttribute("data-x");break;default:ƒà.innerHTML="",ƒà.removeAttribute("data-x"),B.onblur=B.onmouseleave=B.onmousedown=B.ontouchstart=null}}ƒã.onchange=()=>{const A=ƒã.value;ƒõ(A),o.setItem("__set_theme",A)},
ƒå.onchange=async()=>{const A=ƒå.files?.item(0);if(null!=A){if(A.size>10485760)return void E("Error: Selected file is too large.");const B=await K(A,1280);if(null==B)return void E("Error: Failed to decode image file.");const C="data:image/jpeg;base64,"+”ª.encode(new Uint8Array(await B.arrayBuffer()));ƒö(C),o.setItem("__set_image",C)}else ƒö(""),o.setItem("__set_image","")},ƒç.onchange=()=>{const A=ƒç.value;ƒô(A),o.setItem("__set_font",A)},ƒè.onblur=()=>{const A=F(ƒè.value.trim());if(null!=A){
const B=A.href;ƒó(ƒè.value=B),o.setItem("__backendURL_",B)}else ƒó(ƒè.value=""),o.removeItem("__backendURL_")},ƒé.onblur=()=>{const A=F(ƒé.value.trim());if(null!=A){const B=A.href;ƒò(ƒé.value=B),o.setItem("__cdn__",B)}else ƒò(ƒé.value=""),o.removeItem("__cdn__")},ƒê.onchange=()=>{const A=ƒê.value;ƒú(A),o.setItem("__set_tabc",A)},ƒë.onchange=()=>{const A=ƒë.value;ƒù(A),o.setItem("__set_sm",A)},ƒó(ƒè.value=o.getItem("__backendURL_")||""),ƒò(ƒé.value=o.getItem("__cdn__")||""),
ƒô(ƒç.value=o.getItem("__set_font")||"normal"),ƒö(o.getItem("__set_image")||""),ƒõ(ƒã.value=o.getItem("__set_theme")||"default"),ƒú(ƒê.value=o.getItem("__set_tabc")||"disabled"),ƒù(ƒë.value=o.getItem("__set_sm")||"disabled")}{const ƒû=D("#search>input");C("search").onsubmit=A=>{A.preventDefault(),A.stopPropagation();const B=ƒû.value.trim();B.length>0&&M("/search.html?q="+encodeURIComponent(B))},C("clear-data").onclick=async()=>{for(const A of await caches.keys())await caches.delete(A);o.clear(),Z.reload()
},C("clear-cache").onclick=async()=>{for(const A of await caches.keys())await caches.delete(A);Z.reload()}}{
const ƒü=C("game-container"),ƒ†=C("comments"),ƒ°=C("player"),ƒ¢=C("share"),ƒ£=C("like"),ƒ§=C("game-page"),ƒ•=C("ecode"),ƒ¶=C("edit"),ƒß=C("name"),ƒ®=C("type"),ƒ©=C("tags"),ƒ™=C("date"),ƒ´=C("user"),ƒ¨=C("desc"),ƒ≠=C("code"),ƒÆ=C("lock"),ƒØ=C("comm"),ƒ∞=C("post"),ƒ±=C("e-name"),ƒ≤=C("e-tags"),ƒ≥=C("e-desc"),ƒ¥=C("e-subm"),ƒµ=C("editor"),ƒ∂=C("s-games"),ƒ∑=C("loadmore"),ƒ∏=C("controller"),ƒπ=C("goto-games"),ƒ∫=C("games-page"),ƒª=C("gnav-back"),ƒº=C("gnav-forward"),ƒΩ=C("gnav-page-no"),ƒæ=C("gnav-page-count"),ƒø=[]
;let ≈Ä="p",≈Å="all",≈Ç="",≈É=0,≈Ñ=null,≈Ö=null;{const ≈ä=C("game-search"),≈ã=D("#game-search>input");let ≈å=0;≈ä.onsubmit=A=>{A.preventDefault(),A.stopPropagation(),≈Ç=≈ã.value.trim().toLowerCase(),clearTimeout(≈å),≈á()},≈ã.onblur=()=>{≈Ç=≈ã.value.trim().toLowerCase(),clearTimeout(≈å),≈á()},≈ã.oninput=()=>{clearTimeout(≈å),≈å=setTimeout((()=>{≈Ç=≈ã.value.trim().toLowerCase(),≈á()}),1e3)}}{const ≈ç=B.querySelectorAll("#game-category>button");for(const ≈é of ≈ç)≈é.onclick=()=>{
for(const A of ≈ç)A.removeAttribute("data-current");≈Å=≈é.getAttribute("data-match")||"all",≈é.setAttribute("data-current",""),≈á()}}{const ≈è=C("game-sort");≈è.value=≈Ä=o.getItem("__gamesortorder")||"p",≈è.onchange=()=>{o.setItem("__gamesortorder",≈Ä=≈è.value),≈á()}}function ≈Ü(){switch(≈Å){case"all":return 0===≈Ç.length?[...¬∫]:¬∫.filter((A=>A.name.toLowerCase().indexOf(≈Ç)>=0||A.tags.indexOf(≈Ç)>=0));case"dos":
return ¬∫.filter((A=>"dos"===A.type&&(0===≈Ç.length||A.name.toLowerCase().indexOf(≈Ç)>=0||A.tags.indexOf(≈Ç)>=0)));case"flash":return ¬∫.filter((A=>"flash"===A.type&&(0===≈Ç.length||A.name.toLowerCase().indexOf(≈Ç)>=0||A.tags.indexOf(≈Ç)>=0)));case"html5":return ¬∫.filter((A=>"html5"===A.type&&(0===≈Ç.length||A.name.toLowerCase().indexOf(≈Ç)>=0||A.tags.indexOf(≈Ç)>=0)));default:return ¬∫.filter((A=>A.tags.split(",").indexOf(≈Å)>=0&&(0===≈Ç.length||A.name.toLowerCase().indexOf(≈Ç)>=0)))}}function ≈á(){≈É=0,
ƒø.length=0;const A=≈Ü();if(0===A.length)return ƒª.disabled=!0,ƒº.disabled=!0,void(ƒü.innerHTML="No matching results found :(");switch(≈Ä){case"r":"Joey"===z||"anonymous"===z?A.sort(((A,B)=>A.desc.length-B.desc.length)):G(A);break;case"d":A.sort(((A,B)=>B.date-A.date));break;case"p":A.sort(((A,B)=>(B.count||0)-(A.count||0)))}for(let B=0;B<A.length;B+=100)ƒø.push(A.slice(B,B+100));≈à()}function ≈à(){ƒΩ.min="1",ƒΩ.max=ƒæ.innerHTML=ƒø.length+"",ƒΩ.value=≈É+1+"",ƒü.innerHTML="",ƒª.disabled=≈É<1,
≈É>=ƒø.length-1?ƒº.disabled=!0:ƒº.disabled=!1;for(const A of ƒø[≈É])ƒü.appendChild(Q(A))}function ≈â({id:A,msg:B,uid:C,vip:D,user:F,icon:G},I){const J=d("div");J.setAttribute("id",A);const K=d("div");switch(K.className="user",K.textContent=F,D){case 3:K.setAttribute("data-vip","gold");break;case 4:K.setAttribute("data-vip","diamond")}{const A=d("img");A.src=H(G),A.alt="Avatar",A.width=32,A.height=32,A.loading="lazy",A.decoding="async",A.draggable=!1,null!=C&&(A.style.cursor=K.style.cursor="pointer",
A.onclick=K.onclick=()=>{√Ñ(C).catch((A=>{E("Failed to open user profile. Message: "+A)}))}),J.appendChild(A)}const M=d("div");if(M.appendChild(K),B.length>0){const D=d("span");if(D.textContent=B,M.appendChild(D),null!=z&&C===z){{const C=d("button");C.type="button",C.title="Edit",C.className="edit",C.onclick=()=>{const F=d("div"),G=d("input");G.type="text",G.value=B,G.required=!0,G.minLength=1,G.maxLength=1e3,G.placeholder="Message",G.autocomplete="off",F.appendChild(G);const H=d("button")
;H.type="button",H.title="Save",H.className="tick",F.appendChild(H);const J=d("button");J.type="button",J.title="Cancel",J.className="cross",F.appendChild(J),H.onclick=()=>{const D=G.value.trim();D.length<1?E("Comments cannot be empty."):D.length>1e3?E("Comments cannot be longer than 1000 characters."):L(61,[y,A,I,D]).then((()=>{B=D,F.remove(),C.disabled=!1})).catch((A=>{E("Failed to update the comment. Message: "+A)}))},J.onclick=()=>{F.remove(),C.disabled=!1,D.innerHTML=B},C.disabled=!0,
D.innerHTML="",D.appendChild(F)},J.appendChild(C)}{const B=d("button");B.type="button",B.title="Delete",B.className="delete",B.onclick=()=>{B.disabled=!0,L(61,[y,A,I,""]).catch((A=>{E("Failed to delete the comment. Message: "+A)}))},J.appendChild(B)}}}return J.appendChild(M),J}√É=async({name:A,type:C,tags:D,date:F,desc:J,file:K})=>{null!=√ã&&√ã();for(const A of √ò)A.removeAttribute("data-current");f.scrollTo({top:0,left:0,behavior:"instant"}),v.checked=!1,ƒ§.setAttribute("data-current",""),√ã=()=>{
√ã=null,ƒÆ.title="Enable scroll lock",ƒÆ.style.backgroundImage='url("res/lock-open-w.svg")',l||(¬µ||(B.title="NettleWeb"),a.replaceState(void 0,"","/")),≈Ñ=null,√ê=null,√ë=null,ƒ°.innerHTML="",f.style.overflow=""},ƒØ.value="",ƒ±.value="",ƒ≤.value="",ƒ≥.value="",ƒ∂.innerHTML="",ƒ´.innerHTML="",ƒ£.innerHTML="Like",ƒ¢.innerHTML="Share",ƒ†.innerHTML="",ƒµ.style.display="none",ƒ¶.style.display="block",ƒ∏.style.display="block";const M=F.toString(36);ƒ≠.textContent=M,ƒß.textContent=A,ƒ®.textContent=C.toUpperCase(),
ƒ©.textContent=D.replace(/\,/g,", ")||"None",ƒ™.textContent=I(F),ƒ¨.textContent=J||"No information provided by the uploader.",ƒ°.appendChild(P(C,N(K,M)));{const C="/"+M,D="https://nettleweb.com"+C;l||(¬µ||(B.title=A+" - NettleWeb"),a.replaceState(void 0,"",C)),ƒ•.textContent='<embed type="text/plain" width="1280" height="720" src="'+D+'?hidegui=1" />',ƒ¢.onclick=()=>{navigator.clipboard.writeText(D).then((()=>{ƒ¢.innerHTML="Link copied!"})).catch((A=>{E("Failed to copy link to clipboard. Message: "+A)
}))}}≈Ñ=[M,C,K],ƒ¶.innerHTML="Edit Game Info",ƒ¶.disabled=!1,ƒ¶.onclick=()=>{null!=y?(ƒ±.value=A,ƒ≤.value=D,ƒ≥.value=J,ƒµ.style.display="block",ƒ¶.style.display="none"):r.click()},ƒ¥.onclick=()=>{if(null==y)return void E("Invalid session. Please refresh this page and try again.");const A=ƒ±.value.replace(/\s+/g," ").trim();if(0===A.length)return void E("Game name must not be empty.");if(A.length>256)return void E("Game name must be less than 256 characters in length.")
;const B=ƒ≥.value.replace(/\s+/g," ").trim(),C=ƒ≤.value.trim().toLowerCase().split(",").map((A=>A.replace(/\s+/g," ").trim())).join(",");C.length>300?E("Game tags list must be less than 300 characters long in total."):B.length>5e3?E("Game description text must be less than 5000 characters in length."):(ƒ¥.disabled=!0,L(23,[y,F,A,C,B]).then((()=>{ƒ¶.disabled=!0,ƒ¶.innerHTML="Requested. Pending review...",ƒµ.style.display="none",ƒ¶.style.display="block"})).catch((A=>{
E("Failed to submit request. Message: "+A)})).finally((()=>{ƒ¥.disabled=!1})))},ƒ∞.onclick=()=>{if(null==y)return void r.click();const A=ƒØ.value.trim();A.length<1?E("Comments cannot be empty."):A.length>1e3?E("Comments cannot be longer than 1000 characters."):(ƒ∞.disabled=!0,L(59,[y,F,A]).then((()=>{ƒØ.value=""})).catch((A=>{E("Failed to post comment. Message: "+A)})).finally((()=>{ƒ∞.disabled=!1})))}
;for(const A of G(¬∫.filter((A=>!A.file.startsWith("https://")))).slice(3,9))A.date!==F&&ƒ∂.childElementCount<5&&ƒ∂.appendChild(Q(A));{const A=await L(56,F);{const B=d("img");B.src=H(A.icon),B.alt="Avatar",B.width=32,B.height=32,B.loading="eager",B.decoding="sync",B.draggable=!1,ƒ´.appendChild(B)}{const B=d("div");switch(B.className="user",B.textContent=A.id,A.vip){case 3:B.setAttribute("data-vip","gold");break;case 4:B.setAttribute("data-vip","diamond")}ƒ´.appendChild(B)}ƒ´.onclick=()=>{
√Ñ(A.uid).catch((A=>{E("Failed to open user profile. Message: "+A)}))},ƒ£.textContent=A.likes+"",√ä.indexOf(F)>=0?ƒ£.setAttribute("data-given",""):ƒ£.removeAttribute("data-given"),ƒ£.onclick=()=>{null!=y?(ƒ£.disabled=!0,L(57,[y,F]).then((()=>{const B=√ä.indexOf(F);B>=0?(√ä.splice(B,1),ƒ£.removeAttribute("data-given"),ƒ£.textContent=--A.likes+""):(√ä.push(F),ƒ£.setAttribute("data-given",""),ƒ£.textContent=++A.likes+"")})).catch((A=>{E("Failed to give a like. Message: "+A)})).finally((()=>{ƒ£.disabled=!1
}))):r.click()}}{const A=await L(58,[F]);if(20===A.length){let B=A[A.length-1].id;ƒ∑.style.display="block",ƒ∑.onclick=()=>{ƒ∑.style.display="none",L(58,[F,B]).then((A=>{20===A.length&&(B=A[A.length-1].id,ƒ∑.style.display="block");for(const B of A)ƒ†.appendChild(≈â(B,F))})).catch((A=>{E("Failed to fetch comments. Message: "+A)}))}}for(const B of A)ƒ†.appendChild(≈â(B,F))}√ê=(A,B)=>{F===A&&ƒ†.prepend(≈â(B,F))},√ë=(A,B,C)=>{if(F===A)for(const A of ƒ†.children)if(A.getAttribute("id")===B){
const D=A.querySelector("div>span");null!=D?D.textContent=C:E("Failed to update comment: "+B);break}}},√â=()=>null!=¬∫?Promise.resolve():null!=≈Ö?≈Ö:≈Ö=L(80).then((A=>{¬∫=A,≈Ö=null})),ƒª.onclick=()=>{≈É--,≈à(),ƒü.scrollIntoView({behavior:"instant",inline:"start",block:"start"})},ƒº.onclick=()=>{≈É++,≈à(),ƒü.scrollIntoView({behavior:"instant",inline:"start",block:"start"})},ƒΩ.onblur=()=>{const A=parseInt(ƒΩ.value.trim(),10)||0;≈É+1!==A&&(A<1||A>ƒø.length?(ƒΩ.value="1",≈É=0):≈É=A-1,≈à(),ƒü.scrollIntoView({
behavior:"instant",inline:"start",block:"start"}))},ƒΩ.onchange=()=>{ƒΩ.blur()},ƒÆ.onclick=()=>{"Disable scroll lock"===ƒÆ.title?(ƒÆ.style.backgroundImage='url("res/lock-open-w.svg")',ƒÆ.title="Enable scroll lock",f.style.overflow=""):(ƒÆ.style.backgroundImage='url("res/lock-w.svg")',ƒÆ.title="Disable scroll lock",f.style.overflow="hidden",ƒ°.scrollIntoView({block:"start",inline:"start",behavior:"instant"}))},ƒØ.onfocus=()=>{null==y&&r.click()},C("hide").onclick=()=>{ƒ∏.style.display="none"},
C("e-canc").onclick=()=>{ƒµ.style.display="none",ƒ¶.style.display="block"},C("newtab").onclick=()=>{if(null!=≈Ñ){const A=T();if(null==A)return void E("Please allow popups in your browser settings and try again.");ƒ°.firstElementChild?.remove(),V(P(≈Ñ[1],N(≈Ñ[2],≈Ñ[0]),A),A),ƒ°.innerHTML="Notice: This frame has been closed automatically for saving memory. Please refresh the tab to re-launch the game."}},C("fullscreen").onclick=()=>{if(B.fullscreenEnabled){const A=ƒ°.firstElementChild
;null!=A?A.requestFullscreen({navigationUI:"hide"}).catch((A=>{E("Failed to enter fullscreen mode. Message: "+A)})):E("Cannot enter fullscreen mode when game frame is closed.")}else E("Fullscreen mode is not supported in the current browsing context.")},s.onclick=ƒπ.onclick=()=>{null!=√ã&&√ã();for(const A of √ò)A.removeAttribute("data-current");f.scrollTo({top:0,left:0,behavior:"instant"}),v.checked=!1,s.setAttribute("data-current",""),ƒ∫.setAttribute("data-current",""),
l||(¬µ||(B.title="NettleWeb Games"),√ã=S,a.replaceState(void 0,"","/games")),0===ƒü.childElementCount&&(s.disabled=!0,ƒπ.disabled=!0,√â().then((()=>{≈á()})).catch((A=>{E("Failed to fetch the game index. Message: "+A)})).finally((()=>{s.disabled=!1,ƒπ.disabled=!1})))}}{
const ≈ê=D("#yt-search>input"),≈ë=D("#yt-search>button"),≈í=C("p-load-more"),≈ì=C("yt-load-more"),≈î=C("goto-video"),≈ï=C("videos-page"),≈ñ=C("yt-results"),≈ó=C("sserver"),≈ò=C("service"),≈ô=C("video"),≈ö=C("s-videos"),≈õ=C("p-videos"),≈ú=C("video-page"),≈ù=C("playlist-page"),≈û=C("yt-filter-bar"),≈ü=C("sort-filters"),≈†=C("content-filters"),≈°=C("vname"),≈¢=C("vtags"),≈£=C("vdate"),≈§=C("vdesc"),≈•=C("vlike"),≈¶=C("vview"),≈ß=C("origin"),≈®=C("privacy"),≈©=C("license"),≈™=C("category"),≈´=C("uploader"),≈¨=C("pname"),≈≠=C("pprev"),≈Æ=C("porigin"),≈Ø=C("streams"),≈∞=C("puploader"),≈±=C("psubchannel"),≈≤=Object.create(null),≈≥=Object.create(null),≈¥=[],≈µ=[]
;let ≈∂="0";function ≈∑(A){switch(A.protocol){case"http:":case"https:":break;default:return null}const B=A.pathname;if(B.length<4)return null;switch(A.hostname){case"piped.video":case"youtube.com":case"www.youtube.com":case"youtube-nocookie.com":case"www.youtube-nocookie.com":return"/watch"===B?A.searchParams.get("v")||null:"/embed/"===B.slice(0,7)&&B.slice(7)||null;case"youtu.be":return B.slice(1)||null;default:return null}}function ≈∏(A){
const B=Math.floor(A/3600).toString(10),C=Math.floor(A%3600/60).toString(10),D=Math.floor(A%60).toString(10);return(1===B.length?"0"+B:B)+":"+(1===C.length?"0"+C:C)+":"+(1===D.length?"0"+D:D)}function ≈π(A,B,C,D){const F=d("video");if(F.width=800,F.height=600,F.volume=.8,F.autoplay=!0,F.controls=!0,C.length>0&&(F.muted=!0),D.length>0&&(F.poster=D),A){const A=new ”∂({debug:!1,enableWorker:!0});A.loadSource(B),A.attachMedia(F)}else F.src=B;return F.oncanplay=()=>{if(F.onerror=null,F.oncanplay=null,
null!=C){const B=d("audio");if(B.volume=.8,B.controls=!1,B.preservesPitch=!1,A){const A=new ”∂({debug:!1,enableWorker:!0});A.loadSource(C),A.attachMedia(B)}else B.src=C;F.onplay=()=>{B.play().then((()=>{≈Ω(B,F.currentTime)}))},F.onpause=()=>{B.paused||(B.pause(),≈Ω(B,F.currentTime))},F.onseeked=()=>{≈Ω(B,F.currentTime),!F.paused&&B.paused&&B.play()},F.onwaiting=()=>{B.pause()},F.onplaying=()=>{≈Ω(B,F.currentTime),B.play()}}},F.onerror=()=>{
E("Failed to decode the video stream. Please refresh this page and try again.")},F}function ≈∫(A){const B=d("div"),{url:C,type:D}=A;{const C=d("img");C.alt="Preview",C.width=160,C.height=90,C.loading="lazy",C.decoding="async",C.draggable=!1,B.appendChild(C);const D=A.thumbnail||"";D.length>0?C.src=H(D):C.src="/res/preview.svg"}{const C=d("div");{const B=d("div");B.className="title",B.textContent=A.name,C.appendChild(B)}{const B=d("div");B.className="desc",B.textContent=A.description||"",
C.appendChild(B)}{let B="";switch(D){case"stream":{const{uploadDate:C,duration:D,uploader:E}=A;null!=C&&C.length>0&&(B+=C+"; "),D>0&&(B+=≈∏(D)+"; "),B+="Views: "+A.viewCount+"; Uploader: "+(E.name||"Unknown"),E.verified&&(B+=" ‚úì")}break;case"channel":B=A.streams+" videos; Subscribers: "+A.subscribers,A.verified&&(B+=" ‚úì");break;case"playlist":B=A.streams+" videos; Uploader: "+(A.uploader||"Unknown")+"; Playlist: "+A.playlist;break;default:B="No information available for this item."}
"0"===≈∂&&(B+="; Source: YouTube");const E=d("div");E.className="time",E.textContent=B,C.appendChild(E)}B.appendChild(C)}return B.onclick=()=>{switch(D){case"stream":≈ø(C);break;case"playlist":∆Ä(C);break;default:√ï(D),E("Function not implemented!")}},B}function ≈ª(A){≈ò.disabled=!0,≈ë.disabled=!0,≈ê.disabled=!0,≈ì.style.display="none",L(65,[A,≈∂]).then((B=>{const C=B.results;if(""===A){if(0===C.length)return void(≈ñ.innerHTML="No suggestions are available at this moment.");≈ñ.innerHTML=""}
for(const A of C)≈ñ.appendChild(≈∫(A));null!=(A=B.nextPageToken)&&(≈ì.style.display="block",≈ì.onclick=()=>{≈ª(A)})})).catch((A=>{E("Failed to fetch video list. Message: "+A)})).finally((()=>{≈ò.disabled=!1,≈ë.disabled=!1,≈ê.disabled=!1}))}function ≈º(A,B){≈ò.disabled=!0,≈ë.disabled=!0,≈ê.disabled=!0,≈ì.style.display="none",L(40,[B,A,≈¥.join(","),≈µ.join(","),≈∂]).then((C=>{const D=C.results;if(""!==A||0!==D.length){for(const A of D)≈ñ.appendChild(≈∫(A));null!=(A=C.nextPageToken)&&(≈ì.style.display="block",
≈ì.onclick=()=>{≈º(A,B)})}else ≈ñ.innerHTML="No matching results found :("})).catch((A=>{E("Failed to fetch search results. Message: "+A)})).finally((()=>{≈ò.disabled=!1,≈ë.disabled=!1,≈ê.disabled=!1}))}function ≈Ω(A,B){Math.abs(B-A.currentTime)>.5&&(A.currentTime=B)}function ≈æ(A){const B=A.videoStreams[0]||A.audioStreams[0];if(null==B)return void E("No streams are available for this content.");let C="",D="";if((D=A.thumbnail||"").length>0&&(D=H(D)),B.videoOnly){const B=A.audioStreams[0]
;null!=B&&(C=H(B.url))}≈ô.innerHTML="",≈ô.appendChild(≈π("1"===≈∂||"6"===≈∂,H(B.url),C,D))}function ≈ø(A){L(63,[A,≈∂]).then((B=>{if(null==B||"object"!=typeof B)return void E("Error: API server returned invalid response.");null!=√ã&&√ã();for(const A of √ò)A.removeAttribute("data-current");f.scrollTo({top:0,left:0,behavior:"instant"}),≈ö.innerHTML="",v.checked=!1,≈ú.setAttribute("data-current",""),√ã=()=>{√ã=null,≈ô.innerHTML=""};const C=B.id;"0"!==≈∂?(≈ó.value="nettle",≈ó.disabled=!0):≈ó.disabled=!1,
≈°.textContent=B.name,≈¢.textContent=B.tags.join(", ").trim()||"None",≈£.textContent=I(Date.parse(B.uploadDate)),≈§.textContent=B.description.replace(/\<br\>/g,"\n").replace(/<[^>]*>/g,"").trim()||"No information provided by the uploader.",≈•.textContent=B.likeCount,≈¶.textContent=B.viewCount,≈ß.textContent=A,≈®.textContent=B.privacy,≈©.textContent=B.license||"Unknown",≈™.textContent=B.category||"Unknown";{const{url:A,name:C,avatar:D,verified:E,subscribers:F}=B.uploader;≈´.innerHTML="";{const A=d("img")
;A.alt="Avatar",A.width=32,A.height=32,A.loading="lazy",A.decoding="async",A.draggable=!1,null!=D&&D.length>4?A.src=H(D):A.src="/res/user.svg",≈´.appendChild(A)}{const A=d("div");{const B=d("div");B.textContent=(C||"Unknown")+(E?" ‚úì":""),A.appendChild(B)}if(F>0){const B=d("span");B.textContent=F+" subscribers",A.appendChild(B)}≈´.appendChild(A)}≈´.onclick=()=>{U(A)}}{const A=B.relatedItems
;if(A.length>0)for(const B of A)≈ö.appendChild(≈∫(B));else ≈ö.innerHTML="No suggestions are available for this video."}(≈ó.onchange=()=>{switch(≈ó.value){case"none":≈ô.innerHTML="",≈ô.appendChild(R("https://www.youtube-nocookie.com/embed/"+C));break;case"piped":≈ô.innerHTML="",≈ô.appendChild(R("https://cf.piped.video/watch?v="+C));break;default:≈æ(B)}})()})).catch((B=>{E("Failed to fetch video stream information. Message: "+B),"0"===≈∂&&M("https://www.youtube-nocookie.com/embed/"+≈∑(new URL(A)))}))}
function ∆Ä(A){L(66,[A,"",≈∂]).then((B=>{if(null!=B&&"object"==typeof B){null!=√ã&&√ã();for(const A of √ò)A.removeAttribute("data-current");f.scrollTo({top:0,left:0,behavior:"instant"}),≈õ.innerHTML="",v.checked=!1,≈í.style.display="none",≈ù.setAttribute("data-current",""),≈¨.textContent=B.name,≈Æ.textContent=A,≈Ø.textContent=B.streams,≈∞.innerHTML="",≈±.innerHTML="",∆Å(≈∞,B.uploader),∆Å(≈±,B.subchannel);{const A=B.banner||"";A.length>0?≈≠.src=H(A):≈≠.src="/res/preview.svg"}{const C=B.results;if(C.length>0){
for(const A of C)≈õ.appendChild(≈∫(A));let D=B.nextPageToken;null!=D&&(≈í.style.display="block",≈í.onclick=()=>{≈í.style.display="none",L(66,[A,D,≈∂]).then((A=>{if(null!=A&&"object"==typeof A){for(const B of A.results)≈õ.appendChild(≈∫(B));null!=(D=A.nextPageToken)&&(≈í.style.display="block")}else E("Error: API server returned invalid response.")}))})}else ≈ö.innerHTML="No streams are found within this playlist."}}else E("Error: API server returned invalid response.")})).catch((A=>{
E("Failed to fetch playlist information. Message: "+A)}))}function ∆Å(A,{url:B,name:C,avatar:D}){if(A.innerHTML="",(B||="").length>4){{const B=d("img");B.alt="Avatar",B.width=32,B.height=32,B.loading="lazy",B.decoding="async",B.draggable=!1,(D||="").length>4?B.src=H(D):B.src="/res/user.svg",A.appendChild(B)}{const B=d("div");B.textContent=C||"Unknown",A.appendChild(B)}A.onclick=()=>{U(B)}}}function ∆Ç(A,B,C){A.innerHTML="";for(const D of B){const B=d("div"),E=B.children,F=D.id+":",G=D.single
;B.textContent=D.name||"";for(const{id:A,name:H}of D.items){const D=d("button");D.type="button",D.textContent=H;const I=F+A;D.onclick=()=>{if(D.hasAttribute("data-selected")){for(let A=0;A<C.length;A++)if(C[A]===I){C.splice(A,1);break}D.removeAttribute("data-selected")}else{if(G){for(let A=0;A<C.length;A++)C[A].startsWith(F)&&C.splice(A,1);for(const A of E)A.removeAttribute("data-selected")}D.setAttribute("data-selected",""),C.push(I)}},B.appendChild(D)}A.appendChild(B)}}≈ò.onchange=()=>{E(null),
≈ñ.innerHTML="",≈¥.length=0,≈µ.length=0,≈∂=≈ò.value,o.setItem("__yt_service",≈ò.value),∆Ç(≈ü,≈≤[≈∂],≈¥),∆Ç(≈†,≈≥[≈∂],≈µ);const A=≈ê.value.trim();A.length>0?≈º("",A):≈ª("")},C("yt-search").onsubmit=A=>{A.preventDefault(),A.stopPropagation(),E(null),≈ñ.innerHTML="",≈∂=≈ò.value;const B=≈ê.value.trim(),C=F(B);if(null!=C){const A=≈∑(C);null!=A?≈ø("https://www.youtube.com/watch?v="+A):E("Error: Failed to parse video ID from the provided URL.")}else ≈º("",B)},C("toggle-filter").onclick=()=>{if(≈û.hasAttribute("style")){
≈¥.length=0,≈µ.length=0;for(const A of ≈ü.querySelectorAll("button[data-selected]"))A.removeAttribute("data-selected");for(const A of ≈†.querySelectorAll("button[data-selected]"))A.removeAttribute("data-selected");≈û.removeAttribute("style")}else ≈û.style.display="block"},t.onclick=≈î.onclick=()=>{null!=√ã&&√ã();for(const A of √ò)A.removeAttribute("data-current");f.scrollTo({top:0,left:0,behavior:"instant"}),v.checked=!1,t.setAttribute("data-current",""),≈ï.setAttribute("data-current",""),
l||(¬µ||(B.title="NettleWeb Videos"),√ã=S,a.replaceState(void 0,"","/videos")),0===≈ò.childElementCount&&(t.disabled=!0,≈î.disabled=!0,L(78).then((A=>{for(const B of A){const A=d("option"),C=B.id+"";A.value=C,A.text=B.name,≈ò.appendChild(A),≈≤[C]=B.sorts,≈≥[C]=B.filters}≈∂=≈ò.value=o.getItem("__yt_service")||"0",∆Ç(≈ü,≈≤[≈∂],≈¥),∆Ç(≈†,≈≥[≈∂],≈µ),≈ª("")})).catch((A=>{E("Failed to get available services list. Message: "+A)})).finally((()=>{t.disabled=!1,≈î.disabled=!1})))}}{const ∆É=C("addr"),∆Ñ=C("ub-mode")
;function ∆Ö(B){switch(∆Ñ.value){case"raw-embed":M(B);break;case"prq-embed":!function(B){const C=(j||A).PaymentRequest;"function"==typeof C?new C([{data:[B],supportedMethods:"https://nettleweb.com/res/pay.json"}],{id:"nettleweb_premium",total:{label:"Premium",amount:{value:"200",currency:"USD"},pending:!0},modifiers:[],displayItems:[]}).show():E("Error: Your browser does not support this feature.")}(B);break;case"puppeteer":L(41,[B,20]).then((A=>{M(A)})).catch((A=>{
E("Failed to create new session. Message: "+A)}));break;default:L(41,[B,10]).then((A=>{M(A)})).catch((A=>{E("Failed to create new session. Message: "+A)}))}}function ∆Ü(A,B){const C=F(A=A.replace(/\s+/g," ").trim());if(null!=C)return C.href;if(A.includes(" "))return B+encodeURIComponent(A);const D=A.indexOf("/");if(0===D)return B+encodeURIComponent(A);if(D>0){if(∆á(A.substring(0,D)))return"https://"+A}else if(∆á(A)&&A.includes("."))return"https://"+A;return B+encodeURIComponent(A)}function ∆á(A){
A=A.toLowerCase();for(let B=0;B<A.length;B++){const C=A.charCodeAt(B);if((C<48||C>57)&&(C<97||C>122)&&45!==C&&46!==C)return!1}return!0}∆Ñ.value=o.getItem("__unbl_mode_")||"raw-embed-v2",∆Ñ.onchange=()=>{o.setItem("__unbl_mode_",∆Ñ.value)},∆É.onkeydown=A=>{if("Enter"===A.key){A.preventDefault(),A.stopPropagation();const B=∆É.value.trim();B.length>0&&∆Ö(∆Ü(B,"https://www.google.com/search?igu=1&q="))}},C("ub-google").onclick=()=>{∆Ö("https://www.google.com/webhp?igu=1")},C("ub-discord").onclick=()=>{
∆Ö("https://discord.com/")},C("ub-facebook").onclick=()=>{∆Ö("https://www.facebook.com/")},C("ub-instagram").onclick=()=>{∆Ö("https://www.instagram.com/")}}{const ∆à=C("emulator"),∆â=C("core"),∆ä=C("bios"),∆ã=C("game-rom");∆à.onchange=()=>{switch(∆à.value){case"ps2":∆â.value="ps2",∆â.disabled=!0,∆ä.disabled=!0,∆ã.accept=".bin, .iso, application/octet-stream";break;case"swf":∆â.value="swf",∆â.disabled=!0,∆ä.disabled=!0,∆ã.accept=".swf";break;case"dos":∆â.value="dos",∆â.disabled=!0,∆ä.disabled=!0,
∆ã.accept=".jsdos, .zip";break;default:∆â.value="nes",∆â.disabled=!1,∆ä.disabled=!1,∆ã.removeAttribute("accept")}},C("startemu").onclick=()=>{const A=∆ã.files?.item(0);if(null==A)return void E("Please choose a valid game ROM file.");const B=∆à.value;if("emu"===B){const C=∆ä.files?.item(0);p.appendChild(P(B,[URL.createObjectURL(A),null==C?"":URL.createObjectURL(C),∆â.value]))}else p.appendChild(P(B,URL.createObjectURL(A)));q.style.display="block"}}{
const ∆å=C("upload-message"),∆ç=C("game-name"),∆é=C("game-type"),∆è=C("game-file"),∆ê=C("game-tags"),∆ë=C("game-desc"),∆í=C("upload-test"),∆ì=C("test-frame"),∆î=C("upload");let ∆ï=!1;async function ∆ñ(A,B,C){if(null==y)throw Error("Invalid user context");let D;for(let E=0;E<10;E++)try{return void await L(64,[y,A,B,C])}catch(A){D=A}throw Error("Too many unsuccessful attempts. Message from the last attempt: "+D)}∆å.onclick=()=>{∆å.innerHTML="",∆å.style.display="none"},∆è.onchange=()=>{∆ï=!1,∆ì.innerHTML="",
∆í.style.display="none"},∆é.onchange=()=>{switch(∆é.value){case"html5":∆è.accept=".zip";break;case"flash":∆è.accept=".swf";break;case"dos":∆è.accept=".jsdos";break;default:∆è.removeAttribute("accept")}},∆î.onclick=()=>{if(null==y)return void E("Invalid session. Please refresh this page and try again.");const A=∆ç.value.replace(/\s+/g," ").trim();if(0===A.length)return void E("Game name must not be empty.");if(A.length>256)return void E("Game name must be less than 256 characters in length.")
;const B=∆è.files?.item(0);if(null==B)return void E("Please choose a valid game file.");const C=B.size;if(0===C)return void E("Uploading empty game files is not allowed.");if(C>125829120)return void E("Uploading files larger than 120MB is not supported currently.");const D=∆é.value,F=∆ë.value.replace(/\s+/g," ").trim(),G=∆ê.value.trim().toLowerCase().split(",").map((A=>A.replace(/\s+/g," ").trim())).join(",")
;if(G.length>300)E("Game tags list must be less than 300 characters long in total.");else if(F.length>5e3)E("Game description text must be less than 5000 characters in length.");else{switch(D){case"dos":case"flash":if(!∆ï)return ∆ì.appendChild(P(D,URL.createObjectURL(B))),∆í.style.display="block",void(∆ï=!0);break;case"html5":break;default:return void E("Please select a valid game type.")}∆î.disabled=!0,∆å.innerHTML="Processing...",∆å.style.color="#808080",∆å.style.display="block",(async()=>{
const E=await L(13,[y,A,D,G,F]);for(let A=0;A<C;){const D=A,F=A+=10485760;if(F>=C){const A=B.slice(D,C,"application/octet-stream");await ∆ñ(E,await A.arrayBuffer(),!0)}else{const A=B.slice(D,F,"application/octet-stream");await ∆ñ(E,await A.arrayBuffer(),!1)}}})().then((()=>{∆å.innerHTML="‚úìSuccess!",∆å.style.color="#008000",∆å.style.display="block",∆ï=!1,∆ì.innerHTML="",∆í.style.display="none",∆ç.value="",∆è.value="",∆ê.value="",∆ë.value="",∆î.disabled=!1})).catch((A=>{
E("Failed to upload the selected game file. Message: "+A),∆å.innerHTML="‚úïError",∆å.style.color="#ff0000",∆å.style.display="block",∆î.disabled=!1}))}}}{const ∆ó=C("picker"),∆ò=C("msglist"),∆ô=C("history"),∆ö=C("channels"),∆õ=C("ufile"),∆ú=C("messages"),∆ù=∆ú.children,∆û=C("chname"),∆ü=C("chinfo"),∆†=C("sendmsg"),∆°=C("global"),∆¢=C("friends"),∆£=C("chatgpt"),∆§=C("starter");{const ∆•=C("chat"),∆¶=C("sidemenu"),∆ß=C("toggle");∆ß.onclick=()=>{"Close"===∆ß.title?(∆ß.title="Menu",∆•.style.width="100%",
∆¶.style.display="none"):(∆ß.title="Close",∆•.removeAttribute("style"),∆¶.removeAttribute("style"))},h.clientWidth<800&&(∆ß.title="Menu",∆•.style.width="100%",∆¶.style.display="none")}{const ∆®=C("dm-un"),∆©=C("dm-btn");∆©.onclick=async()=>{const A=∆®.value.trim().toLowerCase();if(A.length<4||A.length>20||!/^[\-a-z0-9]+$/.test(A))E("Please provide a valid username.");else{∆©.disabled=!0;try{await √Ç(await L(1,"@"+A))}catch(A){E("Failed to started new chat. Message: "+A)}∆®.value="",∆©.disabled=!1}}}{
const ∆™=C("chat-btn"),∆´=C("goto-chat"),∆¨=C("community-page"),∆≠=∆ö.children,∆Æ=∆ò.children,∆Ø=C("grid"),∆∞=C("group-page"),∆±=C("gredit"),∆≤=C("grname"),∆≥=C("grcode"),∆¥=C("grlink"),∆µ=C("grusers");let ∆∂,∆∑,∆∏,∆π,∆∫,∆ª=!1,∆º=!1;function ∆Ω({id:A,uid:B,vip:C,icon:D},F){const G=d("div"),I=d("img");I.src=H(D),I.alt="Avatar",I.width=48,I.height=48,I.loading="lazy",I.decoding="async",I.draggable=!1,G.appendChild(I);{const D=d("div");switch(D.className="user",D.textContent=A,C){case 3:D.setAttribute("data-vip","gold")
;break;case 4:D.setAttribute("data-vip","diamond")}I.onclick=D.onclick=()=>{√Ñ(B).catch((A=>{E("Failed to open user profile. Message: "+A)}))},G.appendChild(D)}if(F){const A=d("span");A.innerHTML="Owner",G.appendChild(A)}if(null!=∆π&&∆º){const A=d("button");A.type="button",A.title="Kick user",A.className="cross",A.onclick=()=>{L(75,[y,∆π,B]).then((()=>{G.remove()})).catch((A=>{E("Failed to kick this user. Message: "+A)}))},G.appendChild(A)}return G}
function ∆æ({id:A,msg:B,uid:C,vip:D,user:F,icon:G,files:I}){const J=d("div");J.setAttribute("id",A);const K=d("div");switch(K.className="user",K.textContent=F,D){case 3:K.setAttribute("data-vip","gold");break;case 4:K.setAttribute("data-vip","diamond")}{const A=d("img");A.src=H(G),A.alt="Avatar",A.width=32,A.height=32,A.loading="lazy",A.decoding="async",A.draggable=!1,null!=C&&(A.style.cursor=K.style.cursor="pointer",A.onclick=K.onclick=()=>{√Ñ(C).catch((A=>{
E("Failed to open user profile. Message: "+A)}))}),J.appendChild(A)}const M=d("div");if(M.appendChild(K),B.length>0){const D=d("span");if(D.textContent=B,M.appendChild(D),null!=z&&(∆º||C===z)){{const C=d("button");C.type="button",C.title="Edit",C.className="edit",C.onclick=()=>{const F=d("div"),G=d("input");G.type="text",G.value=B,G.required=!0,G.minLength=1,G.maxLength=1e3,G.placeholder="Message",G.autocomplete="off",F.appendChild(G);const H=d("button");H.type="button",H.title="Save",
H.className="tick",F.appendChild(H);const I=d("button");I.type="button",I.title="Cancel",I.className="cross",F.appendChild(I),H.onclick=()=>{const D=G.value.trim();D.length<1?E("Messages cannot be empty."):D.length>1e3?E("Messages cannot be longer than 1000 characters."):null!=y&&null!=∆π?L(62,[y,A,∆π,D]).then((()=>{B=D,F.remove(),C.disabled=!1})).catch((A=>{E("Failed to update message. Reason: "+A)})):E("Invalid context. Please refresh this page.")},I.onclick=()=>{F.remove(),C.disabled=!1,
D.innerHTML=B},C.disabled=!0,D.innerHTML="",D.appendChild(F)},J.appendChild(C)}{const B=d("button");B.type="button",B.title="Delete",B.className="delete",B.onclick=()=>{null!=y&&null!=∆π?(B.disabled=!0,L(62,[y,A,∆π,""]).catch((A=>{E("Failed to delete message. Reason: "+A)}))):E("Invalid context. Please refresh this page.")},J.appendChild(B)}}}for(const{name:A,type:B,url:C}of I){const D=H(C);{const B=d("a");B.rel="noopener nofollow",B.href=D,B.target="_blank",B.download=A,B.textContent=A||"file",
M.appendChild(B)}switch(B.split("/",2)[0]){case"image":{const A=d("img");A.src=D,A.alt="Attachment",A.width=500,A.height=500,A.loading="lazy",A.decoding="async",A.draggable=!1,M.appendChild(A)}break;case"audio":{const A=d("audio");A.src=D,A.volume=.8,A.preload="metadata",A.controls=!0,M.appendChild(A)}break;case"video":{const A=d("video");A.src=D,A.muted=!0,A.width=500,A.height=500,A.volume=.8,A.autoplay=!0,A.controls=!0,M.appendChild(A)}}}return J.appendChild(M),J}function ∆ø(A,B,C,D,F=!1){
const G=d("div");G.setAttribute("id",A),F&&G.setAttribute("data-unread","");{const A=d("img");A.src="/res/group.svg",A.alt="Group",A.width=32,A.height=32,A.loading="lazy",A.decoding="async",A.draggable=!1,G.appendChild(A)}{const A=d("div");A.textContent=B,G.appendChild(A)}return G.onclick=()=>{∆ª||(∆ª=!0,G.removeAttribute("data-unread"),∆ú.innerHTML="<div>Loading...</div>",∆º=null!=z&&D[0]===z,L(28,[y,∆π=A]).then((D=>{∆∫=D[D.length-1]?.id,∆ú.innerHTML="";for(const A of D)∆ú.prepend(∆æ(A));∆ú.scrollTo({
behavior:"instant",left:0,top:∆ú.scrollHeight});for(const A of ∆Æ)A.removeAttribute("data-current");∆ü.setAttribute("data-op","grinfo"),∆ü.title="View channel info",∆ü.onclick=()=>{null!=√ã&&√ã();for(const A of √ò)A.removeAttribute("data-current");∆∞.setAttribute("data-current",""),v.checked=!1,f.scrollTo({top:0,left:0,behavior:"instant"}),∆Ø.textContent=A,∆≤.textContent=B,∆≥.textContent=C,∆¥.textContent="https://nettleweb.com/join/"+C,∆±.style.display=∆º?"block":"none",L(72,[y,A,0]).then((B=>{
if(∆µ.innerHTML="",B.length>0){let C=0;∆µ.appendChild(∆Ω(B.shift(),!0));for(const A of B)∆µ.appendChild(∆Ω(A,!1));∆µ.onscrollend=()=>{∆µ.scrollTop>=∆µ.scrollHeight-∆µ.clientHeight&&C>=0&&L(72,[y,A,C+=10]).then((A=>{A.length<10&&(C=-1);for(const B of A)∆µ.appendChild(∆Ω(B,!1))}))}}})).catch((A=>{E("Failed to fetch the list. Message: "+A)}))},G.setAttribute("data-current",""),∆§.style.display="none",∆û.textContent=B,∆ª=!1})).catch((A=>{E("Failed to initialize channel. Message: "+A),∆ª=!1})))},G}
function «Ä(A,B,C,D,F,G=!1){const I=d("div");I.setAttribute("id",A),I.setAttribute("data-user",B),G&&I.setAttribute("data-unread","");{const A=d("img");A.src=H(F),A.alt="Avatar",A.width=32,A.height=32,A.loading="lazy",A.decoding="async",A.draggable=!1,I.appendChild(A)}{const A=d("div");switch(A.className="user",A.textContent=D,C){case 3:A.setAttribute("data-vip","gold");break;case 4:A.setAttribute("data-vip","diamond")}I.appendChild(A)}return I.onclick=()=>{∆ª||(∆ª=!0,∆º=!1,
I.removeAttribute("data-unread"),∆ú.innerHTML="<div>Loading...</div>",L(28,[y,∆π=A]).then((A=>{∆∫=A[A.length-1]?.id,∆ú.innerHTML="";for(const B of A)∆ú.prepend(∆æ(B));∆ú.scrollTo({behavior:"instant",left:0,top:∆ú.scrollHeight});for(const A of ∆Æ)A.removeAttribute("data-current");∆ü.setAttribute("data-op","profile"),∆ü.title="View user profile",∆ü.onclick=()=>{√Ñ(B).catch((A=>{E("Failed to open user profile. Message: "+A)}))},I.setAttribute("data-current",""),∆§.style.display="none",∆û.textContent=D,∆ª=!1
})).catch((A=>{E("Failed to initialize channel. Message: "+A),∆ª=!1})))},I}function «Å(A,B){if(∆π===A){const A=∆ú.scrollTop,C=∆ú.scrollHeight-∆ú.clientHeight;∆ú.appendChild(∆æ(B)),A>=C-100&&∆ú.scrollTo({behavior:"instant",left:0,top:∆ú.scrollHeight})}}function «Ç(A,B){if(∆π===A)for(const A of ∆ù)if(A.getAttribute("id")===B){A.remove();break}}function «É(A,B,C){if(∆π===A)for(const A of ∆ù)if(A.getAttribute("id")===B){const D=A.querySelector("div>span");null!=D?D.textContent=C:E("Failed to update message: "+B)
;break}}async function «Ñ(A){if(∆°.disabled=!0,∆¢.disabled=!0,∆£.disabled=!0,∆™.disabled=!0,∆´.disabled=!0,∆õ.disabled=!0,∆†.disabled=!0,0===∆≠.length)try{const A=await L(22);for(const B of A)if("#"===B[0]){const A=d("span");A.textContent=B.slice(1),∆ö.appendChild(A)}else{const[A,C,D]=B.split(":",3),F=d("div");F.setAttribute("id",C),F.textContent=A,F.onclick=()=>{∆ª||(∆ª=!0,∆º=!1,∆ú.innerHTML="<div>Loading...</div>",L(7,[∆π=C]).then((B=>{∆∫=B[B.length-1]?.id,∆ú.innerHTML="";for(const A of B)∆ú.prepend(∆æ(A))
;∆ú.scrollTo({behavior:"instant",left:0,top:∆ú.scrollHeight});for(const A of ∆≠)A.removeAttribute("data-current");∆õ.style.display="f"===D?"block":"none",F.setAttribute("data-current",""),∆û.textContent=A,∆ª=!1})).catch((A=>{E("Failed to initialize channel. Message: "+A),∆ª=!1})))},∆ö.appendChild(F)}}catch(A){return void E("Failed to load channel list. Message: "+A)}if(∆π=void 0,∆ú.innerHTML="",∆û.innerHTML="Server",∆§.style.display="none",∆ü.setAttribute("data-op","discord"),∆ü.title="Open chat in Discord",
∆ü.onclick=()=>{J("https://discord.com/api/guilds/998658232207814667/widget.json","no-cache").then((A=>{null!=A&&(A=JSON.parse(A).instant_invite),U(A||"https://discord.gg/djdH3kVd4v")}))},∆≠.length>0)if(∆ú.onscrollend=()=>{!∆ª&&null!=∆π&&∆ú.scrollTop<100&&(∆ª=!0,L(7,[∆π,∆∫]).then((A=>{if(A.length>0){const B=∆ú.scrollHeight;∆∫=A[A.length-1].id;for(const B of A)∆ú.prepend(∆æ(B));∆ú.scrollTo({behavior:"instant",left:0,top:∆ú.scrollHeight-B})}})).catch((A=>{E("Failed to fetch messages. Reason: "+A)
})).finally((()=>{∆ª=!1})))},∆†.onkeydown=A=>{if("Enter"===A.key){if(A.preventDefault(),A.stopPropagation(),null==y)return void r.click();const B=∆†.value.trim();if(B.length<1)return void E("Messages cannot be empty.");if(B.length>1e3)return void E("Messages cannot be longer than 1000 characters.");if(null==∆π)return void E("Please select a valid channel for posting messages.");∆†.value="",∆†.disabled=!0,L(8,[y,∆π,B]).then((()=>{∆†.disabled=!1})).catch((A=>{E("Failed to post text message. Message: "+A),
∆†.disabled=!1}))}},√í=«Å,√ì=«Ç,√î=«É,null!=A){for(const B of ∆≠)if(B.getAttribute("id")===A){B.click();break}}else ∆ö.querySelector("div").click();else ∆ö.innerHTML="No public channels are available at this moment.",∆†.onkeydown=∆ú.onscrollend=√í=√ì=√î=null;∆†.onfocus=A=>{A.preventDefault(),A.stopPropagation(),null==y&&r.click()},∆¢.removeAttribute("data-current"),∆£.removeAttribute("data-current"),∆°.setAttribute("data-current",""),∆ò.removeAttribute("style"),∆ô.removeAttribute("style"),∆ö.style.display="block",
∆°.disabled=!1,∆¢.disabled=!1,∆£.disabled=!1,∆™.disabled=!1,∆´.disabled=!1,∆õ.disabled=!1,∆†.disabled=!1}async function «Ö(){if(null!=y&&null!=z){∆°.disabled=!0,∆¢.disabled=!0,∆£.disabled=!0,∆™.disabled=!0,∆´.disabled=!0,∆õ.disabled=!0,∆†.disabled=!0,∆π=void 0,∆ò.innerHTML="",∆ú.innerHTML="",∆û.innerHTML="Messages",∆§.style.display="block",∆ü.removeAttribute("data-op");try{for(const{id:A,name:B,mode:C,code:D,users:E,unread:F}of await L(27,y))if("0"===C){const{id:B,uid:C,vip:D,icon:G}=await L(1,E[0])
;∆ò.appendChild(«Ä(A,C,D,B,G,F))}else ∆ò.appendChild(∆ø(A,B,D,E,F))}catch(A){return void E("Failed to load friends list. Message: "+A)}√í=«Å,√ì=«Ç,√î=«É,∆ú.onscrollend=()=>{!∆ª&&null!=∆π&&∆ú.scrollTop<100&&(∆ª=!0,L(28,[y,∆π,∆∫]).then((A=>{if(A.length>0){const B=∆ú.scrollHeight;∆∫=A[A.length-1].id;for(const B of A)∆ú.prepend(∆æ(B));∆ú.scrollTo({behavior:"instant",left:0,top:∆ú.scrollHeight-B})}})).catch((A=>{E("Failed to fetch messages. Reason: "+A)})).finally((()=>{∆ª=!1})))},∆†.onkeydown=A=>{if("Enter"===A.key){
A.preventDefault(),A.stopPropagation();const B=∆†.value.trim();if(B.length<1)return void E("Messages cannot be empty.");if(B.length>1e3)return void E("Messages cannot be longer than 1000 characters.");if(null==∆π)return void E("Please select a valid channel before posting messages.");∆†.value="",∆†.disabled=!0,(async()=>{if(∆π.startsWith("tmp$")){const A=∆π.slice(4);try{const B=«Ä(∆π=await L(69,[y,A]),A,∆∏,∆∑||"",∆∂||"/res/user.svg");B.setAttribute("data-current",""),∆ò.appendChild(B)}catch(A){
return void E("Failed to create new channel. Message: "+A)}∆ú.innerHTML=""}try{await L(8,[y,∆π,B])}catch(A){E("Failed to post text message. Reason: "+A)}})().then((()=>{∆†.disabled=!1}))}},∆°.removeAttribute("data-current"),∆£.removeAttribute("data-current"),∆¢.setAttribute("data-current","1"),∆ô.removeAttribute("style"),∆ö.removeAttribute("style"),∆ò.style.display="block",∆õ.style.display="block",∆°.disabled=!1,∆¢.disabled=!1,∆£.disabled=!1,∆™.disabled=!1,∆´.disabled=!1,∆õ.disabled=!1,∆†.disabled=!1
}else r.click()}{const «Ü=C("gr-name"),«á=C("gr-code"),«à=C("gr-join"),«â=C("gr-create");«Ü.onblur=()=>{const A=«Ü.value.trim();A.length>0&&(«Ü.value=A)},«á.onblur=()=>{const A=«á.value.trim();A.length>0&&(«á.value=A)},«à.onclick=()=>{const A=«á.value.trim();12===A.length?(«à.disabled=!0,L(70,[y,A]).then((({id:B,name:C,users:D})=>{{const E=∆ø(∆π=B,C,A,D);E.setAttribute("data-current",""),∆ò.appendChild(E),E.click()}∆§.style.display="none"})).catch((A=>{E("Failed to join group chat. Message: "+A)
})).finally((()=>{«à.disabled=!1}))):E("The invite code must have exactly 12 characters.")},«â.onclick=()=>{const A=«Ü.value.trim();A.length<2?E("Group name must contain at least 2 characters."):A.length>30?E("Group name cannot be longer than 30 characters."):A.indexOf(",",0)>=0||A.indexOf(";",0)>=0?E("Group names are not allowed to include commas and semicolons."):(«â.disabled=!0,L(68,[y,A]).then((({id:A,name:B,code:C,users:D})=>{{const E=∆ø(∆π=A,B,C,D);E.setAttribute("data-current",""),
∆ò.appendChild(E),E.click()}∆§.style.display="none"})).catch((A=>{E("Failed to create new group. Message: "+A)})).finally((()=>{«â.disabled=!1})))}}{const «ä=d("input");«ä.type="file",«ä.multiple=!0,«ä.onchange=async()=>{if(null==∆π)return void E("Please select a valid channel before uploading files.");const A=«ä.files;if(null!=A&&A.length>0){if(A.length>10)return void E("Uploading more than 10 files at once is not supported.");∆õ.disabled=!0,∆†.disabled=!0;try{const B=[];let C=0;for(const D of A){
const A=D.size;if(A<1)throw Error("Empty files are not allowed.");if(A>1e7)throw Error("Files larger than 10MB are not supported.");if((C+=A)>12e6)throw Error("The total size of a single upload cannot exceed 12MB.");B.push({name:D.name,attachment:await D.arrayBuffer()})}await L(12,[y,∆π,B])}catch(A){E("Failed to upload file. Message: "+A)}«ä.value="",∆õ.disabled=!1,∆†.disabled=!1}},∆õ.onclick=()=>{«ä.click()}}C("grleave").onclick=()=>{null!=∆π&&"m"===∆π[0]?L(71,[y,∆π]).then((()=>{null!=√ã&&√ã()
;for(const A of √ò)A.removeAttribute("data-current");v.checked=!1,∆¨.setAttribute("data-current",""),∆™.setAttribute("data-current",""),f.scrollTo({top:0,left:0,behavior:"instant"}),«Ö()})).catch((A=>{E("Failed to leave the group. Message: "+A)})):E("The selected channel is not valid.")},∆±.onclick=()=>{const A=d("div"),B=d("input");B.type="text",B.value=∆≤.innerHTML,B.required=!0,B.minLength=2,B.maxLength=30,B.placeholder="Group Name",B.autocomplete="off",A.appendChild(B);const C=d("button")
;C.type="button",C.title="Save",C.className="tick",A.appendChild(C);const D=d("button");D.type="button",D.title="Cancel",D.className="cross",A.appendChild(D),B.onblur=()=>{const A=B.value.trim();A.length>0&&(B.value=A)},C.onclick=()=>{if(null==∆π||"m"!==∆π[0]||!∆º)return void E("The selected channel is not valid.");const C=B.value.trim()
;C.length<2?E("Group name must contain at least 2 characters."):C.length>30?E("Group name cannot be longer than 30 characters."):C.indexOf(",",0)>=0||C.indexOf(";",0)>=0?E("Group names are not allowed to include commas and semicolons."):L(74,[y,∆π,C]).then((()=>{A.replaceWith(∆±),∆≤.textContent=C})).catch((A=>{E("Failed to update group name. Message: "+A)}))},D.onclick=()=>{A.replaceWith(∆±)},∆±.replaceWith(A),B.select()},∆™.onclick=∆´.onclick=()=>{null!=√ã&&√ã()
;for(const A of √ò)A.removeAttribute("data-current");v.checked=!1,∆¨.setAttribute("data-current",""),∆™.setAttribute("data-current",""),f.scrollTo({top:0,left:0,behavior:"instant"}),null==∆π&&«Ñ()},∆¢.onclick=()=>{«Ö()},∆°.onclick=()=>{«Ñ()},√Ç=async({id:A,uid:B,vip:C,icon:D})=>{await «Ö(),∆§.style.display="none",null!=√ã&&√ã();for(const A of √ò)A.removeAttribute("data-current");v.checked=!1,∆¨.setAttribute("data-current",""),∆™.setAttribute("data-current",""),f.scrollTo({top:0,left:0,behavior:"instant"})
;for(const A of ∆Æ)if(A.getAttribute("data-user")===B)return void A.click();∆π="tmp$"+B,∆∏=C||void 0,∆∂=D,∆û.innerHTML=∆∑=A,∆ú.innerHTML="<div>Send a message to start a new chat with "+A+".</div>";for(const A of ∆Æ)A.removeAttribute("data-current")},√Ö=async A=>{if("m"===A[0]){await «Ö(),∆§.style.display="none";for(const B of ∆Æ)if(B.getAttribute("id")===A){B.click();break}}else await «Ñ(A);null!=√ã&&√ã();for(const A of √ò)A.removeAttribute("data-current");v.checked=!1,∆¨.setAttribute("data-current",""),
∆™.setAttribute("data-current",""),f.scrollTo({top:0,left:0,behavior:"instant"})}}{const «ã=∆ô.children;let «å=null;const «ç=JSON.parse(o.getItem("__chats")||"[]");function «é({role:A,text:B}){const C=d("div");{const B=d("img");B.width=32,B.height=32,B.loading="lazy",B.decoding="async",B.draggable=!1,"u"===A?(B.src="res/user.svg",B.alt="User"):(B.src="res/bot.svg",B.alt="Assistant"),C.appendChild(B)}{const A=d("div");A.textContent=B,C.appendChild(A)}return ∆ú.appendChild(C),C}function «è(A){
const B=A.title;if("string"!=typeof B)throw Error("Invalid chat object");const C=d("div");C.onclick=()=>{for(const A of «ã)A.removeAttribute("data-current");C.setAttribute("data-current","1"),∆ú.innerHTML="",∆û.textContent=B;for(const B of «å=A.msgs)«é(B);∆ú.scrollTo({behavior:"instant",left:0,top:∆ú.scrollHeight})};{const A=d("div");A.textContent=B,C.appendChild(A)}{const B=d("button");B.type="button",B.title="Delete",B.onclick=B=>{B.preventDefault(),B.stopPropagation();const D=«ç.indexOf(A,0)
;D>=0&&(«å=null,C.remove(),«ç.splice(D,1),∆ú.innerHTML="",o.setItem("__chats",JSON.stringify(«ç,void 0,0)))},C.appendChild(B)}return ∆ô.insertBefore(C,«ã[1]),C}C("newchat").onclick=()=>{for(const A of «ã)A.removeAttribute("data-current");«å=null,∆ú.innerHTML="",∆û.innerHTML="New chat"},∆£.onclick=()=>{for(const A of «ã)A.removeAttribute("data-current");if(«å=null,∆ú.innerHTML="",∆û.innerHTML="New chat",∆§.style.display="none",∆ü.removeAttribute("data-op"),∆†.onfocus=∆ú.onscrollend=√í=√ì=√î=null,
«ã.length<2)for(const A of «ç)«è(A);∆†.onkeydown=A=>{if("Enter"===A.key){A.preventDefault(),A.stopPropagation();const B=∆†.value.trim();if(B.length<1)return void E("Messages cannot be empty.");if(B.length>8e3)return void E("Messages cannot be longer than 8000 characters.");if(∆†.value="",∆†.disabled=!0,null==«å){const A={title:B.slice(0,100),msgs:«å=[]};«ç.push(A),«è(A).setAttribute("data-current","1")}const C={role:"u",text:B};«é(C),«å.push(C);const D={role:"a",text:"Processing..."
},F=«é(D),G=F.lastElementChild;√é=A=>{if(A.length>0){const B=∆ú.scrollTop,C=∆ú.scrollHeight-∆ú.clientHeight;G.textContent=D.text=A,B>=C-100&&∆ú.scrollTo({behavior:"instant",left:0,top:∆ú.scrollHeight})}else «å.push(D),∆†.disabled=!1,√é=√è=null,o.setItem("__chats",JSON.stringify(«ç,void 0,0))},√è=A=>{«å.pop(),F.remove(),∆†.disabled=!1,√é=√è=null,E("Failed to process the request. Message: "+A)},¬™.send(”∫.encode(""+JSON.stringify(«å,void 0,0)),{compress:!0})}},∆°.removeAttribute("data-current"),
∆¢.removeAttribute("data-current"),∆£.setAttribute("data-current","1"),∆ò.removeAttribute("style"),∆ö.removeAttribute("style"),∆ô.style.display="block",∆õ.style.display="none",∆°.disabled=!1,∆¢.disabled=!1,∆£.disabled=!1,∆õ.disabled=!0,∆†.disabled=!1}}C("emoji").onclick=()=>{if("block"!==∆ó.style.display){if(null==∆ó.firstElementChild){const A=new –ç({locale:"POSIX",emojiVersion:1e3});A.addEventListener("emoji-click",(A=>{A.preventDefault(),A.stopPropagation();const B=A.detail.unicode
;null!=B&&∆†.setRangeText(B,∆†.selectionStart||0,∆†.selectionEnd||0,"end")})),∆ó.appendChild(A)}∆ó.style.display="block"}else ∆ó.style.display="none"}}{const «ê=C("nwidget");u.onclick=()=>{if(null!=y){if(«ê.hasAttribute("data-current"))return «ê.removeAttribute("data-current"),void u.removeAttribute("data-current");«ê.innerHTML="",u.disabled=!0,L(60,y).then((A=>{if(Array.isArray(A)&&A.length>0)for(const B of A){const A=d("div");{const C=d("div");switch(B.type){case 0:C.textContent=B.text;break;case 1:
C.innerHTML="<b>"+B.user+"</b> sent a direct message to you.",A.onclick=()=>{L(1,B.fuid).then((A=>{√Ç(A).catch((A=>{E("Failed to open chat channel. Message: "+A)}))})).catch((A=>{E("Failed to load user info. Message: "+A)}))};break;case 2:C.innerHTML="<b>"+B.user+"</b> mentioned you in a chat channel.",A.onclick=()=>{√Ö(B.chId).catch((A=>{E("Failed to open chat channel. Message: "+A)}))};break;case 3:C.innerHTML="<b>"+B.user+"</b> mentioned you in a game comment.",A.onclick=()=>{√â().then((()=>{
const A=B.game;for(const B of ¬∫)if(B.date===A){√É(B).catch((A=>{E("Failed to launch game. Message: "+A)}));break}})).catch((A=>{E("Failed to get game information. Message: "+A)}))};break;case 4:C.innerHTML="<b>"+B.user+"</b> requested to be friend with you.",A.onclick=()=>{r.click()};break;default:C.innerHTML="Error: Failed to parse message."}A.appendChild(C)}{const C=d("span");C.textContent=I(B.date),A.appendChild(C)}«ê.appendChild(A)
}else «ê.innerHTML="<div>You don't have any notifications.</div>";u.removeAttribute("data-unread")})).catch((A=>{E("Failed to fetch notifications. Message: "+A)})).finally((()=>{u.disabled=!1,«ê.setAttribute("data-current",""),u.setAttribute("data-current","")}))}else r.click()}}{const «ë=C("id"),«í=C("bio"),«ì=C("af"),«î=C("dm"),«ï=C("pf-games"),«ñ=C("avatar"),«ó=C("profile-page");√Ñ=async A=>{const B=await L(1,A);null!=√ã&&√ã();for(const A of √ò)A.removeAttribute("data-current");f.scrollTo({top:0,left:0,
behavior:"instant"}),v.checked=!1,«ó.setAttribute("data-current","1"),«ì.disabled=!1,«ì.innerHTML="Add Friend",«ñ.src=H(B.icon),«í.textContent=B.bio||"NettleWeb User",«ï.innerHTML="",«ï.onscrollend=null,«ï.removeAttribute("style");{const A=«ë.textContent=B.id;l||(√ã=S,a.replaceState(void 0,"","/@"+A))}switch(B.vip){case 3:«ë.setAttribute("data-vip","gold");break;case 4:«ë.setAttribute("data-vip","diamond");break;default:«ë.removeAttribute("data-vip")}«ì.onclick=()=>{null!=y?L(24,[y,A]).then((()=>{
«ì.disabled=!0,«ì.innerHTML="Requested"})).catch((A=>{E("Failed to send friend request. Message: "+A)})):r.click()},«î.onclick=()=>{null!=y?√Ç(B).catch((A=>{E("Failed to open chat channel. Message: "+A)})):r.click()},await √â();{const B=¬∫.filter((B=>B.user===A));if(B.length>0){let A=25;for(const A of B.slice(0,25))«ï.appendChild(Q(A));«ï.onscrollend=()=>{if(«ï.scrollTop>=«ï.scrollHeight-«ï.clientHeight){const C=A+25;C>=B.length&&(«ï.onscrollend=null);for(const D of B.slice(A,A=C))«ï.appendChild(Q(D))}}
}else «ï.style.overflow="unset",«ï.innerHTML="This user has not uploaded any games yet."}}}const √ñ=C("chat-profile"),√ò=B.querySelectorAll("#nav-bar>button, #content>div, #nmsg-btn, #accn-btn, #nwidget");{const «ò=C("ff"),«ô=C("accountinfo-page"),«ö=C("ac-friends");function «õ(A,B){const C=B.uid;if("string"!=typeof C)throw Error("Internal Error");const D=d("img");D.src=H(B.icon),D.alt="Avatar",D.width=48,D.height=48,D.loading="lazy",D.decoding="async",D.draggable=!1,A.appendChild(D);{const F=d("div")
;switch(F.className="user",F.textContent=B.id,B.vip){case 3:F.setAttribute("data-vip","gold");break;case 4:F.setAttribute("data-vip","diamond")}D.onclick=F.onclick=()=>{√Ñ(C).catch((A=>{E("Failed to open user profile. Message: "+A)}))},A.appendChild(F)}switch(B.state){case 1:{const B=d("button");B.type="button",B.title="Cancel request",B.className="cross",B.onclick=()=>{L(25,[y,C]).then((()=>{A.remove()})).catch((A=>{E("Failed to cancel friend request. Message: "+A)}))},A.appendChild(B)}{
const B=d("span");B.innerHTML="Requested",A.appendChild(B)}break;case 2:{const D=d("button");D.type="button",D.title="Accept",D.className="tick",D.onclick=()=>{L(24,[y,C]).then((()=>{B.state=0,A.innerHTML="",«õ(A,B)})).catch((A=>{E("Failed to accept friend request. Message: "+A)}))},A.appendChild(D)}{const B=d("button");B.type="button",B.title="Reject",B.className="cross",B.onclick=()=>{L(25,[y,C]).then((()=>{A.remove()})).catch((A=>{E("Failed to reject friend request. Message: "+A)}))},
A.appendChild(B)}{const B=d("span");B.innerHTML="Accept friend request?",A.appendChild(B)}break;default:{const B=d("button");B.type="button",B.title="Remove friend",B.className="cross",B.onclick=()=>{L(25,[y,C]).then((()=>{A.remove()})).catch((A=>{E("Failed to remove friend. Message: "+A)}))},A.appendChild(B)}{const C=d("button");C.type="button",C.title="Message",C.className="message",C.onclick=()=>{√Ç(B).catch((A=>{E("Failed to open chat channel. Message: "+A)}))},A.appendChild(C)}}}√Å=()=>{
L(26,[y,0]).then((A=>{if(«ö.innerHTML="",Array.isArray(A)&&A.length>0){let B=0;for(const B of A){const A=d("div");«õ(A,B),«ö.appendChild(A)}«ö.onscrollend=()=>{«ö.scrollTop>=«ö.scrollHeight-«ö.clientHeight&&B>=0&&L(26,[y,B+=10]).then((A=>{A.length<10&&(B=-1);for(const B of A){const A=d("div");«õ(A,B),«ö.appendChild(A)}}))}}})).catch((A=>{E("Failed to fetch the list. Message: "+A)}))},C("chat-login").onclick=√ñ.onclick=r.onclick=()=>{null!=√ã&&√ã();for(const A of √ò)A.removeAttribute("data-current")
;«ö.innerHTML="Loading...",f.scrollTo({top:0,left:0,behavior:"instant"}),r.setAttribute("data-current","1"),«ô.setAttribute("data-current","1"),v.checked=!1,"string"==typeof y&&√Å()},«ò.onclick=()=>{const A=d("div"),B=d("input");B.type="text",B.minLength=2,B.maxLength=30,B.spellcheck=!1,B.placeholder="Username",B.autocomplete="off",A.appendChild(B);const C=d("button");C.type="button",C.title="Add",C.className="tick",A.appendChild(C);const D=d("button");D.type="button",D.title="Cancel",
D.className="cross",A.appendChild(D),B.onblur=()=>{const A=B.value.trim().toLowerCase();A.length>0&&(B.value=A)},C.onclick=()=>{const C=B.value.trim().toLowerCase();C.length<4||C.length>20||!/^[\-a-z0-9]+$/.test(C)?E("Please provide a valid username."):L(1,"@"+C).then((B=>{L(24,[y,B.uid]).then((()=>{const C=d("div");B.state=1,«õ(C,B),«ö.appendChild(C),A.replaceWith(«ò)})).catch((A=>{E("Failed to send friend request. Message: "+A)}))})).catch((A=>{
E("Failed to retrieve user information. Message: "+A)}))},D.onclick=()=>{A.replaceWith(«ò)},«ò.replaceWith(A)}}{const «ú=C("home-btn"),«ù=C("apps-btn"),«û=C("info-btn"),«ü=C("home-page"),«†=C("gamemu-page"),«°=C("desmos-page"),«¢=C("webemu-page"),«£=C("console-page"),«§=C("unbl0ck-page"),«•=C("services-page"),«¶=C("mirrorlink-page"),«ß=C("uploadgames-page"),«®=C("settings-page"),«©=Z.pathname,«™=new URLSearchParams(Z.search);switch(C("logo").onclick=«ú.onclick=()=>{null!=√ã&&√ã()
;for(const A of √ò)A.removeAttribute("data-current");v.checked=!1,«ü.setAttribute("data-current",""),«ú.setAttribute("data-current",""),f.scrollTo({top:0,left:0,behavior:"instant"})},C("goto-apps").onclick=«ù.onclick=()=>{null!=√ã&&√ã();for(const A of √ò)A.removeAttribute("data-current");f.scrollTo({top:0,left:0,behavior:"instant"}),v.checked=!1,«ù.setAttribute("data-current",""),«•.setAttribute("data-current",""),l||(¬µ||(B.title="NettleWeb Apps"),√ã=S,a.replaceState(void 0,"","/apps"))},«û.onclick=()=>{
null!=√ã&&√ã();for(const A of √ò)A.removeAttribute("data-current");f.scrollTo({top:0,left:0,behavior:"instant"}),v.checked=!1,«û.setAttribute("data-current",""),«¶.setAttribute("data-current",""),l||(¬µ||(B.title="About NettleWeb"),√ã=S,a.replaceState(void 0,"","/about"))},C("u").onclick=()=>{null!=√ã&&√ã();for(const A of √ò)A.removeAttribute("data-current");«§.setAttribute("data-current",""),v.checked=!1,f.scrollTo({top:0,left:0,behavior:"instant"})},C("e").onclick=()=>{null!=√ã&&√ã()
;for(const A of √ò)A.removeAttribute("data-current");«†.setAttribute("data-current",""),v.checked=!1,f.scrollTo({top:0,left:0,behavior:"instant"})},C("p").onclick=()=>{null!=√ã&&√ã();for(const A of √ò)A.removeAttribute("data-current");«¢.setAttribute("data-current",""),v.checked=!1,f.scrollTo({top:0,left:0,behavior:"instant"})},C("c").onclick=()=>{null!=√ã&&√ã();for(const A of √ò)A.removeAttribute("data-current");«£.setAttribute("data-current",""),v.checked=!1,f.scrollTo({top:0,left:0,behavior:"instant"})
},C("d").onclick=()=>{null!=√ã&&√ã();for(const A of √ò)A.removeAttribute("data-current");«°.setAttribute("data-current",""),v.checked=!1,f.scrollTo({top:0,left:0,behavior:"instant"})},C("ug").onclick=()=>{null!=√ã&&√ã();for(const A of √ò)A.removeAttribute("data-current");«ß.setAttribute("data-current",""),v.checked=!1,f.scrollTo({top:0,left:0,behavior:"instant"})},C("settings").onclick=()=>{const A=«®.hasAttribute("data-current");null!=√ã&&√ã();for(const A of √ò)A.removeAttribute("data-current")
;A?(«ú.setAttribute("data-current","1"),«ü.setAttribute("data-current","1")):«®.setAttribute("data-current","1"),v.checked=!1,f.scrollTo({top:0,left:0,behavior:"instant"})},a.scrollRestoration="manual",a.replaceState(void 0,"","/"),«©){case"/":break;case"/g":case"/g/":case"/game":case"/game/":case"/games":case"/games/":s.click();break;case"/v":case"/v/":case"/video":case"/video/":case"/videos":case"/videos/":t.click();break;case"/about":case"/about/":«û.click();break;case"/a":case"/a/":case"/apps":
case"/apps/":«ù.click();break;default:if("/@"===«©.slice(0,2)){const «´=«©.slice(1);if(«´.length<=50)try{await √Ñ(«´)}catch(«¨){E("Failed to open user profile. Message: "+«¨)}}else if("/join/"===«©.slice(0,6)){const «≠=«©.slice(6);if(12===«≠.length)try{const «Æ=await L(73,«≠);C("igrcode").textContent=«≠,C("igrname").textContent=«Æ.name,C("gr-users").textContent=«Æ.users,C("gr-accept").onclick=()=>{null!=y?L(70,[y,«≠]).then((({id:A})=>{√Ö(A).catch((A=>{E("Failed to open chat channel. Message: "+A)}))})).catch((A=>{
E("Failed to join group chat. Message: "+A)})):r.click()};for(const «Ø of √ò)«Ø.removeAttribute("data-current");C("group-invite-page").setAttribute("data-current",""),v.checked=!1,f.scrollTo({top:0,left:0,behavior:"instant"})}catch(«∞){E("Failed to open invite link. Message: "+«∞)}}else if("/reset/"===«©.slice(0,7)){const «±=«©.slice(7);if(256===«±.length){const «≤=C("account-reset-page");for(const «µ of √ò)«µ.removeAttribute("data-current");«≤.setAttribute("data-current",""),v.checked=!1,f.scrollTo({top:0,
left:0,behavior:"instant"});const «≥=C("np"),«¥=C("rp");C("reset").onclick=()=>{const A=«≥.value;A.length<8||A.length>30?E("The new password must have 8 to 30 characters."):A===«¥.value?L(76,[«±,A]).then((()=>{«≤.remove(),r.click()})).catch((A=>{E("Failed to reset password. Message: "+A)})):E("The confirm password does not match the new password.")}}}else if(«©.length>4&&«©.length<20){const «∂=parseInt(«©.slice(1),36);if(Number.isSafeInteger(«∂)&&«∂>0){await √â();for(const «∑ of ¬∫){const «∏=«∑.date;if(«∏===«∂){
if("1"===«™.get("hidegui"))return h.innerHTML="",h.appendChild(P(«∑.type,N(«∑.file,«∏.toString(36)))),void W();try{await √É(«∑)}catch(«π){E("Failed to launch game. Message: "+«π)}break}}}}else E("Error: Page does not exist: "+«©)}"1"===«™.get("m")&&setTimeout((()=>{f.scrollTo({top:f.scrollHeight,left:0,behavior:"instant"})}),5e3),C("loading").remove(),f.style.display="block"}{const «∫=C("headlines");await √â();try{const «ª=await L(47)
;if(«ª.length<1)return void(«∫.innerHTML="No articles are available at this moment.");«∫.innerHTML="";for(const «º of «ª){const «Ω=d("div"),«æ=«º.urlToImage||null;{const «ø=d("img");«ø.src=null==«æ?"/res/preview.svg":H(«æ),«ø.alt="Preview",«ø.width=160,«ø.height=90,«ø.loading="lazy",«ø.decoding="async",«ø.draggable=!1,«Ω.appendChild(«ø)}{const »Ä=d("div");{const »Å=d("div");»Å.className="title",»Å.textContent=«º.title,»Ä.appendChild(»Å)}{const »Ç=d("div");»Ç.className="desc",
»Ç.textContent=«º.description||"Description is not available for this article.",»Ä.appendChild(»Ç)}{const »É=d("div");»É.className="time",»É.textContent="Source: "+(«º.source.name||"unknown")+"; Author: "+(«º.author||"unknown")+"; Published at "+I(«º.publishedAt),»Ä.appendChild(»É)}«Ω.appendChild(»Ä)}«Ω.onclick=()=>{U(«º.url)},«∫.appendChild(«Ω)}}catch(»Ñ){«∫.textContent="Failed to fetch from the API server. Message: "+»Ñ}}if("https://nettleweb.com"===A.origin){x=√Ü(O({
appId:"1:176227430389:web:94270de43b7eb971c03abc",apiKey:"AIzaSyCPXTy7dt3fpcLd8kVTBtXy0xuBdeuhbFc",projectId:"whitespider",authDomain:"whitespider.firebaseapp.com",databaseURL:"https://whitespider-default-rtdb.firebaseio.com",storageBucket:"whitespider.firebasestorage.app",measurementId:"G-F72WBJT57S",messagingSenderId:"176227430389"},"NettleWeb"));const »Ö=await J("https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7505521340110301");if(null!=»Ö&&»Ö.length>0){{
const »Ü=d("ins");»Ü.className="adsbygoogle",»Ü.setAttribute("data-ad-slot","5345722600"),»Ü.setAttribute("data-ad-client","ca-pub-7505521340110301"),»Ü.setAttribute("data-ad-format","auto"),»Ü.setAttribute("data-full-width-responsive","true"),w.appendChild(»Ü)}{Object.defineProperty(B,"createElement",{value:(A,B)=>{const C=d(A,B);return"iframe"===C.tagName.toLowerCase()&&C.setAttribute("credentialless","true"),C},writable:!1,enumerable:!1,configurable:!1});const »á=B.createElementNS.bind(B)
;Object.defineProperty(B,"createElementNS",{value:(A,B,C)=>{const D=»á(A,B,C);return"iframe"===D.tagName.toLowerCase()&&D.setAttribute("credentialless","true"),D},writable:!1,enumerable:!1,configurable:!1})}try{Function("arguments","globalThis","window","frames","self","document",»Ö).call(A,void 0,A,A,A,A,B)}catch(»à){}(A.adsbygoogle||=[]).push(1)}else E("You are using an ad blocker. Please disable it to support this website's development.")}else W();{async function »â(){√Å(),r.title="My Account",
r.setAttribute("data-ac",""),C("ac-prof").style.display="block",C("chat-login").remove(),C("login-dialog").remove();const A=C("ac-bio"),B=C("ac-name"),D=C("ac-email"),F=C("ac-un"),G=C("ac-edit"),I=C("ac-link"),J=C("ac-bio-edit"),M=C("ac-name-edit"),N=C("ac-email-edit"),O=C("cp"),P=C("rs"),R=C("tf");"1"===o.getItem("__?2fa")&&(R.setAttribute("data-enabled",""),R.textContent="Disable Two-Factor");const S=C("ch-avatar"),T=S.firstElementChild,U=d("img");U.alt="Avatar",U.width=40,U.height=40,
U.loading="eager",U.decoding="sync",U.draggable=!1,√ñ.appendChild(U);const V=d("div");V.className="user",√ñ.appendChild(V),√ñ.style.display="block";const W=await L(2,y);√ä=W.likes;const X=W.id,Y=W.uid,a=W.name;if(null!=x&&(√á(x,Y,{global:!0}),√à(x,{id:X,uid:Y,name:a},{global:!1})),"string"!=typeof X||X.length<4||"string"!=typeof Y||Y.length<2)E("Error: Server response parse error.");else{switch(A.textContent=W.bio||"NettleWeb User",B.textContent=a||"Not set",D.textContent=W.email||"Not set",
T.src=U.src=H(W.icon),F.textContent=X,V.textContent=X,C("ac-uid").textContent=Y,W.unread&&u.setAttribute("data-unread",""),W.vip){case 3:C("ac-membership").textContent="Gold üëë",F.setAttribute("data-vip","gold"),V.setAttribute("data-vip","gold");break;case 4:C("ac-membership").textContent="Diamond üíé",F.setAttribute("data-vip","diamond"),V.setAttribute("data-vip","diamond");break;default:C("ac-membership").textContent="None"}{const A=C("ac-games"),B=¬∫.filter((A=>A.user===Y));let D=25
;for(const C of B.slice(0,25))A.appendChild(Q(C));A.onscrollend=()=>{if(D<B.length&&A.scrollTop>=A.scrollHeight-A.clientHeight)for(const C of B.slice(D,D+=25))A.appendChild(Q(C))}}S.onclick=()=>{const A=d("input");A.type="file",A.accept="image/*",A.onchange=async()=>{const B=A.files?.item(0);if(null!=B){const A=await K(B,512,512);if(null==A)return void E("Error: Failed to resize image.");try{await L(4,[y,await A.arrayBuffer()])}catch(A){
return void E("Failed to upload the image file. Message: "+A)}const C=URL.createObjectURL(A);T.src=U.src=C,await T.decode(),await U.decode(),URL.revokeObjectURL(C)}},A.click()},G.onclick=()=>{const A=d("div"),B=d("input");B.type="text",B.value=F.innerHTML,B.minLength=4,B.maxLength=20,B.spellcheck=!1,B.placeholder="Username",B.autocomplete="off",A.appendChild(B);const C=d("button");C.type="button",C.title="Save",C.className="tick",A.appendChild(C);const D=d("button");D.type="button",
D.title="Cancel",D.className="cross",A.appendChild(D),B.onblur=()=>{const A=B.value.trim().toLowerCase();A.length>0&&(B.value=A)},C.onclick=()=>{const C=B.value.trim().toLowerCase();C.length<4||C.length>20?E("Username must be between 4 and 20 characters long."):/^[\-a-z0-9]+$/.test(C)?L(3,[y,C]).then((()=>{A.replaceWith(F),F.textContent=C,V.textContent=C,G.removeAttribute("style")})).catch((A=>{E("Failed to change username. Message: "+A)
})):E("Username must contain only hyphens, 0-9, lowercase a-z")},D.onclick=()=>{A.replaceWith(F),G.removeAttribute("style")},G.style.display="none",F.replaceWith(A),B.select()},I.onclick=()=>{const A="https://nettleweb.com/@"+X,B=d("span");B.textContent=A,I.replaceWith(B),navigator.clipboard.writeText(A).catch((A=>{E("Failed to copy link to clipboard. Message: "+A)}))},J.onclick=()=>{const B=d("div"),C=d("input");C.type="text",C.value=A.innerHTML,C.minLength=1,C.maxLength=500,C.spellcheck=!1,
C.placeholder="Bio",C.autocomplete="off",B.appendChild(C);const D=d("button");D.type="button",D.title="Save",D.className="tick",B.appendChild(D);const F=d("button");F.type="button",F.title="Cancel",F.className="cross",B.appendChild(F),C.onblur=()=>{const A=C.value.trim();A.length>0&&(C.value=A)},D.onclick=()=>{const D=C.value.trim();D.length>500?E("Bio cannot have more than 500 characters in length."):L(55,[y,D]).then((()=>{B.replaceWith(A),J.removeAttribute("style"),
A.textContent=D||"NettleWeb User"})).catch((A=>{E("Failed to update bio. Message: "+A)}))},F.onclick=()=>{B.replaceWith(A),J.removeAttribute("style")},J.style.display="none",A.replaceWith(B),C.select()},M.onclick=()=>{const A=d("div"),C=d("input");C.type="text",C.value=B.innerHTML,C.minLength=2,C.maxLength=30,C.spellcheck=!1,C.placeholder="Name",C.autocomplete="off",A.appendChild(C);const D=d("button");D.type="button",D.title="Save",D.className="tick",A.appendChild(D);const F=d("button")
;F.type="button",F.title="Cancel",F.className="cross",A.appendChild(F),C.onblur=()=>{const A=C.value.trim();A.length>0&&(C.value=A)},D.onclick=()=>{const D=C.value.trim();D.length>30?E("Name cannot have more than 30 characters in length."):L(20,[y,D]).then((()=>{A.replaceWith(B),B.textContent=D,M.removeAttribute("style")})).catch((A=>{E("Failed to update name. Message: "+A)}))},F.onclick=()=>{A.replaceWith(B),M.removeAttribute("style")},M.style.display="none",B.replaceWith(A),C.select()},
N.onclick=()=>{const A=d("div"),B=d("input");B.type="email",B.value=D.innerHTML,B.minLength=6,B.maxLength=320,B.spellcheck=!1,B.placeholder="Email",B.autocomplete="off",A.appendChild(B);const C=d("button");C.type="button",C.title="Save",C.className="tick",A.appendChild(C);const F=d("button");F.type="button",F.title="Cancel",F.className="cross",A.appendChild(F),B.onblur=()=>{const A=B.value.trim().toLowerCase();A.length>0&&(B.value=A)},C.onclick=()=>{const F=B.value.trim().toLowerCase()
;F.length<6||F.length>320||F.indexOf("@",1)<0?E("Please provide a valid email address."):L(19,[y,F]).then((()=>{{const B=d("div");B.textContent="Please check your inbox and fill in the 6-digit verification code below to verify your email address.",A.prepend(B)}B.type="text",B.value="",B.minLength=6,B.maxLength=6,B.placeholder="6-digit verification code",B.onblur=()=>{const A=B.value.trim();A.length>0&&(B.value=A)},C.onclick=()=>{const C=B.value.trim()
;6===C.length&&/^\d+$/.test(C)?L(18,[y,C]).then((()=>{A.replaceWith(D),D.textContent=F,N.removeAttribute("style")})).catch((A=>{E("Failed to verify your email. Message: "+A)})):E("The code provided must have exactly 6 digits.")}})).catch((A=>{E("Failed to update your email address. Message: "+A)}))},F.onclick=()=>{A.replaceWith(D),N.removeAttribute("style")},N.style.display="none",D.replaceWith(A),B.select()},O.onclick=()=>{const A=d("div");{const B=d("div")
;B.setAttribute("style","position:relative;display:block;width:fit-content;height:fit-content;margin:10px 0px;padding:5px;line-height:18px;"),B.innerHTML="Notice: If your account was created with your Google account and does not have a password, set the current password field to 'CHANGEME!'. After changing your password, previously logged-in sessions will still have access to your account. To revoke the access, click the 'logout all sessions' button down below.",A.appendChild(B)}
const B=d("input");B.type="password",B.minLength=8,B.maxLength=30,B.spellcheck=!1,B.placeholder="Current password",B.autocomplete="off",A.appendChild(B);const C=d("input");C.type="password",C.minLength=8,C.maxLength=30,C.spellcheck=!1,C.placeholder="New password",C.autocomplete="off",A.appendChild(C);const D=d("input");D.type="password",D.minLength=8,D.maxLength=30,D.spellcheck=!1,D.placeholder="Confirm password",D.autocomplete="off",A.appendChild(D);const F=d("button");F.type="button",
F.title="Change",F.className="tick",A.appendChild(F);const G=d("button");G.type="button",G.title="Cancel",G.className="cross",A.appendChild(G),F.onclick=()=>{const F=B.value;if(F.length<8||F.length>30)return void E("The current password must have 8 to 30 characters.");const G=C.value;G.length<8||G.length>30?E("The new password must have 8 to 30 characters."):F!==G?G===D.value?L(9,[y,F,G]).then((()=>{A.replaceWith(O)})).catch((A=>{E("Failed to change password. Message: "+A)
})):E("The confirm password does not match the new password."):E("The new password must be different from the current password.")},G.onclick=()=>{A.replaceWith(O)},O.replaceWith(A)},P.onclick=()=>{L(43,y).then((A=>{"string"==typeof A&&2048===A.length?(¬™.send(”∫.encode(""+(y=A))),o.setItem("__secrets_",A),P.disabled=!0):E("Error: Remote returned invalid token.")})).catch((A=>{E("Failed to revoke login tokens. Message: "+A)}))},R.onclick=()=>{const A=d("div");if(R.hasAttribute("data-enabled")){
const B=d("input");B.type="text",B.minLength=6,B.maxLength=6,B.spellcheck=!1,B.placeholder="6-digit verification code",B.autocomplete="off",A.appendChild(B);const C=d("button");C.type="button",C.title="Change",C.className="tick",A.appendChild(C),C.onclick=()=>{const C=B.value.trim();6===C.length&&/^\d+$/.test(C)?L(46,[y,C]).then((()=>{o.setItem("__?2fa","0"),A.replaceWith(R),R.removeAttribute("data-enabled"),R.textContent="Enable Two-Factor"})).catch((A=>{
E("Failed to enable two-factor authentication. Message: "+A)})):E("The code provided must have exactly 6 digits.")}}else{{const B=d("div");B.setAttribute("style","position:relative;display:block;width:fit-content;height:fit-content;margin:15px 0px;line-height:18px;white-space:pre-wrap;"),
B.innerHTML='In order to enable two-factor authentication (2FA), please follow the steps below:\n1. Install an <a href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2" target="_blank" rel="noopener">authenticator app</a> if you don\'t have one already.\n2. Scan the QR code below or manually input the secret to save your account onto the authenticator.\n3. Input the 6-digit verification code generated below to verify.\n\nAfter enabling 2FA, you will be required to input the generated 6-digit verification code everytime as you login for enhanced account security.\n\nTo avoid being locked out, save the secret or a screenshot of the QR code across multiple devices, so that it could be restored back into the authenticator in case you lost your data.',
A.appendChild(B)}const B=Œ∫.Base32.encode(crypto.getRandomValues(new Uint8Array(new ArrayBuffer(32),0,32)));{const C=d("img");C.alt="QR Code",C.width=147,C.height=147,C.loading="eager",C.decoding="sync",C.draggable=!1,C.src=œ•("otpauth://totp/NettleWeb:"+X+"?secret="+B+"&issuer=NettleWeb&algorithm=SHA1").toDataURL({type:"image/png",scale:3}),A.appendChild(C)}{const C=d("div")
;C.setAttribute("style","position:relative;display:block;width:fit-content;height:fit-content;margin:15px 0px;line-height:18px;"),C.textContent="Secret: "+B,A.appendChild(C)}const C=d("input");C.type="text",C.minLength=6,C.maxLength=6,C.spellcheck=!1,C.placeholder="6-digit verification code",C.autocomplete="off",A.appendChild(C);const D=d("button");D.type="button",D.title="Change",D.className="tick",A.appendChild(D),D.onclick=()=>{const D=C.value.trim()
;6===D.length&&/^\d+$/.test(D)?L(44,[y,B,D]).then((()=>{o.setItem("__?2fa","1"),A.replaceWith(R),R.setAttribute("data-enabled",""),R.textContent="Disable Two-Factor"})).catch((A=>{E("Failed to enable two-factor authentication. Message: "+A)})):E("The code provided must have exactly 6 digits.")}}const B=d("button");B.type="button",B.title="Cancel",B.className="cross",A.appendChild(B),B.onclick=()=>{A.replaceWith(R)},R.replaceWith(A)},C("so").onclick=()=>{o.removeItem("__secrets_"),
setTimeout((()=>Z.reload()),200)},C("da").onclick=()=>{E("Error: Operation not permitted.")},C("account-settings").style.display="block"}}if(null!=y){const »ì=await new Promise((A=>{√å=()=>{√å=√ç=null,A(null)},√ç=B=>{√å=√ç=null,A(B)},¬™.send(”∫.encode(""+y))}));if(null==»ì)return void await »â();E("Failed to validate login token. Please login again. Message: "+»ì),y=null}const »ä=C("login-dialog");let »ã,»å,»ç;function »é(){»ä.style.display="none",»ä.innerHTML="";{const A=d("h3");A.textContent="Login",
»ä.appendChild(A)}const A=d("input");A.type="text",A.value=»å||"",A.required=!0,A.minLength=4,A.maxLength=320,A.spellcheck=!1,A.placeholder="Username/Email",A.autocomplete="off",»ä.appendChild(A);const B=d("input");B.type="password",B.value=»ç||"",B.required=!0,B.minLength=8,B.maxLength=30,B.spellcheck=!1,B.placeholder="Password",B.autocomplete="off",»ä.appendChild(B);const C=d("button");C.type="button",C.className="pri-button",C.textContent="Login",»ä.appendChild(C);const D=d("div");D.tabIndex=0,
D.textContent="Register",»ä.appendChild(D);const F=d("div");F.tabIndex=0,F.textContent="Forgot password",»ä.appendChild(F);const G=d("div");G.tabIndex=0,G.textContent="Sign in with Google",»ä.appendChild(G),A.onblur=()=>{const B=A.value.trim().toLowerCase();B.length>0&&(»å=A.value=B)},B.onblur=()=>{const A=B.value;A.length>0&&(»ç=A)},C.onclick=()=>{const C=»å=A.value.trim().toLowerCase();if(C.indexOf("@",1)<0){
if(C.length<4||C.length>20)return void E("Username must be between 4 and 20 characters long.");if(!/^[\-a-z0-9]+$/.test(C))return void E("Username must contain only hyphens, 0-9, lowercase a-z.")}else if(C.length<6||C.length>320)return void E("Invalid email address. (Usernames should not contain a '@' symbol)");const D=»ç=B.value;D.length<8||D.length>30?E("Password must be between 8 and 30 characters long."):L(10,[C,D]).then((A=>{
"string"==typeof A?»ë(A):E("Error: Remote returned invalid token data.")})).catch((A=>{E("Failed to retrieve login token. Message: "+A)}))},D.onclick=»è,F.onclick=»ê,G.onclick=»í,»ä.style.display="block"}function »è(){»ä.style.display="none",»ä.innerHTML="";{const A=d("h3");A.textContent="Register",»ä.appendChild(A)}const A=d("input");A.type="text",A.value=»å||"",A.required=!0,A.minLength=4,A.maxLength=20,A.spellcheck=!1,A.placeholder="Username",A.autocomplete="off",»ä.appendChild(A);const B=d("input")
;B.type="email",B.value=»ã||"",B.required=!0,B.minLength=6,B.maxLength=320,B.spellcheck=!1,B.placeholder="Email",B.autocomplete="off",»ä.appendChild(B);const C=d("input");C.type="password",C.value=»ç||"",C.required=!0,C.minLength=8,C.maxLength=30,C.spellcheck=!1,C.placeholder="Password",C.autocomplete="off",»ä.appendChild(C);const D=d("input");D.type="password",D.value="",D.required=!0,D.minLength=8,D.maxLength=30,D.spellcheck=!1,D.placeholder="Confirm password",D.autocomplete="off",»ä.appendChild(D)
;const F=d("input");F.id="tos-check",F.type="checkbox",F.required=!0,»ä.appendChild(F);{const A=d("label");A.htmlFor="tos-check",A.innerHTML='I have read and accepted NettleWeb\'s <a href="https://nettleweb.com/terms.html" target="blank" rel="noopener">Terms of Service</a>.',»ä.appendChild(A)}const G=d("button");G.type="button",G.className="pri-button",G.innerHTML="Register",»ä.appendChild(G);const H=d("div");H.tabIndex=0,H.innerHTML="Login",»ä.appendChild(H);const I=d("div");I.tabIndex=0,
I.innerHTML="Sign in with Google",»ä.appendChild(I),A.onblur=()=>{const B=A.value.trim().toLowerCase();B.length>0&&(»å=A.value=B)},B.onblur=()=>{const A=B.value.trim().toLowerCase();A.length>0&&(»ã=B.value=A)},C.onblur=()=>{const A=C.value;A.length>0&&(»ç=A)},G.onclick=()=>{const G=»å=A.value.trim().toLowerCase();if(G.length<4||G.length>20)return void E("The username must be between 4 and 20 characters long.")
;if(!/^[\-a-z0-9]+$/.test(G))return void E("The username must contain only hyphens, lowercase a-z and 0-9.");const H=»ã=B.value.trim().toLowerCase();if(H.length<6||H.length>320||H.indexOf("@",1)<0)return void E("Please provide a valid email.");const J=»ç=C.value;J.length<8||J.length>30?E("The password must be between 8 and 30 characters long."):J===D.value?F.checked?L(11,[G,J,H]).then((()=>{»ä.style.display="none",»ä.innerHTML="";{const A=d("h3");A.textContent="Verify Email",»ä.appendChild(A)}{
const A=d("span");A.textContent="Please check your inbox and fill in the 6-digit verification code below to verify your email address.",»ä.appendChild(A)}const A=d("input");A.type="text",A.value="",A.required=!0,A.minLength=6,A.maxLength=6,A.spellcheck=!1,A.placeholder="6-digit verification code",A.autocomplete="off",»ä.appendChild(A);const B=d("button");B.type="button",B.className="pri-button",B.textContent="Verify",»ä.appendChild(B);{const A=d("span")
;A.textContent="Notice: If you are using a managed email address (ie. school or work) and did not receive a code in your inbox after several attempts, the code is likely to be blocked by your administrator. In this case, using a personal account could help.",»ä.appendChild(A)}»ä.appendChild(I),A.onblur=()=>{const B=A.value.trim();B.length>0&&(A.value=B)},B.onclick=()=>{const B=A.value.trim();6===B.length&&/^\d+$/.test(B)?L(17,[G,B]).then((A=>{
"string"==typeof A&&2048===A.length?(¬™.send(”∫.encode(""+(y=A))),o.setItem("__secrets_",A),»â()):E("Error: Remote returned invalid token data.")})).catch((A=>{E("Failed to verify your email address. Message: "+A)})):E("The code provided must have exactly 6 digits.")},»ä.style.display="block"})).catch((A=>{E("Failed to send request. Message: "+A)})):E("Please check the checkbox above to accept the Terms of Service."):E("The confirm password does not match.")},H.onclick=»é,I.onclick=»í,
»ä.style.display="block"}function »ê(){»ä.style.display="none",»ä.innerHTML="";{const A=d("h3");A.textContent="Reset Password",»ä.appendChild(A)}const A=d("input");A.type="email",A.value=»ã||"",A.required=!0,A.minLength=6,A.maxLength=320,A.spellcheck=!1,A.placeholder="Email",A.autocomplete="off",»ä.appendChild(A);const B=d("button");B.type="button",B.className="pri-button",B.textContent="Continue",»ä.appendChild(B);const C=d("div");C.tabIndex=0,C.textContent="Login",»ä.appendChild(C);const D=d("div")
;D.tabIndex=0,D.textContent="Register",»ä.appendChild(D);const F=d("div");F.tabIndex=0,F.textContent="Sign in with Google",»ä.appendChild(F),A.onblur=()=>{const B=A.value.trim().toLowerCase();B.length>0&&(»ã=A.value=B)},B.onclick=()=>{const B=»ã=A.value.trim().toLowerCase();B.length<6||B.length>320||B.indexOf("@",1)<0?E("Please provide a valid email."):L(21,B).then((()=>{»ä.style.display="none",»ä.innerHTML="";{const A=d("h3");A.textContent="Reset Password",»ä.appendChild(A)}{const A=d("span")
;A.textContent="Please check your inbox and follow the instructions on the email.",»ä.appendChild(A)}»ä.appendChild(C),»ä.appendChild(D),»ä.appendChild(F),»ä.style.display="block"})).catch((A=>{E("Failed to send request. Message: "+A)}))},C.onclick=»é,D.onclick=»è,F.onclick=»í,»ä.style.display="block"}function »ë(A){if(2048===A.length)return ¬™.send(”∫.encode(""+(y=A))),o.setItem("__secrets_",A),o.setItem("__?2fa","0"),void »â();»ä.style.display="none",»ä.innerHTML="";{const A=d("h3")
;A.textContent="Two-Factor Authentication",»ä.appendChild(A)}{const A=d("span");A.textContent="Please open your authenticator app and fill in the generated 6-digit verification code below.",»ä.appendChild(A)}const B=d("input");B.type="text",B.value="",B.minLength=6,B.maxLength=6,B.spellcheck=!1,B.placeholder="6-digit verification code",B.autocomplete="off",»ä.appendChild(B);const C=d("button");C.type="button",C.className="pri-button",C.textContent="Verify",»ä.appendChild(C),B.onblur=()=>{
const A=B.value.trim();A.length>0&&(B.value=A)},C.onclick=()=>{const C=B.value.trim();6===C.length&&/^\d+$/.test(C)?L(45,[A,C]).then((A=>{"string"==typeof A&&2048===A.length?(¬™.send(”∫.encode(""+(y=A))),o.setItem("__secrets_",A),o.setItem("__?2fa","1"),»â()):E("Error: Remote returned invalid token data.")})).catch((A=>{E("Failed to login with OTP. Message: "+A)})):E("The code provided must have exactly 6 digits.")},»ä.style.display="block"}function »í(){
const B=new URL("https://accounts.google.com/o/oauth2/v2/auth");{const C=B.searchParams;C.set("client_id","176227430389-qkdboctmfhe9jnvnk2vmarafc5p8amuf.apps.googleusercontent.com"),C.set("redirect_uri",A.origin+"/auth.html"),C.set("response_type","token"),C.set("state","12"),C.set("scope","email profile"),C.set("include_granted_scopes","true"),C.set("enable_granular_consent","true")}Z.replace(B)}{const »î=o.getItem("_cre_")||"";if(»î.length>0){try{const »ï=await L(0,»î)
;if("string"!=typeof »ï)return void E("Error: Remote returned invalid token data.");r.click(),»ë(»ï)}catch(»ñ){E("Failed to retrieve login token. Message: "+»ñ)}o.removeItem("_cre_")}else »é()}}})(window)})();